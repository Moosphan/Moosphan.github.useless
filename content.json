{"pages":[],"posts":[{"title":"Android Gradle3.0å¼€å§‹Implementation ä¸ Apiçš„çˆ±æ¨æƒ…ä»‡","text":"æœ¬æ–‡ç¿»è¯‘äº Bedanta Bikash Borah çš„æ–‡ç« ï¼ŒåŸæ–‡é“¾æ¥å¦‚ä¸‹ï¼š Implementation Vs Api in Android Gradle plugin 3.0 å½“æˆ‘ä»¬åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨ Gradle 3.0 åŠä»¥ä¸Šç‰ˆæœ¬çš„æ’ä»¶ï¼Œä½ ä¸€å®šä¼šæ³¨æ„åˆ° compile å…³é”®å­—å·²ç»è¢«å¼ƒç”¨æ¥æ”¯æŒ implementation å’Œ apiã€‚è®©æˆ‘ä»¬å€ŸåŠ©ä¸€ä¸ªä¾‹å­æ¥äº†è§£å®ƒä»¬ã€‚ ç¤ºä¾‹åº”ç”¨ (Kotlin) å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚ è®©æˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ª Android é¡¹ç›®åŒ…å«ä»¥ä¸‹å››ä¸ª library moduleï¼š LibraryA LibraryB LibraryC LibraryD å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š æ¯ä¸ª Library module éƒ½åŒ…å«ä¸€ä¸ªç®€å•çš„ç±»ã€‚ LibraryD: 123456class ClassD { fun tellMeAJoke():String{ return \"You are funny :D\" }} LibraryC: 12345class ClassC { fun tellMeAJoke(): String { return \"You are funny :C\" }} LibraryB: 12345678class ClassB { val b = ClassD() fun whereIsMyJoke(): String { return b.tellMeAJoke() }} LibraryA: 12345678class ClassA { val c = ClassC() fun whereIsMyJoke(): String { return c.tellMeAJoke() }} ä»ä¸Šé¢è¿™äº›ç±»æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ° LibraryA å’Œ LibraryB åˆ†åˆ«ä¾èµ–äº LibraryC å’Œ LibraryDã€‚å› æ­¤ï¼Œéœ€è¦å°†å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»æ·»åŠ åˆ° build.gradle æ–‡ä»¶å½“ä¸­ã€‚ Compile (2.0) or Api (3.0):3.0 ä¸­æ–°çš„ api å…³é”®å­—ä¸ä¹‹å‰ç‰ˆæœ¬çš„ compile å…³é”®å­—æ„ä¹‰å®Œå…¨ç›¸åŒã€‚å› æ­¤ï¼Œå¦‚æœé¡¹ç›®ä¸­æ‰€æœ‰ compile å…³é”®å­—è¢« api æ‰€å–ä»£ï¼Œè¿™å®Œå…¨å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨ LibraryB ä¸­é€šè¿‡ api å…³é”®å­—æ¥ä¾èµ– LibraryDï¼š 1234dependencies { . . . . api project(path: ':libraryD')} åŒæ ·åœ°ï¼Œå°† LibraryB æ·»åŠ åˆ° app æ¨¡å—ä¸­ï¼š 1234dependencies { . . . . api project(path: ':libraryB')} ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ app æ¨¡å—ä¸­è®¿é—®åˆ° LibraryB å’Œ LibraryDã€‚åœ¨ç¤ºä¾‹åº”ç”¨ä¸­ï¼Œä¸¤ä¸ªåº“çš„è®¿é—®å½¢å¼å¦‚ä¸‹ï¼š Implementation (3.0):ç°åœ¨æ˜¯æ—¶å€™æ¥æ‰¾å‡º implementation å’Œ api ä¹‹é—´çš„ä¸åŒä¹‹å¤„äº†ã€‚å†æ¬¡å›åˆ°ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œç°åœ¨è®©æˆ‘ä»¬åœ¨ LibraryA ä¸­é€šè¿‡ implementation å…³é”®å­—å¼•å…¥ LibraryCï¼š 1234dependencies { . . . . implementation project(path: ':libraryC')} App æ¨¡å—åŒç†ï¼š 1234dependencies { . . . . implementation project(path: ':libraryA')} ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ app æ¨¡å—è®¿é—® LibraryCï¼ŒAndroid studio å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼š è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬ä½¿ç”¨ implementation å…³é”®å­—ä»£æ›¿ apiï¼ŒLibraryC å°†æ— æ³•åœ¨ App æ¨¡å—ä¸­è¢«è®¿é—®ã€‚é‚£ä¹ˆ implementation è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ Implementation vs api:åœ¨ç¬¬ä¸€ä¸ªåœºæ™¯ä¸­ï¼ŒLibraryD æ˜¯é€šè¿‡ api å…³é”®å­—æ¥ç¼–è¯‘çš„ã€‚ä¸€æ—¦ LibraryD ä¸­çš„å®ç°åšäº†ä»»ä½•æ”¹åŠ¨ï¼Œé‚£ä¹ˆ gradle éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ LibraryDï¼ŒLibraryB å’Œæ‰€æœ‰å…¶ä»–å¼•å…¥ LibraryB çš„æ¨¡å—ä¸€æ ·å¯èƒ½ä½¿ç”¨çš„æ˜¯ LibraryD ä¸­çš„å®ç°ã€‚ ä½†åœ¨ç¬¬äºŒä¸ªåœºæ™¯ä¸­ï¼Œå¦‚æœæ›´æ”¹äº† LibraryC ä¸­çš„ä»£ç å®ç°ï¼Œé‚£ä¹ˆ Gradle åªä¼šé‡æ–°ç¼–è¯‘ LibraryC å’Œ LibraryAï¼Œå› ä¸ºå…¶ä»–ä»»ä½•æ²¡æœ‰ç›´æ¥ä¾èµ– LibraryC çš„ç±»éƒ½æ— æ³•ä½¿ç”¨å…¶ä¸­ä»»ä½•å®ç°ã€‚ å¦‚æœä½ æ­£åœ¨å¼€å‘å…·æœ‰å¤šä¸ªæ¨¡å—çš„é¡¹ç›®ï¼Œé‚£ä¹ˆè¿™ç§ç­–ç•¥å¯ä»¥æ˜¾è‘—åŠ å¿«æ„å»ºè¿‡ç¨‹ã€‚æˆ‘åœ¨ç¤ºä¾‹ç¨‹åºä¸­è¿›è¡Œäº†å°è¯•ï¼Œå‡ ç§’é’Ÿåå°±æœ‰äº†ä¸€äº›æ”¹è¿›ã€‚ä»¥ä¸‹æ˜¯æ‰€æœ‰æ–¹æ¡ˆçš„æ„å»ºæŠ¥å‘Šã€‚ å…¨é‡æ„å»º: å˜æ›´ LibraryD: å˜æ›´ libraryC: æ€»ç»“Android Gradle æ’ä»¶ç‰ˆæœ¬å‡çº§è‡³3.0ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ‰€æœ‰ compile æ›¿æ¢ä¸º implementation å…³é”®å­—å¹¶å°è¯•æ„å»ºé¡¹ç›®ã€‚å¦‚æœå¯ä»¥æ„å»ºæˆåŠŸï¼Œé‚£ä¹ˆå¾ˆå¥½ã€‚å¦åˆ™ï¼Œè¯·æŸ¥æ‰¾ä»»ä½•ä½ å¯èƒ½æ­£åœ¨ä½¿ç”¨çš„é—æ¼çš„ä¾èµ–åº“ï¼Œå¹¶æ‰¾åˆ°å®¿ä¸» library æ¢ç”¨ api å…³é”®å­—å¼•å…¥è¿™äº› libraryã€‚","link":"/2020/08/19/Android-Gradle3-0%E5%BC%80%E5%A7%8BImplementation-%E4%B8%8E-Api%E7%9A%84%E7%88%B1%E6%81%A8%E6%83%85%E4%BB%87/"},{"title":"ã€Œ2019ï¼Œè·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ã€","text":"ä¸Šå¤©æ€»æ˜¯â€œç¥ä¸çŸ¥é¬¼ä¸è§‰â€åœ°å·èµ°ä½ çš„æ—¶é—´ï¼Œæ¯å½“æˆ‘ä»¬å›é¡¾çš„æ—¶å€™æ‰å€æ„Ÿçæƒœã€‚ 2019å¹´åˆè§„åˆ’çš„â€œè±ªæƒ…å£®å¿—â€ï¼Œå¦‚ä»Šçœ‹æ¥ï¼Œå·²ç„¶è¢«æ—¶é—´é•¿æ²³æ©åŸ‹å’Œè…åŒ–ï¼š Android æ·±å…¥å­¦ä¹  æ·±å…¥ Kotlin è¯­è¨€å­¦ä¹ å’Œå®è·µ äº†è§£è·¨å¹³å°å¼€å‘åŠå‰ç«¯å¼€å‘ äº†è§£Flutterå¹¶ä½œå®ä¾‹è®­ç»ƒ ç¨³å®šç»´æŠ¤ä¸€ä¸ªå¼€æºé¡¹ç›® å­¦ä¹  Python å’Œæ•°æ®çˆ¬è™«ã€åˆ†æç­‰ æŠ€æœ¯æ–‡ç« æ¯æœˆè‡³å°‘å‘è¡¨ä¸€ç¯‡ äº†è§£é¡¹ç›®ç®¡ç†ç›¸å…³ä¸“ä¸šçŸ¥è¯† æŠ€æœ¯ã€äº§å“ã€èŒä¸šå‘å±•ã€ä¸ªäººæˆé•¿ç­‰ç›¸å…³ä¹¦ç± Ã— 10 äº”æ¬¾æ¡†æ¶æºç é˜…è¯»ã€è§£æå’Œå®æˆ˜åº”ç”¨ åˆ’çº¿éƒ¨åˆ†å°±æ˜¯ä»Šå¹´æœªå®Œæˆçš„è®¡åˆ’ï¼Œæœ‰ä¸€åŠéƒ½è¢«ææµ…äº†ï¼Œæƒ³æ¥ç€å®æƒ­æ„§ã€‚ä¸è¿‡ï¼Œè™½ç„¶æœŸé—´ä¹Ÿæœ‰å¾ˆå¤šçªå‘äº‹ä»¶æ‰“æ–­äº†åŸæœ¬è®¡åˆ’ï¼Œæ¯”å¦‚å…¬å¸ä¸šåŠ¡å˜è¿ã€é¡¹ç›®èŒè´£å˜æ›´ã€ä¸ªäººå…´è¶£è½¬å˜ã€ç”Ÿæ´»çäº‹ç­‰ç­‰ï¼Œä½†ä¹Ÿè¿˜æ˜¯ Get åˆ°äº†ä¸€äº›è®¡åˆ’å¤–çš„æ”¶è·ï¼Œä¹Ÿç®—ç»™ç„¦èºçš„å†…å¿ƒå¸¦æ¥ä¸€ä¸å®‰æ…°ã€‚ å›é¡¾ 20192019ï¼Œè¿™çŸ­çŸ­çš„ä¸€å¹´ç»å†äº†å¤§å¤§å°å°çš„äº‹æƒ…ï¼Œè™½ç„¶é”™è¿‡äº†å¾ˆå¤šï¼Œå´ä¹Ÿæ”¶è·äº†å¾ˆå¤šã€‚é¦–å…ˆä»æŠ€æœ¯é¢†åŸŸè¯´èµ·ã€‚ Android é¢†åŸŸè‡ªæ¯•ä¸šå¼€å§‹åˆ°ç°åœ¨ï¼Œæˆ‘å·²ç»åœ¨ Android æ–¹é¢æ‘¸çˆ¬æ»šæ‰“äº†ä¸¤ä¸ªå¤šå¹´å¤´äº†ã€‚2019ï¼Œå·²ç»ä¸åƒå‰ä¸€å¹´é‚£æ ·è¿›æ­¥é£å¿«äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯â€œæ­¥å±¥ç»´è‰°â€ï¼Œè®©æ€è€ƒå’Œç»éªŒæ¥æ²‰æ·€è‡ªå·±ï¼Œè¿™åº”è¯¥ä¹Ÿç®—æ˜¯æ¯ä¸ªæŠ€æœ¯äººå‘˜å¿…ç»çš„æ—¶æœŸå§ã€‚ä»¥å¾€å¼€å‘è¿‡ç¨‹ä¸­æ›´å¤šçš„æ˜¯â€œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šâ€å»å¿«é€Ÿå¼€å‘å’Œå®Œæˆä»»åŠ¡ï¼Œç¼ºå°‘ä¸ªäººçš„æ€è€ƒå’Œå¯¹äºæŠ€æœ¯çºµå‘æ·±åº¦çš„é¢†æ‚Ÿï¼Œä»¥è‡³äºå‡ºç°æŸäº›ç‰¹å®šé—®é¢˜æ²¡æœ‰ç»™å‡ºè‰¯å¥½æ–¹æ¡ˆå»è§£å†³çš„æƒ…å†µã€‚ äºæ˜¯ä¹ï¼Œä»Šå¹´ä¾¿å¼€å§‹äº†â€œç—›è‹¦è€Œå……å®â€çš„è¿›é˜¶ä¹‹è·¯ï¼Œä¹¦ç±ã€åšå®¢ã€è¯¾ç¨‹ã€æ–‡æ¡£ç­‰ç­‰çŸ¥è¯†æ¶“æ¶“ç»†æµçŒè¾“äºå¿ƒï¼Œè®©æˆ‘è‡ªèº«åœ¨è€ƒè™‘å’Œè§£å†³é—®é¢˜è§’åº¦åŠæ€åº¦æ–¹é¢å‘ç”Ÿå¾ˆå¤§è½¬å˜ã€‚æ¯”å¦‚ï¼Œåœ¨å·¥ä½œæµç¨‹ä¸Šï¼Œä»¥å¾€å®Œæˆä¸€é¡¹éœ€æ±‚å¼€å‘ä»»åŠ¡ä¼šç›´æ¥æ‰‹ç»˜å‡ºå¤§æ¦‚ä¸šåŠ¡é€»è¾‘å’Œå¤æ‚ç‚¹ï¼Œç„¶åä¾¿ç›´æ¥ç€æ‰‹å¼€å‘ï¼›è€Œä»Šï¼Œä¼šåœ¨å¼€å‘å‰å…ˆå»é€šè¿‡â€œéœ€æ±‚çœ‹æ¿â€æ¥ç»†åˆ†éœ€æ±‚ï¼Œè€Œåå€ŸåŠ©äºæµç¨‹å›¾å»ç†æ¸…ä¸šåŠ¡å…³ç³»å’Œç”¨æˆ·äº¤äº’ç»†èŠ‚ï¼Œæ¥ç€é€šè¿‡ TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰æ¨¡å¼æ¥ç¼–å†™å•å…ƒæµ‹è¯•å¹¶ç¼–å†™å’Œè·‘é€šå¯¹åº”çš„åŠŸèƒ½ä»£ç ã€‚å½“ç„¶ï¼Œåœ¨ç¼–å†™ä»£ç å‰ä¹Ÿéœ€è¦è€ƒè™‘å¾ˆå¤šäº‹æƒ…ï¼Œå¦‚é€‰æ‹©ä¸åŒçš„å®ç°æ€è·¯ï¼Œå¯¹åº”çš„å‰æœŸæŠ•å…¥ã€å¼€å‘æˆæœ¬ã€ç»´æŠ¤æˆæœ¬ç­‰å¯èƒ½ä¼šå¤§ç›¸å¾„åº­ã€‚æ­¤å¤–ï¼Œåœ¨ç»å†ä¸€æ®µæ—¶é—´å°å›¢é˜Ÿå¼€å‘å½¢å¼åï¼Œå¼€å‘è§„èŒƒçš„é‡è¦æ€§ä¹Ÿæ—¥ç›Šå‡¸æ˜¾ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬éœ€è¦å½¢æˆä¸€ä¸ªç»Ÿä¸€ã€è§„èŒƒåŒ–å’Œç³»ç»ŸåŒ–çš„å¼€å‘æ¨¡å¼ï¼ŒåŒæ—¶è¦å…»æˆä»£ç é‡æ„çš„ä¹ æƒ¯ï¼ˆä»£ç è§„èŒƒå¯å‚è€ƒé˜¿é‡ŒAndroidå¼€å‘è§„èŒƒï¼‰ã€‚ å¦å¤–ï¼Œæ¯”è¾ƒâ€œå¹¸ç¦çš„ä¸€ä»¶äº‹â€æ˜¯é‡‡ç”¨äº† Kotlin è¯­è¨€æ…¢æ…¢ä»£æ›¿å…ˆå‰çš„ Java è¯­è¨€ï¼Œå¹¶ç€æ‰‹æ–°é¡¹ç›®å¼€å‘ä»¥åŠè€é¡¹ç›®çš„è¿­ä»£å’Œç»´æŠ¤å·¥ä½œã€‚å°± Android å¼€å‘è€Œè¨€ï¼Œé‡‡ç”¨å“ªç§è¯­è¨€å¹¶æ²¡æœ‰ç»å¯¹çš„å¥½ä¸åã€ä¼˜ä¸åŠ£ä¹‹åˆ†ï¼Œå…³é”®åœ¨äºâ€œæŒå‰‘çš„äººâ€ï¼šä¸€æŠŠç»ä¸–å¥½åˆ€åœ¨å¤§ä¾ æ‰‹ä¸­å¯èƒ½å°±æ˜¯åŠ«å¯Œæµè´«çš„åˆ©å™¨ï¼Œè€Œåœ¨å± å¤«æ‰‹ä¸­å¯èƒ½åªæ˜¯ä¸€æŠŠå……æ»¡è¡€è…¥å‘³çš„æ™®é€šçš„åˆ€è€Œå·²ã€‚ æœ€åï¼Œåœ¨ç³»ç»Ÿæºç é˜…è¯»æ–¹é¢æœ‰äº†ä¸€äº›è¿›å±•ï¼Œé€šè¿‡æŸ¥çœ‹å’Œåˆ†ææºç ï¼Œè¿›ä¸€æ­¥ç†Ÿæ‚‰ App ä»å®‰è£…åˆ°å¯åŠ¨å†åˆ°æ­£å¸¸è¿è¡Œçš„è¿‡ç¨‹ã€UIç»˜åˆ¶çš„æµç¨‹ã€ç»„ä»¶é€šä¿¡çš„è¿‡ç¨‹ç­‰ç­‰ï¼Œå¯ä»¥å¾ˆå¥½çš„å­¦ä¹ å„ç§è®¾è®¡æ¨¡å¼åœ¨Androidæºç ä¸­çš„çµæ´»åº”ç”¨å¹¶æ˜¾è‘—æå‡è§£å†³é—®é¢˜çš„èƒ½åŠ›å’Œä»£ç è§„èŒƒæ€§ã€‚å½“ç„¶ï¼Œè¿‡ç¨‹ç—›è‹¦ï¼Œä½†æƒ³è¦èœ•åŒ–æˆè¶ï¼Œå°±å¿…é¡»è¦ç»å†è¿™ä¸ªæ€æƒ³ç£¨ç ºçš„è¿‡ç¨‹ã€‚ æ­¤å¤„é™„ä»Šå¹´å·²è¯»éƒ¨åˆ†Androidä¹¦å•ï¼š ã€ŠAndroid å¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹ ã€ŠAndroid è¿›é˜¶ä¹‹å…‰ã€‹ ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹ ã€ŠGradle in Actionã€‹ ã€ŠAndroid ç§»åŠ¨æ€§èƒ½å®æˆ˜ã€‹ ã€ŠKotlin in Actionã€‹ Flutter æ–¹é¢ä»Šå¹´ï¼Œå¶ç„¶æœºä¼šæ¥è§¦äº†Flutterï¼Œè™½ç„¶é—®ä¸–ä¸ä¹…ï¼Œä½†ä» GitHub çš„ç«çƒ­ç¨‹åº¦ä»¥åŠæ€§èƒ½æ¥çœ‹ï¼Œæœªæ¥å‘å±•å½¢åŠ¿è‚¯å®šä¹Ÿæ˜¯ä¸€ç‰‡å¤§å¥½ã€‚å¤§æ¦‚åœ¨ 11 æœˆåˆï¼Œæˆ‘å‚ä¸äº†å…¬å¸æ–°é¡¹ç›®æŠ€æœ¯æ–¹é¢çš„é€‰å‹å’Œç ”ç©¶ï¼Œç”±äºæ–°é¡¹ç›®éœ€æ±‚å¹¶ä¸å¤æ‚ï¼Œå°±è€ƒè™‘åˆ°é¡¹ç›®å¯ä»¥é€šè¿‡ Flutter æŠ€æœ¯æ¥å®ç°çš„å¯èƒ½æ€§ã€‚ç»è¿‡å‡ å¤©çš„åˆ†æå’Œè®¨è®ºï¼Œæœ€åç»ˆäºç¡®å®šä¸‹æ¥æ–°é¡¹ç›®é‡‡ç”¨ Flutter æ¥æ„å»ºã€‚å¦‚ä»Šï¼Œæˆ‘ä»¬å°ç»„å·²ç»å€ŸåŠ©äº Flutter æ¥å¼€å‘é¡¹ç›®æœ‰ä¸€ä¸ªå¤šæœˆäº†ï¼Œè™½ç„¶æœ‰äº›ç£•ç£•ç»Šç»Šï¼Œä½†ä¹Ÿå¹¶æ²¡æœ‰å‘ç°æ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜ï¼Œè¿‘æœŸé¡¹ç›®ä¹Ÿä¸€ç›´å¤„äºç¨³æ­¥çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¢„è®¡å°†äºå¹´å‰ä¸Šçº¿ã€‚ å¼€æºé¡¹ç›®å¹¸è¿çš„æ˜¯ï¼Œ2019 å¹´åˆï¼Œä¸€ä¸ªå¶ç„¶çš„æœºä¼šï¼Œæˆ‘å’Œå‡ ä¸ªæœ‹å‹è®¨è®ºä¸€äº› Android é¢è¯•æ–¹é¢çš„é—®é¢˜ï¼Œäºæ˜¯ä¾¿æ¶Œèµ·äº†ä¸€ä¸ªç‰¹æ®Šçš„æƒ³æ³•ï¼šä½•ä¸å°†é¢è¯•é¢˜é€šè¿‡â€œæ¯å¤©ä¸€é—®â€çš„å½¢å¼åœ¨ GitHub ä¸Šé¢åˆ›å»ºä¸€ä¸ªå¼€æ”¾ä»“åº“å‘¢ï¼ŸåŸºäºè¿™ä¸ªä¸–ç•Œæœ€å¤§çš„æŠ€æœ¯ç¤¾åŒºï¼Œå¤§å®¶å¯ä»¥é€šè¿‡ Issue æ¥è®¨è®ºæ¯å¤©çš„é¢è¯•é¢˜ï¼Œç•…æ‰€æ¬²è¨€ã€‚æ¥ç€ï¼Œè¿™ä¸ªè®¡åˆ’ â€”â€” Android daily Interview å°±äºå‡ å¤©åè¢«æˆåŠŸå®æ–½ï¼Œå¹¶ä¸€ç›´åšæŒç»´æŠ¤åˆ°äº†ç°åœ¨ï¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­å·²ç» 300 å¤©äº†ï¼Œç´¯è®¡æœ‰ 200 æœŸäº†ã€‚åœ¨æ­¤æœŸé—´ï¼Œä¹Ÿæ„Ÿè°¢æ´‹å“¥çš„å¤šæ¬¡æ¨èï¼Œè®©æ›´å¤šå°ä¼™ä¼´å‚ä¸è¿›æ¥ï¼Œä¸è®ºæ˜¯å»ºè®®è¿˜æ˜¯å‚ä¸ç­”é¢˜åˆæˆ–æ˜¯æä¾›é¢è¯•é¢˜ï¼Œä¸è¾è¾›è‹¦ï¼Œéƒ½ä¸ºäº†è¿™ä¸ªé¡¹ç›®å¥‰çŒ®äº†è‡ªå·±çš„åŠ›é‡ï¼Œåœ¨è¿™é‡Œæˆ‘è¦å¯¹ä»–ä»¬è¡¨ç¤ºæœ€çœŸæŒšçš„æ„Ÿè°¢ğŸ™ã€‚ å¦‚æœä½ è¿‘æœŸæˆ–åç»­æœ‰æ¢å·¥ä½œéœ€è¦ï¼Œåˆæˆ–æ˜¯æœ‰å¿ƒæƒ³å‚ä¸è¿›æ¥ï¼Œæ¬¢è¿ç­”é¢˜ or ä¸€èµ·åšæŒã€ç»´æŠ¤ä¸‹å»ï¼âœŠ å¦å¤–ï¼Œæœ€è¿‘ç€æ‰‹å¼€å‘ä¸€ä¸ªä¸ªäººåº”ç”¨ â€”â€” Sightï¼ŒåŸºäº Kotlin å’Œ JetPackï¼Œé¢„è®¡å°†äºå¹´åä¸Šæ¶å¹¶å¼€æºã€‚ æ–‡ç« åˆ›ä½œå›é¡¾è¿™ä¸€å¹´ï¼ŒæŠ€æœ¯æ–‡ç« äº§é‡é™ä½äº†ï¼Œè™½ç„¶æ›´åŠ å¿™ç¢Œäº†ï¼Œä½†å§‹ç»ˆæ— æ³•ä»¥æ­¤ä¸ºç†ç”±æ¥æªå¡è‡ªå·±ã€‚ä¸è¿‡ï¼Œæ–‡ç« åˆ›ä½œä¸Šæ›´åŠ æœ‰æ¡ç†æ€§å’Œç³»ç»Ÿäº†ï¼Œä¸å†åƒä»¥å‰é‚£æ ·æŒ¥ç¬”ç–¾æ¥äº†ï¼Œè€Œæ˜¯å…ˆæ„æ€ä¸€ä¸‹å¹¶æ€è€ƒç¼–æ’°æ–¹å¼ï¼Œå½“ç„¶ï¼Œéšä¹‹è€Œæ¥çš„æ˜¯æ—¶é—´æˆæœ¬çš„å¢åŠ ï¼Œä¸è¿‡ï¼Œæ˜¾ç„¶è¿™äº›ä»˜å‡ºæ˜¯å€¼å¾—çš„ã€‚ä¹Ÿæ˜¯åœ¨ä»Šå¹´æ‰é™†ç»­åœ¨æ˜é‡‘ä¸Šå‘è¡¨æ–‡ç« ï¼Œè™½ç„¶æ•°é‡ä»…æœ‰å‡ ç¯‡ï¼Œæ‰€å¹¸æ–‡ç« çš„æ›å…‰åº¦å’Œåå“éƒ½è¿˜ä¸é”™ï¼Œæ”¶è·äº†å¤§æ¦‚ 2000 å…³æ³¨åº¦ï¼Œè¿™ä¹Ÿå°†ç»§ç»­æ¿€åŠ±æˆ‘è¿›è¡Œåç»­çš„æ–‡ç« åˆ›ä½œã€‚ æŠ€æœ¯æ´»åŠ¨2019 ä¸‹åŠå¹´ï¼Œæœ‰å¹¸å‚åŠ äº†å‡ åœºæŠ€æœ¯åˆ†äº«ç››ä¼šï¼Œæ”¶è·è‰¯å¤šã€‚9 æœˆä»½çš„ Google IO å¤§ä¼šä¸Šï¼Œæˆ‘å†ä¸€æ¬¡æ„Ÿå—äº†ç§‘æŠ€è¿›æ­¥çš„é­…åŠ›ï¼Œå‡ ä¹æ¯å¹´éƒ½èƒ½æ„Ÿå—åˆ°æŠ€æœ¯å˜åŒ–å¸¦æ¥çš„æƒŠå–œï¼Œè¿™ç§å–œæ‚¦å¹¶ä¸åªæ˜¯é’ˆå¯¹æˆ‘ä»¬æŠ€æœ¯äººå‘˜ï¼Œå¯¹äºå¹¿å¤§æ°‘ä¼—å’Œæ•´ä¸ªäº’è”ç½‘å¸‚åœºæ¥è¯´ä¹Ÿæ˜¯æœºé‡æ— é™ã€‚ä» Android 10 é—®ä¸–åˆ° Kotlin ä¸ JetPack çš„è¿›ä¸€æ­¥å‘å±•ï¼ŒAndroid åº”ç”¨å¼€å‘æˆæœ¬å¤§å¹…åº¦é™ä½ï¼ŒæŠ€æœ¯æ ˆä¹Ÿæ›´åŠ å®Œå–„å´ä¹Ÿå‘ˆç°â€œç™¾å®¶äº‰é¸£â€ä¹‹æ€ï¼›ä» Flutter 1.0 é—®ä¸–åˆ° 1.9 ç‰ˆæœ¬çš„å‘å¸ƒï¼Œè·¨å¹³å°å¼€å‘å°†å‘ˆç°æ›´å¤§çš„å‘å±•æ€åŠ¿ï¼›ä» ARCore å¢å¼ºç°å®æŠ€æœ¯åˆ° TensorFlow æœºå™¨å­¦ä¹ çš„ä¸æ–­æ”¹è¿›ï¼Œç§‘å¹»ç”µå½±ä¸­çš„â€œé»‘ç§‘æŠ€â€å°†ç¦»æˆ‘ä»¬ä¸å†é¥è¿œã€‚ éšç€ Material design è®¾è®¡æ€æƒ³çš„æ¨å¹¿å’Œä¼ æ’­ï¼Œæ–°çš„è®¾è®¡çš„é£æ ¼ä¹Ÿæ­£åœ¨ä¸€ç‚¹ç‚¹è¢«å¤§ä¼—æ‰€æ¥å—â€¦â€¦ ä¸šä½™é˜…è¯»é™¤äº†æŠ€æœ¯ä¹¦ç±ä»¥å¤–ï¼Œæˆ‘ä¹Ÿåœ¨ä¸€äº›â€œè¾¹è¾¹è§’è§’â€çš„æ—¶é—´çœ‹äº†ä¸€äº›å…¶ä»–æ–¹é¢çš„ä¹¦ç±ã€‚ä»ã€Šç©·æŸ¥ç†å®å…¸ã€‹ä¸­ï¼Œèƒ½ç»†å“æŸ¥ç†â€¢èŠ’æ ¼çš„äººç”Ÿæ™ºæ…§ï¼Œå—ç”¨æ— ç©·ï¼›ä»ã€Šå¢é•¿é»‘å®¢ã€‹ä¸­å­¦ä¹ äº†å¦‚ä½•é›¶æˆæœ¬æ¨å¹¿å’Œå‘å±•äº§å“ï¼›è¯»ã€Šä¹Œåˆä¹‹ä¼—ã€‹ä¸€ä¹¦ï¼Œè¿›ä¸€æ­¥è§£è¯»å¤§ä¼—å¿ƒæ€å’Œå¿ƒç†ï¼ŒåŒæ—¶è¦åœ¨æ™®éä»ä¼—çš„ç°è±¡ä¸­ä¿æŒè‡ªæˆ‘ï¼Œè€Œä¸æ˜¯æ²¦ä¸ºå•çº¯çš„â€œä¸€ç¾¤åªä¼šæ”»å‡»çš„é‡å…½â€ã€‚ æ–°ä¸€å¹´è§„åˆ’æ¥ä¸‹æ¥çš„ 2020ï¼Œåˆå°†æ˜¯ä¸€ä¸ªæ–°çš„å¼€å§‹ã€‚ä»è‹¥å¤šæ¡ˆä¾‹æ¥çœ‹ï¼Œæˆ‘æ·±çŸ¥å’±ä»¬ææŠ€æœ¯çš„å¦‚æœå­¦ä¸åŠ¨æˆ–è€…åœæ»äº†å‘å‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç¦»è¢«æ·˜æ±°ä¹Ÿå°±ä¸è¿œäº†ã€‚ç”Ÿæ´»ä¸­è‚¯å®šä¸èƒ½ä¸€ç›´æŠ±ç€â€œèˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´â€çš„å¿ƒæ€ï¼Œæå‰è§„åˆ’å­¦ä¹ ç›®æ ‡å’Œåˆ¶å®šæˆé•¿è·¯çº¿æ˜¾ç„¶æ‰æ˜¯ä¸Šç­–ã€‚ Android Android æ–¹é¢æ‰æ˜¯ä¸»æŠ€èƒ½ï¼Œåƒé¥­çš„å®¶ä¼™å¯ä¸èƒ½ä¸¢æ‰ï¼Œæ–°çš„ä¸€å¹´å°†ç»§ç»­ç ”è¯»æºç ã€æ·±å…¥ç ”ç©¶ View ç»˜åˆ¶ã€Binder æœºåˆ¶ã€æ’ä»¶åŒ–æ·±åº¦æ¢ç´¢ã€JVMè™šæ‹Ÿæœºã€Kotlin Coroutines ç­‰å†…å®¹ã€‚åç»­å°†å°½é‡å‡å°æ¨ªå‘æŠ€æœ¯çš„å‘æ•£ï¼Œè¿›ä¸€æ­¥åŠ å¼ºçºµå‘æŠ€æœ¯æ·±åº¦ã€‚Android æ¶‰åŠä¸šåŠ¡é¢†åŸŸä¼—å¤šï¼Œæˆ‘ç›¸ä¿¡ï¼Œå¦‚æœåœ¨ä»»ä½•ä¸€ä¸ªé¢†åŸŸç«™ç¨³è„šè·Ÿï¼Œé‚£ä¹ˆæœªæ¥çš„è·¯éƒ½ä¸ä¼šå¤ªå·®ï¼Œé‡è¦çš„æ˜¯åŠªåŠ›æ‰¾å‡†è‡ªå·±çš„æ–¹å‘å¹¶åšæŒâ€œé’»å­ç²¾ç¥â€ã€‚ Flutter Flutter ä»…ä»…æ¥è§¦äº†ä¸åˆ°ä¸¤ä¸ªæœˆï¼Œè™½ç„¶æ—¶é—´è¾ƒçŸ­ï¼Œä½†ä½œä¸ºä¸€é¡¹ä¸ªäººè¾…åŠ©æŠ€èƒ½ä¹Ÿæ˜¯æœªæ¥å¯æœŸã€‚æ‰€ä»¥ï¼Œæœªæ¥è¦åŠ æ·±è¿™éƒ¨åˆ†æŠ€æœ¯çš„å­¦ä¹ ä»¥åŠéƒ¨åˆ†æºç çš„è§£è¯»ï¼Œç ”ç©¶å’Œå®è·µæ··åˆå¼€å‘çš„é‚£äº›äº‹ï¼Œå¹¶è¿ç”¨åˆ°ä¸ªäººçš„å®é™…é¡¹ç›®ä¸­ï¼Œæœ‰å¿…è¦çš„è¯è¿˜æ˜¯éœ€è¦ç¨å¾®äº†è§£ä¸€ä¸‹ iOS çš„æ‰“åŒ…ã€ä»“åº“é…ç½®å’Œæ’ä»¶å¼€å‘ç›¸å…³çŸ¥è¯†ï¼Œæ¯•ç«Ÿæ—¢ç„¶æ¥è§¦äº†è·¨å¹³å°çš„å¼€å‘æŠ€èƒ½ï¼Œå¦‚æœä»…å®è·µäº Android ç«¯ï¼Œé‚£ä¹Ÿå®åœ¨è¯´ä¸è¿‡å»äº†ã€‚ å…¶ä»– é™¤äº†åŠ æ·±ç§»åŠ¨ç«¯ç³»ç»Ÿæ–¹é¢çš„å­¦ä¹ ï¼Œä¹Ÿè¦ç•™æ„æ•°æ®ç»“æ„ç®—æ³•çš„æ­¥ä¼ä¸èƒ½è½ä¸‹ï¼Œåç»­ä¹Ÿéœ€è¦è¿›ä¸€æ­¥åˆ¶å®šå„éƒ¨åˆ†çš„è¯¦ç»†è®¡åˆ’ç›‘ç£å’Œç£ä¿ƒè‡ªå·±ï¼Œé˜²æ­¢ä¸äº†äº†ä¹‹çš„æƒ…å†µå‡ºç°ã€‚Leetcode é¢˜åº“çš„ç»§ç»­æ”¶å‰²å’Œè®­ç»ƒã€æ“ä½œç³»ç»Ÿå’Œè®¡ç®—æœºç»„æˆæ–¹é¢çŸ¥è¯†çš„å›é¡¾å’Œå·©å›ºç­‰ï¼Œè¿™äº›ä¸œè¥¿è™½ç„¶çœ‹ä¼¼å¹³å®å‹æ ¹ç”¨ä¸ä¸Šï¼Œä½†æ˜¯å¾ˆå¤šåœ°æ–¹ç©¶å…¶æ ¹æºè¿˜æ˜¯ä¼šç‰µæ‰¯åˆ°è¿™éƒ¨åˆ†çš„æ‰©å±•ï¼Œä½•å†µä¹Ÿå±äºé¢è¯•å¿…è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹ï¼Œä¸å¯å¿½è§†ï¼ æåˆ°è¿™ï¼Œçªç„¶æƒ³åˆ°è‡ªå·±çš„ç®€å†ä¹Ÿå¥½ä¹…æ²¡æ›´æ–°äº†ï¼Œå¹´åè€ƒè™‘è·³æ§½ï¼Œè¿‘æœŸéœ€è¦é‡æ–°å‡†å¤‡ä¸€ä¸‹ä¸­/è‹±ç‰ˆç®€å†ï¼Œæ­¤ä»»åŠ¡ä¼˜å…ˆçº§è¾ƒé«˜ã€‚ åšå®¢ åœ¨æ–‡ç« åˆ›ä½œæ–¹é¢ï¼Œé¢„è®¡åšæŒ 1-2 ä¸ªæœˆäº§å‡ºä¸€ç¯‡è¾ƒé«˜è´¨é‡çš„æ–‡ç« ï¼ŒåŒæ ·ï¼ŒåŸºæœ¬éƒ½ä¼šé…ä¸Š demo åœ°å€ã€‚æ–‡ç« å¤§éƒ¨åˆ†ä¸»è¦å‘å¸ƒåœ¨æ˜é‡‘è¿™ç§å‚ç›´æ€§çš„æŠ€æœ¯ç¤¾åŒºï¼Œæ–‡ç« å†…å®¹ä»¥ç§»åŠ¨ç«¯æŠ€æœ¯å®è·µå’Œæ–°æŠ€æœ¯å°é²œä¸ºä¸»ã€‚å¹¶ä¼šæ ¹æ®â€œä¿®ç‚¼æˆæœâ€å°è¯•åœ¨ä¸‹åŠå¹´åˆ›åŠä¸ªäººçš„å…¬ä¼—å·ï¼Œä¸»è¦ä»¥æŠ€æœ¯æ–‡ç« ä¸ºä¸»ã€‚ å¼€æºé¡¹ç›® é¢„è®¡åœ¨ 2020 å¹´ä¸»è¦ç»´æŠ¤ä¸¤æ¬¾å¼€æºçš„é¡¹ç›®ï¼Œå³æˆ‘ä¸Šé¢æåˆ°çš„ Android daily Interview å’Œ Sightã€‚ æ¯æ—¥é¢è¯•é¢˜çš„é¡¹ç›®åŸºç¡€é¢˜åº“å·²ç»å¿«æ¥è¿‘å°¾å£°ï¼Œåç»­å°†åœ¨ Android ç³»ç»Ÿæºç ã€éš¾é¢˜è§£å†³æ–¹æ¡ˆã€æ•°æ®ç»“æ„ç®—æ³•ã€Kotlin å®è·µå’Œæºç åˆ†æã€æ¶æ„ç­‰æ–¹é¢æ¥å‡ºé¢˜ï¼Œé¢˜ç›®å‡ ä¹æ¥æºäºå›½å†…å¤–å„å¤§å…¬å¸çš„å†…éƒ¨é¢˜åº“ï¼Œä¹Ÿè¯·å¤§å®¶æ‹­ç›®ä»¥å¾…å•¦ï¼å½“ç„¶ï¼Œå¦‚æœä½ æœ‰å¥½çš„é¢˜ç›®ï¼Œæ¬¢è¿æäº¤ PRï¼Œä¸æˆ‘ä»¬ä¸€èµ·â€œå¹¶è‚©ä½œæˆ˜â€ï¼ è‡³äº Sight è¿™æ¬¾åº”ç”¨ï¼ˆæš‚å‘½åï¼‰ï¼Œä¸»è¦ç”¨æ¥ç†Ÿæ‚‰å’Œå®æˆ˜ Kotlin ä»¥åŠ JetPack å…¨å®¶æ¡¶ï¼Œä¸¥æ ¼éµå¾ª Material Designï¼ŒåŠªåŠ›è¾¾åˆ°ä¸€æ¬¾â€œäº§å“çº§â€åº”ç”¨è¦æ±‚ï¼Œå¹¶å°†ä¼šä¸Šæ¶äº Google å’Œå›½å†…åº”ç”¨å¸‚åœºï¼Œåˆ°æ—¶å€™æ¬¢è¿å¤§å®¶å‰æ¥ä½“éªŒå’Œæå‡º Bug ğŸ˜„ã€‚æ­¤å¤–ï¼Œè¯¥é¡¹ç›®åç»­ä¹Ÿå°†é€šè¿‡ Flutter æ¥æ··åˆå¼€å‘éƒ¨åˆ†é¡µé¢ï¼Œå¹¶ Clone é¡¹ç›®å’Œ Flutter é‡æ„ï¼Œå°è¯•å°†å…¶åº”ç”¨åˆ°å¤šç«¯ã€‚æœ€ç»ˆä»£ç å°†ä¼šåœ¨åº”ç”¨ä¸Šæ¶åå¼€æºã€‚ ä¸ªäººèº«å¿ƒ è¿™æ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼è¿‘æœŸç½‘ä¸Šå„ç§åŒè¡Œ ICU æˆ–è€…è¢«é€¼è¿«è¾èŒçš„æ¡ˆä¾‹å±¡è§ä¸é²œã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿè¦å­¦ä¼šæ­¦è£…è‡ªå·±ï¼Œåˆ©ç”¨ä¸€äº›ä¸šåŠ¡æ—¶é—´æ¥è§¦ä¸€äº›æ³•å¾‹ã€å¿ƒç†ã€åˆ›ä¸šç­‰å…¶ä»–æ–¹é¢æ„Ÿå…´è¶£çš„çŸ¥è¯†ï¼Œä¸è‡³äºâ€œç ´é‡œæ²‰èˆŸâ€çš„æ—¶å€™æ‰å‘ç°è‡ªå·±åªæ˜¯åˆ«äººçš„â€œå«è„šçŸ³â€ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹äºæˆ‘ä»¬æ½œå¿ƒâ€œä¿®ç‚¼æŠ€æœ¯â€çš„äººæ¥è¯´ï¼Œâ€œæŠ€æœ¯æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›â€ï¼Œä½†æ›´è¦æ˜ç™½ï¼šèº«ä½“æ‰æ˜¯é©å‘½çš„æœ¬é’±ã€‚æ²¡äº†å¥åº·ï¼Œä½ æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡ä¹Ÿè®¸åªæ˜¯è™šå¦„ã€‚æ‰€ä»¥ï¼Œå¤§å®¶åœ¨åšæŠ€æœ¯çš„åŒæ—¶ä¸€å®šè¦åšæŒé”»ç‚¼ï¼Œä¿æŒè‰¯å¥½çš„ç”Ÿæ´»æ€åº¦ï¼Œå¿ƒä¸è€ï¼Œæ°”é•¿å­˜ã€‚ å¾€äº‹ä¸å›å¤´ï¼Œå²æœˆä¸é¥¶äººã€‚ç•™ç»™æˆ‘ä»¬çš„æ—¶é—´ä¸å¤šäº†ï¼Œ2020ï¼Œè·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ï¼Œä¸€èµ·åŠ æ²¹å§ï¼ æœ€åï¼Œé€ä¸Šæˆ‘å–œæ¬¢çš„ä¸€å¥è¯ï¼šâ€œæˆ‘çš„å‰‘ï¼Œç•™ç»™èƒ½å¤ŸæŒ¥èˆå®ƒçš„äººâ€ã€‚å¸Œæœ›å¤§å®¶ 2020 å¹´èƒ½å¤ŸæŒ¥èˆè‡ªå·±å¿ƒä¸­çš„é‚£æŠŠè‰¯å‰‘ï¼Œæ–©è· offerï¼Œä¸€å¤«å½“å…³ä¸‡å¤«è«æ•Œï¼","link":"/2020/01/08/2019-summary/"},{"title":"Androidé¡¹ç›®ä¸­è°ƒèµ·æ‰‹æœºåœ°å›¾å¯¼èˆª","text":"ç°åœ¨,ç§»åŠ¨åº”ç”¨ä¸­é›†æˆåœ°å›¾å·²ç»æˆä¸ºä¸€ç§è¶‹åŠ¿ã€‚å¯¼èˆª - ä½œä¸ºåœ°å›¾ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€é¡¹åŠŸèƒ½,è¢«å¾ˆå¤šç§»åŠ¨åº”ç”¨æ‰€é’ç,ç„¶è€Œ,å¯¼èˆªæ–¹å¼é€‰æ‹©ä¸Š,ä¸ºäº†å‡å°‘ä¸å¿…è¦çš„èµ„æºå’Œapkå®¹é‡,ä¸€èˆ¬åº”ç”¨éƒ½é€‰æ‹©é€šè¿‡è°ƒç”¨ç¬¬ä¸‰æ–¹çš„åœ°å›¾åº”ç”¨æ¥å®ç°å¯¼èˆªåŠŸèƒ½ã€‚åœ¨ä»‹ç»ä¹‹å‰,å…ˆçœ‹ä¸€ä¸‹æœ€ç»ˆæ•ˆæœ:æœ¬æ–‡ä¸»è¦æä¾›å‡ ç§å¸¸ç”¨çš„è°ƒèµ·ä¸‰æ–¹åœ°å›¾åº”ç”¨çš„å¯¼èˆªå¹³å°,ä»¥é«˜å¾·,ç™¾åº¦,è…¾è®¯,è°·æ­Œåœ°å›¾ä¸ºä¾‹ã€‚ åœ°å›¾å¹³å° Uriæ–‡æ¡£ é«˜å¾·åœ°å›¾ http://lbs.amap.com/api/uri-api/guide/travel/route ç™¾åº¦åœ°å›¾ http://lbsyun.baidu.com/index.php?title=uri/api/android è°·æ­Œåœ°å›¾ https://developers.google.com/maps/documentation/android-api/intents è…¾è®¯åœ°å›¾ http://lbs.qq.com/uri_v1/guide-route.html å„å¤§åœ°å›¾æœåŠ¡å•†åŸºæœ¬éƒ½æä¾›äº†Uri,æ–¹ä¾¿å…¶ä»–åº”ç”¨è°ƒç”¨(é™¤äº†è…¾è®¯),uriç½‘å€å¦‚ä¸Šæ‰€ç¤º. åŸºæœ¬çœ‹äº†ä»¥ä¸Šçš„æ–‡æ¡£å°±ä¼šä½¿ç”¨äº†,ä¸‹é¢å°±æä¾›å‡ ä¸ªå¹³å°çš„åŸºæœ¬å†™æ³•å§: é«˜å¾·åœ°å›¾å¯¼èˆª: é«˜å¾·åœ°å›¾è¾ƒä¸ºç‰¹æ®Š,å…¶ä»–åœ°å›¾å¹³å°éƒ½å¯ä»¥é€‰æ‹©ä¼ å…¥åœ°å€æˆ–è€…ç»çº¬åº¦ä½œä¸ºå‚æ•°,è€Œé«˜å¾·è¦æ±‚å¿…é¡»æœ‰ç»çº¬åº¦ã€‚æ²¡åŠæ³•,é‚£å°±å…ˆæ’¸ä¸ªåœ°ç†ç¼–ç çš„è½®å­å§,æ–¹ä¾¿æˆ‘ä»¬å°†åœ°å€ä¿¡æ¯è½¬åŒ–ä¸ºå‡†ç¡®çš„ç»çº¬åº¦åæ ‡,å…·ä½“çœ‹ä¸‹é¢ä»£ç : 12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * by moos on 2017/09/18 * func:è°ƒç”¨é«˜å¾·åœ°å›¾çš„åœ°ç†ç¼–ç æ¥å£,è¿”å›ç»çº¬åº¦åæ ‡ * @param address */ private void translateAddressToLocation(String address){ OkHttpUtils .get() .url(GEOCODE_HTTP_URL + &quot;address=&quot;+address+&quot;&amp;key=&quot;+SELF_AMAP_KEY) .build() .execute(new StringCallback() { @Override public void onError(Call call, Exception e, int id) { Log.e(&quot;åœ°ç†ç¼–ç å¤±è´¥=&quot;, e.getMessage()); //DialogUtils.dismissProgressDialog(); Toast.makeText(UnityScanActivity.this, getString(R.string.act_qr_code_fail), Toast.LENGTH_LONG).show(); } @Override public void onResponse(String response, int id) { Logger.e(&quot;åœ°ç†ç¼–ç ç»“æœ =&quot; + response); resultBean = JSONObject.parseObject(response, GeocodeResultBean.class); if (resultBean.getStatus().equals(&quot;1&quot;)) { locationList = resultBean.getGeocodes(); if(locationList!=null &amp;&amp; locationList.size()&gt;0){ //é»˜è®¤è·å–ç¬¬ä¸€æ¡ locationString = locationList.get(0).getLocation(); lon = locationString.substring(0,locationString.indexOf(&quot;,&quot;)); lat = locationString.substring(locationString.indexOf(&quot;,&quot;)+1,locationString.length()); Log.e(&quot;ç»çº¬åº¦ä¿¡æ¯ä¸º===&quot;,lon+&quot;=======&quot;+lat); }else { Toast.makeText(UnityScanActivity.this, &quot;æ— ç›¸å…³ä¿¡æ¯&quot;, Toast.LENGTH_LONG).show(); } } else { Toast.makeText(UnityScanActivity.this, resultBean.getInfo(), Toast.LENGTH_LONG).show(); } } }); } &emsp;&emsp;è¿™é‡Œæˆ‘å¹¶æ²¡æœ‰é‡‡ç”¨é«˜å¾·åŒ…ä¸­çš„åœ°ç†ç¼–ç æ¥å£æ¥å®ç°,è€Œæ˜¯è°ƒç”¨çš„å…¶webæ¥å£ã€‚è¯·åŸè°…æˆ‘çš„ä»»æ€§,æœ€è¿‘æ¥å£è°ƒä¸Šç˜¾äº†ğŸ˜†,å€¼å¾—æ³¨æ„çš„æ˜¯,urlä¸­éœ€è¦ä¼ å…¥key,è¿™ä¸ªè¦åœ¨é«˜å¾·å®˜ç½‘è‡ªå·±åˆ›å»ºwebåº”ç”¨ç”³è¯·,ä¸è¿‡å¾ˆæ–¹ä¾¿,ä¸éœ€è¦åŒ…åå’Œsha1ç­‰ã€‚ ä¸‹é¢çœ‹çœ‹å¦‚ä½•è°ƒèµ·æ‰‹æœºä¸­çš„é«˜å¾·åœ°å›¾å§: 123456789101112131415161718192021222324252627282930313233343536373839404142//è°ƒèµ·å¯¼èˆªçš„uri private final String BAIDU_MAP_NAVI_URI = &quot;baidumap://map/navi?query=&quot;; private final String GAODE_MAP_NAVI_URI = &quot;androidamap://navi?sourceApplication=&quot;; private final String GOOGLE_MAP_NAVI_URI = &quot;google.navigation:q=&quot;; //map appåŒ…å private final String BAIDU_MAP_APP = &quot;com.baidu.BaiduMap&quot;; private final String GAODE_MAP_APP = &quot;com.autonavi.minimap&quot;; private final String GOOGLE_MAP_APP = &quot;com.google.android.apps.maps&quot;; private final String QQ_MAP_URL = &quot;http://apis.map.qq.com/uri/v1/routeplan?type=drive&amp;&quot;; //é«˜å¾·webæœåŠ¡çš„ä¸´æ—¶key(ç”¨äºåœ°ç†ç¼–ç ) private final String SELF_AMAP_KEY = &quot;your key&quot;; private final String GEOCODE_HTTP_URL = &quot;http://restapi.amap.com/v3/geocode/geo?&quot;; private GeocodeResultBean resultBean; private List&lt;GeocodeResultBean.GeocodeBean&gt; locationList; private String locationString; private String lon; private String lat;/** * by moos on 2017/09/18 * func:è°ƒèµ·é«˜å¾·å¯¼èˆª * @param lat çº¬åº¦ * @param lon ç»åº¦ * @param dev æ˜¯å¦åç§»(0:lat å’Œ lon æ˜¯å·²ç»åŠ å¯†åçš„,ä¸éœ€è¦å›½æµ‹åŠ å¯†; 1:éœ€è¦å›½æµ‹åŠ å¯†) * @param style å¯¼èˆªæ–¹å¼(0 é€Ÿåº¦å¿«; 1 è´¹ç”¨å°‘; 2 è·¯ç¨‹çŸ­; 3 ä¸èµ°é«˜é€Ÿï¼›4 èº²é¿æ‹¥å µï¼›5 ä¸èµ°é«˜é€Ÿä¸”é¿å…æ”¶è´¹ï¼›6 ä¸èµ°é«˜é€Ÿä¸”èº²é¿æ‹¥å µï¼›7 èº²é¿æ”¶è´¹å’Œæ‹¥å µï¼›8 ä¸èµ°é«˜é€Ÿèº²é¿æ”¶è´¹å’Œæ‹¥å µ) */ private void goNaviByGaoDeMap(String lat,String lon,String dev,String style){ Intent intent = new Intent(); intent.setAction(Intent.ACTION_VIEW); intent.addCategory(Intent.CATEGORY_DEFAULT); //å°†åŠŸèƒ½Schemeä»¥URIçš„æ–¹å¼ä¼ å…¥data Uri uri = Uri.parse(GAODE_MAP_NAVI_URI + &quot;Test&quot; + &quot;&amp;lat=&quot; + lat + &quot;&amp;lon=&quot; + lon + &quot;&amp;dev=&quot; + dev + &quot;&amp;style=&quot; +style); intent.setData(uri); intent.setPackage(&quot;com.autonavi.minimap&quot;); startActivity(intent); } æ³¨é‡Šæ¯”è¾ƒè¯¦ç»†äº†,å°±ä¸åšå…·ä½“è®²è§£äº†,å¯ä»¥å‚è€ƒå®˜æ–¹æä¾›çš„æ–‡æ¡£ã€‚ ç™¾åº¦åœ°å›¾å¯¼èˆª: 1234567891011/** * by moos on 2017/09/18 * func:è°ƒèµ·ç™¾åº¦å¯¼èˆª */ private void goNaviByBaiDuMap(String address){ Intent intent = new Intent(); intent.setData(Uri.parse(BAIDU_MAP_NAVI_URI + address)); startActivity(intent); } è°·æ­Œåœ°å›¾å¯¼èˆª: 12345678910111213/** * by moos on 2017/09/18 * func:è°ƒèµ·è°·æ­Œå¯¼èˆª * @param lat * @param lon */ private void goNaviByGoogleMap(String lat,String lon,String address){ Uri uri = Uri.parse(GOOGLE_MAP_NAVI_URI+lat+&quot;,&quot;+lon +&quot;,&quot; + address); Intent mapIntent = new Intent(Intent.ACTION_VIEW, uri); mapIntent.setPackage(&quot;com.google.android.apps.maps&quot;); context.startActivity(mapIntent); } è…¾è®¯åœ°å›¾å¯¼èˆª:&emsp;&emsp;åˆšåˆšè¯´è¿‡,è…¾è®¯åœ°å›¾ç›®å‰è¿˜æœªæ”¯æŒå…¶ä»–åº”ç”¨ä»¥uriå½¢å¼è°ƒèµ·è…¾è®¯è‡ªå®¶çš„åœ°å›¾åŠŸèƒ½,ä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡web æ¥å£æ–¹å¼è°ƒç”¨,å…·ä½“ä»£ç å¦‚ä¸‹,æ¯”è¾ƒç®€å•: 1234567891011121314/** * by moos on 2017/09/18 * func:é€šè¿‡ç½‘é¡µå½¢å¼è°ƒèµ·è…¾è®¯åœ°å›¾ * @param startPoint * @param endPoint * @param policy è§„åˆ’ç­–ç•¥(0:å¿«æ·,1:æ— é«˜é€Ÿ,2:è·ç¦»çŸ­) * @param appName å½“å‰åº”ç”¨çš„åç§° */ private void goNaviByTencentMap(String startPoint,String endPoint,String policy,String appName){ Uri uri = Uri.parse(QQ_MAP_URL + &quot;from=&quot;+startPoint + &quot;&amp;to=&quot; +endPoint + &quot;&amp;policy=&quot;+policy + &quot;&amp;referer=&quot;+appName ); Intent intent = new Intent(Intent.ACTION_VIEW,uri); startActivity(intent); } æˆ‘ä»¬åªéœ€è¦åœ¨urlä¸­ä¼ å…¥å‚æ•°,ç„¶åè®¿é—®è¯¥ç½‘å€å°±å¯ä»¥,å¾ˆç®€å•å§ğŸ˜†ã€‚ å…¶ä»–:&emsp;&emsp;ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ,æˆ‘ä»¬ä¼šåŠ ä¸Šä¸€äº›æé†’ç”¨æˆ·çš„äº¤äº’,å¦‚:ç”¨æˆ·æ‰‹æœºæ²¡æœ‰å®‰è£…åœ°å›¾åº”ç”¨,å¯ä»¥å¼¹çª—è®©ç”¨æˆ·å‰å¾€å•†åº—ä¸‹è½½,æ¥å§,ä¸€å¤§æ³¢ä»£ç æ¥è¢­: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677/** * by moos on 2017/09/18 * func:æ¥å—å¯¼èˆªè¯·æ±‚,å¹¶å‘èµ·å¯¼èˆª */ private void navigateForDestination(){ if(isApplicationInstall(GAODE_MAP_APP)){ //å®‰è£…äº†é«˜å¾·map Log.e(&quot;Tminstore&quot;,&quot;å·²å®‰è£…é«˜å¾·åœ°å›¾&quot;); translateAddressToLocation(&quot;ä¸œæ–¹æ˜ç &quot;);//åœ°ç†ç¼–ç  goNaviByGaoDeMap(lat,lon,&quot;1&quot;,&quot;2&quot;); //goNaviByTencentMap(MyApplication.mapLocation.getAddress(),&quot;ä¸Šæµ·ä¸œæ–¹æ˜ç &quot;,&quot;0&quot;,&quot;com.ucardstore.Activity&quot;); }else if(isApplicationInstall(BAIDU_MAP_APP)){ //å®‰è£…äº†ç™¾åº¦map Log.e(&quot;Tminstore&quot;,&quot;å·²å®‰è£…ç™¾åº¦åœ°å›¾&quot;); goNaviByBaiDuMap(&quot;ä¸Šæµ·ä¸œæ–¹æ˜ç &quot;); }else if(isApplicationInstall(GOOGLE_MAP_APP)){ //å®‰è£…äº†google map Log.e(&quot;Tminstore&quot;,&quot;å·²å®‰è£…è°·æ­Œåœ°å›¾&quot;); goNaviByGoogleMap(&quot;&quot;,&quot;&quot;,&quot;ä¸Šæµ·ä¸œæ–¹æ˜ç &quot;); }else { //é»˜è®¤å®‰è£…é«˜å¾·app showInstallAppTip(); //ä½¿ç”¨è…¾è®¯ç½‘é¡µåœ°å›¾(å¯é€‰) //goNaviByTencentMap(MyApplication.mapLocation.getAddress(),&quot;ä¸Šæµ·ä¸œæ–¹æ˜ç &quot;,&quot;0&quot;,&quot;com.ucardstore.Activity&quot;); } } ..... /** * by moos on 2017/09/18 * func:åˆ¤æ–­æ‰‹æœºæ˜¯å¦å®‰è£…äº†è¯¥åº”ç”¨ * @param packageName * @return */ private boolean isApplicationInstall(String packageName){ return new File(&quot;/data/data/&quot; + packageName).exists(); } ...... /** * by moos on 2017/09/18 * func:å®‰è£…åœ°å›¾appçš„æç¤º */ private void showInstallAppTip(){ TipDialog dialog = new TipDialog(this, new View.OnClickListener() { @Override public void onClick(View arg0) { switch (arg0.getId()) { case R.id.dialog_btn_sure: Intent intent ; Uri uri = Uri.parse(&quot;market://details?id=com.autonavi.minimap&quot;); intent = new Intent(Intent.ACTION_VIEW, uri); startActivity(intent); break; case R.id.dialog_btn_cancel: break; } } }); dialog.setMessage(getString(R.string.install_app_tip)); dialog.setBtnSure(getString(R.string.go_to_install)); dialog.setBtnCancel(getString(R.string.cancel)); dialog.show(); } å¥½äº†,è¿™å·®ä¸å¤šå°±æ˜¯å…¨éƒ¨ä»£ç äº†,è‡³äºå¼¹çª—TipDialogæ˜¯æˆ‘è‡ªå®šä¹‰çš„dialog,æ²¡ä»€ä¹ˆéš¾åº¦,å°±ä¸è´´å‡ºæ¥ğŸ˜ã€‚","link":"/2017/09/19/amap-guide/"},{"title":"MotionLayout:)å¸¦ä½ è¿›å…¥åŠ¨ç”»æ–°ä¸–ç•Œ","text":"è·ç¦»ä¸Šä¸€ç¯‡æ–‡ç« ã€Œ MotionLayoutï¼šæ‰“å¼€åŠ¨ç”»æ–°ä¸–ç•Œå¤§é—¨ï¼ˆä¸Šç¯‡ï¼‰ã€å·²ç»è¿‡å»äº†å¾ˆä¹…ï¼Œç”±äºä¸ªäººåŸå› ï¼ŒMotionLayout ç³»åˆ—æ–‡ç« å§—å§—æ¥è¿Ÿã€‚åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬é¢†ç•¥åˆ°äº† MotionLayout çš„é­…åŠ›ï¼Œäº†è§£åˆ°å®ƒç»§æ‰¿è‡ª ConstraintLayoutï¼Œå¹¶å…·æœ‰å®ƒâ€œçº¦æŸå¸ƒå±€â€çš„ç‰¹æ€§ã€‚åŒæ—¶ï¼Œå…³äºå¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨ MotionScene åŠå…¶å†…éƒ¨çš„ KeyFrameSet ä¹Ÿéƒ½åšäº†ä¸€äº›ç®€å•ä»‹ç»ã€‚é‚£ä¹ˆï¼Œæœ¬æ–‡æ¥å¸¦å¤§å®¶è¿›ä¸€æ­¥æ¢ç´¢ KeyFrameSet è¿™ä¸ªå¤§å®¶æ—ä¸­çš„â€œç¥ç§˜å®è—â€ï¼Œå¹¶é’ˆå¯¹ä¸Šæ–‡ä¸­ç•™ä¸‹çš„ä¸€äº›å½©è›‹è¿›è¡Œè®²è§£ï¼Œæ¥çœ‹çœ‹å¦‚ä½•å®ç° MotionLayout ä¸å…¶ä»–æ§ä»¶çš„è”åŠ¨ã€‚ å†æ¢ç´¢ KeyFrameSetåœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬è¯´åˆ° KeyFrameSet èƒ½å¤Ÿè®©å•è°ƒçš„åŠ¨ç”»ç‹¬æ ‘ä¸€å¸œï¼Œå¯ä»¥æ ¹æ®æˆ‘ä»¬çš„æ„æ„¿æ¥æè¿°åŠ¨ç”»è¿åŠ¨çš„è½¨è¿¹ã€‚ä¹‹å‰åªæ˜¯æ¯”è¾ƒè¯¦ç»†ä»‹ç»äº† KeyFrameSet è¿™ä¸ªå¤§å®¶æ—ä¸­çš„ Keypositionï¼Œé‚£ä¹ˆæœ¬æ–‡å°±æ¥å’Œå¤§å®¶çª¥æ¢ä¸€ä¸‹å…¶ä»–å®è—çš„ç§˜å¯†å§ğŸ˜„ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€å¼ ç†Ÿæ‚‰çš„ MotionLayout ç»“æ„å›¾ï¼š ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒKeyFrameSet ä¸­ä¸»è¦åŒ…å«äº† KeyPositionã€KeyAttribute ä»¥åŠ KeyCycle ä¸‰ç§ç±»å‹çš„å…³é”®å¸§ã€‚å…¶å®é™¤æ­¤ä»¥å¤–ï¼ŒKeyFrameSet è¿˜æä¾›äº† KeyTimeCycle å’Œ KeyTriggerï¼Œå…·ä½“çš„ç”¨æ³•å’Œä½¿ç”¨åœºæ™¯ä¼šåœ¨åç»­æ–‡ç« è¿›è¡Œä»‹ç»ã€‚æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å…ˆæ¥è¯¦ç»†çœ‹ä¸€ä¸‹ KeyAttribute ä»¥åŠ KeyCycleã€‚ KeyAttributeæˆ‘ä»¬çŸ¥é“ï¼ŒKeyPosition æè¿°çš„æ˜¯ç›®æ ‡ View åœ¨æŸä¸ªä½ç½®çš„å…³é”®å¸§ï¼Œè¿›è€Œæ”¹å˜åŠ¨ç”»çš„ç§»åŠ¨è½¨è¿¹ï¼Œè‡³äº KeyAttributeï¼Œåˆ™æ˜¯æè¿°è¿™ä¸ª View åœ¨æŸä¸ªå…³é”®å¸§æ—¶æ‰€å¤„çš„â€œçŠ¶æ€â€ï¼Œå³æ‰€è°“çš„â€é«˜çŸ®èƒ–ç˜¦â€œã€‚å‰è€…ä¾§é‡çš„æ˜¯æ”¹å˜åŠ¨ç”»çš„è½¨è¿¹ï¼Œåè€…åˆ™æ˜¯å¼ºè°ƒæ›´æ”¹ View è‡ªèº«çš„å±æ€§ã€‚ ä»ä¸Šå›¾çš„ KeyAttribute ç»“æ„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ”¯æŒå„ç§å±æ€§ï¼Œè¶³å¤Ÿæˆ‘ä»¬æ¥æè¿°ä¸€ä¸ª View çš„çŠ¶æ€äº†ã€‚å‡å¦‚æˆ‘ä»¬å¸Œæœ›å®ç°å¦‚ä¸‹æ•ˆæœï¼š å…¶å®ä¸Šé¢çš„åŠ¨ç”»å®ç°å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ç‰¹å®šä½ç½®æ·»åŠ ä¸€äº›â€œå…³é”®å¸§â€å°±å¯ä»¥äº†ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;Transition app:constraintSetStart=\"@+id/start\" app:constraintSetEnd=\"@+id/end\" app:duration=\"3200\" app:motionInterpolator=\"bounce\"&gt; &lt;KeyFrameSet&gt; &lt;KeyAttribute app:motionTarget=\"@+id/loading_ball\" app:framePosition=\"20\" android:scaleX=\"1.5\" android:scaleY=\"1.5\" android:alpha=\"0.7\"/&gt; &lt;KeyAttribute app:motionTarget=\"@+id/loading_ball\" app:framePosition=\"35\" android:scaleX=\"1\" android:scaleY=\"1\" android:alpha=\"1\"/&gt; &lt;KeyAttribute app:motionTarget=\"@+id/loading_ball\" app:framePosition=\"50\" android:scaleX=\"1.5\" android:scaleY=\"1.5\" android:alpha=\"0.7\"/&gt; &lt;KeyAttribute app:motionTarget=\"@+id/loading_ball\" app:framePosition=\"65\" android:scaleX=\"1\" android:scaleY=\"1\" android:alpha=\"1\"/&gt; &lt;KeyAttribute app:motionTarget=\"@+id/loading_ball\" app:framePosition=\"80\" android:scaleX=\"1.5\" android:scaleY=\"1.5\" android:alpha=\"0.7\"/&gt; &lt;KeyAttribute app:motionTarget=\"@+id/loading_ball\" app:framePosition=\"95\" android:scaleX=\"1\" android:scaleY=\"1\" android:alpha=\"1\" /&gt; &lt;/KeyFrameSet&gt; &lt;OnClick app:targetId=\"@+id/loading_ball\" app:clickAction=\"toggle\"/&gt; &lt;/Transition&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@id/loading_ball\" android:layout_width=\"32dp\" android:layout_height=\"32dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.15\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintVertical_bias=\"0.5\"/&gt; &lt;/ConstraintSet&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@+id/loading_ball\" android:layout_width=\"32dp\" android:layout_height=\"32dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.85\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintVertical_bias=\"0.5\" /&gt; &lt;/ConstraintSet&gt;&lt;/MotionScene&gt; æœ€ç»ˆä»£ç å¦‚ä¸Šæ‰€ç¤ºï¼Œæ˜¯ä¸æ˜¯å¾ˆ easyï¼Ÿè¿™é‡Œæˆ‘ä»¬åœ¨é€”ç»è·¯çº¿ä¸­æ·»åŠ ä¸€äº›ç‰¹å®šçš„ keyAttribute ï¼Œå¹¶æ”¹å˜å®ƒä»¬çš„å±æ€§çŠ¶æ€ï¼Œè¿™é‡Œå˜åŒ–çš„å±æ€§åªæ¶‰åŠåˆ° scaleXã€scaleY å’Œ alpha ã€‚ è€ƒè™‘åˆ° KeyAttribute ä¸­æä¾›çš„å±æ€§æœ‰é™ï¼Œæ‰€ä»¥ï¼ŒCustomAttribute æ¨ªç©ºå‡ºä¸–ï¼Œå®ƒæ”¯æŒä»»æ„è‡ªå®šä¹‰çš„å±æ€§ï¼Œå¸¸è§çš„æœ‰ TextView çš„ textColorã€background æˆ–è€…æ˜¯ ImageView çš„ src ã€tint ç­‰ã€‚å½“ç„¶è¿˜ä¸æ­¢è¿™äº›ï¼Œæˆ‘ä»¬å¹³æ—¶è‡ªå®šä¹‰ View ä¸­æä¾›çš„è‡ªå®šä¹‰å±æ€§åŒæ ·æ”¯æŒå“¦ã€‚å°±åƒ GitHub ä¸Šçš„ä¸€ä¸ª ShapeOfView çš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥æä¾›ç»™æˆ‘ä»¬è‡ªå®šä¹‰æ§ä»¶å½¢çŠ¶çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆç»“åˆäº† MotionLayout ä¸­çš„ CustomAttributeï¼Œæˆ‘ä»¬å°±å¯ä»¥è¾¾åˆ°ä¸‹é¢è¿™ç§å¹³æ»‘è½¬æ¢çš„æ•ˆæœï¼š ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸Šé¢çš„å°çƒåŠ è½½åŠ¨ç”»æˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿåœ¨è¿åŠ¨è¿‡ç¨‹ä¸­é¢œè‰²ä¹Ÿéšä¹‹å˜åŒ–ï¼Œç„¶è€Œ ä¸­å¹¶æ²¡æœ‰æä¾›ç›¸å…³å±æ€§ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©äº æ¥å®ç°å•¦ã€‚æ”¹åŠ¨éƒ¨åˆ†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132333435......&lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@id/loading_ball\" android:layout_width=\"32dp\" android:layout_height=\"32dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.15\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintVertical_bias=\"0.5\"&gt; &lt;CustomAttribute app:attributeName=\"colorFilter\" app:customColorValue=\"@android:color/holo_blue_light\"/&gt; &lt;/Constraint&gt;&lt;/ConstraintSet&gt;&lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@+id/loading_ball\" android:layout_width=\"32dp\" android:layout_height=\"32dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.85\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintVertical_bias=\"0.5\"&gt; &lt;CustomAttribute app:attributeName=\"colorFilter\" app:customColorValue=\"@color/colorAccent\"/&gt; &lt;/Constraint&gt;&lt;/ConstraintSet&gt; æˆ‘ä»¬è®¾ç½®äº† colorFilter å±æ€§ï¼Œä½œç”¨ç›¸å½“äº tintï¼Œé‡æ–°è¿è¡Œåï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ•ˆæœï¼š éœ€è¦æˆ‘ä»¬æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„è‡ªå®šä¹‰å±æ€§çš„ attributeName å¯¹åº”çš„å€¼å¹¶ä¸ä¸€å®šæ˜¯åœ¨ xml å¸ƒå±€æ–‡ä»¶ä¸­æ§ä»¶å¯¹åº”çš„å±æ€§åç§°ï¼Œè€Œæ˜¯åœ¨å¯¹åº”æ§ä»¶ä¸­æ‹¥æœ‰ setter è®¾ç½®çš„å±æ€§åç§°ã€‚æ€ä¹ˆç†è§£å‘¢ï¼Ÿå…¶å®å½’æ ¹ç»“åº• CustomAttribute å†…éƒ¨è¿˜æ˜¯åˆ©ç”¨çš„åå°„ï¼Œä»ä¸‹é¢çš„éƒ¨åˆ†æºç ä¸­å°±èƒ½å¤Ÿå¯Ÿè§‰åˆ°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980public void applyCustomAttributes(ConstraintLayout constraintLayout) { int count = constraintLayout.getChildCount(); for(int i = 0; i &lt; count; ++i) { View view = constraintLayout.getChildAt(i); int id = view.getId(); if (!this.mConstraints.containsKey(id)) { Log.v(\"ConstraintSet\", \"id unknown \" + Debug.getName(view)); } else { if (this.mForceId &amp;&amp; id == -1) { throw new RuntimeException(\"All children of ConstraintLayout must have ids to use ConstraintSet\"); } if (this.mConstraints.containsKey(id)) { ConstraintSet.Constraint constraint = (ConstraintSet.Constraint)this.mConstraints.get(id); ConstraintAttribute.setAttributes(view, constraint.mCustomConstraints); } } } }...... public static void setAttributes(View view, HashMap&lt;String, ConstraintAttribute&gt; map) { Class&lt;? extends View&gt; viewClass = view.getClass(); Iterator var3 = map.keySet().iterator(); while(var3.hasNext()) { String name = (String)var3.next(); ConstraintAttribute constraintAttribute = (ConstraintAttribute)map.get(name); String methodName = \"set\" + name; try { Method method; switch(constraintAttribute.mType) { case COLOR_TYPE: method = viewClass.getMethod(methodName, Integer.TYPE); method.invoke(view, constraintAttribute.mColorValue); break; case COLOR_DRAWABLE_TYPE: method = viewClass.getMethod(methodName, Drawable.class); ColorDrawable drawable = new ColorDrawable(); drawable.setColor(constraintAttribute.mColorValue); method.invoke(view, drawable); break; case INT_TYPE: method = viewClass.getMethod(methodName, Integer.TYPE); method.invoke(view, constraintAttribute.mIntegerValue); break; case FLOAT_TYPE: method = viewClass.getMethod(methodName, Float.TYPE); method.invoke(view, constraintAttribute.mFloatValue); break; case STRING_TYPE: method = viewClass.getMethod(methodName, CharSequence.class); method.invoke(view, constraintAttribute.mStringValue); break; case BOOLEAN_TYPE: method = viewClass.getMethod(methodName, Boolean.TYPE); method.invoke(view, constraintAttribute.mBooleanValue); break; case DIMENSION_TYPE: method = viewClass.getMethod(methodName, Float.TYPE); method.invoke(view, constraintAttribute.mFloatValue); } } catch (NoSuchMethodException var9) { Log.e(\"TransitionLayout\", var9.getMessage()); Log.e(\"TransitionLayout\", \" Custom Attribute \\\"\" + name + \"\\\" not found on \" + viewClass.getName()); Log.e(\"TransitionLayout\", viewClass.getName() + \" must have a method \" + methodName); } catch (IllegalAccessException var10) { Log.e(\"TransitionLayout\", \" Custom Attribute \\\"\" + name + \"\\\" not found on \" + viewClass.getName()); var10.printStackTrace(); } catch (InvocationTargetException var11) { Log.e(\"TransitionLayout\", \" Custom Attribute \\\"\" + name + \"\\\" not found on \" + viewClass.getName()); var11.printStackTrace(); } } } é¦–å…ˆåœ¨ MotionLayout ä¸­ï¼Œå¦‚æœæ˜¯è‡ªå®šä¹‰å±æ€§ï¼Œé‚£ä¹ˆä¼šæ‰§è¡Œ ConstraintSet ç±»ä¸­çš„ applyCustomAttributes æ–¹æ³•ï¼Œæ¥ç€ä¼šè°ƒç”¨ ConstraintAttribute ç±»ä¸­çš„ setAttributes æ–¹æ³•ï¼Œå°±å¦‚ä¸Šä»£ç ä¸­æ‰€å†™çš„é‚£æ ·ï¼Œå®ƒä¼šæ ¹æ®å±æ€§åç§°ç»„è£…æˆå¯¹åº”çš„ set æ–¹æ³•ï¼Œç„¶åé€šè¿‡åå°„è°ƒç”¨ã€‚æ˜¯ä¸æ˜¯æœ‰ç§æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼Ÿè¯è¯´ï¼Œè¿™æ ·çš„æœºåˆ¶æ˜¯ä¸æ˜¯å¥½åƒå“ªé‡Œè§åˆ°è¿‡ï¼Ÿæ²¡é”™ï¼Œæ­£æ˜¯å±æ€§åŠ¨ç”»ã€‚ KeyCycleä»€ä¹ˆæ˜¯ KeyCycle å‘¢ï¼Ÿä¸‹é¢æ˜¯æ¥è‡ª Gal Maoz çš„æ€»ç»“ï¼š A KeyCycle is a highly-detailed, custom-made interpolator for a specific view, whereas the interpolator is influencing the entire scene, with a large focus on repetitive actions (hence the cycle in the name). ç®€å•æ¥è¯´ï¼ŒKeyCycle æ˜¯é’ˆå¯¹ç‰¹å®šè§†å›¾çš„éå¸¸è¯¦ç»†çš„å®šåˆ¶åŒ–æ’å€¼å™¨ã€‚å®ƒæ¯”è¾ƒé€‚åˆæˆ‘ä»¬å¸¸è¯´çš„æ³¢å½¢æˆ–å‘¨æœŸè¿åŠ¨åœºæ™¯ï¼Œæ¯”å¦‚å®ç°æ§ä»¶çš„æŠ–åŠ¨åŠ¨ç”»æˆ–è€…å‘¨æœŸæ€§çš„å¾ªç¯åŠ¨ç”»ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒKeyCycle ä¸»è¦ç”±ä»¥ä¸Šå‡ ä¸ªå±æ€§ç»„æˆï¼Œå‰ä¸¤ä¸ªç›¸ä¿¡å¤§å®¶éƒ½æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œè¿™é‡Œä¸å¿…å¤šè¯´ï¼Œå¦å¤– view properties æ­£å¦‚ä¹‹å‰çš„ KeyAttribute ç»“æ„å›¾ä¸­æ‰€æè¿°çš„é‚£æ ·ï¼Œä»£è¡¨Viewçš„å„ç§å±æ€§ï¼Œå¦‚ rotationã€translationã€alpha ç­‰ç­‰ã€‚ è¿™é‡Œä¸»è¦ä»‹ç»å¦å¤–ä¸‰ä¸ªæ¯”è¾ƒé‡è¦ä¸”å…·æœ‰ç‰¹è‰²çš„å±æ€§ï¼š wavePeriodï¼šè¿™ä¸ªè¡¨ç¤ºåœ¨å½“å‰åœºæ™¯ä½ç½®ä¸‹éœ€è¦æ‰§è¡ŒåŠ¨ç”»çš„æ³¢ï¼ˆå‘¨æœŸï¼‰çš„æ•°é‡ã€‚è¿™æ ·è¯´å¯èƒ½ä¸å¤ªå®¹æ˜“ç†è§£ï¼Œåˆ«æ€¥ï¼Œæˆ‘ä»¬å¾…ä¼šä¸¾ä¸ªä¾‹å­è¯´æ˜ã€‚ waveOffsetï¼šè¡¨ç¤ºå½“å‰æ§ä»¶éœ€è¦å˜åŒ–çš„å±æ€§çš„åç§»é‡ï¼Œå³ view properties æ‰€å¯¹åº”çš„åˆå§‹å€¼æˆ–è€…åŸºå‡†å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åŠ¨ç”»æ‰§è¡Œçš„æŸä¸ªä½ç½®è®¾ç½®äº† scaleX ä¸º 0.3ï¼Œè€Œè®¾ç½®äº† waveOffset å€¼ä¸º 1ï¼Œé‚£ä¹ˆï¼ŒåŠ¨ç”»æ‰§è¡Œåˆ°è¯¥ä½ç½®ï¼Œæ§ä»¶çš„å®é™…å®½åº¦ä¼šå˜ä¸º 1 + 0.3 = 1.3ï¼Œä¹Ÿå°±æ˜¯ä¼šæ‰©å¤§ä¸º 1.3 å€ï¼Œè€Œä¸æ˜¯ç¼©å°ä¸ºä¹‹å‰çš„ 0.3 å€ã€‚ waveShapeï¼šè¿™ä¸ªå±æ€§æ¯”è¾ƒå¥½ç†è§£ï¼Œå³æ³¢çš„å½¢çŠ¶ï¼Œå¸¸è§çš„å€¼æœ‰ï¼šsinã€cosã€sawtooth ç­‰ï¼Œæ›´å¤šå¯å‚è€ƒå®˜ç½‘APIï¼šhttps://developer.android.com/reference/androidx/constraintlayout/motion/widget/MotionLayout#keycycle ä¸‹é¢ä¸¾ä¸ªç®€å•çš„ä¾‹å­å¸®åŠ©ç†è§£ï¼Œä»¥ä¸‹é¢è¿™ä¸ªæ•ˆæœä¸ºä¾‹ï¼š å¯¹åº”çš„ KeyFrameSet ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223&lt;KeyFrameSet&gt; &lt;KeyCycle motion:framePosition=\"0\" motion:target=\"@+id/button\" motion:wavePeriod=\"0\" motion:waveOffset=\"1\" motion:waveShape=\"sin\" android:scaleX=\"0.3\"/&gt; &lt;KeyCycle motion:framePosition=\"18\" motion:target=\"@+id/button\" motion:wavePeriod=\"0\" motion:waveOffset=\"1\" motion:waveShape=\"sin\" android:scaleX=\"0.3\"/&gt; &lt;KeyCycle motion:framePosition=\"100\" motion:target=\"@+id/button\" motion:wavePeriod=\"3\" motion:waveOffset=\"1\" motion:waveShape=\"sin\" android:scaleX=\"0\"/&gt;&lt;/KeyFrameSet&gt; æ ¹æ®åŠ¨ç”»æ•ˆæœç»“åˆä»£ç å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬è¿™ä¸ªæ”¾å¤§çš„Qå¼¹çš„æ•ˆæœåªæ˜¯æ”¹å˜äº† scaleX è¿™ä¸ªå±æ€§ï¼Œå¹¶ä¸”è®©å®ƒâ€œæ‘‡æ‘†äº†â€å¤§æ¦‚ä¸‰ä¸ªæ¥å›ï¼ˆå‘¨æœŸï¼‰ï¼Œæ°å¥½ wavePeriod å±æ€§å€¼ä¸º 3ã€‚ä¹Ÿè®¸åŠ¨ç”»ä¸å¤ªæ–¹ä¾¿å¯Ÿè§‰ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å€ŸåŠ©äº Google æä¾›çš„ä¸“é—¨ç”¨æ¥æŸ¥çœ‹ KeyCycle æ³¢å½¢å˜åŒ–çš„å¿«æ·å·¥å…·æ¥æŸ¥çœ‹å®ƒæ³¢å½¢å˜åŒ–è¿‡ç¨‹ï¼š å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¾ˆç›´è§‚åœ°çœ‹åˆ°ä¸Šå›¾ä¸­æç»˜çš„æ³¢å½¢å˜åŒ–è¿‡ç¨‹äº†ï¼Œçš„ç¡®æ˜¯ä¸‰ä¸ªå‘¨æœŸæ²¡æœ‰é”™ï¼Œå¹¶ä¸”æ˜¯ä»¥æ­£å¼¦ sin æ¥å˜åŒ–çš„ã€‚ å…³äºè¿™æ¬¾å·¥å…·çš„ä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥å‰å¾€ï¼šhttps://github.com/googlearchive/android-ConstraintLayoutExamples/releases/download/1.0/CycleEditor.jar ä¸Šä¸‹è½½ï¼Œç„¶åé€šè¿‡æ‰§è¡Œ java -jar [xx/CycleEditor.jar] å³å¯çœ‹åˆ°å¯è§†åŒ–ç•Œé¢ï¼Œç„¶åå°† KeyFrameSet éƒ¨åˆ†çš„ä»£ç  copy åˆ°ç¼–è¾‘æ ï¼Œç„¶åç‚¹å‡» File -&gt; parse xml å³å¯çœ‹åˆ°ä»£ç å¯¹åº”çš„æ³¢å½¢èµ°åŠ¿ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªæ•ˆæœï¼š è¿™ä¸ªQå¼¹çš„æ•ˆæœå°±æ˜¯åŸºäº KeyCycle å®ç°çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„åœºæ™¯å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;Transition app:constraintSetStart=\"@+id/start\" app:constraintSetEnd=\"@+id/end\" app:motionInterpolator=\"easeInOut\" app:duration=\"5200\"&gt; &lt;KeyFrameSet&gt; &lt;KeyCycle app:motionTarget=\"@+id/image\" app:framePosition=\"10\" android:rotationY=\"22\" app:wavePeriod=\"2\" app:waveShape=\"sin\" app:waveOffset=\"1\"/&gt; &lt;KeyCycle app:motionTarget=\"@+id/image\" app:framePosition=\"30\" android:rotationX=\"15\" app:wavePeriod=\"1\" app:waveShape=\"sin\" app:waveOffset=\"0\"/&gt; &lt;KeyCycle app:motionTarget=\"@+id/image\" app:framePosition=\"65\" android:rotationY=\"14\" app:wavePeriod=\"1\" app:waveShape=\"sin\" app:waveOffset=\"0\"/&gt; &lt;KeyCycle app:motionTarget=\"@+id/image\" app:framePosition=\"92\" android:rotationY=\"0\" android:rotationX=\"2\" app:wavePeriod=\"0\" app:waveShape=\"sin\" app:waveOffset=\"0\"/&gt; &lt;/KeyFrameSet&gt; &lt;OnClick app:targetId=\"@+id/image\" app:clickAction=\"toggle\"/&gt; &lt;/Transition&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@+id/image\" android:layout_width=\"120dp\" android:layout_height=\"120dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.76\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintVertical_bias=\"0.45\"/&gt; &lt;/ConstraintSet&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@+id/image\" android:layout_width=\"120dp\" android:layout_height=\"120dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.76\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintVertical_bias=\"0.45\"/&gt; &lt;/ConstraintSet&gt;&lt;/MotionScene&gt; æˆ‘ä»¬åœ¨åŠ¨ç”»è·¯å¾„ä¸Šæ·»åŠ ä¸€äº›å…³é”®å¸§ï¼Œå¹¶ç¨å¾®æ”¹å˜æ§ä»¶çš„æ—‹è½¬è§’åº¦ï¼Œé…åˆ keyCycle å°±èƒ½è¾¾åˆ°ä¸Šé¢çš„å¼¹æ€§åŠ¨ç”»ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±åŠ¨æ‰‹å°è¯•ä½“éªŒä¸€ä¸‹ã€‚ MotionLayout çš„è”åŠ¨æ€§å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬çš„æ§ä»¶å¹¶ä¸åªæ˜¯å•ä¸€çš„ä¸ªä½“ï¼Œè€Œæ˜¯éœ€è¦ä¸å…¶ä»–æ§ä»¶äº§ç”Ÿâ€œäº¤äº’ä¸Šçš„å…³è”â€ï¼Œå¸¸è§åœ°ï¼ŒAndroid çš„Material design components å…¨å®¶æ¡¶ä¸­æä¾›äº†ä¸€å¥—â€œä¼˜é›…çµåŠ¨â€çš„ç»„ä»¶ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ä½“éªŒè¿‡äº†ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬çš„ MotionLayout å¯ä»¥ä¸å®ƒä»¬ç¢°æ’å‡ºæ€æ ·çš„ç«èŠ±å‘¢ï¼Ÿ ä¸€åˆ‡ä»â€œå¤´â€å¼€å§‹Material design ç»„ä»¶åº“ä¸­æä¾›äº†ä¸€ä¸ª AppBarLayout ç»„ä»¶ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨å®ƒæ¥é…åˆ CoordinatorLayout æ§ä»¶å®ç°ä¸€äº›ç®€å•çš„äº¤äº’åŠ¨ä½œï¼Œä¾‹å¦‚å¤´éƒ¨å¯¼èˆªæ çš„ä¼¸ç¼©æ•ˆæœï¼Œå„ä½åº”è¯¥æˆ–å¤šæˆ–å°‘éƒ½ç”¨åˆ°è¿‡ï¼Œè¿™é‡Œä¸å†ä»‹ç»ã€‚ä¸‹é¢æˆ‘ä»¬å°±ä» AppBarLayout å¼€å§‹ï¼Œçœ‹çœ‹å¦‚ä½•å®ç°ä¸ MotionLayout çš„è”åŠ¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªç®€å•çš„æ•ˆæœï¼š æˆ‘ä»¬çŸ¥é“ï¼Œé€šè¿‡ CoordinatorLayout å’Œ AppBarLayout ä¹Ÿå¯ä»¥å®ç°ç±»ä¼¼çš„äº¤äº’æ•ˆæœï¼Œä½†æ˜¾ç„¶ MotionLayout ä¼šæ›´åŠ çµæ´»å¤šå˜ã€‚å…¶å®ä¸Šé¢çš„åŠ¨ç”»æ•ˆæœå¾ˆç®€å•ï¼Œåªæ˜¯åœ¨ AppBarLayout é«˜åº¦å˜åŒ–è¿‡ç¨‹ä¸­æ”¹å˜èƒŒæ™¯è‰²ã€æ ‡é¢˜çš„ä½ç½®å’Œå¤§å°å³å¯ï¼Œå¯¹åº”çš„ MotionScene æ–‡ä»¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:motion=\"http://schemas.android.com/tools\"&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@+id/background\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" motion:layout_constraintBottom_toBottomOf=\"parent\"&gt; &lt;CustomAttribute app:attributeName=\"backgroundColor\" app:customColorValue=\"@color/blue_magic\"/&gt; &lt;/Constraint&gt; &lt;Constraint android:id=\"@+id/tipText\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:scaleY=\"1.6\" android:scaleX=\"1.6\" android:alpha=\"1.0\" android:layout_marginStart=\"62dp\" android:layout_marginTop=\"12dp\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\"/&gt; &lt;/ConstraintSet&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@id/background\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" motion:layout_constraintBottom_toBottomOf=\"parent\"&gt; &lt;CustomAttribute app:attributeName=\"backgroundColor\" app:customColorValue=\"@color/bgColor_dark\"/&gt; &lt;/Constraint&gt; &lt;Constraint android:id=\"@id/tipText\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginEnd=\"20dp\" android:layout_marginBottom=\"12dp\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\"/&gt; &lt;/ConstraintSet&gt; &lt;Transition app:constraintSetStart=\"@id/start\" app:constraintSetEnd=\"@id/end\" app:duration=\"4000\"&gt; &lt;KeyFrameSet&gt; &lt;KeyPosition app:framePosition=\"60\" app:motionTarget=\"@id/tipText\" app:keyPositionType=\"parentRelative\" app:percentY=\"0.7\"/&gt; &lt;/KeyFrameSet&gt; &lt;/Transition&gt;&lt;/MotionScene&gt; ç»“åˆä»¥ä¸Šæ•ˆæœå›¾ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“ç†è§£ä¸Šé¢çš„åœºæ™¯å®ç°ä»£ç ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å¸ƒå±€æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:id=\"@+id/content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"false\" android:background=\"@android:color/white\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;com.google.android.material.appbar.AppBarLayout android:id=\"@+id/appBarLayout\" android:layout_width=\"match_parent\" android:layout_height=\"260dp\" android:theme=\"@style/AppTheme.AppBarOverlay\"&gt; &lt;com.moos.constraint.widget.MotionToolBar android:id=\"@+id/motionLayout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:motionDebug=\"NO_DEBUG\" app:layoutDescription=\"@xml/motion_scene_simple_appbar\" android:minHeight=\"52dp\" app:layout_scrollFlags=\"scroll|enterAlways|snap|exitUntilCollapsed\"&gt; &lt;View android:id=\"@+id/background\" android:layout_width=\"match_parent\" android:layout_height=\"300dp\" android:background=\"@color/blue_magic\" /&gt; &lt;TextView android:id=\"@+id/tipText\" android:text=\"Time flies fast\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:textSize=\"20sp\" android:textColor=\"@color/white\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\"/&gt; &lt;/com.moos.constraint.widget.MotionToolBar&gt; &lt;/com.google.android.material.appbar.AppBarLayout&gt; &lt;androidx.core.widget.NestedScrollView android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:layout_behavior=\"com.google.android.material.appbar.AppBarLayout$ScrollingViewBehavior\"&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:textColor=\"@color/content_text_color\" android:lineSpacingExtra=\"8dp\" android:padding=\"12dp\" android:text=\"@string/long_text_en\"/&gt; &lt;/androidx.core.widget.NestedScrollView&gt;&lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&gt; è§‚å¯Ÿä¸Šé¢å¸ƒå±€æ–‡ä»¶ï¼Œå…¶å®ä»£ç ä¸ä¼ ç»Ÿ CoordinatorLayout &amp; AppBarLayout äº¤äº’çš„ä»£ç å¤§åŒå°å¼‚ï¼Œåªä¸è¿‡æˆ‘ä»¬åœ¨ AppBarLayout å†…éƒ¨æ·»åŠ äº†ä¸€ä¸ª MotionToolBar æ§ä»¶ï¼Œè¿™å…¶å®æ˜¯ä¸ª MotionLayoutï¼Œåªä¸è¿‡å†…éƒ¨æ ¹æ® AppBarLayout ä¼¸ç¼©çš„é«˜åº¦åŠ¨æ€æ”¹å˜åŠ¨ç”»è¿›åº¦è€Œå·²ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å…·ä½“å®ç°ï¼š 123456789101112131415class MotionToolBar @JvmOverloads constructor( context: Context, attrs: AttributeSet? = null, defStyleAttr: Int = 0) : MotionLayout(context, attrs, defStyleAttr), AppBarLayout.OnOffsetChangedListener { override fun onOffsetChanged(appBarLayout: AppBarLayout?, verticalOffset: Int) { Log.e(\"MotionToolBar\", \"onOffsetChanged: -----&gt;$verticalOffset, scroll range--&gt; ${appBarLayout?.totalScrollRange}\") val seekPosition = -verticalOffset / (appBarLayout?.totalScrollRange!!.toFloat()/5*3) progress = seekPosition } override fun onAttachedToWindow() { super.onAttachedToWindow() (parent as? AppBarLayout)?.addOnOffsetChangedListener(this) }} ä»£ç é‡å¾ˆå°‘ï¼Œé€šè¿‡åœ¨ onOffsetChanged æ–¹æ³•ä¸­ç›‘å¬ AppBarLayout çš„ä¼¸ç¼©é«˜åº¦ï¼Œå¹¶ç»è¿‡æ¢ç®—åå¾—åˆ°å½“å‰çš„è¿›åº¦å€¼ä¼ é€’ç»™ progressï¼Œè¯¥å­—æ®µå°±å¯¹åº”ç€ MotionLayout çš„ setProgress æ–¹æ³•ï¼Œå¦‚æ­¤ä¸€æ¥å°±èƒ½å¤ŸåŠ¨æ€çš„æ”¹å˜å…¶åŠ¨ç”»è¿›åº¦äº†ã€‚ ç†è§£äº†ä¸Šè¿°ä»£ç ï¼Œå°±ä¸éš¾å®ç°ä¸‹é¢çš„æ•ˆæœäº†ï¼š å…·ä½“ä»£ç å°±ä¸è´´äº†ï¼Œæ–‡æœ«ä¼šé™„ä¸Š GitHub ä»“åº“åœ°å€ï¼Œæ‰€æœ‰æ•ˆæœå®ç°ä»£ç éƒ½èƒ½å¤Ÿåœ¨é‡Œé¢æ‰¾åˆ°ã€‚ Lottie ä¸ MotionLayout çš„åŒå‰‘åˆç’§Lottie æƒ³å¿…å¤§å®¶éƒ½äº†è§£è¿‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ¨ç”»å·¥å…·ï¼Œèƒ½å¤Ÿå°† UI çš„è®¾è®¡åŠ¨ç”»æ•ˆæœè½¬ä¸º Json æ ¼å¼çš„æ•°æ®æ–‡ä»¶ï¼Œç„¶åå„ç«¯éƒ½æä¾›äº†ç›¸åº”çš„åº“æ¥è§£æå¹¶æ‰§è¡ŒåŠ¨ç”»æ–‡ä»¶ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´å»å€ŸåŠ©äºä»£ç å®ç°çš„å¤æ‚åŠ¨ç”»ï¼Œå¦‚ä»Šä¸è´¹å¹ç°ä¹‹åŠ›å°±æå®šäº†ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šè§£æ”¾äº†æˆ‘ä»¬çš„åŒæ‰‹ã€‚ é‚£ä¹ˆï¼ŒLottie ä¸ MotionLayout ä¸€èµ·èƒ½å¤Ÿç¢°æ’å‡ºæ€æ ·çš„ç«èŠ±å‘¢ï¼Ÿæˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¸€ä¸ªç®€å•æ•ˆæœä¸ºä¾‹ï¼š å…¶å®ç®€å•æ¥è¯´ï¼ŒMotionLayout èƒ½å¤Ÿå°†è‡ªèº«çš„åŠ¨ç”»è¿‡ç¨‹ä¸ Lottie åŒæ­¥ï¼Œå°±åƒå›¾ä¸­çš„å®‰å“æœºå™¨äººåŠ¨ç”»å°±æ˜¯ MotionLayout å®ç°çš„ï¼Œè€Œä¸‹é¢çš„å¡é€šäººç‰©çœ¼ç¥æ¸¸ç¦»çš„åŠ¨ç”»åˆ™æ˜¯ Lottie åŠ¨ç”»ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡æ‰‹åŠ¿æ»‘åŠ¨ ViewPager ä¸¤ä¸ªåŠ¨ç”»ä¸€ç›´ä¿æŒç€â€œåŒæ­¥è¿åŠ¨â€ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°çš„ï¼Œé¦–å…ˆæ˜¯å¸ƒå±€æ–‡ä»¶ï¼Œæ¯”è¾ƒç®€å•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:id=\"@+id/motionView\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@android:color/white\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;com.moos.constraint.widget.ViewpagerHeader android:id=\"@+id/header\" android:layout_width=\"match_parent\" android:layout_height=\"300dp\" app:layoutDescription=\"@xml/motion_with_view_pager\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:motionProgress=\"0\"&gt; &lt;com.airbnb.lottie.LottieAnimationView android:id=\"@+id/lottieView\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:lottie_rawRes=\"@raw/face\"/&gt; &lt;ImageView android:id=\"@+id/ic_robot\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:src=\"@drawable/ic_launcher_foreground\"/&gt; &lt;/com.moos.constraint.widget.ViewpagerHeader&gt; &lt;com.google.android.material.tabs.TabLayout android:id=\"@+id/tabLayout\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" app:tabSelectedTextColor=\"@color/colorAccent\" app:tabTextColor=\"@color/content_text_color\" app:layout_constraintTop_toBottomOf=\"@+id/header\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\"&gt; &lt;/com.google.android.material.tabs.TabLayout&gt; &lt;androidx.viewpager.widget.ViewPager android:id=\"@+id/viewPager\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" app:layout_constraintTop_toBottomOf=\"@+id/tabLayout\" app:layout_constraintBottom_toBottomOf=\"parent\"&gt; &lt;/androidx.viewpager.widget.ViewPager&gt;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt; è‡³äºè¿™ä¸ª ViewPagerHeader ç›¸ä¿¡å¤§å®¶ä¹ŸçŒœåˆ°äº†ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸ª MotionLayout : 12345678910111213141516class ViewpagerHeader @JvmOverloads constructor( context: Context, attrs: AttributeSet? = null, defStyleAttr: Int = 0) : MotionLayout(context, attrs, defStyleAttr), androidx.viewpager.widget.ViewPager.OnPageChangeListener { override fun onPageScrollStateChanged(state: Int) { } override fun onPageScrolled(position: Int, positionOffset: Float, positionOffsetPixels: Int) { val animateProgress = (position.toFloat() + positionOffset)/3 Log.e(\"LottieMotionActivity\", \"viewpager scroll progress is: $animateProgress\") progress = animateProgress } override fun onPageSelected(position: Int) { }} åªä¸è¿‡å®ƒå†…éƒ¨å®ç°äº† ViewPager çš„ onPageChangeListenerï¼Œä»¥ç›‘å¬é¡µé¢çš„æ»‘åŠ¨çŠ¶æ€ï¼Œç„¶åè®¡ç®—å‡ºæ­¤æ—¶ MotionLayout çš„åŠ¨ç”»è¿›åº¦ï¼Œè¿™é‡Œç”±äº json åŠ¨ç”»æ–‡ä»¶å­˜åœ¨é—®é¢˜ï¼Œæ‰€ä»¥åªæˆªå–äº†ä¸€éƒ¨åˆ†åŠ¨ç”»è¿‡ç¨‹æ¥æ‰§è¡Œã€‚è¯´äº†è¿™ä¹ˆå¤šï¼Œå®ƒçš„ MotionScene æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿå…¶å®å¾ˆ easyï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:motion=\"http://schemas.android.com/apk/res-auto\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;Transition motion:constraintSetStart=\"@+id/start\" motion:constraintSetEnd=\"@+id/end\"&gt; &lt;/Transition&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@id/lottieView\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" motion:progress=\"0\"/&gt; &lt;Constraint android:id=\"@id/ic_robot\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginStart=\"20dp\" motion:layout_constraintTop_toTopOf=\"parent\" motion:layout_constraintStart_toStartOf=\"parent\"&gt; &lt;CustomAttribute app:attributeName=\"colorFilter\" app:customColorValue=\"@android:color/holo_blue_light\"/&gt; &lt;/Constraint&gt; &lt;/ConstraintSet&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@id/lottieView\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" motion:progress=\"1\"/&gt; &lt;Constraint android:id=\"@id/ic_robot\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginEnd=\"20dp\" motion:layout_constraintTop_toTopOf=\"parent\" motion:layout_constraintEnd_toEndOf=\"parent\"&gt; &lt;CustomAttribute app:attributeName=\"colorFilter\" app:customColorValue=\"@color/colorAccent\"/&gt; &lt;/Constraint&gt; &lt;/ConstraintSet&gt;&lt;/MotionScene&gt; å”¯ä¸€éœ€è¦å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šè¿™é‡Œæˆ‘ä»¬åˆ†åˆ«åœ¨ MotionLayout çš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®è®¾ç½®äº† motion:progress å±æ€§ä¸º 0 å’Œ 1ï¼Œç”±äº LottieAnimationView å†…éƒ¨æ‹¥æœ‰ setProgress æ–¹æ³•ï¼Œè¿™æ ·åšçš„ç›®çš„å°±æ˜¯å°† Lottie çš„åŠ¨ç”»è¿‡ç¨‹ä¸ MotionLayout è¿›è¡Œç»‘å®šï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹å˜è¿™ä¸ªå±æ€§ï¼Œå°±èƒ½å¤Ÿé—´æ¥æ§åˆ¶ Lottie åŠ¨ç”»å•¦ğŸ˜ã€‚ æœ€åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ Activity ä¸­è®¾ç½®å¦‚ä¸‹ä»£ç å°±å¯ä»¥æˆåŠŸæ‰§è¡Œå•¦ï¼š 123456val adapter = ViewPagerAdapter(supportFragmentManager)adapter.addPage(\"Now\", R.layout.holder_layout)adapter.addPage(\"Discover\", R.layout.holder_layout)viewPager.adapter = adaptertabLayout.setupWithViewPager(viewPager)viewPager.addOnPageChangeListener(header as androidx.viewpager.widget.ViewPager.OnPageChangeListener) å½“ç„¶ï¼ŒMotionLayout è¿˜èƒ½å’Œå¾ˆå¤šç»„ä»¶è¿›è¡Œè”åŠ¨ï¼Œç¯‡å¹…æœ‰é™å°±ä¸ä¸€ä¸€ä»‹ç»å•¦ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æœ¬ç¯‡æ–‡ç« å†…å®¹ä¹Ÿå·®ä¸å¤šè¯¥å‘Šä¸€æ®µè½äº†ï¼Œå…³äº MotionLayout ç³»åˆ—æ–‡ç« çš„æ‰€æœ‰ç¤ºä¾‹ä»£ç éƒ½èƒ½å¤Ÿåœ¨ GitHub ä»“åº“ä¸­æ‰¾åˆ°ï¼š https://github.com/Moosphan/MotionLayoutSamples åç»­å¦‚æ­¤ä¸€æ¥ï¼ŒMotionLayout ç³»åˆ—å·²ç»å®Œæˆä¸¤ç¯‡æ–‡ç« äº†ï¼Œå‰©ä¸‹çš„å†…å®¹åº”è¯¥è¿˜éœ€è¦ä¸€ç¯‡æ–‡ç« æ¥å®¹çº³ï¼Œåç»­å¯èƒ½è¿˜ä¼šé¢å¤–æä¾›ä¸€ç¯‡å®æˆ˜ç³»åˆ—æ–‡ç« ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« ä¸»è¦ä»‹ç» KeyFrameSet å®¶æ—æœ€åä¸€ä¸ªæˆå‘˜ä»¥åŠ MotionLayout å¤šçŠ¶æ€åœºæ™¯çš„ä½¿ç”¨ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šä»‹ç»å¦‚ä½•å®ç°ä¸ RecyclerView â€œå¼ºå¼ºè”åˆâ€ã€‚æœ€åï¼ŒGoogle åœ¨ Android studio 4.2 ç»ˆäºæ¨å‡ºäº† Motion Editor å·¥å…·ï¼Œä¸‹ç¯‡æ–‡ç« ä¹Ÿä¼šé€šè¿‡ä¸€ä¸ªå°å®æˆ˜é¡¹ç›®æ¥ä»‹ç»å…¶ç”¨æ³•ï¼Œæ‹­ç›®ä»¥å¾…ã€‚ ç¬”è€…è¯´æœ€è¿‘è¿™ä¸¤ç¯‡æ–‡ç« éƒ½å°½é‡åšåˆ°æ¯ä¸ªé‡è¦çŸ¥è¯†ç‚¹éƒ½æä¾›ä¸€ä¸ªå®æˆ˜çš„å°ç¤ºä¾‹ï¼ŒåŠ›æ±‚åšåˆ°åŠ æ·±ç†è§£ï¼Œæ–‡ä¸­å¾ˆå¤šå†…å®¹éƒ½å‚è€ƒè‡ª Nicolas Roard å¯¹äº MotionLayout çš„ç³»åˆ—æ•™ç¨‹å’Œ Android å®˜æ–¹æ–‡æ¡£ï¼Œå¹¶åŠ å…¥è‡ªå·±çš„ç†è§£ã€‚ä»å»å¹´ç¼–æ’°ç¬¬ä¸€ç¯‡æ–‡ç« æ—¶æ¥çœ‹ï¼Œå›½å†…å¯¹äº MotionLayout çš„ç³»åˆ—æ–‡ç« éå¸¸å°‘ï¼Œå†™æ–‡ç« çš„ç›®çš„å…¶å®å¾ˆç®€å•ï¼Œè®©è‡ªå·±æ¶ˆåŒ–æ–°çŸ¥è¯†çš„åŒæ—¶ï¼Œä¹Ÿèƒ½å¤Ÿè®©æ›´å¤šå›½äººçŸ¥é“ã€è®¤è¯†å’Œå°è¯•ä½¿ç”¨ MotionLayout è¿™ä¸ªå…¨æ–°çš„åŠ¨ç”»ç»„ä»¶ã€‚ ç”±äºä¸ªäººæŠ€æœ¯èƒ½åŠ›å’Œè¡¨è¿°èƒ½åŠ›æœ‰é™ï¼Œå¾ˆå¤šå†…å®¹å¯èƒ½å¹¶æ²¡æœ‰è®²è§£å…¨é¢å’Œé€å½»ï¼Œå¦‚æœæœ‰ä»€ä¹ˆå»ºè®®æˆ–è€…é—®é¢˜ï¼Œæ¬¢è¿ç•™è¨€åŒºæ¢è®¨ï¼Œä¸€èµ·è¿›æ­¥ğŸºã€‚","link":"/2020/08/12/MotionLayout%EF%BC%9A%E5%B8%A6%E4%BD%A0%E8%BF%9B%E5%85%A5%E5%8A%A8%E7%94%BB%E6%96%B0%E4%B8%96%E7%95%8C/"},{"title":"AndroidåŸºäºé«˜å¾·åœ°å›¾å®ç°æœç´¢æ¡†çš„è‡ªåŠ¨è¾“å…¥æç¤ºåŠŸèƒ½","text":"æœ€è¿‘å…¬å¸é¡¹ç›®ä¸­ä¸€ç›´åœ¨æåœ°å›¾å¼€å‘,ä»Šå¤©äº§å“ç»ç†å°±ç»™æˆ‘å¸ƒç½®äº†ä¸€äº›(æ— æ³•æƒ³è±¡)ä»»åŠ¡,å…¶ä¸­ä¸€ä¸ªå°±æ˜¯å®ç°åœ°ç‚¹æœç´¢è¾“å…¥æ¡†çš„è‡ªåŠ¨è¾“å…¥æç¤ºåŠŸèƒ½ã€‚æ‹¿åˆ°ä»»åŠ¡è‚¯å®šæƒ³è®¨ä»·è¿˜ä»·ä¸€ç•ª,ä½†æ˜¯æƒ³åˆ°ä»¥å‰ä¹Ÿå†™è¿‡,å°±ä¸å†è´Ÿéš…é¡½æŠ—äº†ã€‚ ä»¥å‰åœ¨å­¦æ ¡çš„æ—¶å€™å®ç°è¿‡ç±»ä¼¼åŠŸèƒ½,æ˜¯ä½¿ç”¨é«˜å¾·è‡ªå¸¦çš„InputtipsListeneræ¥å®ç°çš„,æƒ³äº†è§£å¯ä»¥çœ‹çœ‹:æ–‡ç« ä¼ é€ç‚¹,è¿™é‡Œå°±ä¸è¯¦ç»†ä»‹ç»äº†ã€‚ä½œä¸ºä¸€åå¤´è„‘å‘çƒ­çš„å¼€å‘è€…,è‚¯å®šä¸èƒ½å®‰äºç°çŠ¶,è¿™é‡Œä¸»è¦ä»‹ç»å…¶ä»–ä¸¤ç§æ–¹å¼ - poiå®ç°å’Œhttpè¯·æ±‚æ¥å£å®ç°,ä¸ç®¡èƒ½ä¸èƒ½æˆåŠŸ,è¯•äº†å†è¯´,æ’¸èµ·è¢–å­å°±æ˜¯å¹²ã€‚å…ˆçœ‹çœ‹æœ€ç»ˆçš„æ•ˆæœ: åšä¹‹å‰å…ˆåˆ†æä¸€ä¸‹åŠŸèƒ½éœ€æ±‚,é¦–å…ˆè¾“å…¥æ¡†ä¸­è¦æ·»åŠ å†…å®¹æ¸…é™¤çš„icon,å½“è¾“å…¥æ¡†æœ‰æ–‡å­—æ—¶,éœ€è¦æ˜¾ç¤º,ä¸ºç©ºæ—¶éšè—;æ¥ç€,éœ€è¦å®ç°åœ°å€æœç´¢åŠŸèƒ½å¹¶é€šè¿‡listviewå±•ç¤ºç»“æœ;æœ€åéœ€è¦å®ç°å±•ç¤ºæœç´¢å†å²çš„åŠŸèƒ½ã€‚å¥½çš„,é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥å®ç°ã€‚ å…¶å®,å®ç°æ•ˆæœä¸­çš„è¾“å…¥æ¡†å¹¶ä¸éš¾,åªéœ€è¦ä¸‰ä¸ªä¸œè¥¿å°±å¤Ÿäº†:LinearLayout,EditText,ImageViewã€‚ç›´æ¥ä¸Šä»£ç å§,ä¸Šäº†ä»£ç ä½ å°±çŸ¥é“å®ƒåˆ°åº•æœ‰å¤šç®€å•äº†: 123456789101112131415161718192021222324252627282930313233&lt;LinearLayout android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;36dp&quot; android:layout_weight=&quot;1&quot; android:layout_marginLeft=&quot;20dp&quot; android:background=&quot;@drawable/search_view_bg&quot; android:orientation=&quot;horizontal&quot; android:gravity=&quot;center_vertical&quot;&gt; &lt;EditText android:id=&quot;@+id/search_edit_text&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;36dp&quot; android:hint=&quot;@string/input_cross_location&quot; android:textColorHint=&quot;#9B9B9B&quot; android:textSize=&quot;12sp&quot; android:maxLines=&quot;1&quot; android:layout_weight=&quot;1&quot; android:paddingBottom=&quot;10dp&quot; android:paddingTop=&quot;10dp&quot; android:paddingLeft=&quot;10dp&quot; android:background=&quot;@drawable/search_edit_bg&quot; android:drawableLeft=&quot;@mipmap/icon_edit_search&quot; android:drawablePadding=&quot;16dp&quot;/&gt; &lt;ImageView android:id=&quot;@+id/search_edit_delete&quot; android:layout_width=&quot;12dp&quot; android:layout_height=&quot;12dp&quot; android:layout_marginLeft=&quot;5dp&quot; android:layout_marginRight=&quot;8dp&quot; android:visibility=&quot;gone&quot; android:src=&quot;@mipmap/iocn_search_cancel&quot;/&gt; &lt;/LinearLayout&gt; æ²¡é”™,è¿™é‡Œä¸ºEditTextçˆ¶å®¹å™¨LinearLayoutè®¾ç½®èƒŒæ™¯,ç„¶åEditTextè®¾ç½®åŒæ ·çš„èƒŒæ™¯,åªä¸è¿‡éœ€è¦å°†å³è¾¹çš„åœ†è§’æ•ˆæœå»æ‰,è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚ä¹Ÿå³æ˜¯è¯´,æˆ‘ä»¬çš„è¾“å…¥æ¡†ç›¸å½“äºæ˜¯LinearLayout,é‡Œé¢åŒ…å«äº†edittextå’Œåˆ é™¤å›¾æ ‡imageview,æ¥çœ‹çœ‹drawableçš„ä»£ç å§: search_view_bg: 12345678910111213141516171819&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;item android:state_window_focused=&quot;false&quot;&gt; &lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;!--&lt;solid android:color=&quot;#F4F4F4&quot; /&gt;--&gt; &lt;corners android:radius=&quot;3dp&quot;/&gt; &lt;solid android:color=&quot;#F3F3F3&quot;/&gt; &lt;!--&lt;stroke android:color=&quot;#ffececec&quot; android:width=&quot;1dp&quot;/&gt;--&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:state_window_focused=&quot;true&quot;&gt; &lt;shape&gt; &lt;corners android:radius=&quot;3dp&quot;/&gt; &lt;!--&lt;stroke android:color=&quot;#ececec&quot; android:width=&quot;1dp&quot; /&gt;--&gt; &lt;solid android:color=&quot;#F3F3F3&quot;/&gt; &lt;!--&lt;solid android:color=&quot;#F4F4F4&quot; /&gt;--&gt; &lt;/shape&gt; &lt;/item&gt;&lt;/selector&gt; search_edit_bg: 1234567891011121314151617181920212223&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;item android:state_window_focused=&quot;false&quot;&gt; &lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;!--&lt;solid android:color=&quot;#F4F4F4&quot; /&gt;--&gt; &lt;corners android:topLeftRadius=&quot;3dp&quot; android:bottomLeftRadius=&quot;3dp&quot;/&gt; &lt;solid android:color=&quot;#F3F3F3&quot;/&gt; &lt;!--&lt;stroke android:color=&quot;#ffececec&quot; android:width=&quot;1dp&quot;/&gt;--&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:state_window_focused=&quot;true&quot;&gt; &lt;shape&gt; &lt;corners android:topLeftRadius=&quot;3dp&quot; android:bottomLeftRadius=&quot;3dp&quot;/&gt; &lt;!--&lt;stroke android:color=&quot;#ececec&quot; android:width=&quot;1dp&quot; /&gt;--&gt; &lt;solid android:color=&quot;#F3F3F3&quot;/&gt; &lt;!--&lt;solid android:color=&quot;#F4F4F4&quot; /&gt;--&gt; &lt;/shape&gt; &lt;/item&gt;&lt;/selector&gt; ok,è¿™å°±å®ç°äº†æœ€ç»ˆçš„è¾“å…¥æ¡†UI,å½“ç„¶,ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹å¼å®ç°,æ¯”å¦‚è‡ªå®šä¹‰view,ç¬¬ä¸‰æ–¹å¼€æºç­‰ç­‰,ä½†æˆ‘è§‰å¾—è¿™å®Œå…¨æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚,è€Œä¸”ç®€å•,ä¸æ˜¯å—?æ¥ä¸‹æ¥,æˆ‘ä»¬éœ€è¦é€šè¿‡ç›‘å¬EditTextçš„å˜åŒ–æ¥å®ç°æœç´¢æ¡†ä¸­åˆ é™¤çš„å˜åŒ–,ä»£ç å¦‚ä¸‹: 12345678910111213141516171819202122232425262728293031323334@Bind(R.id.search_edit_text)EditText inputText;@Bind(R.id.search_edit_delete)ImageView buttonDelete;......buttonDelete.setOnClickListener(this);inputText.addTextChangedListener(this); ......@Overridepublic void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {}@Overridepublic void onTextChanged(CharSequence charSequence, int i, int i1, int i2) { if(charSequence!=null){ buttonDelete.setVisibility(View.VISIBLE); }else { buttonDelete.setVisibility(View.GONE); }}@Overridepublic void afterTextChanged(Editable editable) {} ä»£ç æ¯”è¾ƒç®€å•,å°±ä¸è§£é‡Šäº†,ä¸ç†è§£è¿™ä¸ªæ–¹æ³•çš„å¯ä»¥è°·æ­Œä¸€ä¸‹,æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚ ç”¨è¿‡é«˜å¾·åœ°å›¾apiçš„å¼€å‘è€…åº”è¯¥éƒ½çŸ¥é“é‡Œé¢æœ‰ä¸ªå¸¸ç”¨çš„åŠŸèƒ½:POIæœç´¢.é«˜å¾·æä¾›äº†åƒä¸‡çº§åˆ«çš„ POIï¼ˆPoint of Interestï¼Œå…´è¶£ç‚¹ï¼‰ã€‚åœ¨åœ°å›¾è¡¨è¾¾ä¸­ï¼Œä¸€ä¸ª POI å¯ä»£è¡¨ä¸€æ ‹å¤§å¦ã€ä¸€å®¶å•†é“ºã€ä¸€å¤„æ™¯ç‚¹ç­‰ç­‰ã€‚é€šè¿‡POIæœç´¢ï¼Œå®Œæˆæ‰¾é¤é¦†ã€æ‰¾æ™¯ç‚¹ã€æ‰¾å•æ‰€ç­‰ç­‰çš„åŠŸèƒ½ã€‚å¦‚æœæˆ‘ä»¬çš„éœ€æ±‚æ˜¯è·å–å‘¨å›´å…´è¶£ç‚¹,é‚£ä¹ˆæœç´¢è¾“å…¥æç¤ºåªè¦æ˜¾ç¤ºå…´è¶£ç‚¹å°±å¯ä»¥äº†ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥ä¾æ¬¡é€šè¿‡ä¸¤ç§æ–¹æ³•æ¥å®ç°å¿«æ·è¾“å…¥æç¤ºåŠŸèƒ½: POIæœç´¢å®ç°: è¯ä¸å¤šè¯´,ç›´æ¥ä¸Šä»£ç : 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081//æ–¹æ³•ä¸€:ä½¿ç”¨poiæœç´¢æ¥å£æ–¹æ³• private PoiResult poiResult; // poiè¿”å›çš„ç»“æœ private int currentPage = 0;// å½“å‰é¡µé¢ï¼Œä»0å¼€å§‹è®¡æ•° private PoiSearch.Query query;// PoiæŸ¥è¯¢æ¡ä»¶ç±» private LatLonPoint latLonPoint; private PoiSearch poiSearch; private List&lt;PoiItem&gt; poiItems;// poiæ•°æ® private String keyWord; private CommonAdapter adapter; private final int ADDRESS_LOCATION_GET = 3242; private String POI_SEARCH_TYPE = &quot;æ±½è½¦æœåŠ¡|æ±½è½¦é”€å”®|&quot; + &quot;//æ±½è½¦ç»´ä¿®|æ‘©æ‰˜è½¦æœåŠ¡|é¤é¥®æœåŠ¡|è´­ç‰©æœåŠ¡|ç”Ÿæ´»æœåŠ¡|ä½“è‚²ä¼‘é—²æœåŠ¡|åŒ»ç–—ä¿å¥æœåŠ¡|&quot; + &quot;//ä½å®¿æœåŠ¡|é£æ™¯åèƒœ|å•†åŠ¡ä½å®…|æ”¿åºœæœºæ„åŠç¤¾ä¼šå›¢ä½“|ç§‘æ•™æ–‡åŒ–æœåŠ¡|äº¤é€šè®¾æ–½æœåŠ¡|&quot; + &quot;//é‡‘èä¿é™©æœåŠ¡|å…¬å¸ä¼ä¸š|é“è·¯é™„å±è®¾æ–½|åœ°ååœ°å€ä¿¡æ¯|å…¬å…±è®¾æ–½&quot;; ...... /** * å¼€å§‹è¿›è¡Œpoiæœç´¢ */ protected void doSearchQuery() { latLonPoint = new LatLonPoint(MyApplication.mapLocation.getLatitude(), MyApplication.mapLocation.getLongitude());// 116.472995,39.993743 keyWord = inputText.getText().toString().trim(); currentPage = 0; //keyWordè¡¨ç¤ºæœç´¢å­—ç¬¦ä¸²ï¼Œ //ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºPOIæœç´¢ç±»å‹ï¼ŒäºŒè€…é€‰å¡«å…¶ä¸€ï¼Œé€‰ç”¨POIæœç´¢ç±»å‹æ—¶å»ºè®®å¡«å†™ç±»å‹ä»£ç ï¼Œç è¡¨å¯ä»¥å‚è€ƒä¸‹æ–¹ï¼ˆè€Œéæ–‡å­—ï¼‰ //cityCodeè¡¨ç¤ºPOIæœç´¢åŒºåŸŸï¼Œå¯ä»¥æ˜¯åŸå¸‚ç¼–ç ä¹Ÿå¯ä»¥æ˜¯åŸå¸‚åç§°ï¼Œä¹Ÿå¯ä»¥ä¼ ç©ºå­—ç¬¦ä¸²ï¼Œç©ºå­—ç¬¦ä¸²ä»£è¡¨å…¨å›½åœ¨å…¨å›½èŒƒå›´å†…è¿›è¡Œæœç´¢ query = new PoiSearch.Query(keyWord, POI_SEARCH_TYPE, &quot;&quot;); query.setPageSize(30);// è®¾ç½®æ¯é¡µæœ€å¤šè¿”å›å¤šå°‘æ¡poiItem query.setPageNum(currentPage);// è®¾ç½®æŸ¥ç¬¬ä¸€é¡µ if (latLonPoint != null) { poiSearch = new PoiSearch(this, query); poiSearch.setOnPoiSearchListener(this); poiSearch.setBound(new PoiSearch.SearchBound(latLonPoint, 3000, true));//è®¾ç½®æœç´¢èŒƒå›´ poiSearch.searchPOIAsyn();// å¼‚æ­¥æœç´¢ } } ...... @Override public void onPoiSearched(PoiResult result, int code) { //DialogUtils.dismissProgressDialog(); if (code == AMapException.CODE_AMAP_SUCCESS) { if (result != null &amp;&amp; result.getQuery() != null) {// æœç´¢poiçš„ç»“æœ loge(&quot;æœç´¢çš„codeä¸º====&quot;+code+&quot;, resultæ•°é‡==&quot;+result.getPois().size()); if (result.getQuery().equals(query)) {// æ˜¯å¦æ˜¯åŒä¸€æ¬¡æœç´¢ poiResult = result; loge(&quot;æœç´¢çš„codeä¸º====&quot;+code+&quot;, resultæ•°é‡==&quot;+poiResult.getPois().size()); List&lt;SuggestionCity&gt; suggestionCities = poiResult.getSearchSuggestionCitys();// å½“æœç´¢ä¸åˆ°poiitemæ•°æ®æ—¶ï¼Œä¼šè¿”å›å«æœ‰æœç´¢å…³é”®å­—çš„åŸå¸‚ä¿¡æ¯ if (poiItems != null &amp;&amp; poiItems.size() &gt; 0) { poiItems.clear(); if (adapter != null) { adapter.notifyDataSetChanged(); } } poiItems = poiResult.getPois();// å–å¾—ç¬¬ä¸€é¡µçš„poiitemæ•°æ®ï¼Œé¡µæ•°ä»æ•°å­—0å¼€å§‹ //é€šè¿‡listviewæ˜¾ç¤ºæœç´¢ç»“æœçš„æ“ä½œçœç•¥ ...... } } else { loge(&quot;æ²¡æœ‰æœç´¢ç»“æœ&quot;); toast(getString(R.string.search_no_result)); empty_view.setText(getString(R.string.search_no_result)); } } else { loge(&quot;æœç´¢å‡ºç°é”™è¯¯&quot;); toast(getString(R.string.search_error)); empty_view.setText(getString(R.string.search_error)); } } @Override public void onPoiItemSearched(PoiItem poiItem, int i) { } æ³¨é‡Šéƒ½æ¯”è¾ƒæ¸…æ¥š,å¤§å®¶ç†è§£èµ·æ¥åº”è¯¥ä¹Ÿä¸éš¾,å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒé«˜å¾·å®˜æ–¹æ–‡æ¡£,å¯ä»¥ç›´æ¥åœ¨onTextChangeed()æ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦æœ‰å†…å®¹æ¥è°ƒç”¨doSearchQuery()æ–¹æ³•å³å¯ã€‚ é€šè¿‡å®æ—¶è®¿é—®httpæ¥å£å®ç°:é™¤äº†ä»¥ä¸Šæ–¹æ³•å®ç°,è¿˜å¯ä»¥ç”¨é«˜å¾·æä¾›çš„webç«¯APIæ¥å£å®ç°åŠŸèƒ½,è¯¦æƒ…è§é«˜å¾·webæœåŠ¡å¼€å‘æ–‡æ¡£ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è¯·æ±‚é«˜å¾·ä¸ºæˆ‘ä»¬æä¾›çš„æœç´¢urlæ¥å£æ¥è®¿é—®å¹¶è·å–æ•°æ®,è¾“å…¥æç¤ºAPIæœåŠ¡åœ°å€ä¸ºï¼šhttp://restapi.amap.com/v3/assistant/inputtips?éœ€è¦æˆ‘ä»¬å¡«å……ç›¸åº”çš„å­—æ®µ,å¦‚key,keywordç­‰,å…·ä½“ä»‹ç»çœ‹å®˜æ–¹æ–‡æ¡£å°±å¯ä»¥äº†,å¤§æ³¢ä»£ç æ¥è¢­: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136 //æ–¹æ³•äºŒ:ä½¿ç”¨httpè¯·æ±‚è¿”å›æœç´¢ç»“æœ private List&lt;POISearchResultBean.Tips&gt; tipsList; private POISearchResultBean resultBean; private String locationString; private String lon; private String lat; private final int SEARCH_OK = 3266; @Bind(R.id.search_result_listview) ListView resultListView; ....... private MapSerchActivity.MyWeakReferenceHandler handler = new MapSerchActivity.MyWeakReferenceHandler(this) { @Override public void handleMessage(Message msg, Activity weakReferenceActivity) { if (msg.what == ADDRESS_LOCATION_GET) { if (tipsList != null &amp;&amp; tipsList.size() &gt; 0) { if (adapter == null &amp;&amp; resultListView != null) { //wrong resultListView.setAdapter(adapter = new CommonAdapter&lt;POISearchResultBean.Tips&gt;(SearchAddressActivity.this, tipsList, R.layout.search_result_item) { @Override public void convert(ViewHolder helper, final POISearchResultBean.Tips item) { helper.setText(R.id.search_result_item_address_name, item.getName()); helper.setText(R.id.search_result_item_address_detail, item.getDistrict()+item.getAddress()); helper.getView(R.id.search_result_item_address_layout).setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { loge(&quot;ç‚¹å‡»äº†item&quot;); toast(item.getName()); boolean hasData = hasData(item.getName()); if (!hasData) { insertData(item.getName()); //queryData(&quot;&quot;); } locationString = item.getLocation(); lon = locationString.substring(0,locationString.indexOf(&quot;,&quot;)); lat = locationString.substring(locationString.indexOf(&quot;,&quot;)+1,locationString.length()); loge(&quot;ç»çº¬åº¦ä¿¡æ¯ä¸º===&quot;+lon+&quot;,&quot;+lat); Intent intent = new Intent(); intent.putExtra(&quot;location_lon&quot;,lon); intent.putExtra(&quot;location_lat&quot;,lat); setResult(SEARCH_OK, intent); finish(); } }); } }); } else { adapter = null; resultListView.setAdapter(adapter = new CommonAdapter&lt;POISearchResultBean.Tips&gt;(SearchAddressActivity.this, tipsList, R.layout.search_result_item) { @Override public void convert(ViewHolder helper, final POISearchResultBean.Tips item) { helper.setText(R.id.search_result_item_address_name, item.getName()); helper.setText(R.id.search_result_item_address_detail, item.getDistrict()+item.getAddress()); helper.getView(R.id.search_result_item_address_layout).setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) {// loge(&quot;ç‚¹å‡»äº†item&quot;); loge(&quot;ç‚¹å‡»äº†item&quot;); toast(item.getName()); boolean hasData = hasData(item.getName()); if (!hasData) { insertData(item.getName()); //queryData(&quot;&quot;); } locationString = item.getLocation(); lon = locationString.substring(0,locationString.indexOf(&quot;,&quot;)); lat = locationString.substring(locationString.indexOf(&quot;,&quot;)+1,locationString.length()); loge(&quot;ç»çº¬åº¦ä¿¡æ¯ä¸º===&quot;+lon+&quot;=====&quot;+lat); Intent intent = new Intent(); intent.putExtra(&quot;location_lon&quot;,lon); intent.putExtra(&quot;location_lat&quot;,lat); setResult(SEARCH_OK, intent); finish(); } }); } }); } } } } }; ....... /** * by moos on 2017/09/11 * func:httpè¯·æ±‚è¿”å›å…³é”®è¯æœç´¢ç»“æœ * è¯·æ±‚è·¯å¾„èŒƒä¾‹:http://restapi.amap.com/v3/assistant/inputtips?key=æ‚¨çš„key&amp;keywords=è‚¯å¾·åŸº&amp;types=050301&amp;location=116.481488,39.990464&amp;city=åŒ—äº¬&amp;datatype=all */ private void searchAddressByHttp(String keyWord){ //DialogUtils.createProgressDialog(SearchAddressActivity.this,&quot;Searching...&quot;); OkHttpUtils .get() .url(HttpAPI.AMAP_POI_SEARCH_URL + &quot;key=&quot;+Const.amap_poi_search_key+&quot;&amp;keywords=&quot;+keyWord) .build() .execute(new StringCallback() { @Override public void onError(Call call, Exception e, int id) { loge(&quot;è·å–http poiæœç´¢ç»“æœå¤±è´¥=&quot; + e.getMessage()); //DialogUtils.dismissProgressDialog(); Toast.makeText(SearchAddressActivity.this, getString(R.string.act_qr_code_fail), Toast.LENGTH_LONG).show(); } @Override public void onResponse(String response, int id) { Logger.e(&quot;è·å–http poiæœç´¢ç»“æœ =&quot; + response); resultBean = JSONObject.parseObject(response, POISearchResultBean.class); if (resultBean.getStatus()==1) { //å¤„ç†å’Œæ˜¾ç¤ºæœç´¢æ•°æ®åˆ—è¡¨ if (tipsList != null &amp;&amp; tipsList.size() &gt; 0) { tipsList.clear(); if (adapter != null) { adapter.notifyDataSetChanged(); } } tipsList = resultBean.getTips(); Message message = Message.obtain(handler); message.what = ADDRESS_LOCATION_GET; handler.sendMessage(message); } else { toast(&quot;æœç´¢å¤±è´¥,è¯·é‡æ–°å°è¯•&quot;); } } }); } é€šè¿‡okhttpè¯·æ±‚ç½‘ç»œæ¥å£æœ‰å¾ˆå¤šå¤§ç¥å°è£…å¥½çš„å·¥å…·åº“,è¿™é‡Œæˆ‘ä½¿ç”¨çš„é¸¿ç¥çš„okHttpUtils,å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥é€‰æ‹©ã€‚åŒæ—¶,è¿™é‡Œä½¿ç”¨äº†CommonAdapteræ¥ä½œä¸ºlistviewçš„é€‚é…å™¨,åŒæ ·æ˜¯é¸¿ç¥çš„æ°ä½œ,å¦‚æœä½ å¯¹å®ƒä¸ç†Ÿæ‚‰,å»ºè®®å»çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« :æ‰“é€ listviewä¸‡èƒ½é€‚é…å™¨ã€‚å…¶ä»–çš„å°±æ²¡ä»€ä¹ˆéš¾ç‚¹äº†,å…³é”®è¿˜æ˜¯é è‡ªå·±ç ”ç©¶å’Œç»ƒä¹ ä¸€ä¸‹äº†ã€‚ æœ€å,è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°å±•ç¤ºæœç´¢å†å²çš„åŠŸèƒ½å§ã€‚å…ˆåˆ†æä¸€ä¸‹éœ€æ±‚:é¦–å…ˆè¿›å…¥åˆ°æœç´¢ç•Œé¢è¦å±•ç¤ºæœç´¢å†å²åˆ—è¡¨,ç„¶åå¯ä»¥ç‚¹å‡»åˆ—è¡¨ä¸‹æ–¹çš„æ¸…ç©ºå†å²æ¥æ¸…é™¤æ•°æ®,æ¥ç€,å½“æˆ‘ä»¬æœç´¢åœ°åå¹¶é€‰ä¸­æ—¶,è‡ªåŠ¨å­˜å…¥æœç´¢å†å²ã€‚å…¶å®,è¯´åˆ°åº•,å°±æ˜¯ä¸¤ä¸ªå°åŠŸèƒ½,æ•°æ®å­˜å‚¨å’Œæ•°æ®å±•ç¤º,ä¸‹é¢ä¾æ¬¡æ¥æ¢è®¨å¦‚ä½•å®ç°ã€‚ æœç´¢å†å²æ•°æ®çš„å­˜å‚¨: ä¸€èˆ¬åœ°,æˆ‘ä»¬ä¼šå°†æœç´¢çš„å†å²æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ã€‚å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼åˆ†åˆ«ä¸ºæ•°æ®åº“å­˜å‚¨å’Œsp(SharedPreference)å­˜å‚¨,ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å®ç°æˆ‘ä»¬çš„éœ€æ±‚,è¿™é‡Œæˆ‘æ‰ç”¨çš„æ˜¯æ•°æ®åº“,æœ‰æ—¶é—´çš„è¯å¤§å®¶å¯ä»¥è¯•è¯•spå­˜å‚¨æ–¹å¼ã€‚è¿™é‡Œä¸ç ”ç©¶æ•°æ®åº“çš„åŸºæœ¬ç”¨æ³•æ¯”è¾ƒç®€å•,å°±ä¸€ç¬”å¸¦è¿‡äº†,ç›´æ¥ä¸Šä»£ç : é¦–å…ˆæ˜¯åˆ›å»ºæ•°æ®åº“: 123456789101112131415161718192021222324/** * Created by moos on 17/9/11. */public class SearchHistorySQLiteHelper extends SQLiteOpenHelper { private static String name = &quot;search.db&quot;; private static Integer version = 1; public SearchHistorySQLiteHelper(Context context) { super(context, name, null, version); } @Override public void onCreate(SQLiteDatabase sqLiteDatabase) { sqLiteDatabase.execSQL(&quot;create table history(id integer primary key autoincrement,name varchar(200))&quot;); } @Override public void onUpgrade(SQLiteDatabase sqLiteDatabase, int i, int i1) { }} å…·ä½“æ“ä½œ: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112//å†å²æœç´¢åŠŸèƒ½ private SearchHistorySQLiteHelper helper = new SearchHistorySQLiteHelper(this); private SQLiteDatabase db; private BaseAdapter baseAdapter; @Bind(R.id.search_history_listview) ListView search_history_listView; @Bind(R.id.search_history_view) LinearLayout search_history_view; ...... @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_search_address); ButterKnife.bind(this); initView(); } private void initView(){ buttonCancel.setOnClickListener(this); buttonDelete.setOnClickListener(this); inputText.addTextChangedListener(this); search_history_listView.setOnItemClickListener(new AdapterView.OnItemClickListener() { @Override public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) { loge(&quot;ç‚¹å‡»äº†ç¬¬&quot;+position+&quot;ä¸ªæœç´¢å†å²item&quot;); TextView textView = (TextView) view.findViewById(R.id.search_history_item_address_name); String name = textView.getText().toString(); inputText.setText(name); Toast.makeText(SearchAddressActivity.this, name, Toast.LENGTH_SHORT).show(); } }); // ç¬¬ä¸€æ¬¡è¿›å…¥æŸ¥è¯¢æ‰€æœ‰çš„å†å²è®°å½• queryData(&quot;&quot;); } ...... //é‡‡ç”¨æœ¬åœ°æ•°æ®åº“å­˜å‚¨ /** * æ’å…¥æ•°æ® */ private void insertData(String tempName) { db = helper.getWritableDatabase(); db.execSQL(&quot;insert into history(name) values('&quot; + tempName + &quot;')&quot;); db.close(); } /** * æ¨¡ç³ŠæŸ¥è¯¢æ•°æ® */ private void queryData(String tempName) { Cursor cursor = helper.getReadableDatabase().rawQuery( &quot;select id as _id,name from history where name like '%&quot; + tempName + &quot;%' order by id desc &quot;, null); // åˆ›å»ºadapteré€‚é…å™¨å¯¹è±¡ baseAdapter = new SimpleCursorAdapter(this, R.layout.search_history_item, cursor, new String[] { &quot;name&quot; }, new int[] { R.id.search_history_item_address_name }, CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER); //æ·»åŠ footerView View footerView = LayoutInflater.from(this).inflate(R.layout.delete_search_history_bt,null); search_history_listView.addFooterView(footerView,null,false); footerView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { deleteData(); toast(&quot;æ¸…é™¤æˆåŠŸ&quot;); } }); // è®¾ç½®é€‚é…å™¨ search_history_listView.setAdapter(baseAdapter); baseAdapter.notifyDataSetChanged(); if(baseAdapter.getCount()==0){ //æ— å†å²æœç´¢è®°å½• search_history_view.setVisibility(View.GONE); } } /** * æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦å·²ç»æœ‰è¯¥æ¡è®°å½• */ private boolean hasData(String tempName) { Cursor cursor = helper.getReadableDatabase().rawQuery( &quot;select id as _id,name from history where name =?&quot;, new String[]{tempName}); //åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ª return cursor.moveToNext(); } /** * æ¸…ç©ºæ•°æ® */ private void deleteData() { db = helper.getWritableDatabase(); db.execSQL(&quot;delete from history&quot;); db.close(); loge(&quot;æœç´¢å†å²æ•°æ®åˆ é™¤æˆåŠŸ&quot;); queryData(&quot;&quot;); } æ•°æ®åº“çš„æ“ä½œç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹å’Œæ–‡ç« ,è¿™é‡Œå°±ä¸å¤šåŠ è§£é‡Š,ä¸»è¦è¯´ä¸€ä¸‹é€»è¾‘å§ã€‚é¦–å…ˆ,æˆ‘ä»¬è¾“å…¥å…³é”®è¯æœç´¢åˆ°ç›¸åº”çš„ç›®æ ‡åœ°ç‚¹å,ç‚¹å‡»å›è°ƒä¸­,å³æ’å…¥ä¸€æ¡è¯¥åœ°åçš„æ•°æ®ã€‚å½“ç„¶,ä¸ºäº†é˜²æ­¢é‡å¤,æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ•°æ®åº“ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¯¥æ•°æ®ã€‚æˆ‘ä»¬åˆšè¿›å…¥æœç´¢ç•Œé¢çš„æ—¶å€™,éœ€è¦æŸ¥è¯¢æ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ®å¹¶å±•ç¤ºã€‚ æœç´¢å†å²æ•°æ®çš„å±•ç¤ºå’Œåˆ é™¤: å±•ç¤ºçš„è¯æ²¡ä»€ä¹ˆå¤ªå¤§çš„é—®é¢˜,ä¸€èˆ¬é‡‡ç”¨listviewå±•ç¤ºå¹¶ä¸ºitemåŠ ä¸Šç‚¹å‡»äº‹ä»¶å°±OKäº†,ä¸»è¦æ˜¯è¦è®¾ç½®å¥½å±•ç¤ºæ•°æ®å’Œåˆ·æ–°æ•°æ®çš„é€»è¾‘ã€‚è¿™é‡Œä¸»è¦æä¸€ä¸‹å¦‚ä½•å®ç°ä¸‹æ–¹â€æ¸…é™¤æœç´¢å†å²â€çš„å‹å¥½å±•ç¤ºä»¥åŠé€»è¾‘ã€‚ å¦‚æœæœ‰äººé—®ä½ å¦‚ä½•å¿«é€Ÿå®ç°listviewä¸‹é¢çš„buttonä¾é™„æ•ˆæœ,ä½ ä¼šæ€ä¹ˆå›ç­”?å¸¸è§çš„å›ç­”ä¸€èˆ¬æœ‰ä¸¤ç§: 1.åœ¨listviewä¸‹é¢æ”¾ä¸€ä¸ªbutton,ç„¶åå¤–é¢å¥—ä¸€å±‚ScrollerView 2.ä½¿ç”¨listviewçš„addFooterView()ç»™å…¶æ·»åŠ åº•éƒ¨å¸ƒå±€ è™½ç„¶ä¸¤ç§æ–¹å¼å¾ˆå®¹æ˜“æƒ³åˆ°,ä½†æ˜¯å¯¹äºæˆ‘ä»¬è¿™äº›æ–°æ‰‹æ¥è¯´,åŠ¨æ‰‹å®ç°èµ·æ¥å¤šå°‘æœ‰äº›å¼¯å¼¯ç»•ç»•ã€‚æ¯”å¦‚ç¬¬ä¸€ç§æ–¹å¼,æˆ‘ä»¬éœ€è¦è€ƒè™‘å¦‚ä½•å¤„ç†åµŒå¥—æ»‘åŠ¨çš„é—®é¢˜,è‡³äºç¬¬äºŒç§,æ— éæ˜¯ç ”ç©¶listviewä¹‹footerviewçš„ç”¨æ³•,å½“ç„¶,æŠ›å¼€å„è‡ªçš„éš¾ç‚¹,ç¬¬äºŒç§æ–¹å¼æ— éæ›´åŠ ä¼˜é›…ä¸€äº›,æ‰€ä»¥,è¿™é‡Œåªè®¨è®ºå¦‚ä½•ä½¿ç”¨è¯¥æ–¹å¼å®ç°ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹footerviewçš„å¸ƒå±€: search_history_item: 123456789101112131415161718&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:orientation=&quot;vertical&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot; android:gravity=&quot;center_horizontal&quot;&gt; &lt;TextView android:id=&quot;@+id/item_search_history_delete&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot; android:layout_marginTop=&quot;15dp&quot; android:gravity=&quot;center&quot; android:text=&quot;æ¸…æ¥šæœç´¢å†å²&quot; android:textSize=&quot;12sp&quot; android:layout_marginBottom=&quot;15dp&quot; android:textColor=&quot;#828282&quot;/&gt;&lt;/LinearLayout&gt; listviewæ·»åŠ footerviewæ¯”è¾ƒç®€å•,åªé€šè¿‡ç®€å•çš„ä¸¤è¡Œä»£ç : 123//æ·»åŠ footerViewView footerView = LayoutInflater.from(this).inflate(R.layout.delete_search_history_bt,null);search_history_listView.addFooterView(footerView,null,false); ä¾¿å¯ä»¥å®ç°,ä½†æ˜¯footerviewçš„ç‚¹å‡»äº‹ä»¶å¦‚ä½•è·å–å‘¢?å¾ˆå¤šäººè¯´ç›´æ¥ç”¨onItenClickListener()å‘€,ä½†æ˜¯,å¤§å®¶å¯ä»¥é€šè¿‡logæˆ–è€…toastçœ‹çœ‹,ç‚¹å‡»footerviewæ˜¯å¦çœŸçš„å“åº”äº†ã€‚ç­”æ¡ˆæ˜¯ - å¹¶æ²¡æœ‰ã€‚æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…åœ¨onITemClickListenerå›è°ƒæ–¹æ³•ä¸­å®ç°footerviewç‚¹å‡»äº‹ä»¶,å› ä¸ºpositionå¹¶æ²¡æœ‰å˜åŒ–,ä¸Šé™ä¾æ—§æ˜¯åŸæ¥çš„adapter.getCount()ã€‚æˆ‘ä»¬å¯ä»¥å…ˆç¦æ­¢footerviewåœ¨itemä¸­çš„ç‚¹å‡»å“åº”,å³addFooterView()æ–¹æ³•ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ä¸ºfalse,ç„¶åç»™footerViewå•ç‹¬è®¾ç½®ç‚¹å‡»äº‹ä»¶: 1234567footerView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { deleteData(); toast(&quot;æ¸…é™¤æˆåŠŸ&quot;); } }); åˆ°è¿™é‡Œ,æˆ‘ä»¬å°±å®Œæ•´å®ç°äº†åœ°å›¾çš„æœç´¢åŠŸèƒ½äº†,è™½ç„¶å®ç°çš„æ–¹å¼æ¯”è¾ƒç®€å•,ä½†è¿˜æ˜¯å­¦åˆ°ä¸€äº›ä¸œè¥¿çš„ã€‚åé¢æœ‰æ—¶é—´ä¼šå°†è¯¥éƒ¨åˆ†åŠŸèƒ½åšä¸ªdemoå•ç‹¬åˆ†äº«å‡ºæ¥ã€‚å¦å¤–å¤§å®¶å¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜å’Œä¼˜åŒ–å»ºè®®,æ¬¢è¿ç•™è¨€åé¦ˆ,ä¸èƒœæ„Ÿæ¿€ğŸ˜†ã€‚ æœ€å,è¯·æ•™ä¸€ä¸‹å¤§å®¶macå¦‚ä½•å½•åˆ¶gifå‘¢,ä¸ºä»€ä¹ˆæˆ‘ç”¨licecapå½•åˆ¶å‡ºæ¥çš„æ˜¯é»‘å±å‘¢(âŠ™ï¹âŠ™).","link":"/2017/09/24/amap-input-tips/"},{"title":"åŸºäºé«˜å¾·åœ°å›¾å®ç°å®Œå…¨è‡ªå®šä¹‰Marker","text":"&emsp;&emsp;åšåœ°å›¾ç¤¾äº¤ç±»APPå¼€å‘çš„éƒ½çŸ¥é“,ä¸€èˆ¬æƒ…å†µä¸‹,ä¸ºäº†æ•´ä½“çš„ç¾è§‚å’Œç”¨æˆ·ä½“éªŒåº¦,æˆ‘ä»¬éœ€è¦å®šåˆ¶åŒ–Markerçš„æ ·å¼ã€‚æœ¬æ–‡ä¸­å®ç°çš„æ–¹å¼éƒ½æ˜¯åŸºäºé«˜å¾·åœ°å›¾çš„,ç™¾åº¦åœ°å›¾ä¹Ÿç±»ä¼¼,å¤§å®¶å¯ä»¥ç…§è‘«èŠ¦ç”»ç“¢,åºŸè¯ä¸å¤šè¯´,å…ˆæ¥çœ‹çœ‹æœ€ç»ˆæ•ˆæœ: å®ç°æ€è·¯:å…ˆæ¥çœ‹çœ‹é«˜å¾·å®˜æ–¹æä¾›çš„è®¾ç½®Markerå›¾æ ‡çš„æ–¹æ³•: æˆ‘ä»¬å¯ä»¥çœ‹åˆ°setIcon()æ–¹æ³•,é‡Œé¢çš„å‚æ•°BitmapDescriptorå°±æ˜¯æˆ‘ä»¬æœ€ç»ˆéœ€è¦çš„ä¸œè¥¿ã€‚é‚£ä¹ˆåˆ°åº•è¯¥å¦‚ä½•å¾—åˆ°è¿™ä¸ªBitmapDescriptorå¯¹è±¡å‘¢,å…¶å®å¾ˆç®€å•,è¯¥å¯¹è±¡å¯ä»¥é€šè¿‡BitmapDescriptorFactoryå·¥å‚ç±»è·å–,BitmapDescriptorFactoryæä¾›äº†ä»¥ä¸‹æ–¹æ³•æ¥å¾—åˆ°BitmapDescriptorå¯¹è±¡: 12345678910111213141516171819202122232425262728293031323334353637383940/** * 1.é€šè¿‡èµ„æºidè·å– */public static BitmapDescriptor fromResource(int var0) { ......}/** * 2.é€šè¿‡è‡ªå®šä¹‰çš„viewè·å– */ public static BitmapDescriptor fromView(View var0) { ...... }/** * 3.é€šè¿‡å…·ä½“è·¯å¾„èµ„æºè·å– */ public static BitmapDescriptor fromPath(String var0) { ......}/** * 4.é€šè¿‡å…·ä½“Assetsèµ„æºè·å– */ public static BitmapDescriptor fromAsset(String var0) { ...... }/** * 5.é€šè¿‡å…·ä½“æ–‡ä»¶è·å– */public static BitmapDescriptor fromFile(String var0) { ......}/** * 6.é€šè¿‡bitmapè·å– */ public static BitmapDescriptor fromBitmap(Bitmap var0) { ...... } ä»ä»¥ä¸Šå®˜æ–¹æä¾›çš„æ–¹æ³•å¯ä»¥çœ‹åˆ°,å¾—åˆ°BitmapDescriptorå¯¹è±¡çš„æ–¹å¼æœ‰å¤šç§,æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦è‡ªè¡Œé€‰æ‹©ã€‚ä½†æ˜¯,ä¸ºäº†åº”å¯¹é¢‘ç¹çš„éœ€æ±‚å˜åŒ–,æˆ‘ä»¬è‚¯å®šè¦é€‰æ‹©æ›´ä¸ºåŠ¨æ€,çµæ´»çš„æ–¹å¼æ¥åº”ä»˜æˆ‘ä»¬çš„éœ€æ±‚å˜åŒ–,æˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©fromView()å’ŒfromBitmap()ä¸¤ç§æ–¹å¼æ¥å¾—åˆ°BitmapDescriptorå¯¹è±¡äº†ã€‚è¿™é‡Œé€‰ç”¨fromBitmap()æ–¹å¼æ¥å¾—åˆ°BitmapDescriptorå¯¹è±¡å§,å› ä¸ºé‡‡ç”¨fromView()æ–¹æ³•è·å–åæœ‰ä¸ªå·¨å‘,è¿™ä¸ªåé¢å†è¯´ã€‚ &emsp;&emsp;å¦‚æœæˆ‘ä»¬è¦æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰Marker,å½“ç„¶æ˜¯å¸Œæœ›èƒ½å¤Ÿè®©å®ƒå¯å¤§å¯å°,å¯åŠ¨å¯é™äº†,é‚£å°±éviewè«å±äº†ã€‚åªè¦æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰viewå¸ƒå±€,ç„¶åè½¬åŒ–æˆbitmapä¸å°±OKäº†å—,å¥½,è¯´å¹²å°±å¹²,æˆ‘ä»¬ä»¥è‡ªå®šä¹‰Makreræ ·å¼å¹¶åŠ è½½ç½‘ç»œå›¾ç‰‡ä¸ºä¾‹,å¼€å¹²! å®šåˆ¶åŒ–Markerå¸ƒå±€,åŠ è½½ç½‘ç»œå›¾ç‰‡: æˆ‘ä»¬å°±ä»¥å®ç°ä»¥ä¸‹Markerçš„æ ·å¼ä¸ºä¾‹: è¿™ä¸ªæ ·å¼æ¯”è¾ƒç®€å•,åªè¦ä¸€ä¸ªCircleImageViewå¤–é¢å¥—ä¸€ä¸ªå›ºå®šçš„å®¹å™¨å°±å¯ä»¥äº†,ç›´æ¥çœ‹å¸ƒå±€ä»£ç : marker_bg.xml: 123456789101112131415161718192021&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:layout_width=&quot;40dp&quot; android:layout_height=&quot;47dp&quot; android:layout_gravity=&quot;center&quot;&gt; &lt;RelativeLayout android:layout_width=&quot;40dp&quot; android:layout_height=&quot;47dp&quot; android:layout_centerHorizontal=&quot;true&quot; android:layout_alignParentBottom=&quot;true&quot; android:background=&quot;@mipmap/act_map_business_bg&quot;&gt; &lt;de.hdodenhof.circleimageview.CircleImageView android:id=&quot;@+id/marker_item_icon&quot; android:layout_width=&quot;32dp&quot; android:layout_height=&quot;32dp&quot; android:src=&quot;@mipmap/userheadholder&quot; android:layout_centerHorizontal=&quot;true&quot; android:layout_marginTop=&quot;1dp&quot; /&gt; &lt;/RelativeLayout&gt;&lt;/RelativeLayout&gt; ä¸‹é¢çœ‹ä¸€ä¸‹ä»£ç ä¸­å¦‚ä½•ä½¿ç”¨: 123456789101112131415161718192021222324252627282930313233343536/** * by moos on 2017/11/13 * func:å®šåˆ¶åŒ–markerçš„å›¾æ ‡ * @return */ private void customizeMarkerIcon(String url, final OnMarkerIconLoadListener listener){ final View markerView = LayoutInflater.from(this).inflate(R.layout.marker_bg,null); final CircleImageView icon = (CircleImageView) markerView.findViewById(R.id.marker_item_icon); Glide.with(this) .load(url+&quot;!/format/webp&quot;) .asBitmap() .thumbnail(0.2f) .diskCacheStrategy(DiskCacheStrategy.NONE) .centerCrop() .into(new SimpleTarget&lt;Bitmap&gt;(){ @Override public void onResourceReady(Bitmap bitmap, GlideAnimation glideAnimation) { //å¾…å›¾ç‰‡åŠ è½½å®Œæ¯•åå†è®¾ç½®bitmapDes icon.setImageBitmap(bitmap); bitmapDescriptor = BitmapDescriptorFactory.fromBitmap(convertViewToBitmap(markerView)); listener.markerIconLoadingFinished(markerView); } }); }....../** * by moos on 2017/11/15 * func:è‡ªå®šä¹‰ç›‘å¬æ¥å£,ç”¨æ¥markerçš„iconåŠ è½½å®Œæ¯•åå›è°ƒæ·»åŠ markerå±æ€§ */ public interface OnMarkerIconLoadListener{ void markerIconLoadingFinished(View view); } è¿™éƒ¨åˆ†ä»£ç ä¹Ÿä¸æ˜¯å¾ˆéš¾,æˆ‘å°±ç®€å•è®²è®²æ€è·¯ã€‚é¦–å…ˆåŠ è½½å¸ƒå±€å,æ‹¿åˆ°é‡Œé¢çš„æ§ä»¶CircleImageView,å¹¶ä½¿ç”¨å¸¸ç”¨çš„Glideå›¾ç‰‡åŠ è½½æ¡†æ¶æ¥åŠ è½½ç½‘ç»œå›¾ç‰‡ã€‚å¯èƒ½ä¼šæœ‰äººé—®,ä¸ºä»€ä¹ˆå…³é—­Glideçš„ç¼“å­˜è®¾ç½®å‘¢?å…³æ³¨åˆ°è¿™ç‚¹çš„äººè¿˜æ˜¯æ¯”è¾ƒç»†å¿ƒçš„,æˆ‘ä»¬ä½¿ç”¨glideåŠ è½½å¤§é‡markerå¸ƒå±€çš„æ—¶å€™,å¦‚æœç¤¾ä¼šäº†ç¼“å­˜é€‰é¡¹,é‚£ä¹ˆå°±å¯èƒ½ä¼šå‡ºç°ç›¸åŒå›¾ç‰‡åªæ˜¾ç¤ºä¸€å¼ çš„çŠ¶å†µ,è¿™ä¸ªå¦‚æœä¸ä¿¡çš„è¯å¯ä»¥è‡ªè¡Œå®éªŒã€‚&emsp;&emsp;ä¸‹é¢æ¥è¯´è¯´å¦ä¸€ä¸ªé—®é¢˜,ä¹Ÿå°±æ˜¯åˆšåˆšæˆ‘ä»¬ä¸ºä»€ä¹ˆé€‰æ‹©fromBitmap()è€Œä¸æ˜¯fromView()æ–¹æ³•,å› ä¸ºä¹‹å‰ç”¨fromView()æ—¶å‘ç°æ·»åŠ çš„ç¬¬ä¸€ä¸ªmarkerå¹¶ä¸ä¼šåŠ è½½å‡ºå›¾ç‰‡,è€Œåªæ˜¯æ˜¾ç¤ºé»˜è®¤çš„å ä½å›¾ã€‚å³ä½¿é€šè¿‡åœ¨GlideåŠ è½½å›¾ç‰‡çš„å›è°ƒæ–¹æ³•onResourceReady()è®¾ç½®ä¹Ÿä¾ç„¶æ— æ•ˆ,è¿™ä¸ªé—®é¢˜å¤§å®¶ä¸ä¿¡é‚ªä¹Ÿå¯ä»¥è¯•è¯•çœ‹çœ‹,è¿™å°±æ˜¯æœ€ç»ˆä¸ºä»€ä¹ˆé€‰æ‹©fromBitmap()æ–¹æ³•çš„åŸå› ã€‚è¿™é‡Œè¿˜ä½¿ç”¨äº†è‡ªå®šä¹‰çš„æ¥å£æ¥ä¼ å…¥markerView,æ–¹ä¾¿åé¢çš„äºŒæ¬¡å¼€å‘,ç„¶ååœ¨å›è°ƒæ–¹æ³•markerIconLoadingFinished()æ–¹æ³•ä¸­è®¾ç½®markerçš„å›¾æ ‡ã€‚ å°†viewè½¬åŒ–ä¸ºbitmapå¯¹è±¡: 1234567891011121314151617/** * by mos on 2017.11.13 * func:viewè½¬bitmap */ public static Bitmap convertViewToBitmap(View view) { view.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED), View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED)); view.layout(0, 0, view.getMeasuredWidth(), view.getMeasuredHeight()); view.buildDrawingCache(); Bitmap bitmap = view.getDrawingCache(); return bitmap; } ç½‘ä¸Šç›¸å…³æ–¹æ³•å¾ˆå¤š,è¿™é‡Œå°±ä¸ä»‹ç»äº†,æœ‰å…´è¶£å¯ä»¥å»ç™¾åº¦ä¸€ä¸‹ã€‚ æ‰¹é‡æ·»åŠ è‡ªå®šä¹‰çš„Markeråˆ°åœ°å›¾ä¸Š:å…ˆæ¥çœ‹çœ‹ä»£ç : 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/** * by moos on 2017/11/15 * func:æ·»åŠ markeråˆ°åœ°å›¾ä¸Šæ˜¾ç¤º */ BitmapDescriptor bitmapDescriptor ; private void addMarker(final ImageNearBean.DataBean.ExhibitionListBean bean) { double lat; double lon; lat = bean.getLatitude(); lon = bean.getLongitude(); LatLng latLng = new LatLng(lat, lon, false); loge(&quot;æ·»åŠ makerå‰çš„ç±»å‹ä¸º===&quot;+bean.getUserType()); String url = bean.getUserLogo(); final MarkerOptions markerOptions = new MarkerOptions(); markerOptions.setFlat(true); markerOptions.anchor(0.5f, 0.5f); markerOptions.position(new LatLng(lat, lon)); customizeMarkerIcon(url, bean.getTeamName(),new OnMarkerIconLoadListener() { @Override public void markerIconLoadingFinished(View view) { //bitmapDescriptor = BitmapDescriptorFactory.fromView(view); markerOptions.icon(bitmapDescriptor); Marker marker; marker = mAMap.addMarker(markerOptions); //marker.setObject(cluster); } }); } /** * by moos on 2017/11/15 * func:æ‰¹é‡æ·»åŠ markeråˆ°åœ°å›¾ä¸Š */ private void addMarkersToMap(){ runOnUiThread(new Runnable() { @Override public void run() { for(int i = 0;i&lt;allBussinessBean.size();i++){ addMarker(allBussinessBean.get(i)); } } }); } æ—¢ç„¶markeræ ·å¼å®šåˆ¶å®Œæ¯•,BitmapDescriptorä¹Ÿæ‹¿åˆ°äº†,é‚£ä¹ˆä¸‹é¢å°±ç®€å•äº†,åº”è¯¥å°±ä¸éœ€è¦æˆ‘å¤šè¯´äº†,åªè¦æ³¨æ„ä¸€ç‚¹,æ‰¹é‡æ·»åŠ markerä¸€èˆ¬æ¯”è¾ƒè€—æ—¶,å°½é‡æ”¾åœ¨å­çº¿ç¨‹å¤„ç†ã€‚ &emsp;&emsp;åˆ°è¿™é‡Œ,è‡ªå®šä¹‰markerå°±å®ç°äº†,è¿™åº”è¯¥å¯ä»¥é€‚ç”¨äºå¤šæ•°æƒ…å†µäº†,ä¸€è·¯çœ‹ä¸‹æ¥,æ˜¯ä¸æ˜¯ä¹ŸæŒºç®€å•çš„,åªè¦ç”¨å¿ƒæ€è€ƒç ”ç©¶å°±å¥½äº†,è€Œä¸”æå®šåæœ‰å¾ˆå¼ºçš„å·¥ä½œåŠ¨åŠ›æœ‰æœ¨æœ‰!","link":"/2017/11/25/amap-marker-custom/"},{"title":"ä¸€ç¯‡æ–‡ç« å¸¦ä½ é¢†ç•¥Androidæ··æ·†çš„é­…åŠ›","text":"åœ¨ Android æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ··æ·†æ˜¯æˆ‘ä»¬å¼€å‘ App çš„ä¸€é¡¹å¿…ä¸å¯å°‘çš„æŠ€èƒ½ã€‚åªè¦æ˜¯æˆ‘ä»¬äº²èº«ç»å†è¿‡ App æ‰“åŒ…ä¸Šçº¿çš„è¿‡ç¨‹ï¼Œæˆ–å¤šæˆ–å°‘éƒ½éœ€è¦äº†è§£ä¸€äº›ä»£ç æ··æ·†çš„åŸºæœ¬æ“ä½œã€‚é‚£ä¹ˆï¼Œæ··æ·†åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿå…·ä½“æ•ˆæœå¦‚ä½•ï¼Ÿåˆ«æ€¥ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸€ä¸€æ¢ç´¢å®ƒçš„â€ç‹¬ç‰¹â€é­…åŠ›ğŸ³ã€‚ æ··æ·†ç®€ä»‹ ä»£ç æ··æ·†ï¼ˆObfuscated codeï¼‰æ˜¯å°†ç¨‹åºä¸­çš„ä»£ç ä»¥æŸç§è§„åˆ™è½¬æ¢ä¸ºéš¾ä»¥é˜…è¯»å’Œç†è§£çš„ä»£ç çš„ä¸€ç§è¡Œä¸ºã€‚ æ··æ·†çš„å¥½å¤„æ··æ·†çš„å¥½å¤„å°±æ˜¯å®ƒçš„ç›®çš„ï¼šä»¤ APK éš¾ä»¥è¢«é€†å‘å·¥ç¨‹ï¼Œå³å¾ˆå¤§ç¨‹åº¦ä¸Šå¢åŠ åç¼–è¯‘çš„æˆæœ¬ã€‚æ­¤å¤–ï¼ŒAndroid å½“ä¸­çš„â€æ··æ·†â€è¿˜èƒ½å¤Ÿåœ¨æ‰“åŒ…æ—¶ç§»é™¤æ— ç”¨èµ„æºï¼Œæ˜¾è‘—å‡å°‘ APK ä½“ç§¯ã€‚æœ€åï¼Œè¿˜èƒ½ä»¥å˜é€šæ–¹å¼é¿å… Android ä¸­å¸¸è§çš„ 64k æ–¹æ³•æ•°å¼•ç”¨çš„é™åˆ¶ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ··æ·†å‰åçš„ APK ç»“æ„å¯¹æ¯”ã€‚ æ··æ·†å‰ï¼š æ··æ·†åï¼š ä»ä¸Šé¢ä¸¤å¼ å›¾å¯ä»¥çœ‹å‡ºï¼šç»è¿‡æ··æ·†å¤„ç†ä¹‹åï¼Œæˆ‘ä»¬çš„ APK ä¸­åŒ…åã€ç±»åã€æˆå‘˜åç­‰éƒ½è¢«æ›¿æ¢ä¸ºéšæœºã€æ— æ„ä¹‰çš„åç§°ï¼Œå¢åŠ äº†ä»£ç é˜…è¯»å’Œç†è§£çš„å›°éš¾ç¨‹åº¦ï¼Œæé«˜äº†åç¼–è¯‘çš„æˆæœ¬ã€‚ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½åˆä¼šæ³¨æ„åˆ°ï¼šæ··æ·†å‰å APK çš„ä½“ç§¯ç«Ÿç„¶ä» 2.7M å‡å°åˆ°äº† 1.4Mï¼Œä½“ç§¯ç¼©å‡äº†è¿‘ä¸€å€ï¼çœŸçš„æœ‰è¿™ä¹ˆç¥å¥‡å—ï¼Ÿå“ˆå“ˆï¼Œç¡®å®æ˜¯è¿™ä¹ˆç¥å¥‡ï¼Œè®©æˆ‘ä»¬æ…¢æ…¢æ¥æ­å¼€å®ƒçš„ç¥ç§˜é¢çº±å§ğŸ˜ã€‚ Android å½“ä¸­çš„æ··æ·†åœ¨ Android ä¸­ï¼Œæˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„â€æ··æ·†â€å…¶å®æœ‰ä¸¤å±‚æ„æ€ï¼Œä¸€ä¸ªæ˜¯ Java ä»£ç çš„æ··æ·†ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯èµ„æºçš„å‹ç¼©ã€‚å…¶å®è¿™ä¸¤è€…ä¹‹é—´å¹¶æ²¡æœ‰ä»€ä¹ˆå…³è”ï¼Œåªä¸è¿‡ä¹ æƒ¯æ€§åœ°æ”¾åœ¨ä¸€èµ·æ¥ä½¿ç”¨ã€‚é‚£ä¹ˆï¼Œè¯´äº†è¿™ä¹ˆå¤šï¼ŒAndroid å¹³å°ä¸Šåˆ°åº•è¯¥å¦‚ä½•å¼€å¯æ··æ·†å‘¢ï¼Ÿ å¯ç”¨æ··æ·†1234567891011...... android { buildTypes { release { minifyEnabled true shrinkResources true proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' } }} ä»¥ä¸Šå°±æ˜¯å¼€å¯æ··æ·†çš„åŸºæœ¬æ“ä½œäº†ï¼Œé€šè¿‡ minifyEnabled è®¾ç½®ä¸º true æ¥å¼€å¯æ··æ·†ã€‚åŒæ—¶ï¼Œå¯ä»¥è®¾ç½® shrinkResources ä¸º true æ¥å¼€å¯èµ„æºçš„å‹ç¼©ã€‚ä¸éš¾çœ‹å‡ºï¼Œæˆ‘ä»¬ä¸€èˆ¬åœ¨æ‰“ release åŒ…æ—¶æ‰å¯ç”¨æ··æ·†ï¼Œå› ä¸ºæ··æ·†ä¼šå¢åŠ é¢å¤–çš„ç¼–è¯‘æ—¶é—´ï¼Œæ‰€ä»¥ä¸å»ºè®®åœ¨ debug æ¨¡å¼ä¸‹å¯ç”¨ã€‚æ­¤å¤–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šåªæœ‰åœ¨å¯ç”¨æ··æ·†çš„å‰æä¸‹å¼€å¯èµ„æºå‹ç¼©æ‰ä¼šæœ‰æ•ˆï¼ä»¥ä¸Šä»£ç ä¸­çš„ proguard-android.txt è¡¨ç¤º Android ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„é»˜è®¤æ··æ·†è§„åˆ™æ–‡ä»¶ï¼Œè€Œ proguard-rules.pro åˆ™æ˜¯æˆ‘ä»¬æƒ³è¦è‡ªå®šä¹‰çš„æ··æ·†è§„åˆ™ï¼Œè‡³äºå¦‚ä½•è‡ªå®šä¹‰æ··æ·†è§„åˆ™æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥ä¼šè®²åˆ°ğŸ˜„ã€‚ ä»£ç æ··æ·†å…¶å®ï¼ŒJava å¹³å°ä¸ºæˆ‘ä»¬æä¾›äº† Proguard æ··æ·†å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåœ°å¯¹ä»£ç è¿›è¡Œæ··æ·†ã€‚æ ¹æ® Java å®˜æ–¹ä»‹ç»ï¼ŒProguard å¯¹åº”çš„å…·ä½“ä¸­æ–‡å®šä¹‰å¦‚ä¸‹ï¼š å®ƒæ˜¯ä¸€ä¸ªåŒ…å«ä»£ç æ–‡ä»¶å‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†å’Œæ ¡éªŒç­‰åŠŸèƒ½çš„å·¥å…· å®ƒèƒ½å¤Ÿæ£€æµ‹å¹¶åˆ é™¤æ— ç”¨çš„ç±»ã€å˜é‡ã€æ–¹æ³•å’Œå±æ€§ å®ƒèƒ½å¤Ÿä¼˜åŒ–å­—èŠ‚ç å¹¶åˆ é™¤æœªä½¿ç”¨çš„æŒ‡ä»¤ å®ƒèƒ½å¤Ÿå°†ç±»ã€å˜é‡å’Œæ–¹æ³•çš„åå­—é‡å‘½åä¸ºæ— æ„ä¹‰çš„åç§°ä»è€Œè¾¾åˆ°æ··æ·†æ•ˆæœ æœ€åï¼Œå®ƒè¿˜ä¼šæ ¡éªŒå¤„ç†åçš„ä»£ç ï¼Œä¸»è¦é’ˆå¯¹ Java 6 åŠä»¥ä¸Šç‰ˆæœ¬å’Œ Java ME èµ„æºå‹ç¼©Android ä¸­ï¼Œç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬æä¾›äº†å¦å¤–ä¸€é¡¹å¼ºå¤§çš„åŠŸèƒ½ï¼šèµ„æºçš„å‹ç¼©ã€‚èµ„æºå‹ç¼©èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç§»é™¤é¡¹ç›®åŠä¾èµ–ä»“åº“ä¸­æœªä½¿ç”¨åˆ°çš„èµ„æºï¼Œæœ‰æ•ˆåœ°é™ä½äº†apkåŒ…çš„å¤§å°ã€‚ç”±äºèµ„æºå‹ç¼©ä¸ä»£ç æ··æ·†æ˜¯ååŒå·¥ä½œï¼Œæ‰€ä»¥ï¼Œå¦‚æœéœ€è¦å¼€å¯èµ„æºçš„å‹ç¼©ï¼Œåˆ‡è®°è¦å…ˆå¼€å¯ä»£ç æ··æ·†ï¼Œå¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š 12ERROR: Removing unused resources requires unused code shrinking to be turned on. See http://d.android.com/r/tools/shrink-resources.html for more information.Affected Modules: app è‡ªå®šä¹‰è¦ä¿ç•™çš„èµ„æºå½“æˆ‘ä»¬å¼€å¯äº†èµ„æºå‹ç¼©ä¹‹åï¼Œç³»ç»Ÿä¼šé»˜è®¤æ›¿æˆ‘ä»¬ç§»é™¤æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æºï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦ä¿ç•™æŸäº›ç‰¹å®šçš„èµ„æºï¼Œå¯ä»¥åœ¨æˆ‘ä»¬é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªè¢« &lt;resources&gt; æ ‡è®°çš„ XML æ–‡ä»¶ï¼ˆå¦‚ res/raw/keep.xmlï¼‰ï¼Œå¹¶åœ¨ tools:keep å±æ€§ä¸­æŒ‡å®šæ¯ä¸ªè¦ä¿ç•™çš„èµ„æºï¼Œåœ¨ tools:discard å±æ€§ä¸­æŒ‡å®šæ¯ä¸ªè¦èˆå¼ƒçš„èµ„æºã€‚è¿™ä¸¤ä¸ªå±æ€§éƒ½æ¥å—é€—å·åˆ†éš”çš„èµ„æºåç§°åˆ—è¡¨ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­—ç¬¦ * ä½œä¸ºé€šé…ç¬¦ã€‚å¦‚ï¼š 1234&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources xmlns:tools=\"http://schemas.android.com/tools\" tools:keep=\"@layout/activity_video*,@layout/dialog_update_v2\" tools:discard=\"@layout/unused_layout,@drawable/unused_selector\" /&gt; å¯ç”¨ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼æ­£å¸¸æƒ…å†µä¸‹ï¼Œèµ„æºå‹ç¼©å™¨å¯å‡†ç¡®åˆ¤å®šç³»ç»Ÿæ˜¯å¦ä½¿ç”¨äº†èµ„æºã€‚ä¸è¿‡ï¼Œå¦‚æœæ‚¨çš„ä»£ç ï¼ˆåŒ…å«åº“ï¼‰è°ƒç”¨ Resources.getIdentifier()ï¼Œè¿™å°±è¡¨ç¤ºæ‚¨çš„ä»£ç å°†æ ¹æ®åŠ¨æ€ç”Ÿæˆçš„å­—ç¬¦ä¸²æŸ¥è¯¢èµ„æºåç§°ã€‚è¿™æ—¶ï¼Œèµ„æºå‹ç¼©å™¨ä¼šé‡‡å–é˜²å¾¡æ€§è¡Œä¸ºï¼Œå°†æ‰€æœ‰å…·æœ‰åŒ¹é…åç§°æ ¼å¼çš„èµ„æºæ ‡è®°ä¸ºå¯èƒ½å·²ä½¿ç”¨ï¼Œæ— æ³•ç§»é™¤ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šä½¿æ‰€æœ‰å¸¦ img_ å‰ç¼€çš„èµ„æºæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼š 12String name = String.format(\"img_%1d\", angle + 1);res = getResources().getIdentifier(name, \"drawable\", getPackageName()); è¿™æ—¶ï¼Œæˆ‘å¯ä»¥å¼€å¯èµ„æºçš„ä¸¥æ ¼å®¡æŸ¥æ¨¡å¼ï¼Œåªä¼šä¿ç•™ç¡®å®šå·²ä½¿ç”¨çš„èµ„æºï¼š 123&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources xmlns:tools=\"http://schemas.android.com/tools\" tools:shrinkMode=\"strict\" /&gt; ç§»é™¤å¤‡ç”¨èµ„æºGradle èµ„æºå‹ç¼©å™¨åªä¼šç§»é™¤æœªè¢«åº”ç”¨å¼•ç”¨çš„èµ„æºï¼Œè¿™æ„å‘³ç€å®ƒä¸ä¼šç§»é™¤ç”¨äºä¸åŒè®¾å¤‡é…ç½®çš„å¤‡ç”¨èµ„æºã€‚å¿…è¦æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Android Gradle æ’ä»¶çš„ resConfigs å±æ€§æ¥ç§»é™¤æ‚¨çš„åº”ç”¨ä¸éœ€è¦çš„å¤‡ç”¨èµ„æºæ–‡ä»¶ï¼ˆå¸¸è§çš„æœ‰ç”¨äºå›½é™…åŒ–æ”¯æŒçš„ strings.xmlï¼Œé€‚é…ç”¨çš„ layout.xml ç­‰ï¼‰ï¼š 1234567android { defaultConfig { ... //ä¿ç•™ä¸­æ–‡å’Œè‹±æ–‡å›½é™…åŒ–æ”¯æŒ resConfigs \"en\", \"zh\" }} è‡ªå®šä¹‰æ··æ·†è§„åˆ™å“å°å®Œäº†ä»¥ä¸Šâ€é…èœâ€ï¼Œä¸‹é¢è®©æˆ‘ä»¬æ¥å“å‘³ä¸€ä¸‹æœ¬æ–‡çš„â€ä¸»èœâ€ï¼šè‡ªå®šä¹‰æ··æ·†è§„åˆ™ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å¸¸è§çš„æ··æ·†å‘½ä»¤ã€‚ keep å‘½ä»¤è¿™é‡Œè¯´çš„ keep å‘½ä»¤æŒ‡çš„æ˜¯ä¸€ç³»åˆ—ä»¥ -keep å¼€å¤´çš„å‘½ä»¤ï¼Œå®ƒä¸»è¦ç”¨æ¥ä¿ç•™ Java ä¸­ä¸éœ€è¦è¿›è¡Œæ··æ·†çš„å…ƒç´ ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„ -keep å‘½ä»¤ï¼š -keep ä½œç”¨ï¼šä¿ç•™æŒ‡å®šçš„ç±»å’Œæˆå‘˜ï¼Œé˜²æ­¢è¢«æ··æ·†å¤„ç†ã€‚ä¾‹å¦‚ï¼š 12345# ä¿ç•™åŒ…ï¼šcom.moos.media.entity ä¸‹é¢çš„ç±»ä»¥åŠç±»æˆå‘˜-keep public class com.moos.media.entity.**# ä¿ç•™ç±»ï¼šNumberProgressBar-keep public class com.moos.media.widget.NumberProgressBar {*;} -keepclassmembers ä½œç”¨ï¼šä¿ç•™æŒ‡å®šçš„ç±»çš„æˆå‘˜ï¼ˆå˜é‡/æ–¹æ³•ï¼‰ï¼Œå®ƒä»¬å°†ä¸ä¼šè¢«æ··æ·†ã€‚å¦‚ï¼š 12345# ä¿ç•™ç±»çš„æˆå‘˜ï¼šMediaUtilsç±»ä¸­çš„ç‰¹å®šæˆå‘˜æ–¹æ³•-keepclassmembers class com.moos.media.MediaUtils { public static *** getLocalVideos(android.content.Context); public static *** getLocalPictures(android.content.Context);} -keepclasseswithmembers ä½œç”¨ï¼šä¿ç•™æŒ‡å®šçš„ç±»å’Œå…¶æˆå‘˜ï¼ˆå˜é‡/æ–¹æ³•ï¼‰ï¼Œå‰ææ˜¯å®ƒä»¬åœ¨å‹ç¼©é˜¶æ®µæ²¡æœ‰è¢«åˆ é™¤ã€‚ä¸-keep ä½¿ç”¨æ–¹å¼ç±»ä¼¼ï¼š 12345# ä¿ç•™ç±»ï¼šBaseMediaEntity çš„å­ç±»-keepclasseswithmembers public class * extends com.moos.media.entity.BaseMediaEntity{*;}# ä¿ç•™ç±»ï¼šOnProgressBarListeneræ¥å£çš„å®ç°ç±»-keep public class * implements com.moos.media.widget.OnProgressBarListener {*;} @Keep é™¤äº†ä»¥ä¸Šæ–¹å¼ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ @Keep æ³¨è§£æ¥ä¿ç•™æœŸæœ›ä»£ç ï¼Œé˜²æ­¢å®ƒä»¬è¢«æ··æ·†å¤„ç†ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬é€šè¿‡ @Keep ä¿®é¥°ä¸€ä¸ªç±»æ¥ä¿ç•™å®ƒä¸è¢«æ··æ·†ï¼š 123456@Keepdata class CloudMusicBean(var createDate: String, var id: Long, var name: String, var url: String, val imgUrl: String) åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®© @Keep æ¥ä¿®é¥°æ–¹æ³•æˆ–è€…å­—æ®µè¿›è€Œä¿ç•™å®ƒä»¬ã€‚ å…¶ä»–å‘½ä»¤ dontwarn -dontwarn å‘½ä»¤ä¸€èˆ¬åœ¨æˆ‘ä»¬å¼•å…¥æ–°çš„ library æ—¶ä¼šä½¿ç”¨åˆ°ï¼Œå¸¸ç”¨äºå¤„ç† library ä¸­æ— æ³•è§£å†³çš„è­¦å‘Šã€‚å¦‚ï¼š 123-keep class twitter4j.** { *; }-dontwarn twitter4j.** å…¶ä»–çš„å‘½ä»¤ç”¨æ³•å¯å‚è€ƒ Android ç³»ç»Ÿæä¾›çš„é»˜è®¤æ··æ·†è§„åˆ™ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#æ··æ·†æ—¶ä¸ç”Ÿæˆå¤§å°å†™æ··åˆçš„ç±»å-dontusemixedcaseclassnames#ä¸è·³è¿‡éå…¬å…±çš„åº“çš„ç±»-dontskipnonpubliclibraryclasses#æ··æ·†è¿‡ç¨‹ä¸­è®°å½•æ—¥å¿—-verbose#å…³é—­é¢„æ ¡éªŒ-dontpreverify#å…³é—­ä¼˜åŒ–-dontoptimize#ä¿ç•™æ³¨è§£-keepattributes *Annotation*#ä¿ç•™æ‰€æœ‰æ‹¥æœ‰æœ¬åœ°æ–¹æ³•çš„ç±»ååŠæœ¬åœ°æ–¹æ³•å-keepclasseswithmembernames class * { native &lt;methods&gt;;}#ä¿ç•™è‡ªå®šä¹‰Viewçš„getå’Œsetæ–¹æ³•-keepclassmembers public class * extends android.view.View { void set*(***); *** get*();}#ä¿ç•™Activityä¸­ViewåŠå…¶å­ç±»å…¥å‚çš„æ–¹æ³•ï¼Œå¦‚: onClick(android.view.View)-keepclassmembers class * extends android.app.Activity { public void *(android.view.View);}#ä¿ç•™æšä¸¾-keepclassmembers enum * { **[] $VALUES; public *;}#ä¿ç•™åºåˆ—åŒ–çš„ç±»-keepclassmembers class * implements android.os.Parcelable { public static final android.os.Parcelable$Creator CREATOR;}#ä¿ç•™Ræ–‡ä»¶çš„é™æ€æˆå‘˜-keepclassmembers class **.R$* { public static &lt;fields&gt;;}-dontwarn android.support.**-keep class android.support.annotation.Keep-keep @android.support.annotation.Keep class * {*;}-keepclasseswithmembers class * { @android.support.annotation.Keep &lt;methods&gt;;}-keepclasseswithmembers class * { @android.support.annotation.Keep &lt;fields&gt;;}-keepclasseswithmembers class * { @android.support.annotation.Keep &lt;init&gt;(...);} æ›´å¤šæ··æ·†å‘½ä»¤å¯ä»¥å‚è€ƒæ–‡ç« ï¼šProguard æœ€å…¨æ··æ·†è§„åˆ™è¯´æ˜ ï¼Œè¿™é‡Œå°±ä¸åšè¯¦ç»†è®²è§£äº†ã€‚ æ··æ·†â€é»‘åå•â€æˆ‘ä»¬åœ¨äº†è§£äº†æ··æ·†çš„åŸºæœ¬å‘½ä»¤ä¹‹åï¼Œå¾ˆå¤šäººåº”è¯¥è¿˜æ˜¯ä¸€å¤´é›¾æ°´ï¼šåˆ°åº•å“ªäº›å†…å®¹è¯¥æ··æ·†ï¼Ÿå…¶å®ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ä»£ç æ··æ·†æ—¶ï¼ŒProGuard å¯¹æˆ‘ä»¬é¡¹ç›®ä¸­å¤§éƒ¨åˆ†ä»£ç è¿›è¡Œäº†æ··æ·†æ“ä½œï¼Œä¸ºäº†é˜²æ­¢ç¼–è¯‘æ—¶å‡ºé”™ï¼Œæˆ‘ä»¬åº”è¯¥é€šè¿‡ keep å‘½ä»¤ä¿ç•™ä¸€äº›å…ƒç´ ä¸è¢«æ··æ·†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å“ªäº›å…ƒç´ ä¸åº”è¯¥è¢«æ··æ·†ï¼š æšä¸¾é¡¹ç›®ä¸­éš¾å…å¯èƒ½ä¼šç”¨åˆ°æšä¸¾ç±»å‹ï¼Œç„¶è€Œå®ƒä¸èƒ½å‚ä¸åˆ°æ··æ·†å½“ä¸­å»ã€‚åŸå› æ˜¯ï¼šæšä¸¾ç±»å†…éƒ¨å­˜åœ¨ values æ–¹æ³•ï¼Œæ··æ·†åè¯¥æ–¹æ³•ä¼šè¢«é‡æ–°å‘½åï¼Œå¹¶æŠ›å‡º NoSuchMethodExceptionã€‚åº†å¹¸çš„æ˜¯ï¼ŒAndroid ç³»ç»Ÿé»˜è®¤çš„æ··æ·†è§„åˆ™ä¸­å·²ç»æ·»åŠ äº†å¯¹äºæšä¸¾ç±»çš„å¤„ç†ï¼Œæˆ‘ä»¬æ— éœ€å†å»åšé¢å¤–å·¥ä½œã€‚æƒ³äº†è§£æ›´å¤šæšä¸¾å†…éƒ¨ç»†èŠ‚å¯ä»¥å»æŸ¥çœ‹æºç ï¼Œç¯‡å¹…æœ‰é™ä¸å†ç»†è¯´ã€‚ è¢«åå°„çš„å…ƒç´ è¢«åå°„ä½¿ç”¨çš„ç±»ã€å˜é‡ã€æ–¹æ³•ã€åŒ…åç­‰ä¸åº”è¯¥è¢«æ··æ·†å¤„ç†ã€‚åŸå› åœ¨äºï¼šä»£ç æ··æ·†è¿‡ç¨‹ä¸­ï¼Œè¢«åå°„ä½¿ç”¨çš„å…ƒç´ ä¼šè¢«é‡å‘½åï¼Œç„¶è€Œåå°„ä¾æ—§æ˜¯æŒ‰ç…§å…ˆå‰çš„åç§°å»å¯»æ‰¾å…ƒç´ ï¼Œæ‰€ä»¥ä¼šç»å¸¸å‘ç”Ÿ NoSuchMethodException å’Œ NoSuchFiledException é—®é¢˜ã€‚ å®ä½“ç±»å®ä½“ç±»å³æˆ‘ä»¬å¸¸è¯´çš„â€æ•°æ®ç±»â€ï¼Œå½“ç„¶ç»å¸¸ä¼´éšç€åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ“ä½œã€‚å¾ˆå¤šäººä¹Ÿåº”è¯¥éƒ½æƒ³åˆ°äº†ï¼Œæ··æ·†æ˜¯å°†åŸæœ¬æœ‰ç‰¹å®šå«ä¹‰çš„â€å…ƒç´ â€è½¬å˜ä¸ºæ— æ„ä¹‰çš„åç§°ï¼Œæ‰€ä»¥ï¼Œç»è¿‡æ··æ·†çš„â€æ´—ç¤¼â€ä¹‹åï¼Œåºåˆ—åŒ–ä¹‹åçš„ value å¯¹åº”çš„ key å·²ç„¶å˜ä¸ºæ²¡æœ‰æ„ä¹‰çš„å­—æ®µï¼Œè¿™è‚¯å®šæ˜¯æˆ‘ä»¬ä¸å¸Œæœ›çš„ã€‚åŒæ—¶ï¼Œååºåˆ—åŒ–çš„è¿‡ç¨‹åˆ›å»ºå¯¹è±¡ä»æ ¹æœ¬ä¸Šæ¥è¯´è¿˜æ˜¯å€ŸåŠ©äºåå°„ï¼Œæ··æ·†ä¹‹å key ä¼šè¢«æ”¹å˜ï¼Œæ‰€ä»¥ä¹Ÿä¼šè¿èƒŒæˆ‘ä»¬é¢„æœŸçš„æ•ˆæœã€‚ å››å¤§ç»„ä»¶Android ä¸­çš„å››å¤§ç»„ä»¶åŒæ ·ä¸åº”è¯¥è¢«æ··æ·†ã€‚åŸå› åœ¨äºï¼š å››å¤§ç»„ä»¶ä½¿ç”¨å‰éƒ½éœ€è¦åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­è¿›è¡Œæ³¨å†Œå£°æ˜ï¼Œç„¶è€Œæ··æ·†å¤„ç†ä¹‹åï¼Œå››å¤§ç»„ä»¶çš„ç±»åå°±ä¼šè¢«ç¯¡æ”¹ï¼Œå®é™…ä½¿ç”¨çš„ç±»ä¸ manifest ä¸­æ³¨å†Œçš„ç±»å¹¶ä¸åŒ¹é…ï¼Œæ•…è€Œå‡ºé”™ã€‚ å…¶ä»–åº”ç”¨ç¨‹åºè®¿é—®ç»„ä»¶æ—¶å¯èƒ½ä¼šç”¨åˆ°ç±»çš„åŒ…ååŠ ç±»åï¼Œå¦‚æœç»è¿‡æ··æ·†ï¼Œå¯èƒ½ä¼šæ— æ³•æ‰¾åˆ°å¯¹åº”ç»„ä»¶æˆ–è€…äº§ç”Ÿå¼‚å¸¸ã€‚ JNI è°ƒç”¨çš„Java æ–¹æ³•å½“ JNI è°ƒç”¨çš„ Java æ–¹æ³•è¢«æ··æ·†åï¼Œæ–¹æ³•åä¼šå˜æˆæ— æ„ä¹‰çš„åç§°ï¼Œè¿™å°±ä¸ C++ ä¸­åŸæœ¬çš„ Java æ–¹æ³•åä¸åŒ¹é…ï¼Œå› è€Œä¼šæ— æ³•æ‰¾åˆ°æ‰€è°ƒç”¨çš„æ–¹æ³•ã€‚ å…¶ä»–ä¸åº”è¯¥è¢«æ··æ·†çš„ è‡ªå®šä¹‰æ§ä»¶ä¸éœ€è¦è¢«æ··æ·† JavaScript è°ƒç”¨ Java çš„æ–¹æ³•ä¸åº”æ··æ·† Java çš„ native æ–¹æ³•ä¸åº”è¯¥è¢«æ··æ·† é¡¹ç›®ä¸­å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åº“ä¹Ÿä¸å»ºè®®æ··æ·† æ··æ·†åçš„å †æ ˆè·Ÿè¸ªä»£ç ç»è¿‡ ProGuard æ··æ·†å¤„ç†åï¼Œæƒ³è¦è¯»å– StackTraceï¼ˆå †æ ˆè¿½è¸ªï¼‰ä¿¡æ¯å°±ä¼šå˜å¾—å¾ˆå›°éš¾ã€‚ç”±äºæ–¹æ³•åç§°å’Œç±»çš„åç§°éƒ½ç»è¿‡æ··æ·†å¤„ç†ï¼Œå³ä½¿ç¨‹åºå‘ç”Ÿå´©æºƒé—®é¢˜ï¼Œä¹Ÿå¾ˆéš¾å®šä½é—®é¢˜æ‰€åœ¨ã€‚å¹¸è¿çš„æ˜¯ï¼ŒProGuard ä¸ºæˆ‘ä»¬æä¾›äº†è¡¥æ•‘çš„æªæ–½ï¼Œåœ¨ç€æ‰‹è¿›è¡Œä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ ProGuard æ¯æ¬¡æ„å»ºåç”Ÿæˆäº†å“ªäº›å†…å®¹ã€‚ æ··æ·†è¾“å‡ºç»“æœæ··æ·†æ„å»ºå®Œæˆä¹‹åï¼Œä¼šåœ¨ &lt;module-name&gt;/build/outputs/mapping/release/ ç›®å½•ä¸‹ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š dump.txt è¯´æ˜ APK å†…æ‰€æœ‰ç±»æ–‡ä»¶çš„å†…éƒ¨ç»“æ„ã€‚ mapping.txt æä¾›æ··æ·†å‰åçš„å†…å®¹å¯¹ç…§è¡¨ï¼Œå†…å®¹ä¸»è¦åŒ…å«ç±»ã€æ–¹æ³•å’Œç±»çš„æˆå‘˜å˜é‡ã€‚ seeds.txt ç½—åˆ—å‡ºæœªè¿›è¡Œæ··æ·†å¤„ç†çš„ç±»å’Œæˆå‘˜ã€‚ usage.txt ç½—åˆ—å‡ºä» APK ä¸­ç§»é™¤çš„ä»£ç ã€‚ æ¢å¤å †æ ˆè·Ÿè¸ªäº†è§£å®Œæ··æ·†æ„å»ºå®Œæ¯•åè¾“å‡ºçš„å†…å®¹ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å°±æ¥çœ‹ä¸€ä¸‹ä¹‹å‰çš„é—®é¢˜ï¼šæ··æ·†å¤„ç†åï¼ŒStackTrace å®šä½å›°éš¾ã€‚å¦‚ä½•æ¥æ¢å¤ StackTrace çš„å®šä½èƒ½åŠ›å‘¢ï¼Ÿç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›äº† retrace å·¥å…·ï¼Œç»“åˆä¸Šæ–‡æåˆ°çš„ mapping.txt æ–‡ä»¶ï¼Œå°±å¯ä»¥å°†æ··æ·†åçš„å´©æºƒå †æ ˆè¿½è¸ªä¿¡æ¯è¿˜åŸæˆæ­£å¸¸æƒ…å†µä¸‹çš„ StackTrace ä¿¡æ¯ã€‚ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼æ¥æ¢å¤ StackTraceï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬ä»¥ä¸‹é¢è¿™æ®µå´©æºƒä¿¡æ¯ä¸ºä¾‹ï¼Œå€ŸåŠ©ä¸¤ç§æ–¹å¼åˆ†åˆ«æ¥è¿˜åŸï¼š 123456java.lang.RuntimeException: Unable to start activity Caused by: kotlin.KotlinNullPointerException at com.moos.media.ui.ImageSelectActivity.k(ImageSelectActivity.kt:71) at com.moos.media.ui.ImageSelectActivity.onCreate(ImageSelectActivity.kt:58) at android.app.Activity.performCreate(Activity.java:6237) at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1107) é€šè¿‡ retrace è„šæœ¬å·¥å…· é¦–å…ˆæˆ‘ä»¬è¦è¿›å…¥åˆ° Android SDK è·¯å¾„çš„ /tools/proguard/bin ç›®å½•ä¸­ï¼Œè¿™é‡Œä»¥ Mac ç³»ç»Ÿä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š å¯ä»¥çœ‹åˆ°å¦‚ä¸Šä¸‰ä¸ªæ–‡ä»¶ï¼Œè€Œ proguardgui.sh æ‰æ˜¯æˆ‘ä»¬éœ€è¦çš„ retrace è„šæœ¬ï¼ˆWindowsç³»ç»Ÿä¸‹ä¸º proguardgui.bat ï¼‰ã€‚Windows ç³»ç»Ÿä¸­åªéœ€è¦åŒå‡»è„šæœ¬ proguardgui.bat å³å¯è¿è¡Œï¼Œè‡³äº Mac ç³»ç»Ÿï¼Œå¦‚æœä½ æ²¡æœ‰åšä»»ä½•é…ç½®ï¼Œåªéœ€è¦å°† proguardgui.sh è„šæœ¬æ‹–åŠ¨åˆ° Mac è‡ªå¸¦çš„ç»ˆç«¯ä¸­ï¼Œå›è½¦é”®å³å¯è¿è¡Œã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š é€‰æ‹© ReTrace æ  ï¼Œå¹¶æ·»åŠ æˆ‘ä»¬é¡¹ç›®ä¸­æ··æ·†ç”Ÿæˆçš„ mapping.txt æ–‡ä»¶æ‰€åœ¨ä½ç½®ï¼Œç„¶åå°†æˆ‘ä»¬çš„æ··æ·†åçš„å´©æºƒä¿¡æ¯å¤åˆ¶åˆ° Obfuscated stack trace é‚£ä¸€æ ï¼Œç‚¹å‡» ReTrace! æŒ‰é’®å³å¯è¿˜åŸå‡ºæˆ‘ä»¬çš„å´©æºƒæ—¥å¿—ä¿¡æ¯ï¼Œç»“æœå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¹‹å‰çš„æ··æ·†æ—¥å¿—ï¼šat com.moos.media.ui.ImageSelectActivity.k(ImageSelectActivity.kt:71) è¢«è¿˜åŸæˆäº† **at com.moos.media.ui.ImageSelectActivity.initView(ImageSelectActivity.kt:71)**ã€‚ImageSelectActivity.k æ˜¯æˆ‘ä»¬æ··æ·†åçš„æ–¹æ³•åï¼ŒImageSelectActivity.initView åˆ™æ˜¯æœ€åˆæœªæ··æ·†å‰çš„æ–¹æ³•åï¼Œå€ŸåŠ©äº ReTrace å·¥å…·çš„å¸®åŠ©ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä»¥å‰ä¸€æ ·å¾ˆå¿«å®šä½åˆ°å´©æºƒä»£ç åŒºåŸŸäº†ã€‚ é€šè¿‡ retrace å‘½ä»¤è¡Œ æˆ‘ä»¬å…ˆè¦å°†å´©æºƒä¿¡æ¯å¤åˆ¶åˆ° txt æ ¼å¼çš„æ–‡ä»¶ï¼ˆå¦‚ï¼šproguard_stacktrace.txtï¼‰ä¸­ä¿å­˜ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼ˆMACç³»ç»Ÿï¼‰ï¼š 1retrace.sh -verbose mapping.txt proguard_stacktrace.txt å¦‚æœä½ æ˜¯ windows ç³»ç»Ÿï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1retrace.bat -verbose mapping.txt proguard_stacktrace.txt æœ€ç»ˆè¿˜åŸçš„ç»“æœå’Œä¹‹å‰æ•ˆæœä¸€æ ·ï¼š ä¹Ÿè®¸ä½ é€šè¿‡ä»¥ä¸Šä¸¤ç§æ–¹å¼åœ¨å¯¹ stackTrace è¿›è¡Œæ¢å¤æ—¶ï¼Œå‘ç° Unknown Source é—®é¢˜ï¼š å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè®°å¾—åœ¨æ··æ·†è§„åˆ™ä¸­åŠ ä¸Šå¦‚ä¸‹é…ç½®æ¥æå‡æˆ‘ä»¬çš„ StackSource æŸ¥æ‰¾æ•ˆç‡ï¼š 12# ä¿ç•™æºæ–‡ä»¶åå’Œå…·ä½“ä»£ç è¡Œå·-keepattributes SourceFile,LineNumberTable æ­¤å¤–ï¼Œæˆ‘ä»¬æ¯æ¬¡ä½¿ç”¨ ProGuard åˆ›å»ºå‘å¸ƒæ„å»ºæ—¶éƒ½éƒ½ä¼šè¦†ç›–ä¹‹å‰ç‰ˆæœ¬çš„ mapping.txt æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬æ¯æ¬¡å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶éƒ½å¿…é¡»å°å¿ƒåœ°ä¿å­˜ä¸€ä¸ªå‰¯æœ¬ã€‚é€šè¿‡ä¸ºæ¯ä¸ªå‘å¸ƒæ„å»ºä¿ç•™ä¸€ä¸ª mapping.txt æ–‡ä»¶å‰¯æœ¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç”¨æˆ·æäº¤çš„å·²æ··æ·†çš„ StackTrace æ¥å¯¹æ—§ç‰ˆæœ¬åº”ç”¨çš„é—®é¢˜è¿›è¡Œè°ƒè¯•å’Œä¿®å¤ã€‚ æ¶¨å§¿åŠ¿çš„æ“ä½œç»è¿‡ä¸Šæ–‡çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒAPK åœ¨ç»è¿‡ä»£ç æ··æ·†å¤„ç†åï¼ŒåŒ…åã€ç±»åã€æˆå‘˜åè¢«è½¬åŒ–ä¸ºæ— æ„ä¹‰ã€éš¾ä»¥ç†è§£çš„åç§°ï¼Œå¢åŠ åç¼–è¯‘çš„æˆæœ¬ã€‚Android ProGuard ä¸ºæˆ‘ä»¬æä¾›äº†é»˜è®¤çš„â€æ··æ·†å­—å…¸â€ï¼Œå³å°†å…ƒç´ åç§°è½¬ä¸ºè‹±æ–‡å°å†™å­—æ¯çš„å½¢å¼ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„æ··æ·†å­—å…¸å—ï¼Ÿå–ä¸ªå…³å­ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ æ•ˆæœå›¾ï¼š è¿™ä¸ªæ³¢æ“ä½œæ˜¯ä¸æ˜¯æœ‰ç‚¹â€å‡ºç±»æ‹”èƒâ€äº†ï¼Ÿå“ˆå“ˆï¼Œå°±ä¸å–å…³å­äº†ï¼Œå…¶å®å¾ˆç®€å•ï¼Œåªè¦ç”Ÿæˆä¸€å¥—è‡ªå·±çš„ txt æ ¼å¼çš„æ··æ·†å­—å…¸ï¼Œç„¶ååœ¨æ··æ·†è§„åˆ™ Proguard-rules.pro ä¸­åº”ç”¨ä¸€ä¸‹å³å¯ï¼š æœ¬æ–‡ä¸­ä½¿ç”¨çš„æ··æ·†å­—å…¸å¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹å¹¶ä¸‹è½½ï¼šproguard_tradition.txt å½“ç„¶ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥è‡ªå·±å»å®šåˆ¶åŒ–è‡ªå·±çš„â€æ··æ·†å­—å…¸â€ï¼Œå¢åŠ åç¼–è¯‘çš„éš¾åº¦ã€‚ ä¸€è·¯èµ°ä¸‹æ¥ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä»æ··æ·†æŠ€æœ¯çš„å¿…è¦æ€§å’Œä¼˜ç‚¹æ¥çœ‹ï¼Œå®ƒè¿˜æ˜¯å¾ˆå€¼å¾—æˆ‘ä»¬å»æ·±å…¥å­¦ä¹ å’Œç ”ç©¶çš„ï¼Œæœ¬æ–‡å¸¦å¤§å®¶é¢†ç•¥çš„ä»…ä»…æ˜¯â€å†°å±±ä¸€è§’â€ã€‚ç”±äºæœ¬äººçš„æŠ€æœ¯æ°´å¹³æœ‰é™ï¼Œè‹¥å¤§å®¶å‘ç°æœ‰é—®é¢˜æˆ–è€…é˜è¿°ä¸å½“ä¹‹å¤„ï¼Œæ¬¢è¿æŒ‡å‡ºå¹¶ä¿®æ­£ã€‚ ç›¸å…³å‚è€ƒ Shrink your app è¯»æ‡‚Androidä¸­çš„ä»£ç æ··æ·† Practical ProGuard rules example Android ProGuard ä»£ç æ··æ·†é‚£äº›äº‹å„¿ Proguard æœ€å…¨æ··æ·†è§„åˆ™è¯´æ˜","link":"/2020/06/29/android-proguard/"},{"title":"AndroidåŸºäºé«˜å¾·åœ°å›¾å®ç°Markerèšåˆæ•ˆæœ","text":"æœ€è¿‘,é¡¹ç›®æœ‰äº†æ–°çš„éœ€æ±‚,è¦æ±‚åœ°å›¾ä¸Šçš„æ ‡ç­¾ç‚¹å®ç°èšåˆæ•ˆæœ,å•çº¯çš„markerå·²ç»æ— æ³•æ»¡è¶³å¤§é‡æ•°æ®å±•ç¤ºçš„æƒ…å†µ,èšåˆæ•ˆæœæˆä¸ºå¤§åŠ¿æ‰€è¶‹ã€‚ ç›®å‰,ç½‘ä¸Šæä¾›åŸºäºé«˜å¾·markerèšåˆçš„æ€è·¯å¤§è‡´å·®ä¸å¤š,å¤„äºé›å½¢é˜¶æ®µã€‚é«˜å¾·å®˜æ–¹ä¹Ÿæä¾›äº†å…³äºèšåˆçš„è§£å†³æ–¹æ¡ˆ,å¯¹äºç¼“å­˜å’ŒåŠ è½½æ•ˆç‡éƒ½åšäº†ä¸€äº›å¤„ç†,ä¸ºæˆ‘ä»¬åé¢çš„å®šåˆ¶å¥ å®šäº†åŸºç¡€,æœ¬æ–‡å°±åœ¨é«˜å¾·å®˜æ–¹æä¾›çš„æ–¹æ¡ˆåŸºç¡€ä¸Šåšä¸€äº›å®šåˆ¶åŒ–ã€‚ç¬”è€…ç»è¿‡æ€è€ƒå,è¿˜æ˜¯è§‰å¾—å°†ç¯‡å¹…åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†,å‰ç¯‡ä¸»è¦æ¶‰åŠèšåˆçš„åŸºæœ¬ä½¿ç”¨ä»¥åŠé’ˆå¯¹å®šåˆ¶è¿‡ç¨‹ä¸­å‡ºç°çš„å‘è¿›è¡Œå¡«è¡¥(å¦‚å¤šç§èšåˆæ ‡ç­¾çš„å†²çª,èšåˆæ ‡ç­¾ä¸æ™®é€šæ ‡ç­¾çš„å†²çªé—®é¢˜ç­‰),ä¸‹ç¯‡åˆ™è®²è¿°å¦‚ä½•å®šåˆ¶åŒ–markerå¹¶åŠ è½½ç½‘ç»œå›¾ç‰‡(ä¸ºäº†æ–¹ä¾¿æè¿°,markerèšåˆåœ¨ä¸‹æ–‡éƒ½ç§°ä¹‹ä¸ºèšåˆæ ‡ç­¾)ã€‚çœ‹å®Œä¸¤ç¯‡æ–‡ç« ,å¤§å®¶è¿˜å¯ä»¥å°è¯•å°†èšåˆå’Œç½‘ç»œå›¾ç‰‡æ ·å¼çš„markerç»“åˆèµ·æ¥,è¾¾åˆ°æ›´åŠ ç‚«é…·çš„æ•ˆæœã€‚è¯ä¸å¤šè¯´,å…ˆæ¥çœ‹çœ‹æœ€ç»ˆçš„æ•ˆæœå§: å…ˆæ¥æ”¾ä¸€ä¸‹å®˜ç½‘æä¾›çš„èšåˆç‚¹çš„demo:https://github.com/amap-demo/android-cluster-marker,å¦‚æœåªæ˜¯å®ç°ä¸€ç§èšåˆç‚¹,å¯ä»¥å¤åˆ¶å®˜æ–¹çš„demoä»£ç ,ç¨å¾®æ”¹æ”¹å°±å¯ä»¥ç”¨äº†ã€‚å¦‚æœä½ ä»¬äº§å“æœ‰å…¶ä»–éœ€æ±‚,æ¯”å¦‚å¤šç§èšåˆæ ‡ç­¾ç‚¹,æˆ–è€…å®ç°æ™®é€šæ ‡ç­¾å’Œèšåˆæ ‡ç­¾çš„æ··æ’ä½¿ç”¨,é‚£ä¹ˆå¯ä»¥å‚è€ƒä¸‹æœ¬æ–‡æä¾›çš„æ”¹è¿›æ€è·¯ã€‚ å‘ç°é—®é¢˜: é¦–å…ˆ,æˆ‘ä»¬å‘ç°é«˜å¾·å®˜æ–¹æä¾›çš„demoå­˜åœ¨çš„é—®é¢˜: å½“å­˜åœ¨å¤šç§ç±»å‹èšåˆæ ‡ç­¾ç‚¹æ—¶,èšåˆç‚¹çš„ç‚¹å‡»äº‹ä»¶å†²çªé—®é¢˜. è¿™ä¸ªé—®é¢˜æ˜¯ä»€ä¹ˆæ„æ€å‘¢?ä¸¾ä¸ªä¾‹å­:å½“åœ°å›¾ä¸Šæˆ‘ä»¬å…ˆååˆå§‹åŒ–ä¸¤ç§èšåˆæ ‡ç­¾ç‚¹Aå’ŒBçš„æ—¶å€™,ä¸ç®¡ç‚¹å‡»Aè¿˜æ˜¯Bç±»å‹çš„èšåˆç‚¹,éƒ½ä¼šåªå“åº”Bç±»çš„ç‚¹å‡»äº‹ä»¶,å³å…ˆå£°æ˜çš„èšåˆæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶ä¼šè¢«åå£°æ˜çš„èšåˆæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶â€æŠ¢å â€. å½“åœ°å›¾ä¸Šå­˜åœ¨æ™®é€šæ ‡ç­¾(Marker)å’Œèšåˆæ ‡ç­¾(Cluster)æ—¶,åŒæ ·ä¼šäº§ç”Ÿç‚¹å‡»äº‹ä»¶çš„å†²çªé—®é¢˜. è¿™ä¸ªæ„æ€å°±æ˜¯,ç‚¹å‡»èšåˆæ ‡ç­¾ä»ç„¶ä¼šå“åº”æ™®é€šæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶. åˆ†æé—®é¢˜: è¿™ä¸¤ä¸ªé—®é¢˜å…¶å®å½’æ ¹ç»“åº•æ˜¯ä¸€ä¸ªé—®é¢˜,éƒ½æ˜¯å› ä¸ºmarkerçš„ç‚¹å‡»äº‹ä»¶è¢«æŠ¢å ,ä»å®˜æ–¹çš„æä¾›çš„ClusterOverlayç±»ä¸­ä»£ç æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥: 1234567891011121314151617......amap.setOnCameraChangeListener(this);amap.setOnMarkerClickListener(this);...... //ç‚¹å‡»äº‹ä»¶ @Override public boolean onMarkerClick(Marker arg0) { if (mClusterClickListener == null) { return true; } Cluster cluster= (Cluster) arg0.getObject(); if(cluster!=null){ mClusterClickListener.onClick(arg0,cluster.getClusterItems()); return true; } return false; } &emsp;&emsp;ä»ä»¥ä¸Šä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥,èšåˆå¤„ç†ç±»ClusterOverlayå®ç°äº†AMap.OnMarkerClickListeneræ¥å£,è€Œå½“æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šæ ·å¼çš„èšåˆæ ‡ç­¾æ—¶,æˆ‘ä»¬å°±ä¼šå‘ç°æ˜æ˜æ˜¯ä¸¤ç§ç±»å‹çš„èšåˆæ ‡ç­¾,ä½†æ˜¯å´è§¦å‘ç›¸åŒçš„ç‚¹å‡»äº‹ä»¶ã€‚è¿™æ ·æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬é¢„æœŸéœ€æ±‚çš„,é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•è®©ä¸åŒæ ·å¼çš„èšåˆæ ‡ç­¾A,B,Câ€¦å„å¸å…¶èŒå‘¢?ä½ è‚¯å®šä¼šè¯´,åºŸè¯,ä¸ç„¶ä½ ç°åœ¨åœ¨è®²å•¥!å’³å’³,è¯·å…è®¸æˆ‘é™é™~ è§£å†³é—®é¢˜: &emsp;&emsp;æ˜¾ç„¶,å¦‚æœæˆ‘ä»¬æƒ³è®©å„ç§èšåˆæ ‡ç­¾äº’ä¸å¹²æ‰°,éœ€è¦é›†ä¸­ç®¡ç†å®ƒä»¬çš„ç‚¹å‡»äº‹ä»¶,å³OnMarkerClickListenerã€‚å‡è®¾æˆ‘ä»¬å†™äº†ä¸¤ä¸ªä¸åŒçš„èšåˆæ ‡ç­¾ç±»ClusterOverlayAå’ŒClusterOverlayB,æˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªç±»ä¸­OnMarkerClick()æ–¹æ³•ä¸­çš„é€»è¾‘æ‹¿å‡ºæ¥,å•ç‹¬å°è£…æˆä¸€ä¸ªæ–¹æ³•,ç„¶åæ”¾åœ¨æˆ‘ä»¬Activityçš„onMarkerClick()ä¸­æ‰§è¡Œ.è¿™é‡Œæˆ‘è´´ä¸€ä¸‹ä¿®æ”¹åçš„ClusterOverlayç±»,å‰æ–¹é«˜èƒ½,ä¸€å¤§æ³¢ä»£ç æ¥è¢­: ClusterOverlay: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492/** * Created by yiyi.qi on 16/10/10. * æ•´ä½“è®¾è®¡é‡‡ç”¨äº†ä¸¤ä¸ªçº¿ç¨‹,ä¸€ä¸ªçº¿ç¨‹ç”¨äºè®¡ç®—ç»„ç»‡èšåˆæ•°æ®,ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£å¤„ç†Markerç›¸å…³æ“ä½œ */public class ClusterOverlay { private AMap mAMap; private Context mContext; private List&lt;ClusterItem&gt; mClusterItems; private List&lt;Cluster&gt; mClusters; private int mClusterSize; private ClusterClickListener mClusterClickListener; private ClusterRender mClusterRender; private ClusterRenderB bClusterRender; private AMap.OnMarkerClickListener markerClickListener=new AMap.OnMarkerClickListener() { @Override public boolean onMarkerClick(Marker arg0) { if (mClusterClickListener == null) { return true; } Cluster cluster = (Cluster) arg0.getObject(); //å°†markerçš„ä½ç½®ç§»åŠ¨åˆ°åœ°å›¾ä¸­å¿ƒ LatLng latLng=new LatLng(arg0.getPosition().latitude,arg0.getPosition().longitude); mAMap.moveCamera(CameraUpdateFactory.changeLatLng(latLng)); if (cluster != null) { arg0.showInfoWindow(); Log.e(&quot;timeory&quot;, &quot;æ™®é€šæ ‡ç­¾infowindowå‡ºç°äº†å—? &quot; + arg0.isInfoWindowShown()+ &quot; &quot;+ arg0.isInfoWindowEnable(), null); mClusterClickListener.onClick(arg0, cluster.getClusterItems()); return true; } return false; } }; private List&lt;Marker&gt; mAddMarkers = new ArrayList&lt;Marker&gt;(); private double mClusterDistance; private LruCache&lt;Integer, BitmapDescriptor&gt; mLruCache; private HandlerThread mMarkerHandlerThread = new HandlerThread(&quot;addMarker&quot;); private HandlerThread mSignClusterThread = new HandlerThread(&quot;calculateCluster&quot;); private Handler mMarkerhandler; private Handler mSignClusterHandler; private float mPXInMeters; private boolean mIsCanceled = false; private MarkerOptions markerOptions; private Cluster mcluster; private LatLng latlng1; /** * æ„é€ å‡½æ•° * * @param amap * @param clusterSize èšåˆèŒƒå›´çš„å¤§å°ï¼ˆæŒ‡ç‚¹åƒç´ å•ä½è·ç¦»å†…çš„ç‚¹ä¼šèšåˆåˆ°ä¸€ä¸ªç‚¹æ˜¾ç¤ºï¼‰ * @param context */ public ClusterOverlay(AMap amap, int clusterSize, Context context) { this(amap, null, clusterSize, context); } /** * æ„é€ å‡½æ•°,æ‰¹é‡æ·»åŠ èšåˆå…ƒç´ æ—¶,è°ƒç”¨æ­¤æ„é€ å‡½æ•° * é»˜è®¤æœ€å¤šä¼šç¼“å­˜80å¼ å›¾ç‰‡ä½œä¸ºèšåˆæ˜¾ç¤ºå…ƒç´ å›¾ç‰‡,æ ¹æ®è‡ªå·±æ˜¾ç¤ºéœ€æ±‚å’Œappä½¿ç”¨å†…å­˜æƒ…å†µ,å¯ä»¥ä¿®æ”¹æ•°é‡ * @param amap * @param clusterItems èšåˆå…ƒç´  * @param clusterSize * @param context */ public ClusterOverlay(AMap amap, List&lt;ClusterItem&gt; clusterItems, int clusterSize, Context context) { mLruCache = new LruCache&lt;Integer, BitmapDescriptor&gt;(80) { protected void entryRemoved(boolean evicted, Integer key, BitmapDescriptor oldValue, BitmapDescriptor newValue) { oldValue.getBitmap().recycle(); } }; if (clusterItems != null) { mClusterItems = clusterItems; } else { mClusterItems = new ArrayList&lt;ClusterItem&gt;(); } mContext = context; mClusters = new ArrayList&lt;Cluster&gt;(); this.mAMap = amap; mClusterSize = clusterSize; mPXInMeters = mAMap.getScalePerPixel(); mClusterDistance = mPXInMeters * mClusterSize; initThreadHandler(); assignClusters(); } /** * by moos on 2017/11/13 * function:èšåˆåˆ·æ–°,åœ¨activityçš„onCameraChangeFinish()æ–¹æ³•ä¸­ */ public void updateClusters(){ mPXInMeters = mAMap.getScalePerPixel(); mClusterDistance = mPXInMeters * mClusterSize; assignClusters(); } /** * by moos on 2017/11/13 * func:é€šè¿‡activityä¸­çš„onMarkerClick()å“åº”èšåˆç‚¹çš„ç‚¹å‡»äº‹ä»¶ * @param arg0 */ public void respondClusterClickEvent(Marker arg0){ Cluster cluster = (Cluster) arg0.getObject(); //å°†markerçš„ä½ç½®ç§»åŠ¨åˆ°åœ°å›¾ä¸­å¿ƒ LatLng latLng=new LatLng(arg0.getPosition().latitude,arg0.getPosition().longitude); mAMap.moveCamera(CameraUpdateFactory.changeLatLng(latLng)); if (cluster != null) { arg0.showInfoWindow(); Log.e(&quot;timeory&quot;, &quot;æ™®é€šæ ‡ç­¾infowindowå‡ºç°äº†å—? &quot; + arg0.isInfoWindowShown()+ &quot; &quot;+ arg0.isInfoWindowEnable(), null); mClusterClickListener.onClick(arg0, cluster.getClusterItems()); } } /** * è®¾ç½®èšåˆç‚¹çš„ç‚¹å‡»äº‹ä»¶ * * @param clusterClickListener */ public void setOnClusterClickListener(ClusterClickListener clusterClickListener) { mClusterClickListener = clusterClickListener; } /** * æ·»åŠ ä¸€ä¸ªèšåˆç‚¹ * * @param item */ public void addClusterItem(ClusterItem item) { Message message = Message.obtain(); message.what = SignClusterHandler.CALCULATE_SINGLE_CLUSTER; message.obj = item; mSignClusterHandler.sendMessage(message); } /** * å…±å¤–éƒ¨è°ƒç”¨çš„æ¥å£,è®¾ç½®èšåˆå…ƒç´ çš„æ¸²æŸ“æ ·å¼ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä¸ºæ°”æ³¡åŠ æ•°å­—å½¢å¼è¿›è¡Œæ¸²æŸ“ * * @param render */ public void setClusterRenderer(ClusterRender render) { mClusterRender = render; } /** * è®¾ç½®èšåˆå…ƒç´ çš„æ¸²æŸ“æ ·å¼ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä¸ºæ°”æ³¡åŠ æ•°å­—å½¢å¼è¿›è¡Œæ¸²æŸ“ * * @param render */ public void setBClusterRenderer(ClusterRenderB render) { bClusterRender = render; } public void onDestroy() { mIsCanceled = true; mSignClusterHandler.removeCallbacksAndMessages(null); mMarkerhandler.removeCallbacksAndMessages(null); mSignClusterThread.quit(); mMarkerHandlerThread.quit(); for (Marker marker : mAddMarkers) { marker.remove(); } if(markerClickListener!=null){ markerClickListener = null; } mAddMarkers.clear(); mLruCache.evictAll(); } /** * æ¸…é™¤makerç‚¹å‡»äº‹ä»¶,é˜²æ­¢æŠ¢å  */ public void cleanListener(){ if(markerClickListener!=null){ markerClickListener = null; } } //åˆå§‹åŒ–Handler private void initThreadHandler() { mMarkerHandlerThread.start(); mSignClusterThread.start(); mMarkerhandler = new MarkerHandler(mMarkerHandlerThread.getLooper()); mSignClusterHandler = new SignClusterHandler(mSignClusterThread.getLooper()); } /** * å°†èšåˆå…ƒç´ æ·»åŠ è‡³åœ°å›¾ä¸Š */ private void addClusterToMap(List&lt;Cluster&gt; clusters) { ArrayList&lt;Marker&gt; removeMarkers = new ArrayList&lt;&gt;(); removeMarkers.addAll(mAddMarkers); AlphaAnimation alphaAnimation = new AlphaAnimation(1, 0); MyAnimationListener myAnimationListener = new MyAnimationListener(removeMarkers); for (Marker marker : removeMarkers) { marker.setAnimation(alphaAnimation); marker.setAnimationListener(myAnimationListener); marker.startAnimation(); } for (Cluster cluster : clusters) { addSingleClusterToMap(cluster); } } private AlphaAnimation mADDAnimation = new AlphaAnimation(0, 1); /** * å°†å•ä¸ªèšåˆå…ƒç´ æ·»åŠ è‡³åœ°å›¾æ˜¾ç¤º * * @param cluster */ private void addSingleClusterToMap(Cluster cluster) { latlng1 = cluster.getCenterLatLng(); markerOptions = new MarkerOptions(); markerOptions .anchor(0.5f, 0.5f) .icon(getBitmapDes(cluster.getClusterCount())) .position(latlng1); Marker marker = mAMap.addMarker(markerOptions); marker.setAnimation(mADDAnimation); marker.setObject(cluster); marker.startAnimation();// marker.setTitle(&quot;ä½ å¥½å•Š&quot;);// marker.setSnippet(&quot;çœŸçš„ä¸å¥½&quot;); cluster.setMarker(marker); mcluster = cluster; mAddMarkers.add(marker); } public void newIcon() { markerOptions .anchor(0.5f, 0.5f) .icon(getBitmapDes(mcluster.getClusterCount())) .position(latlng1); } private void calculateClusters() { mIsCanceled = false; mClusters.clear(); //åœ°å›¾è·å–è½¬æ¢å™¨, è·å–å¯è§†åŒºåŸŸ, è·å–å¯è§†åŒºåŸŸçš„å››ä¸ªç‚¹å½¢æˆçš„ç»çº¬åº¦èŒƒå›´, å¾—åˆ°ä¸€ä¸ªç»çº¬åº¦èŒƒå›´ LatLngBounds visibleBounds = mAMap.getProjection().getVisibleRegion().latLngBounds; for (ClusterItem clusterItem : mClusterItems) { if (mIsCanceled) { return; } LatLng latlng = clusterItem.getPosition();//èšåˆå…ƒç´ çš„åœ°ç†ä½ç½® if (visibleBounds.contains(latlng)) {//å¦‚æœè¿™ä¸ªèŒƒå›´åŒ…å«è¿™ä¸ªèšåˆå…ƒç´ çš„åœ°ç†ä½ç½® Cluster cluster = getCluster(latlng, mClusters);//æ ¹æ®è¿™ä¸ªä½ç½®å’Œèšåˆç‰©çš„é›†åˆ, è·å¾—ä¸€ä¸ªèšåˆå™¨ if (cluster != null) { cluster.addClusterItem(clusterItem);//å¾€èšåˆå™¨ä¸­æ·»åŠ èšåˆç‚¹ } else { cluster = new Cluster(latlng); mClusters.add(cluster); cluster.addClusterItem(clusterItem); } } } //å¤åˆ¶ä¸€ä»½æ•°æ®ï¼Œè§„é¿åŒæ­¥ List&lt;Cluster&gt; clusters = new ArrayList&lt;Cluster&gt;(); clusters.addAll(mClusters); Message message = Message.obtain(); message.what = MarkerHandler.ADD_CLUSTER_LIST; message.obj = clusters; if (mIsCanceled) { return; } mMarkerhandler.sendMessage(message); } /** * å¯¹ç‚¹è¿›è¡Œèšåˆ */ private void assignClusters() { mIsCanceled = true; mSignClusterHandler.removeMessages(SignClusterHandler.CALCULATE_CLUSTER); mSignClusterHandler.sendEmptyMessage(SignClusterHandler.CALCULATE_CLUSTER); } /** * åœ¨å·²æœ‰çš„èšåˆåŸºç¡€ä¸Šï¼Œå¯¹æ·»åŠ çš„å•ä¸ªå…ƒç´ è¿›è¡Œèšåˆ * * @param clusterItem */ private void calculateSingleCluster(ClusterItem clusterItem) { LatLngBounds visibleBounds = mAMap.getProjection().getVisibleRegion().latLngBounds; LatLng latlng = clusterItem.getPosition(); if (!visibleBounds.contains(latlng)) { return; } Cluster cluster = getCluster(latlng, mClusters); if (cluster != null) { cluster.addClusterItem(clusterItem); Message message = Message.obtain(); message.what = MarkerHandler.UPDATE_SINGLE_CLUSTER; message.obj = cluster; mMarkerhandler.removeMessages(MarkerHandler.UPDATE_SINGLE_CLUSTER); mMarkerhandler.sendMessageDelayed(message, 5); } else { cluster = new Cluster(latlng); mClusters.add(cluster); cluster.addClusterItem(clusterItem); Message message = Message.obtain(); message.what = MarkerHandler.ADD_SINGLE_CLUSTER; message.obj = cluster; mMarkerhandler.sendMessage(message); } } /** * æ ¹æ®ä¸€ä¸ªç‚¹è·å–æ˜¯å¦å¯ä»¥ä¾é™„çš„èšåˆç‚¹ï¼Œæ²¡æœ‰åˆ™è¿”å›null * * @param latLng * @return */ private Cluster getCluster(LatLng latLng, List&lt;Cluster&gt; clusters) { for (Cluster cluster : clusters) { LatLng clusterCenterPoint = cluster.getCenterLatLng(); double distance = AMapUtils.calculateLineDistance(latLng, clusterCenterPoint); if (distance &lt; mClusterDistance) { return cluster; } } return null; } /** * è·å–æ¯ä¸ªèšåˆç‚¹çš„ç»˜åˆ¶æ ·å¼ */ private BitmapDescriptor getBitmapDes(int num) { //åŠ è½½å­—ä½“ Typeface typeFace = Typeface.createFromAsset(mContext.getAssets(), &quot;fonts/A-OTF-ShinGoPr6N-Ultra.otf&quot;); BitmapDescriptor bitmapDescriptor = mLruCache.get(num); if (bitmapDescriptor == null) { TextView textView = new TextView(mContext); // åº”ç”¨å­—ä½“ textView.setTypeface(typeFace); if (num &lt; 10) { String tile = String.valueOf(num); textView.setText(tile); }else if(num==1){ textView.setText(&quot;&quot;); }else { float zoom = mAMap.getCameraPosition().zoom; //loge(&quot;å½“å‰ç¼©æ”¾çº§åˆ«æ˜¯==&quot; + zoom); if (zoom == 19.0 || zoom == 20.0) { String tile = String.valueOf(num); textView.setText(tile); } } textView.setGravity(Gravity.CENTER); textView.setTextColor(Color.parseColor(&quot;#ffffff&quot;)); textView.setTextSize(TypedValue.COMPLEX_UNIT_SP, 12); if (mClusterRender != null &amp;&amp; mClusterRender.getDrawAble(num) != null) { textView.setBackgroundDrawable(mClusterRender.getDrawAble(num)); //æ ¹æ®æ•°é‡è®¾ç½®èƒŒæ™¯æ ·å¼ } else { //textView.setBackgroundResource(R.mipmap.act_map_evelopetwo); //2017/09/25ä¿®æ”¹ æ¢å›¾æ ‡ textView.setBackgroundResource(R.mipmap.act_map_blue_icon_bg); } bitmapDescriptor = BitmapDescriptorFactory.fromView(textView); mLruCache.put(num, bitmapDescriptor); //æŠŠèšåˆç‚¹æ•°é‡,æ ·å¼é”®å€¼å¯¹å½¢å¼å­˜å…¥é›†åˆä¸­ } return bitmapDescriptor; } /** * æ›´æ–°å·²åŠ å…¥åœ°å›¾èšåˆç‚¹çš„æ ·å¼ */ private void updateCluster(Cluster cluster) { Marker marker = cluster.getMarker(); marker.setIcon(getBitmapDes(cluster.getClusterCount())); }//-----------------------è¾…åŠ©å†…éƒ¨ç±»ç”¨--------------------------------------------- /** * markeræ¸å˜åŠ¨ç”»ï¼ŒåŠ¨ç”»ç»“æŸåå°†Markeråˆ é™¤ */ class MyAnimationListener implements Animation.AnimationListener { private List&lt;Marker&gt; mRemoveMarkers; MyAnimationListener(List&lt;Marker&gt; removeMarkers) { mRemoveMarkers = removeMarkers; } @Override public void onAnimationStart() { } @Override public void onAnimationEnd() { for (Marker marker : mRemoveMarkers) { marker.remove(); } mRemoveMarkers.clear(); } } /** * å¤„ç†marketæ·»åŠ ï¼Œæ›´æ–°ç­‰æ“ä½œ */ class MarkerHandler extends Handler { static final int ADD_CLUSTER_LIST = 0; static final int ADD_SINGLE_CLUSTER = 1; static final int UPDATE_SINGLE_CLUSTER = 2; MarkerHandler(Looper looper) { super(looper); } public void handleMessage(Message message) { switch (message.what) { case ADD_CLUSTER_LIST: List&lt;Cluster&gt; clusters = (List&lt;Cluster&gt;) message.obj; addClusterToMap(clusters); break; case ADD_SINGLE_CLUSTER: Cluster cluster = (Cluster) message.obj; addSingleClusterToMap(cluster); break; case UPDATE_SINGLE_CLUSTER: Cluster updateCluster = (Cluster) message.obj; updateCluster(updateCluster); break; } } } /** * å¤„ç†èšåˆç‚¹ç®—æ³•çº¿ç¨‹ */ class SignClusterHandler extends Handler { static final int CALCULATE_CLUSTER = 0; static final int CALCULATE_SINGLE_CLUSTER = 1; SignClusterHandler(Looper looper) { super(looper); } public void handleMessage(Message message) { switch (message.what) { case CALCULATE_CLUSTER: calculateClusters(); break; case CALCULATE_SINGLE_CLUSTER: ClusterItem item = (ClusterItem) message.obj; mClusterItems.add(item); Log.e(&quot;cluster_overlay&quot;, &quot;calculate single cluster&quot;); calculateSingleCluster(item); break; } } }} ä»¥ä¸Šä»£ç å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±å…·ä½“éœ€è¦ä¿®æ”¹,æ¥ä¸‹æ¥æ˜¯èšåˆæ ‡ç­¾ç±»Clusterä»£ç ,å‡ ä¹æ²¡æ”¹(æ»‘ç¨½): Cluster: 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class Cluster { private LatLng mLatLng; private List&lt;ClusterItem&gt; mClusterItems; private Marker mMarker; public Cluster(LatLng latLng) { mLatLng = latLng; mClusterItems = new ArrayList&lt;ClusterItem&gt;(); } public Cluster(List&lt;ClusterItem&gt; clusterItems){ mClusterItems = new ArrayList&lt;&gt;() ; mClusterItems = clusterItems; } public void addClusterItem(ClusterItem clusterItem) { mClusterItems.add(clusterItem); } public int getClusterCount() { return mClusterItems.size(); } public LatLng getCenterLatLng() { return mLatLng; } public void setMarker(Marker marker) { mMarker = marker; } public Marker getMarker() { return mMarker; } public List&lt;ClusterItem&gt; getClusterItems() { return mClusterItems; }} ç„¶åå°±æ˜¯ClusterItemæ¥å£äº†,ç”¨æ¥è·å–èšåˆæ ‡ç­¾çš„ç›¸å…³ä¿¡æ¯: ClusterItem: 1234567891011public interface ClusterItem { /** * è¿”å›èšåˆå…ƒç´ çš„åœ°ç†ä½ç½® * * @return */ LatLng getPosition(); String getUserType();} æœ‰äººå¯èƒ½ä¼šé—®:getUserType()æ–¹æ³•å¹²å•¥ç”¨çš„?å®¢å®˜,åˆ«æ€¥,å…ˆæ¥ç€å¾€ä¸‹çœ‹,å¾ˆå¿«å°±çŸ¥é“å®ƒçš„ç”¨å¤„äº†. æ¥ç€,å°±æ˜¯æˆ‘ä»¬çš„RegionItemç±»äº†,å®ç°äº†ClusterItemæ¥å£: RegionItem: 12345678910111213141516171819202122public class RegionItem implements ClusterItem { private LatLng mLatLng; private String userType; public String getUserType() { return userType; } public RegionItem(LatLng latLng, String userType) { this.mLatLng=latLng; this.userType = userType; } @Override public LatLng getPosition() { // TODO Auto-generated method stub return mLatLng; }} æœ€å,å°±æ˜¯è¦åœ¨Activityä¸­æ ¹æ®éœ€æ±‚æ·»åŠ æˆ‘ä»¬çš„èšåˆæ ‡ç­¾äº†: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081private ClusterOverlay mClusterOverlay;//æ™®é€šç”¨æˆ·èšåˆè¦†ç›–ç‰©çš„å¯¹è±¡private BClusterOverlay bClusterOverlay;//ä¼ä¸šç”¨æˆ·èšåˆè¦†ç›–ç‰©çš„å¯¹è±¡/** * by moos on 2017/11/15 * func:æ·»åŠ å¹¶æ˜¾ç¤ºèšåˆç‚¹,å¢åŠ ç‚¹å‡»å’Œç»˜åˆ¶äº‹ä»¶ */ private void addItems() { new Thread() { public void run() { List&lt;ClusterItem&gt; items = new ArrayList&lt;ClusterItem&gt;();//æ™®é€šç”¨æˆ· List&lt;ClusterItem&gt; bItems = new ArrayList&lt;ClusterItem&gt;();//ä¼ä¸šç”¨æˆ· //loge(&quot;é™„è¿‘çš„ç‚¹æœ‰===&quot; + imageNearBean.getData().getExhibitionList().size()); for (int i = 0; i &lt; imageNearBean.getData().getExhibitionList().size(); i++) { double lat = imageNearBean.getData().getExhibitionList().get(i).getLatitude(); double lon = imageNearBean.getData().getExhibitionList().get(i).getLongitude(); if (imageNearBean.getData().getExhibitionList().get(i).getUserType() != null &amp;&amp; imageNearBean.getData().getExhibitionList().get(i).getUserType().equals(&quot;03&quot;)) {//æ˜¯ä¼ä¸šç”¨æˆ·çš„æ•°æ® LatLng latLng = new LatLng(lat, lon, false); RegionItem regionItem = new RegionItem(latLng, imageNearBean.getData().getExhibitionList().get(i).getUserType());//æ·»åŠ å…ƒç´  bItems.add(regionItem); allBussinessBean.add(imageNearBean.getData().getExhibitionList().get(i));//æ”¾å…¥æ‰€æœ‰ä¼ä¸šç”¨æˆ·æ•°æ® }else { //æ˜¯æ™®é€šç”¨æˆ· LatLng latLng = new LatLng(lat, lon, false); RegionItem regionItem = new RegionItem(latLng, imageNearBean.getData().getExhibitionList().get(i).getOriginalId(), imageNearBean.getData().getExhibitionList().get(i).getUserType());//æ·»åŠ å…ƒç´  items.add(regionItem); } } log.e(&quot;æ™®é€šç”¨æˆ·æœ‰==&quot; + items.size()); log.e(&quot;ä¼ä¸šç”¨æˆ·æœ‰==&quot; + bItems.size()); if ( items.size() &gt; 0) { if (mClusterOverlay == null) { //è¦†ç›–ç‰©çš„é›†åˆ, mClusterOverlay = new ClusterOverlay(mAMap, items, dp2px(getApplicationContext(), clusterRadius), getApplicationContext()); //åœ°å›¾å¯¹è±¡,é›†åˆ,èšåˆèŒƒå›´,ä¸Šä¸‹æ–‡ä¼ åˆ°æŒ‡å®šæ–¹æ³•å®ç° } else { mClusterOverlay.onDestroy(); //é”€æ¯ä¹‹å‰çš„è¦†ç›–ç‰©é›†åˆ mClusterOverlay = null; mClusterOverlay = new ClusterOverlay(mAMap, items, dp2px(getApplicationContext(), clusterRadius), getApplicationContext()); } //æ¸²æŸ“å’Œèšåˆç‚¹ç‚¹å‡»äº‹ä»¶ç›‘å¬ mClusterOverlay.setClusterRenderer(MapActivity.this); //getdrawable æ–¹æ³•å®ç° mClusterOverlay.setOnClusterClickListener(MapActivity.this); //onclickæ–¹æ³•å®ç° } if ( bItems.size() &gt; 0) { //å•†å®¶ç”¨æˆ·æ•°æ® loge(&quot;è®¾ç½®ä¼ä¸šæ ‡ç­¾ç‚¹å‡»äº‹ä»¶&quot;); if (bClusterOverlay == null) { //è¦†ç›–ç‰©çš„é›†åˆ bClusterOverlay = new BClusterOverlay(mAMap, bItems, dp2px(getApplicationContext(), clusterRadius), getApplicationContext()); } else { bClusterOverlay.onDestroy(); bClusterOverlay = null; bClusterOverlay = new BClusterOverlay(mAMap, bItems, dp2px(getApplicationContext(), clusterRadius), getApplicationContext()); } //æ¸²æŸ“å’Œèšåˆç‚¹ç‚¹å‡»äº‹ä»¶ç›‘å¬ bClusterOverlay.setClusterRenderer(this); bClusterOverlay.setOnClusterClickListener(MapActivity.this); //onBclick æ–¹æ³•å®ç° } runOnUiThread(new Runnable() { @Override public void run() { addMarkersToMap();//æ·»åŠ æ™®é€šmarkeråˆ°åœ°å›¾ } }); } }.start(); } è¿™é‡Œå¤§å®¶å¯èƒ½çœ‹å¾—å¾ˆçƒ¦,æ²¡é”™,çœ‹å¾—å¾ˆçƒ¦å°±å¯¹äº†ğŸ˜†!å› ä¸ºè¿™ä¸€éƒ¨åˆ†å®Œå…¨æ²¡å¿…è¦çœ‹â€¦åªæ˜¯ä¸ºäº†ç­›é€‰åå°ä¸åŒçš„ç”¨æˆ·æ•°æ®è€Œå·²ã€‚è®°å¾—ä¹‹å‰æˆ‘æåˆ°çš„ClusterItemç±»ä¸­getUserType()æ–¹æ³•ä»¥åŠå®ç°è¿™ä¸ªæ¥å£çš„ç±»RegionItemä¸­å®šä¹‰çš„userTypeå˜é‡å—?å®ƒçš„ä½œç”¨å°±æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒçš„èšåˆæ ‡ç­¾,ä»¥ä¸Šä»£ç çš„03ä»£è¡¨å•†å®¶ç”¨æˆ·,å…¶ä½™ç±»å‹é»˜è®¤æ™®é€šç”¨æˆ·ã€‚ æœ€å,å°±æ˜¯æˆ‘ä»¬çš„é‡å¤´æˆäº†,é›†ä¸­å¤„ç†å¤šç§èšåˆæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748mAMap.setOnCameraChangeListener(new AMap.OnCameraChangeListener() { @Override public void onCameraChange(CameraPosition cameraPosition) { //LatLng latLng = cameraPosition.target; } @Override public void onCameraChangeFinish(CameraPosition cameraPosition) { mClusterOverlay.updateClusters();//åˆ·æ–° bClusterOverlay.updateClusters(); } }); mAMap.setOnMarkerClickListener(new AMap.OnMarkerClickListener() { @Override public boolean onMarkerClick(Marker marker) { //mClusterOverlay.cleanListener(); Cluster cluster = (Cluster) marker.getObject(); if(cluster!=null &amp;&amp; cluster.getClusterCount()&gt;0){ if(cluster.getClusterItems().get(0).getUserType().equals(&quot;03&quot;)){ loge(&quot;æ˜¯æ™®é€šç”¨æˆ·èšåˆæ ‡ç­¾&quot;); mClusterOverlay.respondClusterClickEvent(marker);//å“åº”èšåˆç‚¹çš„ç‚¹å‡»äº‹ä»¶ }else { loge(&quot;æ˜¯å•†å®¶ç”¨æˆ·èšåˆæ ‡ç­¾&quot;); bClusterOverlay.respondClusterClickEvent(marker);//å“åº”èšåˆç‚¹çš„ç‚¹å‡»äº‹ä»¶ } } return true; } }); ...... //èšåˆæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶ @Override public void onClick(Marker marker, List&lt;ClusterItem&gt; clusterItems) { loge(&quot;ç‚¹å‡»äº†æ™®é€šç”¨æˆ·&quot;); } @Override public void onBClick(Marker marker, List&lt;ClusterItem&gt; clusterItems) { loge(&quot;ç‚¹å‡»äº†å•†å®¶ç”¨æˆ·&quot;); } ä»£ç æœ‰ç‚¹å¤š,å…·ä½“ä¸šåŠ¡é€»è¾‘ä»£ç å°±ä¸è´´äº†,ä¼°è®¡çœ‹äº†ä¹Ÿä¼šæ¯”è¾ƒçš„çƒ¦,å¤§å®¶åªéœ€è¦çœ‹onMarkerClick()æ–¹æ³•ä¸­çš„é€»è¾‘å°±OKäº†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹,æˆ‘ä»¬éœ€è¦ç‚¹å‡»ä¸åŒçš„markerå,è·å–è¯¥markeråº”è¯¥å¯¹åº”çš„æ•°æ®,é‚£ä¹ˆè¯¥å¦‚ä½•è·å–å‘¢?ä¸ºäº†å¿«ç‚¹ç»“æŸæˆ˜æ–—,è¿™é‡Œæˆ‘å°±ä¸å–å…³å­äº†,é«˜å¾·markerç±»ä¸­æœ‰ä¸€æ–¹æ³•getObject(),å®˜æ–¹æ˜¯è¿™æ ·æè¿°çš„: çœ‹åˆ°è¿™,å¾ˆå¤šäººä¸€å®šè±ç„¶å¼€æœ—,æ²¡é”™!è¿˜æœ‰ä¸ªå¯¹åº”çš„æ–¹æ³•marker.setObject(Object obj)ã€‚åœ¨ClusterOverlayä¸­,æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ä»£ç : 123456789101112131415161718192021/** * å°†å•ä¸ªèšåˆå…ƒç´ æ·»åŠ è‡³åœ°å›¾æ˜¾ç¤º * * @param cluster */ private void addSingleClusterToMap(Cluster cluster) { latlng1 = cluster.getCenterLatLng(); markerOptions = new MarkerOptions(); markerOptions .anchor(0.5f, 0.5f) .icon(getBitmapDes(cluster.getClusterCount())) .position(latlng1); Marker marker = mAMap.addMarker(markerOptions); marker.setAnimation(mADDAnimation); marker.setObject(cluster); marker.startAnimation(); cluster.setMarker(marker); mcluster = cluster; mAddMarkers.add(marker); } çœ‹çœ‹ä¸Šé¢è¿™å—ä»£ç ,æˆ‘ä»¬çš„ç¡®å‘ç°äº†marker.setObject(cluster)æ–¹æ³•,clusteré‡Œé¢æœ‰ä»€ä¹ˆ?æœ‰ClusterItemå‘€!çœ‹åˆ°è¿™,æˆ‘ä»¬å°±å‘ç°,å‰é¢çš„getUsertype()æ–¹æ³•ä¸æ˜¯æ­£å¥½æ´¾ä¸Šç”¨åœºäº†å˜›!æ·»åŠ èšåˆæ ‡ç­¾çš„æ—¶å€™,æˆ‘ä»¬ç»™æ¯ä¸ªmarkerè´´ä¸Šäº†â€åç‰Œâ€,å½“æˆ‘ä»¬ç‚¹å‡»èšåˆæ ‡ç­¾çš„æ—¶å€™,æ‹¿åˆ°é™„åŠ çš„ä¿¡æ¯å¹¶æ‰¾åˆ°è¿™ä¸ªåç‰Œ(userType),è¿™æ ·ä¸å°±å¯ä»¥è½»è€Œæ˜“ä¸¾â€æ’•æ‰åç‰Œâ€äº†å—!ğŸ˜† &emsp;&emsp;è¿™æ ·æˆ‘ä»¬å°±è§£å†³å¤šç§èšåˆæ ‡ç­¾ç‚¹å‡»å†²çªçš„é—®é¢˜äº†,è‡³äºå¦‚ä½•è§£å†³èšåˆæ ‡ç­¾ä¸æ™®é€šMarkerç‚¹å‡»äº‹ä»¶å†²çª,å…¶å®å¤§åŒå°å¼‚,è¿™é‡Œå°±ä¸çŒ®ä¸‘äº†,ç›¸ä¿¡å¯¹äºå¤§å®¶æ¥è¯´æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« å°†ä¸ºå¤§å®¶æä¾›markeråŠ è½½ç½‘ç»œå›¾ç‰‡çš„å®Œç¾è§£å†³æ–¹æ¡ˆ,è¯·æ‹­ç›®ä»¥å¾…! &emsp;&emsp;æœ€å,å¤§å®¶æœ‰ä»»ä½•é—®é¢˜æˆ–è€…å»ºè®®,æ¬¢è¿ç•™è¨€æˆ–è€…åŠ ç¾¤è®¨è®º,è°¢è°¢. ä»£ç åœ°å€ï¼šhttps://github.com/Moosphan/AMapMarker-master","link":"/2017/11/20/amap-marker-lot/"},{"title":"æ˜¯æ—¶å€™è®© Android Tools å±æ€§æ‹¯æ•‘ä½ äº†","text":"æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šé‡åˆ°è¿™æ ·ä¸€ç§åœºæ™¯ï¼šæˆ‘ä»¬å†™å‡ºçš„ UI æ•ˆæœåœ¨å¯¹æ¥æ•°æ®ä¹‹å‰éœ€è¦æå‰è¿›è¡Œé¢„è§ˆï¼Œè¿›è€Œè°ƒæ•´ UI ç»†èŠ‚å’Œæ’ç‰ˆé—®é¢˜ã€‚æˆ‘ä»¬ä¸€èˆ¬çš„åšæ³•æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿå¦‚æœå­˜åœ¨åƒ TextView æˆ–è€… ImageView è¿™ç§åŸºç¡€æ§ä»¶ï¼Œä½ æ˜¯ä¸æ˜¯è¿˜åœ¨é€šè¿‡è¯¸å¦‚ android:text=&quot;xxx&quot; å’Œ android:src=&quot;@drawable/xxx&quot; çš„æ–¹å¼æ¥æµ‹è¯•å’Œé¢„è§ˆUIæ•ˆæœï¼Ÿå½“ç„¶ä½ è‚¯å®šä¹Ÿä¼šé‡åˆ°è¿™äº›â€œè„æ•°æ®â€ç»™ä½ å¸¦æ¥çš„å›°æ‰°ï¼šæµ‹è¯•çš„æ—¶å€™æŸäº›åœ°æ–¹å‡ºç°äº†æœ¬ä¸è¯¥å‡ºç°çš„æ•°æ®ï¼Œäº‹åå¯èƒ½ä¸€æ‹è„‘é—¨æ‰å‘ç°ï¼ŒåŸæ¥æ˜¯å¸ƒå±€ä¸­æ§ä»¶é¢„è§ˆæ•°æ®æ²¡æœ‰æ¸…é™¤å¯¼è‡´çš„ã€‚ å¦‚æœæ˜¯ RecyclerViewï¼Œåœ¨åå°æ¥å£å°šèƒ½æµ‹è¯•çš„æƒ…å†µä¸‹ï¼Œä½ æ˜¯å¦åˆè¦è‡ªå·±ç”Ÿæˆâ€œå‡æ•°æ®â€å¹¶æ‰‹å†™ Adapter å‘¢ï¼Ÿè¿™æ—¶å€™ä½ ä¸ç¦ä¼šé—®ï¼šæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ—¢èƒ½å¤Ÿåšåˆ°å¸ƒå±€æ—¶é¢„è§ˆæ•°æ®æ–¹ä¾¿æ’ç‰ˆï¼Œåˆèƒ½å¤Ÿåœ¨å¯¹æ¥çœŸå®æ•°æ®è¿è¡ŒååŠ¨æ€æ›¿æ¢å’Œç§»é™¤è¿™äº›æ— å…³æ•°æ®å‘¢ï¼Ÿ é“›é“›é“›é“›ï¼Android çš„ Tools attributes åº”è¿è€Œç”Ÿã€‚è€è§„çŸ©ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªæ•ˆæœï¼š Whatï¼Ÿä½ åœ¨è€æˆ‘å—ï¼Ÿè¿™ä¹ˆç®€å•çš„åˆ—è¡¨æ‹¿å‡ºæ¥å¹²å˜›ï¼Ÿå“ˆå“ˆï¼Œå®¢è§‚ä¸è¦ç€æ€¥ã€‚è¿™ä¸ªå¹¶ä¸éš¾å®ç°ï¼Œå€˜è‹¥æˆ‘è¯´è¿™é‡Œå¹¶æ²¡æœ‰å†™ä¸€è¡Œ Java æˆ–è€… Kotlin ä»£ç å°±å®ç°äº†æ­¤æ•ˆæœï¼Œè€Œåªæ˜¯åœ¨å¸ƒå±€é¡µé¢é¢„è§ˆï¼Œä½ æ•¢ä¿¡å—ï¼Ÿä¸Šå›¾åªæ˜¯å†°å±±ä¸€è§’ï¼Œä¸‹é¢è¿™å¼ å›¾æ‰æ˜¯å…¨è²Œï¼š ä¸‹é¢ä¼šå¸¦å¤§å®¶ä¸€æ­¥æ­¥å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œé¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»å¤´è¯´èµ·ã€‚ è®¤è¯† Tools attributesTools attributes å³ä»¥ tools å¼€å§‹çš„å‘½åç©ºé—´ï¼Œä¸¾ä¸ªæˆ‘ä»¬æœ€å¸¸è§åˆ°çš„ä¾‹å­ï¼š 12345678910&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\".MainActivity\"&gt; &lt;/android.support.constraint.ConstraintLayout&gt; å¤§å®¶è‚¯å®šå¹³æ—¶éƒ½ä¼šè§åˆ° tools:context=&quot;.XXXActivity è¿™ä¸ªç³»ç»Ÿé»˜è®¤ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„é…ç½®ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰æ ¹è§†å›¾æ‰èƒ½ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå®ƒæŒ‡å®šäº†å½“å‰å¸ƒå±€é»˜è®¤æ˜¯ä¸å“ªä¸ª Activity ç›¸å…³è”ï¼Œä½¿å¾—å¸ƒå±€èƒ½å¤Ÿè·å–åˆ°ç»‘å®š Activity çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ Theme ç­‰ç­‰ï¼Œè€Œä¸”å½“ä½ åœ¨å¸ƒå±€ä¸­ç»™å­ View æ·»åŠ  onClick äº‹ä»¶æ—¶ï¼Œç›¸åº”çš„æ–¹æ³•ä»£ç ä¼šæ’å…¥åˆ°è¿™ä¸ª Activity ä¸­ã€‚Android studio æ”¯æŒå¾ˆå¤šåœ¨ XML æ–‡ä»¶ä¸­ä»¥ tools ä¸ºå‘½åç©ºé—´çš„å±æ€§ï¼Œå½“æ„å»º App æ—¶è¿™äº›å±æ€§ä¼šè¢«æ“¦é™¤ï¼Œå¯¹ APK çš„å¤§å°å’Œè¿è¡Œæ—¶è¡Œä¸ºæ²¡æœ‰ä»»ä½•å½±å“ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ–‡ç« æœ€åˆæƒ³è¦çš„ç»“æœã€‚ ç»†è¯´ Tools attributesåœ¨å…·ä½“ä»‹ç» Tools attributes ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å¦‚ä½•å¼•å…¥ Tools çš„å‘½åç©ºé—´å¹¶ä½¿ç”¨ï¼Œå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ XML å¸ƒå±€æ–‡ä»¶çš„æ ¹å…ƒç´ ä¸­æ·»åŠ å³å¯ï¼š 12&lt;RootTag xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" &gt; è¿™äº›å·¥å…·å±æ€§å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š Error handling attributeså³é”™è¯¯å’Œè­¦å‘Šå¤„ç†å±æ€§ã€‚è¿™ç±»å±æ€§å¸¸è¢«ç”¨æ¥è§„é¿è¢« lint æ£€æŸ¥å‡ºçš„ä¸€äº›é”™è¯¯æç¤ºä»¥åŠè­¦å‘Šã€‚ä¸‹é¢è®©æˆ‘ä»¬çœ‹ä¸€äº›å¸¸è§çš„ä¾‹å­ï¼š tools:ignore ä¸»è¦ç”¨æ¥å¿½ç•¥ä¸€äº› lint äº§ç”Ÿçš„è­¦å‘Šä¿¡æ¯ï¼Œå¹¶æ”¯æŒä¸€äº›å±æ€§ï¼Œä¾‹å¦‚ï¼š 1234&lt;resources xmlns:tools=\"http://schemas.android.com/tools\"&gt; &lt;string name=\"app_name\"&gt;ConstraintSample&lt;/string&gt; &lt;string name=\"header_image_string\" tools:ignore=\"MissingTranslation\"&gt;header image&lt;/string&gt;&lt;/resources&gt; è¿™ä¸ªå¯¹äº Android studio å‡çº§åˆ° 3.0 ä»¥ä¸Šçš„å°ä¼™ä¼´æ¥è¯´åº”è¯¥æ˜¯å¾ˆå¸¸è§äº†ï¼Œå¦‚æœæˆ‘ä»¬é¡¹ç›®ä¸­æ¶‰åŠåˆ°å›½é™…åŒ–æ”¯æŒï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šæç¤ºæˆ‘ä»¬ä¸ºæ¯ä¸€ç§è¯­è¨€åšé€‚é…ï¼Œä¸èƒ½â€œåšæ­¤è–„å½¼â€ï¼Œå¦‚æœæˆ‘ä»¬æŸäº› string åªéœ€è¦æ”¯æŒä¸€ç§è¯­è¨€ï¼Œåªéœ€è¦åƒä¸Šé¢é‚£æ ·æ·»åŠ  tools:ignore=&quot;MissingTranslation å³å¯ã€‚ç›¸ä¼¼çš„ä¾‹å­è¿˜å¯ä»¥åœ¨ä½¿ç”¨ ImageView çš„æ—¶å€™çœ‹åˆ°ï¼š 12345&lt;ImageView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:src=\"@drawable/ic_person_off\" tools:ignore=\"contentDescription\" /&gt; tools:targetApi è¿™ä¸ªå±æ€§çš„åŠŸèƒ½å’Œ Java ä»£ç ä¸­çš„æ³¨è§£ @TargetApi æ˜¯ä¸€æ ·çš„ï¼šå®ƒæŒ‡å®šäº†å½“å‰æ§ä»¶æˆ–å…ƒç´ æ”¯æŒçš„ API çº§åˆ«ï¼Œå±æ€§å€¼å¯ä»¥æ˜¯ API Code åæˆ–è€… API å¸¸æ•°å€¼ï¼Œå®ƒæ”¯æŒä¸€åˆ‡å±æ€§ã€‚å¦‚ï¼šæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ*android:elevation* å±æ€§æ˜¯åœ¨ API 21 ç‰ˆæœ¬ä»¥ä¸Šæ‰æ”¯æŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç è§„é¿ lint çš„è­¦å‘Šï¼š 12345&lt;Button android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:elevation=\"4dp\" tools:targetApi=\"lollipop\"/&gt; tools:locale è¿™ä¸ªå±æ€§ä¸»è¦ç”¨åœ¨ &lt;resource&gt; æ ‡ç­¾å†…ï¼Œç”¨æ¥æŒ‡å®šå½“å‰èµ„æºä¸­é»˜è®¤ä¸ºå“ªç§è¯­è¨€å’ŒåŒºåŸŸï¼Œè¿›è€Œè§„é¿è¯­è¨€æ‹¼å†™çš„æ£€æµ‹ï¼Œæ¯”å¦‚ä½ å¯ä»¥æŒ‡å®š values/strings.xml æ–‡ä»¶çš„é»˜è®¤è¯­è¨€æ˜¯è¥¿ç­ç‰™è¯­è€Œä¸æ˜¯è‹±è¯­ï¼š 12&lt;resources xmlns:tools=\"http://schemas.android.com/tools\" tools:locale=\"es\"&gt; Resource shrinking attributeså³èµ„æºå‹ç¼©å±æ€§ã€‚å…³äºæ­¤ç±»å±æ€§çš„ç”¨æ³•æˆ‘ä»¬å·²ç»åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« å¸¦ä½ é¢†ç•¥Androidæ··æ·†çš„é­…åŠ›ä¸€æ–‡ä¸­åšè¿‡è¯¦ç»†è®²è§£ï¼Œä¸‹é¢å†ç®€å•è¯´æ˜ä¸€ä¸‹ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ tools:shrinkMode å’Œ tools:keep å±æ€§æ¥åˆ†åˆ«æŒ‡å®šèµ„æºå‹ç¼©çš„æ¨¡å¼å’Œéœ€è¦ä¿ç•™çš„ä¸è¢«å‹ç¼©çš„èµ„æº ï¼Œè¿˜å¯ä»¥é€šè¿‡ tools:discard å±æ€§æ¥æŒ‡å®šéœ€è¦ä¿ç•™çš„èµ„æºï¼Œä¸ keep åŠŸèƒ½ç±»ä¼¼ï¼š 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources xmlns:tools=\"http://schemas.android.com/tools\" tools:shrinkMode=\"strict\" tools:keep=\"@layout/activity_video*,@layout/dialog_update_v2\" tools:discard=\"@layout/unused_layout,@drawable/unused_selector\" /&gt; ä¸‹é¢å°±åˆ°æœ¬ç¯‡æ–‡ç« çš„é‡å¤´æˆäº†ï¼Œæ³¨æ„ï¼Œå‰æ–¹é«˜èƒ½æ¥è¢­ï¼ Design-time View Attributesè¿™å°±æ˜¯æˆ‘ä»¬å…ˆå‰æ•ˆæœå›¾ä¸­çš„é‡è¦åŠŸè‡£äº†ï¼Œå³ï¼šå¸ƒå±€è®¾è®¡æ—¶çš„æ§ä»¶å±æ€§ã€‚è¿™ç±»å±æ€§ä¸»è¦ä½œç”¨äº View æ§ä»¶ï¼Œå¦‚ä¸Šæ–‡æ‰€è¯´çš„ tools:context å°±æ˜¯â€œæˆå‘˜â€ä¹‹ä¸€ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»å…¶ä»–é‡è¦æˆå‘˜ã€‚ åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ­å¼€ tools å‘½åç©ºé—´çš„å¦ä¸€å±‚ç¥ç§˜é¢çº±ï¼š*tools:*** å¯ä»¥æ›¿æ¢ä»»ä½•ä»¥ *android:*** ä¸ºå‰ç¼€çš„å±æ€§ï¼Œå¹¶ä¸ºå…¶è®¾ç½®æ ·ä¾‹æ•°æ®ï¼ˆsample dataï¼‰ã€‚å½“ç„¶ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è¯´ï¼Œtools å±æ€§åªèƒ½åœ¨å¸ƒå±€ç¼–è¾‘æœŸé—´æœ‰æ•ˆï¼ŒAppçœŸæ­£è¿è¡Œåå°±æ¯«æ— æ„ä¹‰äº†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä¸‹é¢è¿™æ ·æ¥åœ¨è¿è¡Œå‰é¢„è§ˆå¸ƒå±€æ•ˆæœï¼š ä¸Šå›¾å¯¹åº”çš„å¸ƒå±€æ–‡ä»¶ä¸ºï¼š Card_item_layout.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.constraint.ConstraintLayout xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:android=\"http://schemas.android.com/apk/res/android\" android:background=\"@android:color/white\" android:clickable=\"true\" android:focusable=\"true\" android:foreground=\"?attr/selectableItemBackground\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_marginStart=\"2dp\" android:layout_marginEnd=\"2dp\" tools:targetApi=\"m\" tools:ignore=\"UnusedAttribute\"&gt; &lt;ImageView android:id=\"@+id/card_item_avatar\" android:layout_width=\"38dp\" android:layout_height=\"38dp\" app:layout_constraintStart_toStartOf=\"parent\" android:layout_marginStart=\"16dp\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\" android:layout_marginBottom=\"16dp\" app:layout_constraintVertical_bias=\"0.0\" tools:ignore=\"ContentDescription\" tools:srcCompat=\"@drawable/user_other\"/&gt; &lt;TextView android:id=\"@+id/card_item_username\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintStart_toStartOf=\"@+id/card_item_title\" app:layout_constraintEnd_toEndOf=\"@+id/card_item_title\" app:layout_constraintHorizontal_bias=\"0.0\" android:textSize=\"12sp\" android:textColor=\"@color/username_text_color\" android:layout_marginEnd=\"16dp\" android:paddingEnd=\"16dp\" tools:text=\"æ°´æœˆæ²é£\" /&gt; &lt;TextView android:id=\"@+id/card_item_title\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:textSize=\"16sp\" android:textColor=\"@color/title_text_color\" app:layout_constraintStart_toEndOf=\"@+id/card_item_avatar\" android:layout_marginStart=\"12dp\" app:layout_constraintTop_toBottomOf=\"@+id/card_item_username\" android:layout_marginTop=\"8dp\" android:maxLines=\"1\" tools:text=\"ä»Šå¤©ä¸Šæµ·çš„å¤œè‰²çœŸç¾ï¼\"/&gt; &lt;TextView android:id=\"@+id/card_item_content\" android:layout_width=\"0dp\" android:layout_height=\"wrap_content\" app:layout_constraintStart_toStartOf=\"parent\" android:layout_marginTop=\"24dp\" app:layout_constraintTop_toBottomOf=\"@+id/card_item_avatar\" app:layout_constraintBottom_toBottomOf=\"parent\" android:layout_marginBottom=\"16dp\" app:layout_constraintVertical_bias=\"1.0\" android:maxLines=\"3\" android:ellipsize=\"end\" android:textColor=\"@color/content_text_color\" android:textStyle=\"normal\" app:layout_constraintEnd_toEndOf=\"@+id/card_item_bottom_border\" android:layout_marginEnd=\"16dp\" android:layout_marginStart=\"16dp\" app:layout_constraintHorizontal_bias=\"0.0\" tools:text=\"äººç”Ÿè‹¥åªå¦‚åˆè§ï¼Œä½•äº‹ç§‹é£æ‚²ç”»æ‰‡...\"/&gt; &lt;ImageView android:id=\"@+id/card_item_poster\" android:layout_width=\"0dp\" android:layout_height=\"200dp\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toBottomOf=\"@+id/card_item_content\" app:layout_constraintEnd_toEndOf=\"parent\" android:layout_marginEnd=\"16dp\" android:scaleType=\"centerCrop\" android:layout_marginTop=\"8dp\" android:layout_marginStart=\"16dp\" app:layout_constraintBottom_toBottomOf=\"parent\" android:layout_marginBottom=\"16dp\" app:layout_constraintVertical_bias=\"0.0\" tools:ignore=\"ContentDescription\" android:visibility=\"visible\" tools:src=\"@drawable/shanghai_night\"/&gt; &lt;View android:id=\"@+id/card_item_bottom_border\" android:layout_width=\"0dp\" android:layout_height=\"2dp\" app:layout_constraintTop_toBottomOf=\"@+id/card_item_poster\" android:background=\"#ffededfe\" app:layout_constraintEnd_toEndOf=\"parent\" android:layout_marginTop=\"16dp\" app:layout_constraintStart_toStartOf=\"parent\"/&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:id=\"@+id/card_item_date\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" android:layout_marginEnd=\"16dp\" android:textColor=\"@color/date_text_color\" android:textSize=\"12sp\" tools:text=\"2019-08-10\"/&gt;&lt;/android.support.constraint.ConstraintLayout&gt; é€šè¿‡ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼šé€šè¿‡ å¯¹ TextView ä½¿ç”¨ tools:text å±æ€§ä»£æ›¿ android:text å°±å¯ä»¥å®ç°æ–‡æœ¬å…·ä½“æ•ˆæœçš„é¢„è§ˆï¼Œç„¶è€Œè¿™é¡¹è®¾ç½®å¹¶ä¸ä¼šå¯¹æˆ‘ä»¬ App å®é™…è¿è¡Œæ•ˆæœäº§ç”Ÿå½±å“ã€‚åŒç†ï¼Œé€šè¿‡å°† tools:src ä½œç”¨äº ImageView ä¹Ÿå¯ä»¥è¾¾åˆ°é¢„è§ˆå›¾ç‰‡çš„æ•ˆæœã€‚æ­¤å¤–ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å¯¹å…¶ä»–ä»¥ android: ä¸ºå‰ç¼€çš„å±æ€§è¿›è¡Œé¢„è§ˆè€Œä¸å½±å“å®é™…è¿è¡Œçš„æ•ˆæœï¼Œä¾‹å¦‚ï¼šä¸Šé¢å¸ƒå±€ä»£ç ä¸­çš„åº•éƒ¨åˆ†å‰²çº¿ &lt;View&gt;ï¼Œæˆ‘ä»¬æƒ³å°†å…¶åœ¨ App å®é™…è¿è¡Œçš„æ—¶å€™éšè—æ‰ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯éœ€è¦çŸ¥é“å®ƒçš„é¢„è§ˆæ•ˆæœå’Œæ‰€å é«˜åº¦ï¼š 123456789101112&lt;View android:id=\"@+id/card_item_bottom_border\" android:layout_width=\"0dp\" android:layout_height=\"2dp\" android:visibility=\"gone\" tools:visibility=\"visible\" tools:layout_height=\"8dp\" app:layout_constraintTop_toBottomOf=\"@+id/card_item_poster\" android:background=\"#ffededfe\" app:layout_constraintEnd_toEndOf=\"parent\" android:layout_marginTop=\"16dp\" app:layout_constraintStart_toStartOf=\"parent\"/&gt; å¦‚ä¸Šæ‰€ç¤ºï¼Œé€šè¿‡ tools:visibility å’Œ tools:layout_height å°±å¯ä»¥ä»…åœ¨å¸ƒå±€é¢„è§ˆæƒ…å†µä¸‹æ”¹å˜ View çš„çŠ¶æ€å’Œé«˜åº¦ã€‚è™½ç„¶ä¸Šè¿°æƒ…å†µæ¯”è¾ƒå°‘ç”¨ï¼Œä½†æ˜¯å¸Œæœ›å¤§å®¶ä¹Ÿèƒ½å¤ŸçŸ¥é“ï¼Œ*tools:* å¯ä»¥æ›¿ä»£æ‰€æœ‰ android: ä¿®é¥°çš„å±æ€§ã€‚ ä¸‹é¢å†åˆ—ä¸¾ä¸€äº›å…¶ä»–ä¼šå¸¸ç”¨åˆ°çš„å±æ€§ã€‚ tools:layout è¿™ä¸ªå±æ€§åªèƒ½ç”¨äº fragment æ§ä»¶ä¸­ï¼Œå¦‚æœæˆ‘ä»¬çš„ activity å¸ƒå±€æ–‡ä»¶ä¸­å£°æ˜äº† &lt;fragment&gt; æ§ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ tools:layout=â€@layout/fragment_mainâ€ æ¥åœ¨å½“å‰ activity å¸ƒå±€ä¸­é¢„è§ˆ fragment ä¸­çš„å¸ƒå±€æ•ˆæœã€‚ tools:showIn è¿™ä¸ªå±æ€§å°±æ¯”è¾ƒå¥½ç©äº†ï¼Œå®ƒå¯ä»¥æŒ‡å®šå…¶ä»–å¸ƒå±€æ–‡ä»¶åƒ &lt;include&gt; ç»„ä»¶ä¸€æ ·åœ¨å½“å‰å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨å’Œé¢„è§ˆ &lt;include&gt; æ§ä»¶çš„å®é™…æ•ˆæœã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ card_item_layout.xml ä½œä¸º showIn çš„å¯¹è±¡ç»™ show_in_layout.xml å¸ƒå±€ä½¿ç”¨ï¼Œç„¶åæˆ‘å°±å¯ä»¥çœ‹åˆ° show_in_layout.xml ä¸­å¦‚ä¸‹æ•ˆæœï¼š tools:menu è¿™ä¸ªå±æ€§å¯ä»¥ç»™å½“å‰å¸ƒå±€é¢„è§ˆå™¨çš„ Toolbar æ·»åŠ å¤šä¸ªèœå•é¡¹ï¼Œä½†ä»…é™äºå¸ƒå±€æ–‡ä»¶çš„æ ¹èŠ‚ç‚¹å…ƒç´ ã€‚å¦‚ï¼š 1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:orientation=\"vertical\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:menu=\"menu1,menu2\" /&gt; tools:maxValue | tools:minValue è¿™ä¸¤ä¸ªå±æ€§ä»…ç”¨äº *&lt;NumberPicker&gt;*ï¼Œå¯ä»¥åœ¨é¢„è§ˆæ—¶æŒ‡å®šå…¶æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š 12345678&lt;NumberPicker xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/numberPicker\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" tools:minValue=\"0\" tools:maxValue=\"10\" /&gt; tools:listitem | tools:listheader | tools:listfooter | tools:listCount ä¸‹é¢æ¥è®²ä¸€ä¸‹åˆ—è¡¨ç›¸å…³ç»„ä»¶çš„ tools å±æ€§ã€‚ä¸Šé¢å››ä¸ªå±æ€§ä»…ç”¨äº &lt;AdapterView&gt; åŠå…¶å­ç±»ï¼ˆå¦‚ï¼šListView å’Œ RecyclerViewï¼‰ã€‚ç„¶è€Œï¼Œå®ƒä»¬å†…éƒ¨ä»æœ‰ä¸€äº›ä½¿ç”¨é™åˆ¶ï¼š*tools:listCount* ä»…ç”¨äº RecyclerViewï¼›*tools:listheader* å’Œ tools:listfooter ä»…é™äº ListViewï¼›è‡³äº tools:listitem å±æ€§äºŒè€…çš†å¯ç”¨ã€‚ä¹‹å‰çš„æ•ˆæœå›¾å°±æ˜¯å€ŸåŠ©äºæ­¤å±æ€§ï¼š activity_main.xmlï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\".MainActivity\" android:background=\"#ffEBEBEF\"&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"0dp\" android:layout_height=\"wrap_content\" android:background=\"?attr/colorPrimary\" android:theme=\"?attr/actionBarTheme\" android:minHeight=\"?attr/actionBarSize\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" android:elevation=\"1dp\" app:title=\"@string/app_name\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintHorizontal_bias=\"0.0\"/&gt; &lt;android.support.v7.widget.RecyclerView android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\" android:scrollbars=\"vertical\" app:layout_constraintTop_toBottomOf=\"@+id/toolbar\" app:layout_constraintHorizontal_bias=\"0.0\" app:layout_constraintVertical_bias=\"0.0\" tools:listitem=\"@layout/card_item_layout\"/&gt;&lt;/android.support.constraint.ConstraintLayout&gt; sample dataå³ æ ·æœ¬æ•°æ® åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ @tools:sample æ¥ä½¿ç”¨è¯¥å±æ€§ï¼Œä¹Ÿå±äº design-time view attributesã€‚ä½†å®ƒå¹¶éåªæ˜¯ä¸€ä¸ªå±æ€§é‚£ä¹ˆç®€å•ï¼Œæ›´åº”è¯¥ç®—æ˜¯ä¸€ä¸ªâ€œå·¥å…·åˆ©å™¨â€ï¼Œæ‰€ä»¥ä¼šå°†å…¶å•ç‹¬æ‹¿å‡ºæ¥è¯¦ç»†ä»‹ç»ã€‚è¿™ä¸ªå·¥å…·æ˜¯æœ¬å¹´åº¦ Google å¤§ä¼šä¸Š Android å¼€å‘å›¢é˜Ÿç‰¹åˆ«ä»‹ç»çš„ä¸€ä¸ªæ–°æ¨å±æ€§ã€‚å®ƒæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿç”¨å¤„å¤§äº†ï¼å…ˆå‰çš„å¸ƒå±€é¢„è§ˆä½¿ç”¨çš„æ•°æ®éƒ½æ˜¯æˆ‘ä»¬ç›´æ¥åœ¨å¸ƒå±€æ§ä»¶ä¸­æ³¨æ˜æˆ–è€…åœ¨ strings.xml æ–‡ä»¶ä¸­ç»™å‡ºçš„ï¼Œè¿™ä¸€å°±ä¼šäº§ç”Ÿä¸€äº›è„æ•°æ®ï¼Œä¸åˆ©äºæˆ‘ä»¬åæœŸçš„å¤„ç†ã€‚è€Œæœ‰äº† sample dataï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å¸ƒå±€é¢„è§ˆå™¨ä¸­çš„ â€œæ ·æœ¬æ•°æ®â€è¿›è¡Œé›†ä¸­ä¿å­˜å’Œç®¡ç†äº†ã€‚ ä¸€ã€sample data çš„ä½¿ç”¨Android studio å·²ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ ·æœ¬æ•°æ®ï¼Œæˆ‘å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ï¼š Attribute value Description of placeholder data @tools:sample/full_names Full names that are randomly generated from the combination of@tools:sample/first_names and @tools:sample/last_names. @tools:sample/first_names Common first names. @tools:sample/last_names Common last names. @tools:sample/cities Names of cities from across the world. @tools:sample/us_zipcodes Randomly generated US zipcodes. @tools:sample/us_phones Randomly generated phone numbers with the following format: (800) 555-xxxx. @tools:sample/lorem Placeholder text that is derived from Latin. @tools:sample/date/day_of_week Randomized dates and times for the specified format. @tools:sample/date/ddmmyy @tools:sample/date/mmddyy @tools:sample/date/hhmm @tools:sample/date/hhmmss @tools:sample/avatars Vector drawables that you can use as profile avatars. @tools:sample/backgrounds/scenic Images that you can use as backgrounds. ä¸Šè¿°è¡¨æ ¼ä¸­ä¸ä»…æœ‰å¸¸ç”¨æ–‡æœ¬æ•°æ®å’Œæ—¥æœŸç­‰æ•°æ®ï¼Œè¿˜æä¾›äº†ä¸€äº›å›¾ç‰‡æ ·æœ¬æ•°æ®ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åˆ‡æ¢åˆ°å¸ƒå±€é¢„è§ˆç•Œé¢ï¼Œå¹¶æ‹–åŠ¨ä¸€ä¸ª ImageView åˆ°é¢æ¿ä¸Šï¼Œç„¶å Android studio å°±ä¼šå¼¹å‡ºå¦‚ä¸‹ç•Œé¢ï¼š ç„¶åé€‰æ‹© avatars æˆ–è€… background/scenic æ•°æ®æºå°±å¯ä»¥äº†ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ xml ä»£ç å½¢å¼æ¥è®¾ç½®ï¼š 12345678910111213141516171819202122232425262728293031&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.constraint.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:background=\"@android:color/white\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;ImageView android:layout_width=\"36dp\" android:layout_height=\"36dp\" android:id=\"@+id/imageView\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintStart_toStartOf=\"parent\" android:layout_marginStart=\"16dp\" tools:srcCompat=\"@tools:sample/avatars\"/&gt; &lt;TextView android:layout_width=\"0dp\" android:layout_height=\"wrap_content\" android:id=\"@+id/textView\" app:layout_constraintStart_toEndOf=\"@+id/imageView\" android:layout_marginStart=\"8dp\" app:layout_constraintEnd_toEndOf=\"parent\" android:layout_marginEnd=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" tools:text=\"@tools:sample/lorem/random\" tools:maxLines=\"8\" android:ellipsize=\"end\" android:textSize=\"14sp\" android:textColor=\"@color/title_color\" android:layout_marginTop=\"16dp\" app:layout_constraintHorizontal_bias=\"0.0\"/&gt;&lt;/android.support.constraint.ConstraintLayout&gt; åŒæ ·åœ°ï¼ŒTextView ä¹Ÿå¯ä»¥é€šè¿‡ @tools:sample/lorem/random æ¥æ·»åŠ æ ·æœ¬æ•°æ®ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š å“ˆå“ˆï¼Œè¿˜ä¸é”™å§ğŸ˜„ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç”¨è‡ªå·±çš„æ ·æœ¬æ•°æ®æºå‘¢ï¼Ÿ äºŒã€è‡ªå®šä¹‰ sample dataå¦‚æœæˆ‘ä»¬æƒ³è¦æ˜¯ç”¨è‡ªå·±å®šåˆ¶åŒ–çš„æ ·ä¾‹æ•°æ®ï¼Œè¯¥å¦‚ä½•åšå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ app ç›®å½•ä¸‹åˆ›å»º sample data directory å°±å¯ä»¥äº†ï¼š æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨é‡Œé¢å®šåˆ¶æˆ‘ä»¬è‡ªå·±çš„æ•°æ®äº†ï¼Œåœ¨åˆšå»ºå¥½çš„ sampledata ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª txt æ ¼å¼çš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚ usersï¼Œç„¶ååœ¨é‡Œé¢åˆ›å»ºå¦‚ä¸‹æ•°æ®ï¼š å¦‚æ­¤è¿™èˆ¬ï¼ŒåŒç†åˆ›å»ºæˆ‘ä»¬çš„å…¶ä»–æ•°æ®ï¼š titlesã€descriptionsï¼Œç„¶ååœ¨ä¸Šè¿° card_item_layout.xml å¸ƒå±€æ–‡ä»¶ä¸­æ›¿æ¢å¹¶ä½¿ç”¨è‡ªå·±çš„æ•°æ®æºï¼š 1234567891011121314&lt;TextView android:id=\"@+id/card_item_username\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintStart_toStartOf=\"@+id/card_item_title\" app:layout_constraintEnd_toEndOf=\"@+id/card_item_title\" app:layout_constraintHorizontal_bias=\"0.0\" android:textSize=\"12sp\" android:textColor=\"#8989ae\" android:layout_marginEnd=\"16dp\" android:paddingEnd=\"16dp\" tools:text=\"@sample/users\" /&gt; è¿™é‡Œä»…ä»¥å…¶ä¸­ä¸€ä¸ª TextView ä¸¾ä¾‹è¯´æ˜ï¼Œå…¶ä»–åŒç†ã€‚ ä»€ä¹ˆï¼Ÿä½ ä»¥ä¸ºåˆ°è¿™é‡Œå°±è®²å®Œäº†ï¼Ÿå“ˆå“ˆï¼Œå°‘å¹´ï¼Œçœ‹ä½ éª¨éª¼æƒŠå¥‡ï¼Œå†æ•™ä½ ä¸€æ‹›æ¥ä¸Šå¤©å…¥åœ°ï¼šé€šè¿‡è‡ªå®šä¹‰ Json æ ¼å¼çš„ æ•°æ®æ¥ä¸ºæ§ä»¶ç»‘å®šæ•°æ®ï¼š æ‰“å®Œæ”¶å·¥ğŸ‘‹ï¼Œè¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œæ¥çœ‹çœ‹å¦‚ä½•é€šè¿‡ json æ•°æ®æ¥ç»‘å®šï¼š 1234567891011121314&lt;TextView android:id=\"@+id/card_item_username\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\" app:layout_constraintStart_toStartOf=\"@+id/card_item_title\" app:layout_constraintEnd_toEndOf=\"@+id/card_item_title\" app:layout_constraintHorizontal_bias=\"0.0\" android:textSize=\"12sp\" android:textColor=\"#8989ae\" android:layout_marginEnd=\"16dp\" android:paddingEnd=\"16dp\" tools:text=\"@sample/sample.json/data/username\" /&gt; ä»¥ä¸Šæ“ä½œçš„æ—¶å€™ Android studio éƒ½ä¼šè‡ªåŠ¨æç¤º sampledata è·¯å¾„ä¸‹çš„æ•°æ®æ–‡ä»¶ï¼ŒJson æ ¼å¼äº¦ä¼šæç¤ºåˆ°å…·ä½“å­—æ®µã€‚ æœ€åä» Google Android å®˜æ–¹çš„è¿›ä¸€æ­¥åŠ¨å‘æ¥çœ‹ï¼Œåç»­Androidæ›´æ–°è¿‡ç¨‹ä¸­ï¼Œå¸ƒå±€ç¼–è¾‘å™¨å°†æ›´åŠ å¼ºå¤§ã€‚ä» Tools attributes åˆ° ConstraintLayout1.1 å†åˆ°å³å°†åˆ°æ¥çš„ ConstraintLayout2.0 ä¸­çš„ MotionLayoutï¼Œæˆ‘ä»¬å¯ä»¥é¢„è§ï¼šAndroid å°†åœ¨ UI æ¸²æŸ“å’ŒåŠ¨ç”»å®ç°æ–¹é¢è¿›ä¸€æ­¥è§£æ”¾æˆ‘ä»¬çš„åŒæ‰‹ã€‚åç»­æˆ‘å°†ç»§ç»­ä¸ºå¤§å®¶å¸¦æ¥ç³»åˆ—æ–‡ç« ï¼Œæ•¬è¯·æœŸå¾…ğŸŒˆã€‚","link":"/2019/08/11/android-tools-attribute/"},{"title":"å¸¦ä½ é¢†ç•¥ ConstraintLayout 1.1 çš„æ–°åŠŸèƒ½","text":"åŸæ–‡åœ°å€ï¼šIntroducing Constraint Layout 1.1 åŸæ–‡ä½œè€…ï¼šSean McQuillan çº¦æŸå¸ƒå±€ï¼ˆConstraintLayoutï¼‰é€šè¿‡ä½¿ç”¨ Android Studio ä¸­çš„å¯è§†åŒ–ç¼–è¾‘å™¨æ¥ä¸ºæ‚¨ç”Ÿæˆç»å¤§å¤šæ•°çš„ UIï¼Œè¿›è€Œè¾¾åˆ°ç®€åŒ– Android ä¸­åˆ›å»ºå¤æ‚å¸ƒå±€çš„ç›®çš„ã€‚å®ƒé€šå¸¸è¢«æˆ‘ä»¬æè¿°ä¸ºæ›´åŠ å¼ºå¤§çš„ RelativeLayoutã€‚é€šè¿‡ä½¿ç”¨çº¦æŸå¸ƒå±€ï¼Œæ‚¨å¯ä»¥å®šä¹‰ä¸€äº›å¤æ‚çš„å¸ƒå±€è€Œä¸éœ€è¦åˆ›å»ºå¤æ‚çš„è§†å›¾å±‚çº§ã€‚ çº¦æŸå¸ƒå±€æœ€è¿‘å‘å¸ƒäº† 1.1 ç¨³å®šç‰ˆæœ¬ï¼Œå¹¶è¿…é€Ÿè·å¾—å¤§é‡å¥½è¯„ã€‚å…¨é¢çš„ä¼˜åŒ–æ”¹è¿›å¯ä»¥è®©å¤šæ•°å¸ƒå±€çš„è¿è¡Œé€Ÿåº¦æ¯”ä»¥å‰æ›´å¿«ï¼Œå±éšœå’Œç¾¤ç»„ç­‰æ–°åŠŸèƒ½ä½¿ç°å®ç”Ÿæ´»çš„è®¾è®¡å˜å¾—ç®€å•ï¼ Android Gradle123dependencies { compile 'com.android.support.constraint:constraint-layout:1.1.0'} å¦‚æœæ‚¨æƒ³è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ–°ç‰¹æ€§ï¼Œéœ€è¦æ·»åŠ  ConstraintLayout 1.1 ç‰ˆæœ¬ä½œä¸ºä¾èµ–ã€‚ 1.1 ç‰ˆæœ¬ä¸­çš„æ–°ç‰¹æ€§ç™¾åˆ†æ¯”åœ¨çº¦æŸå¸ƒå±€ 1.0 ç‰ˆæœ¬ä¸­ï¼Œéœ€è¦ä½¿ç”¨ä¸¤æ¡å¼•å¯¼çº¿æ‰èƒ½è®©è§†å›¾æ ¹æ®ç™¾åˆ†æ¯”æ¥å æ®å±å¹•ã€‚è€Œåœ¨çº¦æŸå¸ƒå±€ 1.1 ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡å…è®¸æ‚¨è½»æ¾åœ°å°†ä»»ä½•è§†å›¾é™åˆ¶ä¸ºç™¾åˆ†æ¯”å®½åº¦æˆ–é«˜åº¦ï¼Œä¸€åˆ‡å°†å˜å¾—å¾ˆç®€å•ã€‚ ä½¿ç”¨ç™¾åˆ†æ¯”æŒ‡å®šæŒ‰é’®çš„å®½åº¦ï¼Œä»¥ä¾¿åœ¨ä¿æŒè®¾è®¡æ•ˆæœçš„åŒæ—¶é€‚åº”å¯ç”¨ç©ºé—´ã€‚ æ‰€æœ‰è§†å›¾éƒ½æ”¯æŒ layout_constraintWidth_percent å’Œ layout_constraintHeight_percent å±æ€§ã€‚è¿™äº›å°†å¯¼è‡´çº¦æŸè¢«å›ºå®šåœ¨å¯ç”¨ç©ºé—´æŒ‡å®šç™¾åˆ†æ¯”ä½ç½®ã€‚ å› æ­¤ï¼Œä½¿ç”¨å‡ è¡Œ XML ä»£ç å°±å¯ä»¥ä½¿ Button æˆ– TextView å±•å¼€å¹¶ä»¥ç™¾åˆ†æ¯”å¡«å……å±å¹•ã€‚ 1234&lt;Button android:layout_width=&quot;0dp&quot; android:layout_height=&quot;wrap_content&quot; app:layout_constraintWidth_percent=&quot;0.7&quot; /&gt; é“¾æ¡é€šè¿‡é“¾æ¡åŠŸèƒ½æ¥æ”¾ç½®å¤šä¸ªå…ƒç´ å¯ä»¥è®©ä½ é…ç½®å®ƒä»¬è¯¥å¦‚ä½•å¡«å……å¯ç”¨ç©ºé—´ã€‚åœ¨ 1.1 ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä¿®å¤äº†é“¾æ¡çš„ä¸€äº›é—®é¢˜ï¼Œå¹¶ä½¿å®ƒä»¬èƒ½å¤Ÿå¤„ç†æ›´å¤šçš„è§†å›¾ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ä¸¤è¾¹æ·»åŠ çº¦æŸæ¥ç”Ÿæˆä¸€ä¸ªé“¾æ¡ã€‚ä¾‹å¦‚åœ¨ä¸‹é¢è¿™ä¸ªåŠ¨ç”»ä¸­ï¼Œæ¯ä¸ªè§†å›¾ä¹‹é—´éƒ½æœ‰ä¸€ä¸ªçº¦æŸã€‚ é€šè¿‡ spreadï¼Œspread_inside å’Œ packedï¼Œé“¾æ¡èƒ½å¤Ÿè®©æ‚¨é…ç½®å¦‚ä½•å¸ƒç½®å¤šä¸ªç›¸å…³çš„è§†å›¾ã€‚ app:layout_constraintVertical_chainStyle å±æ€§å¯ä»¥ä½œç”¨äºé“¾æ¡ä¸­çš„ä»»ä½•è§†å›¾ã€‚ æ‚¨å¯ä»¥è®¾ç½®å®ƒçš„å€¼ä¸º spreadï¼Œspread_inside æˆ–è€… packedã€‚ spreadï¼šå‡åŒ€åˆ†é…é“¾ä¸­çš„æ‰€æœ‰è§†å›¾ spread_insideï¼šå°†ç¬¬ä¸€ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ æ”¾ç½®åœ¨è¾¹ç¼˜ä¸Šï¼Œå¹¶å‡åŒ€åˆ†å¸ƒå…¶ä½™å…ƒç´  packedï¼šå°†å…ƒç´ åŒ…è£¹åœ¨é“¾æ¡çš„ä¸­å¿ƒ å±éšœå¦‚æœæ‚¨æœ‰å‡ ä¸ªè§†å›¾ä¼šåœ¨è¿è¡Œæ—¶æ›´æ”¹å¤§å°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å±éšœåŠŸèƒ½æ¥çº¦æŸå…ƒç´ ã€‚æ‚¨å¯ä»¥å°†å±éšœæ”¾ç½®äºå‡ ä¸ªå…ƒç´ çš„å¼€å§‹ï¼Œé¡¶éƒ¨ï¼Œæœ«å°¾æˆ–åº•éƒ¨ã€‚æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºåˆ¶ä½œè™šæ‹Ÿç»„çš„ä¸€ç§æ–¹å¼ ï¼Œå› ä¸ºå®ƒä¸ä¼šå°†æ­¤ç»„æ·»åŠ åˆ°è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ã€‚ åœ¨å¸ƒç½®å›½é™…åŒ–å­—ç¬¦ä¸²æˆ–æ˜¾ç¤ºç”¨æˆ·ç”Ÿæˆçš„æ— æ³•é¢„æµ‹å¤§å°çš„å†…å®¹æ—¶ï¼Œå±éšœéå¸¸æœ‰ç”¨ã€‚ å±éšœå…è®¸æ‚¨é€šè¿‡å‡ ä¸ªè§†å›¾æ¥åˆ›å»ºä¸€ä¸ªçº¦æŸã€‚ å±éšœå°†å§‹ç»ˆå°†è‡ªå·±ç½®äºè™šæ‹Ÿç¾¤ç»„ä¹‹å¤–ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥é™åˆ¶å…¶ä»–è§†å›¾ã€‚åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³è§†å›¾è¢«é™åˆ¶ä¸ºå§‹ç»ˆå¤„äºæœ€å¤§æ–‡æœ¬è§†å›¾çš„æœ«å°¾ã€‚ ç¾¤ç»„æœ‰æ—¶æ‚¨éœ€è¦ä¸€æ¬¡æ˜¾ç¤ºæˆ–éšè—å¤šä¸ªå…ƒç´ ã€‚ä¸ºäº†æ”¯æŒè¿™ä¸ªï¼Œçº¦æŸå¸ƒå±€å¢åŠ äº†ç¾¤ç»„åŠŸèƒ½ã€‚ ä¸€ä¸ªç¾¤ç»„å¹¶æ²¡æœ‰å¢åŠ è§†å›¾çš„å±‚çº§â€”â€”è¿™å®é™…ä¸Šåªæ˜¯ä¸€ç§æ ‡è®°è§†å›¾çš„æ–¹å¼ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ ‡è®° profile_name å’Œ profile_image ä»¥ä¾› id é…ç½®æ–‡ä»¶å¼•ç”¨ã€‚ å½“æ‚¨æœ‰å¤šä¸ªéœ€è¦æ˜¾ç¤ºæˆ–é™ˆåˆ—åœ¨ä¸€èµ·çš„å…ƒç´ æ—¶ï¼Œè¿™å°†å¾ˆæœ‰ç”¨ã€‚ 123&lt;android.support.constraint.Group android:id=&quot;@+id/profile&quot; app:constraint_referenced_ids=&quot;profile_name,profile_image&quot; /&gt; å½“å®šä¹‰åä¸º profile çš„ç¾¤ç»„åï¼Œæ‚¨å¯ä»¥ä¸ºè¯¥ç¾¤ç»„è®¾ç½®å¯è§æ€§ï¼Œå¹¶å°†å…¶åº”ç”¨äº profile_name å’Œ profile_imageã€‚ 123profile.visibility = GONEprofile.visibility = VISIBLE åœ†å½¢çº¦æŸåœ¨çº¦æŸå¸ƒå±€ä¸­ï¼Œå¤§å¤šæ•°çº¦æŸç”±å±å¹•å°ºå¯¸æŒ‡å®šâ€”â€”æ°´å¹³å’Œå‚ç›´ã€‚åœ¨çº¦æŸå¸ƒå±€ 1.1 ç‰ˆæœ¬ä¸­ï¼Œæœ‰ä¸€ä¸ªæ–°çš„ç±»å‹çº¦æŸ constraintCircleï¼Œå®ƒå…è®¸æ‚¨æŒ‡å®šæ²¿ç€ä¸€ä¸ªåœ†å½¢è¿›è¡Œçº¦æŸã€‚æ‚¨ä¸å¿…æä¾›æ°´å¹³å’Œå‚ç›´è¾¹è·ï¼Œè€Œæ˜¯æŒ‡å®šåœ†çš„è§’åº¦å’ŒåŠå¾„ã€‚è¿™å¯¹äºåƒå¾„å‘èœå•è¿™æ ·çš„è§’åº¦åç§»çš„è§†å›¾å°†éå¸¸æœ‰ç”¨ï¼ æ‚¨å¯ä»¥é€šè¿‡æŒ‡å®šè¦åç§»çš„åŠå¾„å’Œè§’åº¦æ¥åˆ›å»ºå¾„å‘èœå•ã€‚ åˆ›å»ºåœ†å½¢çº¦æŸæ—¶ï¼Œè¯·æ³¨æ„ï¼Œè§’åº¦ä»é¡¶éƒ¨å¼€å§‹å¹¶é¡ºæ—¶é’ˆè¿›è¡Œã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å°†æŒ‰å¦‚ä¸‹æ–¹å¼æŒ‡å®šä¸­é—´çš„ fabï¼š 12345&lt;android.support.design.widget.FloatingActionButton android:id=&quot;@+id/middle_expanded_fab&quot; app:layout_constraintCircle=&quot;@+id/fab&quot; app:layout_constraintCircleRadius=&quot;50dp&quot; app:layout_constraintCircleAngle=&quot;315&quot; /&gt; çº¦æŸé›†ä¸åŠ¨ç”»æ‚¨å¯ä»¥å°† ConstraintLayout éšåŒ ConstraintSet (çº¦æŸé›†)ä¸€èµ·ä½¿ç”¨æ¥ä¸€æ¬¡å®ç°å¤šä¸ªå…ƒç´ çš„åŠ¨ç”»æ•ˆæœã€‚ ä¸€ä¸ª ConstraintSet ä»…æŒæœ‰ä¸€ä¸ª ConstraintLayout çš„çº¦æŸã€‚ä½ å¯ä»¥åœ¨ä»£ç ä¸­åˆ›å»ºä¸€ä¸ªConstraintSetï¼Œæˆ–è€…ä»ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ä¸­åŠ è½½å®ƒã€‚ç„¶åï¼Œæ‚¨å¯ä»¥å°† ConstraintSet åº”ç”¨äº ConstraintLayoutï¼Œæ›´æ–°æ‰€æœ‰çº¦æŸä»¥åŒ¹é… ConstraintSet ä¸­çš„çº¦æŸã€‚ è¦ä½¿å…¶å…·æœ‰åŠ¨ç”»æ•ˆæœï¼Œè¯·ä½¿ç”¨ support library ä¸­çš„ TransitionManager.beginDelayedTransition() æ–¹æ³•ã€‚æ­¤åŠŸèƒ½å°†ä½¿æ‚¨çš„ ConstraintSet ä¸­çš„æ‰€æœ‰å¸ƒå±€çš„æ›´æ–°éƒ½é€šè¿‡åŠ¨ç”»æ¥å‘ˆç°ã€‚ è¿™æ˜¯ä¸€ä¸ªæ›´æ·±å…¥åœ°æ¶µç›–äº†è¿™ä¸ªè¯é¢˜çš„è§†é¢‘ï¼š YouTube è§†é¢‘é“¾æ¥ï¼šhttps://youtu.be/OHcfs6rStRo æ–°çš„ä¼˜åŒ–çº¦æŸå¸ƒå±€ 1.1 ç‰ˆæœ¬ä¸­æ·»åŠ äº†å‡ ä¸ªæ–°çš„ä¼˜åŒ–ç‚¹ï¼Œå¯åŠ å¿«æ‚¨çš„å¸ƒå±€é€Ÿåº¦ã€‚è¿™äº›ä¼˜åŒ–ç‚¹ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„é€šé“è¿è¡Œï¼Œå¹¶å°è¯•å‡å°‘å¸ƒå±€è§†å›¾æ‰€éœ€çš„çº¦æŸæ•°é‡ã€‚ æ€»çš„æ¥è¯´ï¼Œå®ƒä»¬æ˜¯é€šè¿‡åœ¨å¸ƒå±€ä¸­å¯»æ‰¾å¸¸é‡å¹¶ç®€åŒ–å®ƒä»¬æ¥è¿ä½œçš„ã€‚ æœ‰ä¸€ä¸ªåä¸º layout_optimizationLevel çš„æ–°æ ‡ç­¾ï¼Œç”¨äºé…ç½®ä¼˜åŒ–çº§åˆ«ã€‚å®ƒå¯ä»¥è®¾ç½®ä¸ºä»¥ä¸‹å†…å®¹ï¼š barriersï¼šæ‰¾å‡ºå±éšœæ‰€åœ¨ï¼Œå¹¶ç”¨ç®€å•çš„çº¦æŸå–ä»£å®ƒä»¬ directï¼šä¼˜åŒ–é‚£äº›ç›´æ¥è¿æ¥åˆ°å›ºå®šå…ƒç´ çš„å…ƒç´ ï¼Œä¾‹å¦‚å±å¹•è¾¹ç¼˜æˆ–å¼•å¯¼çº¿ï¼Œå¹¶ç»§ç»­ä¼˜åŒ–ç›´æ¥è¿æ¥åˆ°å®ƒä»¬çš„ä»»ä½•å…ƒç´ ã€‚ standardï¼šè¿™æ˜¯åŒ…å« barriers å’Œ direct çš„é»˜è®¤ä¼˜åŒ–çº§åˆ«ã€‚ dimensionsï¼šç›®å‰å¤„äºå®éªŒé˜¶æ®µï¼Œå¹¶ä¸”å¯èƒ½ä¼šåœ¨æŸäº›å¸ƒå±€ä¸Šå‡ºç°é—®é¢˜â€”â€”å®ƒä¼šé€šè¿‡è®¡ç®—ç»´åº¦æ¥ä¼˜åŒ–å¸ƒå±€ä¼ é€’ã€‚ chainsï¼šç›®å‰æ­£åœ¨å®éªŒé˜¶æ®µï¼Œå¹¶è®¡ç®—å‡ºå¦‚ä½•å¸ƒç½®å›ºå®šå°ºå¯¸çš„å…ƒç´ é“¾ã€‚ å¦‚æœä½ æƒ³å°è¯•è¯•éªŒæ€§çš„ä¼˜åŒ–ä¸Šè¿°ä¸­çš„ dimensions å’Œ chainsï¼Œä½ å¯ä»¥åœ¨ ConstraintLayout ä¸­é€šè¿‡å¦‚ä¸‹ä»£ç æ¥å¯ç”¨å®ƒä»¬ï¼š 12&lt;android.support.constraint.ConstraintLayout app:layout_optimizationLevel=&quot;standard|dimensions|chains&quot; å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Ÿä¸å¦‚ç»™ Sean McQuillan ä¸€ç‚¹é¼“åŠ±ã€‚ äº†è§£æ›´å¤š ä½¿ç”¨çº¦æŸå¸ƒå±€æ„å»ºå“åº”å¼ UI | Android Developers çº¦æŸå¸ƒå±€ | Android Developers ä½¿ç”¨çº¦æŸå¸ƒå±€æ¥è®¾è®¡ä½ çš„ Android è§†å›¾ æƒ³è¦äº†è§£æœ‰å…³çº¦æŸå¸ƒå±€ 1.1 ç‰ˆæœ¬çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£å’Œä»£ç å®éªŒå®¤ï¼","link":"/2018/05/20/constraintlayout/"},{"title":"Androidå®ç°ç¤¾äº¤åº”ç”¨ä¸­çš„è¯„è®ºå’Œå›å¤åŠŸèƒ½","text":"æœ¬æ–‡å·²æˆæƒå¾®ä¿¡å…¬ä¼—å·hongyangAndroid(å¼ é¸¿æ´‹)ç‹¬å®¶å‘å¸ƒ. åœ¨Androidçš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œè¯„è®ºä¸å›å¤åŠŸèƒ½æ˜¯æˆ‘ä»¬ç»å¸¸é‡åˆ°çš„éœ€æ±‚ä¹‹ä¸€ï¼Œå…¶ä¸­è¯„è®ºä¸å›å¤åˆ—è¡¨çš„å±•ç¤ºä¸€èˆ¬åœ¨åŠŸèƒ½æ¨¡å—ä¸­å æ¯”è¾ƒå¤§ã€‚å¯¹äºéœ€æ±‚æ”¹åŠ¨å’Œè¿­ä»£è¾ƒé¢‘ç¹çš„å…¬å¸æ¥è¯´ï¼Œå¦‚ä½•å¿«é€Ÿå¼€å‘ä¸€ä¸ªäºŒçº§ç•Œé¢æ¥é€‚åº”æˆ‘ä»¬çš„åŠŸèƒ½éœ€æ±‚æ— ç–‘ä¼˜å…ˆçº§æ›´é«˜ä¸€äº›ã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä»–ç¤¾äº¤ç±»appçš„è¯„è®ºä¸å›å¤åˆ—è¡¨å¦‚ä½•å±•ç¤ºçš„ï¼š Twitterä¸ç”¨è¯´äº†ï¼Œå…¨çƒçŸ¥åç¤¾äº¤å¹³å°ï¼Œä¸Šäº¿ç”¨æˆ·é‡ï¼Œä»–ä»¬çš„è¯„è®ºå›å¤éƒ½åªå±•ç¤ºä¸€çº§æ•°æ®(è¯„è®ºæ•°æ®)ï¼Œå…¶ä»–æ›´å¤šå†…å®¹ï¼ˆå›å¤å†…å®¹ï¼‰ï¼Œæ˜¯éœ€è¦é¡µé¢è·³è½¬å»æŸ¥çœ‹ï¼ŒçŸ¥ä¹ä¹Ÿç±»ä¼¼ã€‚ç¬¬ä¸€å¼ å›¾æ˜¯æˆ‘ä»¬è®¾è®¡ç»™æˆ‘æ‰¾çš„ï¼Œä»–è¯´è¦æŒ‰ç…§è¿™ä¸ªé£æ ¼æ¥ï¼Œå°½é‡å°†è¯„è®ºå’Œå›å¤å†…å®¹åœ¨ä¸€ä¸ªé¡µé¢å±•ç¤ºã€‚å¥½å§ï¼Œæ²¡åŠæ³•ï¼Œæ¯•ç«Ÿæˆ‘ä»¬åšå‰ç«¯çš„ï¼ŒUIè¦çœ‹è®¾è®¡è„¸è‰²ï¼Œæ•°æ®è¦çœ‹åå°è„¸è‰²ğŸ˜‚ã€‚çœ‹åˆ°è®¾è®¡å›¾ï¼Œæˆ‘ä»¬è„‘æµ·è‚¯å®šç¬¬ä¸€æ—¶é—´è”æƒ³ä¸€ä¸‹è§£å†³æ–¹æ¡ˆï¼šç”¨recyclerviewï¼Ÿlistviewï¼Ÿä¸å¯¹ï¼Œåˆ†æä¸€ä¸‹å®ƒçš„å±‚çº§å‘ç°ï¼Œè¯„è®ºæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢çš„å›å¤åˆæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œéš¾é“ç”¨recyclerviewæˆ–è€…listviewçš„åµŒå¥—ï¼ŸæŠ±ç€ä¸ç¡®å®šçš„æ€åº¦ï¼Œç«‹é©¬å»ç½‘ä¸ŠæŸ¥ä¸€ä¸‹ï¼Œæœä¸å…¶ç„¶ï¼Œæœåˆ°çš„å®ç°æ–¹å¼å¤§å¤šéƒ½æ˜¯ç”¨åµŒå¥—å®ç°çš„ï¼Œæ¥å…¬å¸ä¹‹å‰ï¼Œå…¶ä¸­ä¸€ä¸ªé¡¹ç›®é‡Œçš„è¯„è®ºå›å¤åŠŸèƒ½å°±æ˜¯ç”¨çš„åµŒå¥—listviewï¼Œè™½ç„¶å¤„ç†äº†æ»‘åŠ¨å†²çªé—®é¢˜ï¼Œä½†æ•ˆæœä¸ä½³ï¼Œè€Œä¸”æ—¶å¸¸å¡é¡¿ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘è‚¯å®šè¦æ¢ä¸ªæ€è·¯ã€‚ ç½‘ä¸Šè¿˜æœ‰è¯´ç”¨è‡ªå®šä¹‰viewå®ç°çš„ï¼Œä½†æˆ‘å‘ç°å¤§å¤šæ²¡æœ‰å¤„ç†viewçš„å¤ç”¨ï¼Œè€Œä¸”å¼€å‘æˆæœ¬å¤§ï¼Œæš‚æ—¶ä¸äºˆè€ƒè™‘ã€‚é‚£æ€ä¹ˆåŠï¼Ÿæ— æ„ä¸­çœ‹åˆ°expandableè¿™ä¸ªå…³é”®è¯ï¼Œæˆ‘çªç„¶æƒ³åˆ°è°·æ­Œå¾ˆæ—©ä¹‹å‰å‡ºè¿‡ä¸€ä¸ªæ‰©å±•åˆ—è¡¨çš„æ§ä»¶ - ExpandableListViewï¼Œä½†å¬è¯´æ¯”è¾ƒè€ï¼Œå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚ç®—äº†ï¼Œè¯•è¯•å†è¯´ï¼Œé¡ºä¾¿ç†Ÿæ‚‰ä¸€ä¸‹ä»¥å‰åŸºç¡€æ§ä»¶çš„ç”¨æ³•ã€‚ å…ˆæ¥çœ‹ä¸€ä¸‹æœ€ç»ˆçš„æ•ˆæœå›¾å§ï¼š è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„æ•ˆæœå›¾ï¼Œä½ å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ¥å®Œå–„å®ƒã€‚å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœå…·ä½“å¦‚ä½•å®ç°çš„å§ã€‚å¤§å®¶åº”è¯¥ä¸éš¾çœ‹å‡ºæ¥ï¼Œé¡µé¢æ•´ä½“é‡‡ç”¨äº†CoordinatorLayoutæ¥å®ç°è¯¦æƒ…é¡µçš„é¡¶éƒ¨è§†å·®æ•ˆã€‚åŒæ—¶ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨ExpandableListViewæ¥å®ç°å¤šçº§åˆ—è¡¨ï¼Œç„¶åå†è§£å†³å®ƒä»¬çš„åµŒå¥—æ»‘åŠ¨é—®é¢˜ã€‚OKï¼Œæˆ‘ä»¬å…ˆä»ExpandableListViewå¼€å§‹åŠ¨æ‰‹ã€‚ ExpandableListViewå®˜æ–¹å¯¹äºExpandableListViewç»™å‡ºè¿™æ ·çš„è§£é‡Šï¼šA view that shows items in a vertically scrolling two-level list. This differs from the ListView by allowing two levels: groups which can individually be expanded to show its children. The items come from the ExpandableListAdapter associated with this view. ç®€å•æ¥è¯´ï¼ŒExpandableListViewæ˜¯ä¸€ä¸ªç”¨äºå‚ç›´æ–¹å‘æ»šåŠ¨çš„äºŒçº§åˆ—è¡¨è§†å›¾ï¼ŒExpandableListViewä¸listviewä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒå¯ä»¥å®ç°äºŒçº§åˆ†ç»„ï¼Œå¹¶é€šè¿‡ExpandableListAdapteræ¥ç»‘å®šæ•°æ®å’Œè§†å›¾ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ä¸€èµ·å®ç°ä¸Šå›¾çš„æ•ˆæœã€‚ å¸ƒå±€ä¸­å®šä¹‰é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨xmlçš„å¸ƒå±€æ–‡ä»¶ä¸­å£°æ˜ExpandableListViewï¼š 12345678&lt;ExpandableListView android:id=&quot;@+id/detail_page_lv_comment&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:divider=&quot;@null&quot; android:layout_marginBottom=&quot;64dp&quot; android:listSelector=&quot;@android:color/transparent&quot; android:scrollbars=&quot;none&quot;/&gt; è¿™é‡Œéœ€è¦è¯´æ˜ä¸¤ä¸ªé—®é¢˜ï¼š ExpandableListViewé»˜è®¤ä¸ºå®ƒçš„itemåŠ ä¸Šäº†ç‚¹å‡»æ•ˆæœï¼Œç”±äºitemé‡Œé¢è¿˜åŒ…å«äº†childItemï¼Œæ‰€ä»¥ï¼Œç‚¹å‡»åï¼Œæ•´ä¸ªitemé‡Œé¢çš„å†…å®¹éƒ½ä¼šæœ‰ç‚¹å‡»æ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥å–æ¶ˆå…¶ç‚¹å‡»ç‰¹æ•ˆï¼Œé¿å…å…¶å½±å“ç”¨æˆ·ä½“éªŒï¼Œåªéœ€è¦è®¾ç½®å¦‚ä¸Šä»£ç ä¸­çš„listSelectorå³å¯ã€‚ ExpandableListViewå…·æœ‰é»˜è®¤çš„åˆ†å‰²çº¿ï¼Œå¯ä»¥é€šè¿‡dividerå±æ€§å°†å…¶éšè—ã€‚ è®¾ç½®Adapteræ­£å¦‚ä½¿ç”¨listViewé‚£æ ·ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºExpandableListViewè®¾ç½®ä¸€ä¸ªé€‚é…å™¨Adapterï¼Œä¸ºå…¶ç»‘å®šæ•°æ®å’Œè§†å›¾ã€‚ExpandableListViewçš„adapteréœ€è¦ç»§æ‰¿è‡ªExpandableListAdapterï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142/** * Author: Moos * E-mail: moosphon@gmail.com * Date: 18/4/20. * Desc: è¯„è®ºä¸å›å¤åˆ—è¡¨çš„é€‚é…å™¨ */public class CommentExpandAdapter extends BaseExpandableListAdapter { private static final String TAG = &quot;CommentExpandAdapter&quot;; private List&lt;CommentDetailBean&gt; commentBeanList; private Context context; public CommentExpandAdapter(Context context, List&lt;CommentDetailBean&gt; commentBeanList) { this.context = context; this.commentBeanList = commentBeanList; } @Override public int getGroupCount() { return commentBeanList.size(); } @Override public int getChildrenCount(int i) { if(commentBeanList.get(i).getReplyList() == null){ return 0; }else { return commentBeanList.get(i).getReplyList().size()&gt;0 ? commentBeanList.get(i).getReplyList().size():0; } } @Override public Object getGroup(int i) { return commentBeanList.get(i); } @Override public Object getChild(int i, int i1) { return commentBeanList.get(i).getReplyList().get(i1); } @Override public long getGroupId(int groupPosition) { return groupPosition; } @Override public long getChildId(int groupPosition, int childPosition) { return getCombinedChildId(groupPosition, childPosition); } @Override public boolean hasStableIds() { return true; } boolean isLike = false; @Override public View getGroupView(final int groupPosition, boolean isExpand, View convertView, ViewGroup viewGroup) { final GroupHolder groupHolder; if(convertView == null){ convertView = LayoutInflater.from(context).inflate(R.layout.comment_item_layout, viewGroup, false); groupHolder = new GroupHolder(convertView); convertView.setTag(groupHolder); }else { groupHolder = (GroupHolder) convertView.getTag(); } Glide.with(context).load(R.drawable.user_other) .diskCacheStrategy(DiskCacheStrategy.RESULT) .error(R.mipmap.ic_launcher) .centerCrop() .into(groupHolder.logo); groupHolder.tv_name.setText(commentBeanList.get(groupPosition).getNickName()); groupHolder.tv_time.setText(commentBeanList.get(groupPosition).getCreateDate()); groupHolder.tv_content.setText(commentBeanList.get(groupPosition).getContent()); groupHolder.iv_like.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { if(isLike){ isLike = false; groupHolder.iv_like.setColorFilter(Color.parseColor(&quot;#aaaaaa&quot;)); }else { isLike = true; groupHolder.iv_like.setColorFilter(Color.parseColor(&quot;#FF5C5C&quot;)); } } }); return convertView; } @Override public View getChildView(final int groupPosition, int childPosition, boolean b, View convertView, ViewGroup viewGroup) { final ChildHolder childHolder; if(convertView == null){ convertView = LayoutInflater.from(context).inflate(R.layout.comment_reply_item_layout,viewGroup, false); childHolder = new ChildHolder(convertView); convertView.setTag(childHolder); } else { childHolder = (ChildHolder) convertView.getTag(); } String replyUser = commentBeanList.get(groupPosition).getReplyList().get(childPosition).getNickName(); if(!TextUtils.isEmpty(replyUser)){ childHolder.tv_name.setText(replyUser + &quot;:&quot;); } childHolder.tv_content.setText(commentBeanList.get(groupPosition).getReplyList().get(childPosition).getContent()); return convertView; } @Override public boolean isChildSelectable(int i, int i1) { return true; } private class GroupHolder{ private CircleImageView logo; private TextView tv_name, tv_content, tv_time; private ImageView iv_like; public GroupHolder(View view) { logo = view.findViewById(R.id.comment_item_logo); tv_content = view.findViewById(R.id.comment_item_content); tv_name = view.findViewById(R.id.comment_item_userName); tv_time = view.findViewById(R.id.comment_item_time); iv_like = view.findViewById(R.id.comment_item_like); } } private class ChildHolder{ private TextView tv_name, tv_content; public ChildHolder(View view) { tv_name = (TextView) view.findViewById(R.id.reply_item_user); tv_content = (TextView) view.findViewById(R.id.reply_item_content); } }} ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰è‡ªå·±çš„ExpandableListAdapteråï¼Œéœ€è¦å®ç°ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š æ„é€ æ–¹æ³•ï¼Œè¿™ä¸ªåº”è¯¥æ— éœ€å¤šè¯´äº†ï¼Œä¸€èˆ¬ç”¨æ¥åˆå§‹åŒ–æ•°æ®ç­‰æ“ä½œã€‚ getGroupCountï¼Œè¿”å›groupåˆ†ç»„çš„æ•°é‡ï¼Œåœ¨å½“å‰éœ€æ±‚ä¸­æŒ‡ä»£è¯„è®ºçš„æ•°é‡ã€‚ getChildrenCountï¼Œè¿”å›æ‰€åœ¨groupä¸­childçš„æ•°é‡ï¼Œè¿™é‡ŒæŒ‡ä»£å½“å‰è¯„è®ºå¯¹åº”çš„å›å¤æ•°ç›®ã€‚ getGroupï¼Œè¿”å›groupçš„å®é™…æ•°æ®ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯å½“å‰è¯„è®ºæ•°æ®ã€‚ getChildï¼Œè¿”å›groupä¸­æŸä¸ªchildçš„å®é™…æ•°æ®ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯å½“å‰è¯„è®ºçš„æŸä¸ªå›å¤æ•°æ®ã€‚ getGroupIdï¼Œè¿”å›åˆ†ç»„çš„idï¼Œä¸€èˆ¬å°†å½“å‰groupçš„ä½ç½®ä¼ ç»™å®ƒã€‚ getChildIdï¼Œè¿”å›åˆ†ç»„ä¸­æŸä¸ªchildçš„idï¼Œä¸€èˆ¬ä¹Ÿå°†childå½“å‰ä½ç½®ä¼ ç»™å®ƒï¼Œä¸è¿‡ä¸ºäº†é¿å…é‡å¤ï¼Œå¯ä»¥ä½¿ç”¨getCombinedChildId(groupPosition, childPosition);æ¥è·å–idå¹¶è¿”å›ã€‚ hasStableIdsï¼Œè¡¨ç¤ºåˆ†ç»„å’Œå­é€‰é¡¹æ˜¯å¦æŒæœ‰ç¨³å®šçš„idï¼Œè¿™é‡Œè¿”å›trueå³å¯ã€‚ isChildSelectableï¼Œè¡¨ç¤ºåˆ†ç»„ä¸­çš„childæ˜¯å¦å¯ä»¥é€‰ä¸­ï¼Œè¿™é‡Œè¿”å›trueã€‚ getGroupViewï¼Œå³è¿”å›groupçš„è§†å›¾ï¼Œä¸€èˆ¬åœ¨è¿™é‡Œè¿›è¡Œä¸€äº›æ•°æ®å’Œè§†å›¾ç»‘å®šçš„å·¥ä½œï¼Œä¸€èˆ¬ä¸ºäº†å¤ç”¨å’Œé«˜æ•ˆï¼Œå¯ä»¥è‡ªå®šä¹‰ViewHolderï¼Œç”¨æ³•ä¸listviewä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚ getChildViewï¼Œè¿”å›åˆ†ç»„ä¸­childå­é¡¹çš„è§†å›¾ï¼Œæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½“å‰groupæ‰€åœ¨çš„ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰childæ‰€åœ¨ä½ç½®ã€‚ è¿™é‡Œçš„æ•°æ®æ˜¯æˆ‘è‡ªå·±åšçš„æ¨¡æ‹Ÿæ•°æ®ï¼Œä¸è¿‡åº”è¯¥ç®—æ˜¯è¾ƒä¸ºé€šç”¨çš„æ ¼å¼äº†ï¼Œå¤§ä½“æ ¼å¼å¦‚ä¸‹ï¼š ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åå°ä¼šé€šè¿‡æ¥å£è¿”å›ç»™æˆ‘ä»¬ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹æ›´å¤šè¯„è®ºï¼Œéœ€è¦è·³è½¬åˆ°â€œæ›´å¤šé¡µé¢â€å»æŸ¥çœ‹ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åªè€ƒè™‘åŠ è½½éƒ¨åˆ†æ•°æ®ã€‚ Activityä¸­ä½¿ç”¨æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨activityä¸­æ˜¾ç¤ºè¯„è®ºå’Œå›å¤çš„äºŒçº§åˆ—è¡¨äº†ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576private ExpandableListView expandableListView;private CommentExpandAdapter adapter;private CommentBean commentBean;private List&lt;CommentDetailBean&gt; commentsList;...@Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); initView(); } private void initView() { expandableListView = findViewById(R.id.detail_page_lv_comment); initExpandableListView(commentsList); } /** * åˆå§‹åŒ–è¯„è®ºå’Œå›å¤åˆ—è¡¨ */ private void initExpandableListView(final List&lt;CommentDetailBean&gt; commentList){ expandableListView.setGroupIndicator(null); //é»˜è®¤å±•å¼€æ‰€æœ‰å›å¤ adapter = new CommentExpandAdapter(this, commentList); expandableListView.setAdapter(adapter); for(int i = 0; i&lt;commentList.size(); i++){ expandableListView.expandGroup(i); } expandableListView.setOnGroupClickListener(new ExpandableListView.OnGroupClickListener() { @Override public boolean onGroupClick(ExpandableListView expandableListView, View view, int groupPosition, long l) { boolean isExpanded = expandableListView.isGroupExpanded(groupPosition); Log.e(TAG, &quot;onGroupClick: å½“å‰çš„è¯„è®ºid&gt;&gt;&gt;&quot;+commentList.get(groupPosition).getId()); // if(isExpanded){// expandableListView.collapseGroup(groupPosition);// }else {// expandableListView.expandGroup(groupPosition, true);// } return true; } }); expandableListView.setOnChildClickListener(new ExpandableListView.OnChildClickListener() { @Override public boolean onChildClick(ExpandableListView expandableListView, View view, int groupPosition, int childPosition, long l) { Toast.makeText(MainActivity.this,&quot;ç‚¹å‡»äº†å›å¤&quot;,Toast.LENGTH_SHORT).show(); return false; } }); expandableListView.setOnGroupExpandListener(new ExpandableListView.OnGroupExpandListener() { @Override public void onGroupExpand(int groupPosition) { //toast(&quot;å±•å¼€ç¬¬&quot;+groupPosition+&quot;ä¸ªåˆ†ç»„&quot;); } }); } /** * by moos on 2018/04/20 * func:ç”Ÿæˆæµ‹è¯•æ•°æ® * @return è¯„è®ºæ•°æ® */ private List&lt;CommentDetailBean&gt; generateTestData(){ Gson gson = new Gson(); commentBean = gson.fromJson(testJson, CommentBean.class); List&lt;CommentDetailBean&gt; commentList = commentBean.getData().getList(); return commentList; } å°±ä»¥ä¸Šä»£ç ä½œä¸€ä¸‹ç®€å•è¯´æ˜ï¼š ExpandableListViewåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä¸ºæˆ‘ä»¬è‡ªå¸¦åˆ†ç»„çš„iconï¼ˆâ–¶ï¸ï¼‰ï¼Œå½“å‰éœ€æ±‚ä¸‹ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦å±•ç¤ºï¼Œå¯ä»¥é€šè¿‡expandableListView.setGroupIndicator(null)æ¥éšè—ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦é»˜è®¤å±•å¼€æ‰€æœ‰çš„åˆ†ç»„ï¼Œæˆ‘å°±å¯ä»¥é€šè¿‡å¾ªç¯æ¥è°ƒç”¨expandableListView.expandGroup(i);æ–¹æ³•ã€‚ ExpandableListViewä¸ºæˆ‘ä»¬æä¾›äº†groupå’Œchildçš„ç‚¹å‡»äº‹ä»¶ï¼Œåˆ†åˆ«é€šè¿‡setOnGroupClickListenerå’ŒsetOnChildClickListeneræ¥è®¾ç½®ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œgroupçš„ç‚¹å‡»äº‹ä»¶é‡Œå¦‚æœæˆ‘ä»¬è¿”å›çš„æ˜¯falseï¼Œé‚£ä¹ˆæˆ‘ä»¬ç‚¹å‡»groupå°±ä¼šè‡ªåŠ¨å±•å¼€ï¼Œä½†æˆ‘è¿™é‡Œç¢°åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘è¿”å›falseæ—¶ï¼Œç¬¬ä¸€æ¡è¯„è®ºæ•°æ®ä¼šå¤šå‡ºä¸€æ¡ã€‚é€šè¿‡ç™¾åº¦æŸ¥æ‰¾æ–¹æ³•ï¼Œè™½ç„¶å¾ˆå¤šç±»ä¼¼é—®é¢˜ï¼Œä½†ç»ˆç©¶æ²¡æœ‰è§£å†³ï¼Œæœ€åæˆ‘è¿”å›äº†tureï¼Œå¹¶é€šè¿‡ä»¥ä¸‹ä»£ç æ‰‹åŠ¨å±•å¼€å’Œæ”¶ç¼©å°±å¯ä»¥äº†ï¼š 12345if(isExpanded){ expandableListView.collapseGroup(groupPosition);}else { expandableListView.expandGroup(groupPosition, true);} æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡setOnGroupExpandListenerå’ŒsetOnGroupCollapseListeneræ¥ç›‘å¬ExpandableListViewçš„åˆ†ç»„å±•å¼€å’Œæ”¶ç¼©çš„çŠ¶æ€ã€‚ è¯„è®ºå’Œå›å¤åŠŸèƒ½ä¸ºäº†æ¨¡æ‹Ÿæ•´ä¸ªè¯„è®ºå’Œå›å¤åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰‹åŠ¨æ’å…¥æ”¶æ®å¹¶åˆ·æ–°æ•°æ®åˆ—è¡¨ã€‚è¿™é‡Œæˆ‘å°±ç®€å•åšä¸€ä¸‹æ¨¡æ‹Ÿï¼Œè¯·å¿½ç•¥ä¸€äº›UIä¸Šçš„ç»†èŠ‚ã€‚ æ’å…¥è¯„è®ºæ•°æ®æ’å…¥è¯„è®ºæ•°æ®æ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦åœ¨listä¸­æ’å…¥ä¸€æ¡æ•°æ®å¹¶åˆ·æ–°å³å¯ï¼š 123456789101112String commentContent = commentText.getText().toString().trim();if(!TextUtils.isEmpty(commentContent)){ //commentOnWork(commentContent); dialog.dismiss(); CommentDetailBean detailBean = new CommentDetailBean(&quot;å°æ˜&quot;, commentContent,&quot;åˆšåˆš&quot;); adapter.addTheCommentData(detailBean); Toast.makeText(MainActivity.this,&quot;è¯„è®ºæˆåŠŸ&quot;,Toast.LENGTH_SHORT).show();}else { Toast.makeText(MainActivity.this,&quot;è¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©º&quot;,Toast.LENGTH_SHORT).show();} adapterä¸­çš„addTheCommentDataæ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112131415/** * by moos on 2018/04/20 * func:è¯„è®ºæˆåŠŸåæ’å…¥ä¸€æ¡æ•°æ® * @param commentDetailBean æ–°çš„è¯„è®ºæ•°æ® */public void addTheCommentData(CommentDetailBean commentDetailBean){ if(commentDetailBean!=null){ commentBeanList.add(commentDetailBean); notifyDataSetChanged(); }else { throw new IllegalArgumentException(&quot;è¯„è®ºæ•°æ®ä¸ºç©º!&quot;); }} ä»£ç æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå°±ä¸å¤šåšè¯´æ˜äº†ã€‚ æ’å…¥å›å¤æ•°æ®é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®ç°ç‚¹å‡»æŸä¸€æ¡è¯„è®ºï¼Œç„¶å@ta,é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨groupçš„ç‚¹å‡»äº‹ä»¶é‡Œå¼¹èµ·å›å¤æ¡†ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859expandableListView.setOnGroupClickListener(new ExpandableListView.OnGroupClickListener() { @Override public boolean onGroupClick(ExpandableListView expandableListView, View view, int groupPosition, long l) { showReplyDialog(groupPosition); return true; } }); ....../** * by moos on 2018/04/20 * func:å¼¹å‡ºå›å¤æ¡† */ private void showReplyDialog(final int position){ dialog = new BottomSheetDialog(this); View commentView = LayoutInflater.from(this).inflate(R.layout.comment_dialog_layout,null); final EditText commentText = (EditText) commentView.findViewById(R.id.dialog_comment_et); final Button bt_comment = (Button) commentView.findViewById(R.id.dialog_comment_bt); commentText.setHint(&quot;å›å¤ &quot; + commentsList.get(position).getNickName() + &quot; çš„è¯„è®º:&quot;); dialog.setContentView(commentView); bt_comment.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { String replyContent = commentText.getText().toString().trim(); if(!TextUtils.isEmpty(replyContent)){ dialog.dismiss(); ReplyDetailBean detailBean = new ReplyDetailBean(&quot;å°çº¢&quot;,replyContent); adapter.addTheReplyData(detailBean, position); Toast.makeText(MainActivity.this,&quot;å›å¤æˆåŠŸ&quot;,Toast.LENGTH_SHORT).show(); }else { Toast.makeText(MainActivity.this,&quot;å›å¤å†…å®¹ä¸èƒ½ä¸ºç©º&quot;,Toast.LENGTH_SHORT).show(); } } }); commentText.addTextChangedListener(new TextWatcher() { @Override public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) { } @Override public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) { if(!TextUtils.isEmpty(charSequence) &amp;&amp; charSequence.length()&gt;2){ bt_comment.setBackgroundColor(Color.parseColor(&quot;#FFB568&quot;)); }else { bt_comment.setBackgroundColor(Color.parseColor(&quot;#D8D8D8&quot;)); } } @Override public void afterTextChanged(Editable editable) { } }); dialog.show(); } æ’å…¥å›å¤çš„æ•°æ®ä¸ä¸Šé¢æ’å…¥è¯„è®ºç±»ä¼¼ï¼Œè¿™é‡Œè´´ä¸€ä¸‹adapterä¸­çš„ä»£ç ï¼š 123456789101112131415161718192021/** * by moos on 2018/04/20 * func:å›å¤æˆåŠŸåæ’å…¥ä¸€æ¡æ•°æ® * @param replyDetailBean æ–°çš„å›å¤æ•°æ® */public void addTheReplyData(ReplyDetailBean replyDetailBean, int groupPosition){ if(replyDetailBean!=null){ Log.e(TAG, &quot;addTheReplyData: &gt;&gt;&gt;&gt;è¯¥åˆ·æ–°å›å¤åˆ—è¡¨äº†:&quot;+replyDetailBean.toString() ); if(commentBeanList.get(groupPosition).getReplyList() != null ){ commentBeanList.get(groupPosition).getReplyList().add(replyDetailBean); }else { List&lt;ReplyDetailBean&gt; replyList = new ArrayList&lt;&gt;(); replyList.add(replyDetailBean); commentBeanList.get(groupPosition).setReplyList(replyList); } notifyDataSetChanged(); }else { throw new IllegalArgumentException(&quot;å›å¤æ•°æ®ä¸ºç©º!&quot;); }} éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œç”±äºä¸ä¸€å®šæ‰€æœ‰çš„è¯„è®ºéƒ½æœ‰å›å¤æ•°æ®ï¼Œæ‰€ä»¥åœ¨æ’å…¥æ•°æ®å‰æˆ‘ä»¬è¦åˆ¤æ–­ReplyListæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œç›´æ¥è·å–å½“å‰è¯„è®ºçš„å›å¤åˆ—è¡¨ï¼Œå¹¶æ’å…¥æ•°æ®ï¼›å¦‚æœä¸ºç©ºï¼Œéœ€è¦newä¸€ä¸ªReplyListï¼Œæ’å…¥æ•°æ®åè¿˜è¦ä¸ºè¯„è®ºsetä¸€ä¸‹ReplyListã€‚ è§£å†³CoordinatorLayoutä¸ExpandableListViewåµŒå¥—é—®é¢˜å¦‚æœä½ ä¸éœ€è¦ä½¿ç”¨CoordinatorLayoutæˆ–è€…NestedScrollViewï¼Œå¯ä»¥è·³è¿‡æœ¬å°èŠ‚ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬äº§å“ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œè¿˜éœ€è¦æˆ‘ä»¬åŠ ä¸Šç±»ä¼¼çš„é¡¶éƒ¨è§†å·®æ•ˆæœæˆ–è€…ä¸‹æ‹‰åˆ·æ–°ç­‰ï¼Œè¿™å°±è¦æˆ‘ä»¬å¤„ç†ä¸€äº›å¸¸è§çš„åµŒå¥—æ»‘åŠ¨é—®é¢˜äº†ã€‚ ç”±äºCoordinatorLayoutå®ç°NestedScrollingParentæ¥å£,RecycleViewå®ç°äº†NestedScrollingChildæ¥å£,æ‰€ä»¥å°±å¯ä»¥åœ¨NestedScrollingChildHelperçš„å¸®åŠ©ä¸‹å®ç°åµŒå¥—æ»‘åŠ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„ExpandableListViewå®ç°NestedScrollingChildæ¥å£æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475/** * Author: Moos * E-mail: moosphon@gmail.com * Date: 18/4/20. * Desc: è‡ªå®šä¹‰ExpandableListView,è§£å†³ä¸CoordinatorLayoutæ»‘åŠ¨å†²çªé—®é¢˜ */public class CommentExpandableListView extends ExpandableListView implements NestedScrollingChild{ private NestedScrollingChildHelper mScrollingChildHelper; public CommentExpandableListView(Context context, AttributeSet attrs) { super(context, attrs); mScrollingChildHelper = new NestedScrollingChildHelper(this); if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) { setNestedScrollingEnabled(true); } } @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) { int expandSpec = MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE &gt;&gt; 2, MeasureSpec.AT_MOST); super.onMeasure(widthMeasureSpec, expandSpec); } @Override public void setNestedScrollingEnabled(boolean enabled) { mScrollingChildHelper.setNestedScrollingEnabled(enabled); } @Override public boolean isNestedScrollingEnabled() { return mScrollingChildHelper.isNestedScrollingEnabled(); } @Override public boolean startNestedScroll(int axes) { return mScrollingChildHelper.startNestedScroll(axes); } @Override public void stopNestedScroll() { mScrollingChildHelper.stopNestedScroll(); } @Override public boolean hasNestedScrollingParent() { return mScrollingChildHelper.hasNestedScrollingParent(); } @Override public boolean dispatchNestedScroll(int dxConsumed, int dyConsumed, int dxUnconsumed, int dyUnconsumed, int[] offsetInWindow) { return mScrollingChildHelper.dispatchNestedScroll(dxConsumed, dyConsumed, dxUnconsumed, dyUnconsumed, offsetInWindow); } @Override public boolean dispatchNestedPreScroll(int dx, int dy, int[] consumed, int[] offsetInWindow) { return mScrollingChildHelper.dispatchNestedPreScroll(dx, dy, consumed, offsetInWindow); } @Override public boolean dispatchNestedFling(float velocityX, float velocityY, boolean consumed) { return mScrollingChildHelper.dispatchNestedFling(velocityX, velocityY, consumed); } @Override public boolean dispatchNestedPreFling(float velocityX, float velocityY) { return mScrollingChildHelper.dispatchNestedPreFling(velocityX, velocityY); }} ä»£ç å°±ä¸è§£é‡Šäº†ï¼Œæ¯•ç«Ÿè¿™ä¸æ˜¯æœ¬ç¯‡æ–‡ç« ç­‰é‡ç‚¹ï¼Œå¤§å®¶å¯ä»¥å»ç½‘ä¸ŠæŸ¥é˜…NestedScrollViewç›¸å…³æ–‡ç« æˆ–è€…æºç å»å¯¹ç…§ç†è§£ã€‚ å®Œæ•´çš„å¸ƒå±€ä»£ç æ¯”è¾ƒå¤šï¼Œç¯‡å¹…æœ‰é™ï¼Œå¤§å®¶å¯ä»¥å»githubä¸Šé¢æŸ¥çœ‹ï¼šhttps://github.com/Moosphan/CommentWithReplyView-master ä¹Ÿæ¬¢è¿å¤§å®¶åŠ å…¥Androidé›†ä¸­è¥ï¼Œä¸€èµ·æ¢è®¨æŠ€æœ¯ï¼š","link":"/2018/04/25/comment-reply-component/"},{"title":"Dartå…¥é—¨ï¼Ÿä¸€ç¯‡æ–‡ç« è¶³çŸ£","text":"è¿‘æœŸå…¬å¸å‡†å¤‡å¯åŠ¨æ–°é¡¹ç›®ï¼Œç»è¿‡æŠ€æœ¯å›¢é˜Ÿä¸€ç•ªè°ƒç ”ï¼Œå†³å®šé‡‡ç”¨ Flutter æ¥å¼€å‘ç¬¬ä¸€ç‰ˆAppï¼Œæ•…ä½œæ­¤æ–‡ï¼Œå¸¸æ¥å›é¡¾æ¸©ä¹ ã€‚ç”±äºé¡¹ç›®é‡‡ç”¨æ•æ·å¼€å‘æ¨¡å¼ï¼Œæ•…æœ¬æ–‡ä¸»è¦æ€»ç»“å’Œè®°å½• Dart å¸¸ç”¨è¯­æ³•ï¼Œæ›´å¤šé«˜çº§å’Œç”Ÿåƒ»ç”¨æ³•å°†åœ¨åé¢å¼€å‘è¿‡ç¨‹ä¸­ä¸å®šæœŸæ›´æ–°ã€‚ First of allåœ¨æˆ‘ä»¬æ­£å¼æ¥è§¦ Dart è¯­æ³•ä¹‹å‰ï¼Œéœ€è¦é“­è®°ä»¥ä¸‹å†…å®¹ï¼Œè¿™å°†ä¼šå¯¹åç»­ Dart è¯­æ³•çš„å­¦ä¹ ã€ç†è§£å’Œåº”ç”¨æœ‰å¾ˆå¤§å¸®åŠ©ï¼š ä¸‡ç‰©çš†å¯¹è±¡ï¼Œ æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ã€‚åœ¨ Dart ä¸­ï¼Œç”šè‡³è¿æ•°å­—ã€æ–¹æ³•å’Œ null éƒ½æ˜¯å¯¹è±¡ï¼Œå¹¶ä¸”æ‰€æœ‰çš„å¯¹è±¡éƒ½ç»§æ‰¿äº Object ç±»ã€‚ å°½ç®¡ Dart è¯­è¨€æ˜¯ä¸€ç§å¼ºç±»å‹è¯­è¨€ï¼Œä½†ä½ åœ¨ç±»å‹å£°æ˜æ—¶ä»ç„¶å¯ä»¥ä¸æŒ‡å®šç±»å‹ï¼Œå› ä¸º Dart å¯ä»¥è‡ªåŠ¨è¿›è¡Œç±»å‹æ¨æ–­ã€‚å¦‚åœ¨ä»£ç  var number = 5; ä¸­ï¼Œnumber å˜é‡çš„ç±»å‹å°±è¢«æ¨æ–­ä¸º intï¼Œå½“ä½ å¹¶ä¸æƒ³æ˜¾å¼åœ°å£°æ˜ç±»å‹æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ç‰¹æœ‰çš„ç±»å‹ dynamic æ¥æ ‡è¯†ã€‚ Dart è¯­è¨€åŒæ ·æ”¯æŒæ³›å‹ï¼Œå¦‚ List&lt;int&gt;ã€List&lt;dynamic&gt;ï¼ˆåŒ Java ä¸­çš„ List&lt;Object&gt;ï¼‰ã€‚ Dart è¯­è¨€æ”¯æŒé¡¶çº§æ–¹æ³•ï¼ˆå³ä¸ä¸ç±»ç»‘å®šçš„æ–¹æ³•ï¼Œå¦‚ä¸Šçš„ main æ–¹æ³•ï¼‰ï¼Œä»¥åŠç»‘å®šç±»å’Œå®ä¾‹çš„æ–¹æ³•ï¼ˆåˆ†åˆ«å¯¹åº”é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰ï¼Œè€Œä¸”è¿˜æ”¯æŒæ–¹æ³•åµŒå¥—ï¼ˆåŒ Python å’Œ JSï¼‰ã€‚ åŒæ ·ï¼ŒDart è¿˜æ”¯æŒé¡¶çº§å˜é‡ï¼Œä»¥åŠåœ¨ç±»ä¸­å®šä¹‰çš„å˜é‡ï¼ˆå¦‚é™æ€å˜é‡å’Œå®ä¾‹å˜é‡ï¼‰ã€‚ å’Œ Java ä¸åŒçš„æ˜¯ï¼ŒDart æ²¡æœ‰ publicã€ protected ä»¥åŠ private å…³é”®å­—ã€‚å®ƒé€šè¿‡ç»™å˜é‡æˆ–è€…æ–¹æ³•ååŠ ä¸Š _ å‰ç¼€æ¥å°†å…¶æ ‡è¯†ä¸ºç§æœ‰åŸŸã€‚ å˜é‡ä½ å¯ä»¥é€šè¿‡ var æˆ–è€…ç‰¹å®šçš„ç±»å‹æ¥ä¿®é¥°å˜é‡ï¼Œå¦‚æœå˜é‡çš„ç±»å‹ä¸æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ dynamic æˆ–è€… Object æ¥ä¿®é¥°ã€‚å¦‚ï¼š 123456// ç±»å‹æ¨æ–­var name = 'Bob';// æŒ‡å®šç±»å‹String name = 'Bob';// ç±»å‹ä¸å±€é™äºstringdynamic name = 'Bob'; é»˜è®¤å€¼Dart ä¸­å£°æ˜æ—¶å¦‚æœæœªåˆå§‹åŒ–ï¼Œä¼šè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸ºnullï¼š 12int lineCount;assert(lineCount == null); æ³¨ï¼šassert åªåœ¨å¼€å‘ç¯å¢ƒæœ‰æ•ˆï¼Œåœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒæ— æ•ˆã€‚ final ä¸ constfinal å’Œ const æ ‡è¯†è¯¥å˜é‡åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ï¼ŒåŒºåˆ«åœ¨äº final æ˜¯è¿è¡Œæ—¶èµ‹å€¼ï¼Œconst æ˜¯ç¼–è¯‘æ—¶èµ‹å€¼ã€‚ 123final String nickname = 'Jack';// finalä¿®é¥°æ—¶, å¯çœç•¥ç±»å‹å£°æ˜final name = 'Jack'; constä¸ä»…å¯ä»¥ç”¨æ¥å£°æ˜å˜é‡ï¼Œè¿˜èƒ½ç”¨æ¥åˆ›å»ºå¸¸é‡å€¼ï¼Œå¦‚ï¼š 12345678// æ­¤æ—¶ä¸èƒ½åœ¨å¯¹åˆ—è¡¨aè¿›è¡Œæ›´æ–°æ“ä½œvar a = const [1, 2];// æ³¨æ„ä»¥ä¸‹ const ä¿®é¥°çš„åŒºåˆ«var foo = const [];const baz = []; // Equivalent to `const []`...foo = [1, 2, 3]; // Was const []baz = [42]; // Error: Constant variables can't be assigned a value. æ•°æ®ç±»å‹Dart è¯­è¨€æ”¯æŒçš„æ•°æ®ç±»å‹ä¸ Java ç±»ä¼¼ï¼Œä½†ä¹Ÿæœ‰æ‰€ä¸åŒï¼Œä¸‹é¢æˆ‘ä»¬æ¥æŒ‰ç…§â€œæ±‚åŒå­˜å¼‚â€çš„æ³•åˆ™æ¥åˆ†åˆ«è®¤è¯†å®ƒä»¬ã€‚ æ•°å­—ç±»å‹Dart ä¸­çš„æ•°å­—ç±»å‹åªæœ‰ä¸¤ç§ï¼šInt å’Œ doubleã€‚ä¸ Java ä¸åŒçš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æä¾› float ç±»å‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥å®šä¹‰æ•°å­—ï¼š 123456// å®šä¹‰æ•´å‹var x = 123;var hex = 0xDEADBEEF;// å®šä¹‰åŒç²¾åº¦ç±»å‹var y = 1.199;var exponents = 1.42e5; å†æ¥çœ‹ä¸‹å¸¸ç”¨çš„æ•°æ®è½¬æ¢è¯¥å¦‚ä½•æ‰§è¡Œï¼š 123456789101112131415// String -&gt; intvar a = int.parse('1');assert(a == 1);// String -&gt; doublevar b = double.parse('1.1');assert(b == 1.1);// int -&gt; StringString c = 1.toString();assert(c == '1');// double -&gt; StringString d = 3.14159.toStringAsFixed(2);assert(d == '3.14'); int ç±»å‹å¯ä»¥æ‰§è¡Œä¼ ç»Ÿçš„æŒ‰ä½ç§»ä½( &lt;&lt;ï¼Œ&gt;&gt; )ï¼ŒAND( &amp; )å’ŒOR( | )è¿ç®—ç¬¦ï¼Œå¦‚ï¼š 123assert((3 &lt;&lt; 1) == 6); // 0011 &lt;&lt; 1 == 0110assert((3 &gt;&gt; 1) == 1); // 0011 &gt;&gt; 1 == 0001assert((3 | 4) == 7); // 0011 | 0100 == 0111 å­—ç¬¦ä¸²ç±»å‹å­—ç¬¦ä¸²çš„å£°æ˜å¯ä»¥é€šè¿‡å•å¼•å·æˆ–è€…åŒå¼•å·æ¥å¼•å…¥ï¼š 1234var s1 = 'Single quotes work well for string literals.';var s2 = \"Double quotes work just as well.\";var s3 = 'It\\'s easy to escape the string delimiter.';var s4 = \"It's even easier to use the other delimiter.\"; å­—ç¬¦ä¸²æ‹¼æ¥å¯ä»¥é€šè¿‡ + æˆ–è€… æ¢è¡Œ æ¥å®ç°ï¼Œå¦‚ï¼š 123456var a = '123' + '456'var b = '123' '456';assert(a == b)print(a);// Out: 123456 å¦å¤–ï¼Œå¯ä»¥é€šè¿‡ä¸‰é‡å¼•å·æ¥ä¿®é¥°å¤šè¡Œå­—ç¬¦ä¸²ï¼ˆç»´æŒç‰¹å®šæ ¼å¼ï¼‰ï¼š 1234567var s1 = '''You can createmulti-line strings like this one.''';var s2 = \"\"\"This is also amulti-line string.\"\"\"; å¸ƒå°”ç±»å‹Dart ä¸­çš„ bool ç±»å‹å¯ä»¥é€šè¿‡ if-else æˆ–è€…æ˜¯ assert æ¥æ£€æŸ¥ï¼Œå¦‚ï¼š 123456789101112131415// Check for an empty string.var fullName = '';assert(fullName.isEmpty);// Check for zero.var hitPoints = 0;assert(hitPoints &lt;= 0);// Check for null.var unicorn;assert(unicorn == null);// Check for NaN.var iMeantToDoThis = 0 / 0;assert(iMeantToDoThis.isNaN); æ•°ç»„ç±»å‹åœ¨ Dart è¯­è¨€ä¸­ï¼Œæ•°ç»„å³åˆ—è¡¨ï¼Œåˆ—è¡¨å³æ•°ç»„ã€‚ 123456789void main() { var list = [1, 2, 3]; list.add(4); list.remove(3); list[1] = 5; var last = list[list.length - 1]; print('list is $list'); print('last is $last');} å¦å¤–ï¼Œä½ å¯ä»¥é€šè¿‡ â€¦ æˆ–è€… ...?ï¼ˆé¿å…ç©ºå¼‚å¸¸ï¼‰ æ¥æ‰¹é‡æ’å…¥å¤šä¸ªå…ƒç´ ï¼š 12345var list1 = [1, 2, 3];var list2 = [0, ...list1];var list3;var list24 = [0, ...?list3]; é™¤æ­¤ä»¥å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ if æˆ–è€… for æ¡ä»¶è¿ç®—ç¬¦æ¥æ’å…¥å…ƒç´ ï¼š 12345678910111213var nav = [ 'Home', 'Furniture', 'Plants', if (promoActive) 'Outlet'];var listOfInts = [1, 2, 3];var listOfStrings = [ '#0', for (var i in listOfInts) '#$i'];assert(listOfStrings[1] == '#1'); Set å’Œ MapDartä¸­çš„Setæ˜¯æ— åºçš„å”¯ä¸€é¡¹çš„é›†åˆã€‚è¦åˆ›å»ºä¸€ä¸ªç©ºé›†åˆï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š 123var names = &lt;String&gt;{};Set&lt;String&gt; names = {}; // This works, too.// var names = {}; // Creates a map, not a set. é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºå¸¸é‡ Setï¼š 12345678final constantSet = const { 'fluorine', 'chlorine', 'bromine', 'iodine', 'astatine',};// constantSet.add('helium'); // Uncommenting this causes an error. è‡³äº Map å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹æ•°æ®ï¼Œkey å’Œ value å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºä¸€ä¸ª Mapï¼š 123456789101112var gifts = Map();gifts['first'] = 'partridge';gifts['second'] = 'turtledoves';gifts['fifth'] = 'golden rings';// æˆ–è€…é€šè¿‡ä»¥ä¸‹æ–¹å¼var gifts = { // Key: Value 'first': 'partridge', 'second': 'turtledoves', 'fifth': 'golden rings'}; å‡½æ•°Dart æ˜¯ä¸€é—¨å®Œå…¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œå³ä½¿å®ƒçš„å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”æœ‰è‡ªå·±çš„ç±»å‹â€”â€” Functionã€‚è¿™å°±æ„å‘³ç€å‡½æ•°å¯ä»¥è¢«èµ‹å€¼ä¸ºä¸€ä¸ªå˜é‡ï¼Œæˆ–è€…ä½œä¸ºä¸€ä¸ªå‚æ•°åœ¨å…¶ä»–å‡½æ•°ä¹‹é—´ä¼ é€’ã€‚ å¯¹äºåªåŒ…å«ä¸€ä¸ªè¡¨è¾¾å¼çš„æ–¹æ³•ä½“ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ =&gt; çš„ç®€å†™å½¢å¼ï¼Œå¦‚ï¼š 123456void say() { print('123');}// è¯¥å†™æ³•ä¸ä»¥ä¸Šæœ‰åŒæ ·æ•ˆæœvoid say2() =&gt; print('123'); æ­¤å¤–ï¼Œå‡½æ•°åŒæ ·æ”¯æŒç±»å‹æ¨æ–­ï¼Œå¦‚ï¼š 1234bool isNoble(int atomicNumber) =&gt; _nobleGases[atomicNumber] != null;// ä¸ä¸‹é¢çš„æ•ˆæœä¸€æ ·isNoble(atomicNumber) =&gt; _nobleGases[atomicNumber] != null; å¯é€‰å‚æ•°ä¸ kotlin è¯­è¨€ç±»ä¼¼ï¼ŒDart çš„ å‡½æ•°åŒæ ·æ”¯æŒå¯é€‰å‚æ•°è¿™ä¸€åŠŸèƒ½ï¼Œä¸»è¦åˆ†ä¸ºå‘½åå¯é€‰å‚æ•°å’Œä½ç½®å¯é€‰å‚æ•°ï¼Œå®ƒä»¬ä¸èƒ½åœ¨ä¸€ä¸ªå‡½æ•°ä¸­åŒæ—¶ä½¿ç”¨ã€‚ä½†å®ƒä»¬éƒ½æ”¯æŒé»˜è®¤å‚æ•°è®¾ç½®ã€‚ å‘½åå¯é€‰å‚æ•° å‘½åå¯é€‰å‚æ•°é€šè¿‡èŠ±æ‹¬å· {} æ¥æŒ‡å®šå¯é€‰çš„å‘½åå‚æ•°ï¼Œå¦‚ï¼š 1234567void main() { hello(name: 'Tom');}void hello({@required String name='Jack', int age=18}) { print('Hello, my name is $name, i\\'m $age years old.');} æˆ‘ä»¬å¯ä»¥ä¸ºå‘½åå¯é€‰å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å¦‚æœä¸æŒ‡å®šè¯¥å¯é€‰å‚æ•°çš„å€¼ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ @required æ¥æ ‡æ³¨é‚£äº›ä¸æƒ³è¢«å¿½ç•¥çš„å‚æ•°ã€‚ ä½ç½®å¯é€‰å‚æ•° é¡¾åæ€ä¹‰ï¼Œå¯é€‰ä½ç½®å‚æ•°å°±å…è®¸æˆ‘ä»¬åœ¨ä½¿ç”¨æŸä¸ªå‡½æ•°æ—¶å¯ä»¥å¿½ç•¥æŸä¸ªå‚æ•°ï¼Œå¦‚ï¼š 1234567891011void main() { sayHello('Tom', 19);}void sayHello(String name, int age, [String hobby = null]) { var result = 'Hello, my name is $name, i\\'m $age years old'; if (hobby != null) { result += ', my bobby is $hobby.'; } print(result);} åŒ¿åå‡½æ•°ä¸ç®¡ä»€ä¹ˆè¯­è¨€ï¼Œå¥½åƒéƒ½èƒ½çœ‹åˆ°åŒ¿åå‡½æ•°çš„èº«å½±ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥ç®€å•å£°æ˜ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼š 12345var loge = (msg) =&gt; Logger.print(Logger.Error, msg);void main() { loge(\"there has some errors\");} Dart ä¸­ list å°±æä¾›äº†åŒ¿åå‡½æ•° â€”â€” forEachï¼Œå¦‚ï¼š 1234var list = ['apples', 'bananas', 'oranges'];list.forEach((item) { print('${list.indexOf(item)}: $item');}); å¸¸ç”¨æ“ä½œç¬¦Dart æä¾›äº†å¾ˆå¤šåŠŸèƒ½å¼ºå¤§çš„æ“ä½œç¬¦ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„ï¼š ç±»å‹åˆ¤æ–­ å¦‚ï¼š**is** ç›¸å½“äº Java ä¸­çš„ instanceof æ•´é™¤ å¦‚ï¼š**a ~/ b** ç­‰ä»·äº (a /b) as int éç©ºè°ƒç”¨ å¦‚ï¼š**a?.b** ç›¸å½“äº a == null ? null : a.b ä¸‰ç›®è¿ç®— å¦‚ï¼š**a??b** ç›¸å½“äº a == null ? b : a ä¸‰ç›®èµ‹å€¼è¿ç®— å¦‚ï¼š**a ??= b** ç›¸å½“äº a = a == null ? b : a ç±»å‹è½¬æ¢ å¦‚ï¼š**a as int** ç›¸å½“äº Java ä¸­çš„ (int) a çº§è”æ“ä½œç¬¦ çº§è”æ“ä½œç¬¦ç”¨**..** æ¥è¡¨ç¤ºï¼Œä¸»è¦ç”¨æ¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œè¿ç»­æ“ä½œï¼Œæœ‰ç‚¹ç±»ä¼¼ kotlin ä¸­çš„ apply å’Œ letï¼Œå¦‚ï¼š 12345678910var button = Button(this);button.text = 'Confirm';button.color = Color.parse(\"#f3f355\");button.onClick.listen((v) =&gt; toast('Confirmed'));// ç­‰ä»·äºä¸‹é¢å†™æ³•Button(this) ..text = 'Confirm' // Use its members. ..color = Color.parse(\"#f3f355\") ..onClick.listen((v) =&gt; toast('Confirmed')); å¼‚å¸¸å¤„ç†æŠ›å¼‚å¸¸åœ¨ Dart ä¸­å¯ä»¥æŠ›å‡ºéç©ºå¯¹è±¡ï¼ˆä¸ä»…ä»…æ˜¯ Exception æˆ– Errorï¼‰ä½œä¸ºå¼‚å¸¸ã€‚æŠ›å‡ºå¼‚å¸¸çš„æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€è¦è¿™æ ·ï¼š 12345throw FormatException('Expected at least 1 section');throw 'Out of llamas!';void distanceTo(Point other) =&gt; throw UnimplementedError(); æ•è·å¼‚å¸¸æˆ‘ä»¬å¯ä»¥é€šè¿‡ try-on æ¥æ•è·æŸä¸ªç‰¹å®šå¼‚å¸¸ï¼Œå¦‚ï¼š 12345try { breedMoreLlamas();} on OutOfLlamasException { buyMoreLlamas();} å½“ç„¶ï¼Œä½ å¯ä»¥æŠ›å‡ºå¤šä¸ªç±»å‹çš„ Exceptionï¼Œä½†æ˜¯ç”±ç¬¬ä¸€ä¸ª catch åˆ°çš„åˆ†å¥æ¥å¤„ç†å¦‚æœ catch åˆ†å¥æ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥å¤„ç†ä»»ä½•ç±»å‹çš„å¼‚å¸¸ï¼š 1234567try { throw 'This a Exception!'; } on Exception catch(e) { print('Unknown exception: $e'); } catch(e) { print('Unknown type: $e'); } æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œå¦‚æœæƒ³è¦æ‰§è¡ŒæŸæ®µä»£ç ï¼Œå¯ä»¥é€šè¿‡ finally å®ç°ï¼š 1234567try { throw 'This a Exception!'; } catch(e) { // å¦‚æœå»æ‰ catch è¯­å¥ï¼Œé‚£ä¹ˆå¼‚å¸¸å°†ä¼šåœ¨finallyä»£ç å—ä¹‹åä¼ é€’ã€‚ print('Catch Exception: $e'); } finally { print('Close'); } ç±»å’Œå¯¹è±¡Dart ä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç±»çš„å®ä¾‹ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ç±»éƒ½æ˜¯ Object çš„å­ç±»ã€‚ ç±»çš„å®šä¹‰å’Œæ„é€ å‡½æ•°ç±»çš„å®šä¹‰ç”¨ class å…³é”®å­—ï¼Œå¦‚æœæœªæ˜¾å¼å®šä¹‰æ„é€ å‡½æ•°ï¼Œä¼šé»˜è®¤ä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•°ï¼Œè¿™ä¸€ç‚¹ä¸ Java ä¸è°‹è€Œåˆã€‚å¦å¤–ï¼ŒDart è¿˜æä¾› å‘½åæ„é€ å‡½æ•°è¿™ä¸€åŠŸèƒ½ï¼Œæ ¼å¼ä¸ºï¼šClass.costructorName(var params)ã€‚è¿™ç§ç”¨æ³•åœ¨æŸäº›åœºæ™¯ä¸‹å¾ˆå®ç”¨ï¼Œæ¯”å¦‚ï¼š 1234567891011121314151617class Person{ String name; int age; bool sex; String hobby; Person(this.name, this.age, this.sex, this.hobby); /// å‘½åæ„é€ å‡½æ•° Person.fromJson(Map json){ print(\"Person constructor...\"); this.name = json['name']; this.age = json['age']; this.sex = json['sex']; this.hobby = json['hobby']; }} é€šè¿‡å‘½åæ„é€ å‡½æ•°ï¼Œæˆ‘å°±å¯ä»¥ç›´æ¥é€šè¿‡å¤šç§æ–¹å¼æ¥ç”Ÿæˆå½“å‰ç±»çš„å®ä¾‹ï¼Œè¿™é‡Œé€šè¿‡ Json æ ¼å¼æ•°æ®ç”Ÿæˆ Person å¯¹è±¡ã€‚å¦å¤–ï¼Œå¦‚æœæ„é€ å‡½æ•°åªæ˜¯ç®€å•çš„å‚æ•°ä¼ é€’ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨æ„é€ å‡½æ•°ååŠ  : æ¥å¯¹å‚æ•°è¿›è¡Œèµ‹å€¼ï¼Œå¤šä¸ªå‚æ•°å¯é€šè¿‡ , ç›¸è¿ï¼š 123456789101112131415161718class Point { num x; num y; num z; Point(this.x, this.y, z) { //ç¬¬ä¸€ä¸ªå€¼ä¼ é€’ç»™this.xï¼Œç¬¬äºŒä¸ªå€¼ä¼ é€’ç»™this.y this.z = z; } Point.fromeList(var list): //å‘½åæ„é€ å‡½æ•°ï¼Œæ ¼å¼ä¸ºClass.name(var param) x = list[0], y = list[1], z = list[2]{//ä½¿ç”¨å†’å·åˆå§‹åŒ–å˜é‡ } //å½“ç„¶ï¼Œä¸Šé¢å¥ä½ ä¹Ÿå¯ä»¥ç®€å†™ä¸ºï¼š //Point.fromeList(var list): this(list[0], list[1], list[2]); String toString() =&gt; 'x:$x y:$y z:$z';} å¦‚æœä½ è¦åˆ›å»ºä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡ï¼Œä½ å¯ä»¥å®šä¹‰ç¼–è¯‘æ—¶å¸¸é‡å¯¹è±¡éœ€è¦åœ¨æ„é€ å‡½æ•°å‰åŠ  constï¼š 123456class ImmutablePoint { final num x; final num y; const ImmutablePoint(this.x, this.y); // å¸¸é‡æ„é€ å‡½æ•° static final ImmutablePoint origin = const ImmutablePoint(0, 0); // åˆ›å»ºä¸€ä¸ªå¸¸é‡å¯¹è±¡ä¸èƒ½ç”¨newï¼Œè¦ç”¨const} å±æ€§è®¿é—®å™¨å³æˆ‘ä»¬å¸¸è¯´çš„ Setter/Getterï¼Œä¸»è¦æ˜¯ç”¨æ¥è¯»å†™ä¸€ä¸ªå±æ€§çš„æ–¹æ³•ã€‚æ¯ä¸ªå­—æ®µéƒ½å¯¹åº”ä¸€ä¸ªéšå¼çš„ Getter å’Œ Setter ï¼Œä½†æ˜¯è°ƒç”¨çš„æ—¶å€™æ˜¯ obj.nameï¼Œè€Œä¸æ˜¯ obj.name()ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡ get å’Œ set å…³é”®å­—æ‰©å±•åŠŸèƒ½æ¥å®ç°è‡ªå·±çš„ Setter/Getter ï¼Œ å¦‚æœå­—æ®µä¸º final æˆ–è€… const çš„è¯ï¼Œé‚£ä¹ˆå®ƒåªèƒ½æœ‰ä¸€ä¸ª getter æ–¹æ³•ã€‚å¦‚ï¼š 123456789101112131415161718class Rectangle { num left, top, width, height; Rectangle(this.left, this.top, this.width, this.height); // Define two calculated properties: right and bottom. num get right =&gt; left + width; set right(num value) =&gt; left = value - width; num get bottom =&gt; top + height; set bottom(num value) =&gt; top = value - height;}void main() { var rect = Rectangle(3, 4, 20, 15); assert(rect.left == 3); rect.right = 12; assert(rect.left == -8);} å·¥å‚æ„é€ å‡½æ•°å¹¶ä¸æ˜¯ä»»ä½•æ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¦‚ï¼šå¯ä»¥è¿”å›ä¸€ä¸ªå·²ç»ç¼“å­˜å¥½çš„å¯¹è±¡æˆ–è€…è¯¥ç±»çš„å­ç±»å¯¹è±¡ã€‚æˆ‘ä»¬ä»¥è¿”å›è¯¥ç±»çš„ä¸€ä¸ªç¼“å­˜å¯¹è±¡ä¸ºä¾‹ï¼š 1234567891011121314151617181920class Logger { final String name; bool mute = false; // _cache is library-private, thanks to // the _ in front of its name. static final Map&lt;String, Logger&gt; _cache = &lt;String, Logger&gt;{}; factory Logger(String name) { return _cache.putIfAbsent( name, () =&gt; Logger._internal(name)); } Logger._internal(this.name); void log(String msg) { if (!mute) print(msg); }} æ³¨æ„ï¼šfactory æ„é€ å‡½æ•°ä¸èƒ½é€šè¿‡ this å…³é”®å­—æ¥è·å–ç±»çš„æˆå‘˜ã€‚ æŠ½è±¡ç±»Dart ä¸­å¹¶æ²¡æœ‰ interface å…³é”®å­—ï¼Œåªæœ‰ abstract æ¥ä¿®é¥°â€æŠ½è±¡ç±»â€ï¼Œä½†æ˜¯ï¼Œè¿™é‡Œçš„æŠ½è±¡ç±»æ—¢å¯ä»¥è¢«ç»§æ‰¿ï¼ˆextendsï¼‰ï¼Œä¹Ÿå¯ä»¥è¢«å®ç°ï¼ˆimplementsï¼‰ã€‚å¦‚ï¼š 12345678910111213141516171819202122232425abstract class Person { // å¯ä»¥ä¸ç”¨ abstract ä¿®é¥°ï¼Œå¦‚æœåŠ ä¸Š abstract çš„è¯ Person ä¸èƒ½è¢«å®ä¾‹åŒ– String greet(who); }class Student implements Person { String name; Student(this.name); String greet(who) =&gt; 'Student: I am $name!'; } class Teacher implements Person { String name; Teacher(this.name); String greet(who) =&gt; 'Teacher: I am $name!'; } void main() { Person student = new Student('Wang'); Person teacher = new Teacher('Lee'); print( student.greet('Chen')); print(teacher.greet('Chen')); } åŒæ ·åœ°ï¼ŒDart ä¸­çš„ç±»æ˜¯å•ç»§æ‰¿ï¼Œå¤šå®ç°ã€‚è¿™é‡Œä½¿ç”¨çš„ implements åï¼Œå­ç±» Student æ— æ³•å»è®¿é—®çˆ¶ç±» Persion ä¸­çš„å˜é‡ï¼Œä½†æ˜¯æŠ½è±¡æ–¹æ³•å¿…é¡»æ˜¾å¼å®ç°ã€‚ç›¸åï¼Œå¦‚æœä½¿ç”¨ extends ç»§æ‰¿ï¼Œå­ç±»å°±å¯ä»¥ç›´æ¥ä½¿ç”¨çˆ¶ç±»çš„éç§æœ‰å˜é‡ï¼Œå€˜è‹¥çˆ¶ç±»ä¸æ˜¯æŠ½è±¡ç±»ï¼Œé‚£ä¹ˆå­ç±»åŒæ ·ä¸éœ€è¦æ˜¾å¼å®ç°é‡Œé¢æ–¹æ³•ã€‚å¦‚ï¼š 12345678910111213141516171819202122232425// A person. The implicit interface contains greet().class Person { // In the interface, but visible only in this library. final _name; // Not in the interface, since this is a constructor. Person(this._name); // In the interface. String greet(String who) =&gt; 'Hello, $who. I am $_name.';}// An implementation of the Person interface.class Impostor implements Person { get _name =&gt; ''; String greet(String who) =&gt; 'Hi $who. Do you know who I am?';}String greetBob(Person person) =&gt; person.greet('Bob');void main() { print(greetBob(Person('Kathy'))); print(greetBob(Impostor()));} è¿ç®—ç¬¦é‡è½½ä»¥ä¸‹çš„è¿ç®—ç¬¦æ”¯æŒé‡è½½åŠŸèƒ½ï¼š | &lt; | + | | | [] || â€”- | â€”- | â€”- | â€”- || &gt; | / | ^ | []= || &lt;= | ~/ | &amp; | ~ || &gt;= | * | &lt;&lt; | == || â€“ | % | &gt;&gt; | | è¿™ä¸€ç‚¹ä¸ kotlin è¯­è¨€ä¸­çš„è¿ç®—ç¬¦é‡è½½åŠŸèƒ½ç±»ä¼¼ã€‚æˆ‘ä»¬ä»¥ä¸‹é¢è¿™ä¸ªè¡¨ç¤ºå¹³é¢å‘é‡çš„ç±»ä¸ºä¾‹ï¼Œä¸ºå®ƒå¢åŠ ä¸¤ä¸ªå‘é‡ç›¸åŠ å’Œç›¸å‡åŠŸèƒ½ï¼š 12345678910111213141516171819class Vector { final int x, y; Vector(this.x, this.y); Vector operator +(Vector v) =&gt; Vector(x + v.x, y + v.y); Vector operator -(Vector v) =&gt; Vector(x - v.x, y - v.y); // Operator == and hashCode not shown. For details, see note below. // Â·Â·Â·}void main() { final v = Vector(2, 3); final w = Vector(2, 2); assert(v + w == Vector(4, 5)); assert(v - w == Vector(0, 1));} æšä¸¾æšä¸¾çš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œå’Œ Java ä¸­çš„ç”¨æ³•ç±»ä¼¼ï¼Œå£°æ˜çš„å…ƒç´  index å€¼ä» 0 å¼€å§‹è®¡ç®—ã€‚ 12345enum Color { red, green, blue }......assert(Color.red.index == 0);assert(Color.green.index == 1);assert(Color.blue.index == 2); Mixin æ··åˆæ¨¡å¼Mixins æ˜¯ä¸€ç§åœ¨å¤šä¸ªç±»çš„å±‚çº§ä¸­å¤ç”¨ç±»ä¸­ä»£ç çš„ä¸€ç§æ–¹å¼ã€‚åœ¨ç±»ååæ·»åŠ  with å…³é”®å­—ï¼Œå¹¶åœ¨ with åç´§è·Ÿç±»çš„æ ‡è¯†ç¬¦åˆ—è¡¨ï¼Œé€šè¿‡é€—å·åˆ†éš”ï¼Œå¦‚ï¼š 1234567class Maestro extends Person with Musical, Aggressive, Demented { Maestro(String maestroName) { name = maestroName; canConduct = true; }} å¦‚æœæƒ³è¦å£°æ˜ä¸€ä¸ªæ··åˆæ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡ mixin æ¥ä»£æ›¿ class å®šä¹‰ä¸€ä¸ªä¸å«æ„é€ æ–¹æ³•çš„ç±»ï¼š 123456789101112131415mixin Musical { bool canPlayPiano = false; bool canCompose = false; bool canConduct = false; void entertainMe() { if (canPlayPiano) { print('Playing piano'); } else if (canConduct) { print('Waving hands'); } else { print('Humming to self'); } }} å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæŸä¸ªç±»æ¥ä½¿ç”¨å®šä¹‰çš„æ··åˆæ¨¡å¼ï¼Œé€šè¿‡ on å…³é”®å­—ï¼š 123mixin MusicalPerformer on Musician { // Â·Â·Â·} é™æ€å˜é‡å’Œå‡½æ•°å®šä¹‰é™æ€å˜é‡å’Œå‡½æ•°çš„æ–¹æ³•ä¸ Java ç±»ä¼¼ï¼š 1234567891011121314151617181920class Point { num x, y; Point(this.x, this.y); static const originalPoint = Point(0, 0); static num distanceBetween(Point a, Point b) { var dx = a.x - b.x; var dy = a.y - b.y; return sqrt(dx * dx + dy * dy); }}// usagevoid main() { var a = Point(2, 2); var b = Point(4, 4); var distance = Point.distanceBetween(a, b); assert(2.8 &lt; distance &amp;&amp; distance &lt; 2.9); print(distance);} å¼‚æ­¥æ“ä½œDart æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œå¦‚æœè¿›è¡Œ I/O æ“ä½œæˆ–è¿›è¡Œè€—æ—¶çš„æ“ä½œæ—¶ï¼Œç¨‹åºå¯èƒ½ä¼šå‘ç”Ÿé˜»å¡ã€‚Dart åº“ä¸­çš„å¾ˆå¤šå‡½æ•°éƒ½è¿”å› Future æˆ–è€… Stream å¯¹è±¡ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå®ƒä»¬å¯ä»¥åœ¨å»ºç«‹ä¸€ä¸ªè€—æ—¶æ“ä½œä¹‹åè¿”å›ï¼Œè€Œæ— éœ€ç­‰å¾…è€—æ—¶æ“ä½œæ‰§è¡Œå®Œæˆã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥å®ç°å¼‚æ­¥æ“ä½œï¼š é€šè¿‡ async å’Œ await å®ç° å€ŸåŠ©äº Future API æ¥å®ç° async å’Œ awaité€šè¿‡ async å’Œ await å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°å¼‚æ­¥æ“ä½œã€‚è¦ä½¿ç”¨ awaitï¼Œå¿…é¡»è¦å°†å‡½æ•°ç”¨ async ä¿®é¥°ï¼ŒåŒæ—¶å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª Future å¯¹è±¡ã€‚ç®€å•ç”¨æ³•å¦‚ä¸‹ï¼š 1234567Future checkVersion() async { try { version = await lookUpVersion(); } catch (e) { // React to inability to look up the version }} ç”Ÿæˆå™¨ *åŒæ­¥ç”Ÿæˆå™¨ â€” sync** å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒåŒæ­¥ç”Ÿæˆå™¨ä¼šè¿”å› Iterable å¯¹è±¡ï¼š 1234Iterable&lt;int&gt; naturalsTo(int n) sync* { int k = 0; while (k &lt; n) yield k++;} *å¼‚æ­¥ç”Ÿæˆå™¨ â€” async** å¼‚æ­¥ç”Ÿæˆå™¨è¿”å› Stream å¯¹è±¡ï¼š 1234Stream&lt;int&gt; asynchronousNaturalsTo(int n) async* { int k = 0; while (k &lt; n) yield k++;} *yield** é€šè¿‡ yield* åœ¨é€’å½’ä¸­æå‡æ€§èƒ½ï¼š 123456Iterable&lt;int&gt; naturalsDownFrom(int n) sync* { if (n &gt; 0) { yield n; yield* naturalsDownFrom(n - 1); }} å°†ç±»å¯¹è±¡ä½œä¸ºå‡½æ•°è°ƒç”¨Dart å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå‡½æ•°æ¥è°ƒç”¨ï¼Œåªéœ€è¦å®ç° call() å‡½æ•°å³å¯ï¼š 123456789class WannabeFunction { call(String a, String b, String c) =&gt; '$a $b $c!';}main() { var wf = new WannabeFunction(); var out = wf(\"Hi\",\"there,\",\"gang\"); print('$out');} æœªå®Œå¾…ç»­ æ­¤æ–‡åªæ˜¯ Dart å¾ç¨‹çš„ä¸€ä¸ªèµ·ç‚¹ï¼Œäº¦æ˜¯ Flutter ä¸­çš„ä¸€å—åŸºçŸ³ï¼Œåç»­è¿˜æœ‰æ›´å¤šè¿›é˜¶ç”¨æ³•å’Œç»†èŠ‚ API ç­‰ç€æˆ‘ä»¬å»æŒ–æ˜ï¼Œkeep learningï¼","link":"/2019/08/20/dart-learning/"},{"title":"Flutter ä¹‹ AppBar è¿™æ ·çš„éªšæ“ä½œä½ çŸ¥é“å—ï¼Ÿ","text":"å¥½ä¹…ä¸è§äº†ï¼Œè¿™é˜µå­åœ¨å¿™å…¬å¸çš„é¡¹ç›®ï¼ŒåŠ ç­æ¯”è¾ƒä¸¥é‡ï¼Œè¿™å‘¨ç»ˆäºæŠ½äº†ç‚¹æ—¶é—´æ¥å­¦ä¹ ä¸€ä¸‹æ–°æŠ€æœ¯ã€‚ç”±äºå»å¹´ä¹æœˆä»½åœ¨ä¸Šæµ·å‚åŠ è¿‡ Google ä¸¾åŠçš„ Google develop daysï¼Œ å—ç›Šé¢‡å¤šï¼Œç‰¹åˆ«åœ¨å…¶ç›®å‰æ­£åœ¨å¤§åŠ›çƒ­æ¨çš„ Flutter æ¡†æ¶ã€‚ç›¸æ¯”äºç›®å‰çƒ­é—¨çš„è·¨å¹³å°æ¡†æ¶ React Nativeï¼ŒFlutteråœ¨ UI ç»˜åˆ¶ä»¥åŠæ€§èƒ½æ–¹ä¾¿ä¸é‘å¤šè®©ã€‚å› æ­¤ï¼Œè¿™æ¬¾ app æ‰“ç®—åŸºäº Dart è¯­è¨€ï¼Œå¹¶é‡‡ç”¨ Flutter æ¡†æ¶æ¥å®Œæˆã€‚ èŠ±äº†å¤§æ¦‚å‡ å¤©æ—¶é—´ç†Ÿæ‚‰äº†ä¸‹ Dart è¯­æ³•å’Œ Flutter åŸºæœ¬ç»„æˆæ§ä»¶ï¼Œå°±å¼€å§‹æ‘¸ç´¢ç€åšä¸€ä¸ªç»ƒæ‰‹é¡¹ç›®ã€‚AppBar æƒ³å¿…å¤§å®¶éƒ½ç”¨è¿‡ï¼Œå½“å…¶å¤„äºå¯åŠ¨é¡µé¢æ—¶æ˜¯éšè— leading çš„ï¼Œè€Œå¤„äºå…¶ä»–é¡µé¢æ—¶å·¦è¾¹é»˜è®¤æºå¸¦è¿”å›æŒ‰é’®ã€‚ç›®å‰ï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯ï¼šé¦–é¡µçš„ AppBar æœ€å·¦è¾¹ä¸ºç”¨æˆ·å¤´åƒï¼Œç‚¹å‡»ç”¨æˆ·å¤´åƒå¯ä»¥è‡ªåŠ¨æ‰“å¼€å·¦ä¾§æŠ½å±‰æ ã€‚ æœ€ç»ˆæ•ˆæœå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š åˆå­¦è€…ä¸€å¼€å§‹æ€»æ˜¯ç—›è‹¦çš„ï¼Œè¿˜å¥½ï¼Œè§£å†³é—®é¢˜çš„é€”å¾„â€œä¸‡å˜ä¸ç¦»å…¶å®—â€ã€‚æˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹ä¸€ä¸‹ Flutter å®˜æ–¹æ–‡æ¡£ å‘ç°ï¼Œè¦ä½¿ç”¨ AppBaræ¥æ“ä½œé¡µé¢ï¼Œå†³å®šå…¶å·¦è¾¹ç‚¹å‡»äº‹ä»¶çš„å±æ€§å°±æ˜¯ leading ï¼š 12345678910111213141516171819AppBar({Key key,Widget leading,bool automaticallyImplyLeading: true,Widget title,List&lt;Widget&gt; actions,Widget flexibleSpace,PreferredSizeWidget bottom,double elevation,Color backgroundColor,Brightness brightness,IconThemeData iconTheme,TextTheme textTheme,bool primary: true,bool centerTitle,double titleSpacing: NavigationToolbar.kMiddleSpacing,double toolbarOpacity: 1.0,double bottomOpacity: 1.0}) å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ AppBar ä¸­çš„ leading å±æ€§æ˜¯ä¸€ä¸ª Widget ç±»å‹ï¼Œé‚£ä¹ˆå®ƒæ¥æ”¶çš„å‚æ•°èŒƒå›´å°±å¾ˆå¹¿äº†ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†ä¸€ä¸ªæŒ‰é’®ä¼ é€’ç»™å®ƒï¼Œå¹¶åœ¨ onPressed æ–¹æ³•ä¸­å¤„ç†å·¦è¾¹ä¾§æ»‘æ çš„å¼€å¯å’Œå…³é—­çŠ¶æ€ã€‚ğŸ‘Œï¼Œæœ‰æ€è·¯äº†å’±ä»¬ä¹…å¼€å§‹è¯•éªŒä¸€ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950final GlobalKey&lt;ScaffoldState&gt; _scaffoldKey = new GlobalKey();@override Widget build(BuildContext context) { return new DefaultTabController( length: _pages.length, child: new Scaffold( key: _scaffoldKey, appBar: new AppBar( /// ç¬¬ä¸€ç§æ–¹å¼ /// é€šè¿‡å¯ç›‘å¬ç‚¹å‡»çš„IconButtonä¼ å…¥widgetï¼Œ /// å¹¶åœ¨onPressedä¸­å¤„ç†drawerå¼€å¯ï¼Œå€ŸåŠ©äºGlobalKey leading: new IconButton( icon: new Container( padding: EdgeInsets.all(3.0), child: new CircleAvatar( radius: 30.0, backgroundImage: AssetImage(&quot;assets/images/moosphon_logo.jpeg&quot;) ), ), onPressed: (){ _scaffoldKey.currentState.openDrawer(); }, ), centerTitle: true, title: new TabBar( isScrollable: true, labelPadding: EdgeInsets.all(14), indicatorSize: TabBarIndicatorSize.label, indicatorColor: Colors.white, tabs: _titles.map((String title) =&gt; new Tab(text: title)).toList() ), actions: &lt;Widget&gt;[ new IconButton( icon: new Icon(Icons.search), tooltip: 'æœç´¢', onPressed: (){ NavigatorUtil.intentToPage(context, new SearchPage(), pageName: &quot;SearchPage&quot;); } ) ], ), body: new TabBindingView(), drawer: new Drawer( child: new HomeLeftDrawerPage(), ), ) ); } ä¸ºäº†ä¸å½±å“ç¯‡å¹…ï¼Œè¿™é‡Œæˆ‘åªè´´äº†å…³é”®ä»£ç ï¼Œè‡³äº Drawer ç”¨æ³•ç›¸ä¿¡å¤§å®¶æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬ç»™ AppBar çš„leading å‚æ•°ä¼ äº†ä¸€ä¸ª IconButton æ§ä»¶ï¼Œé‡Œé¢æˆ‘è¿˜å®ç°äº†åœ†å½¢å¤´åƒã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„ç”¨æˆ·å¤´åƒå°±å¯ä»¥è¢«ç‚¹å‡»äº†å“åº”äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å¤„ç†å¤´åƒç‚¹å‡»äº‹ä»¶ä¸ Drawer çš„è”åŠ¨æ€§äº†ã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡è®¾ç½® GlobalKey æ¥è®© Scaffold å®¹å™¨è·å–åˆ°å…¶å†…éƒ¨çš„ Drawer ç»„ä»¶ï¼Œè¿›è€Œæ§åˆ¶å®ƒçš„å¼€é—­ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å·²ç»å¯ä»¥é€šè¿‡ç‚¹å‡»è‡ªå®šä¹‰çš„ç”¨æˆ·å¤´åƒæ¥å¼€å¯å·¦è¾¹ä¾§æ»‘æ å•¦ğŸ˜„ã€‚ ç»†å¿ƒçš„å°ä¼™ä¼´ä¸€å®šä¼šå‘ç°ï¼Œä¸Šé¢çš„ä»£ç ä¸­æˆ‘æ³¨é‡Šè¿™åªæ˜¯ç¬¬ä¸€ç§å®ç°æ–¹å¼ï¼Œéš¾é“è¿˜æœ‰ç¬¬äºŒç§å®ç°æ–¹å¼ï¼Ÿå“ˆå“ˆï¼Œæ²¡é”™ï¼Œçš„ç¡®è¿˜æœ‰ç¬¬äºŒç§æ€è·¯ã€‚å…¶å®ï¼Œé€šè¿‡æŸ¥çœ‹ AppBar çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼šAppBarå†…éƒ¨å·²ç»è‡ªåŠ¨å®ç°äº† AppBar çš„ leading ä¸ Drawer æŠ½å±‰æ çš„å…³è”ï¼š 12345678910111213141516171819Widget leading = widget.leading; if (leading == null &amp;&amp; widget.automaticallyImplyLeading) { if (hasDrawer) { leading = IconButton( icon: const Icon(Icons.menu), onPressed: _handleDrawerButton, tooltip: MaterialLocalizations.of(context).openAppDrawerTooltip, ); } else { if (canPop) leading = useCloseButton ? const CloseButton() : const BackButton(); } } if (leading != null) { leading = ConstrainedBox( constraints: const BoxConstraints.tightFor(width: _kLeadingWidth), child: leading, ); } ç”±äºä»£ç è¾ƒå¤šï¼Œè¿™é‡Œæˆ‘åªæ”¾ä¸Šäº† build æ–¹æ³•ä¸­å…³äº leading éƒ¨åˆ†çš„å…³é”®ä»£ç ï¼Œé€šè¿‡åˆ†ææˆ‘ä»¬å¯ä»¥å‘ç°ï¼š leading å¦‚æœ ä¸ºç©ºå¹¶ä¸” automaticallyImplyLeading å±æ€§ä¸ºtrueï¼Œé‚£ä¹ˆå°±ä¼šè‡ªåŠ¨æ¨æ–­å‡º leading çš„ Widget çš„ç±»å‹å’Œç”¨é€”ï¼Œå¦å¤–å¦‚æœå½“å‰ Scaffold ä¸­å­˜åœ¨ Drawer ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª IconButton ä½œä¸ºleading ä½¿ç”¨ï¼ŒåŒæ—¶å®ƒçš„ç‚¹å‡»äº‹ä»¶ä¸­å¤„ç†äº†ä¸ Drawer æŠ½å±‰æ çš„å…³è”äº‹ä»¶ï¼Œæ— éœ€å¼€å‘è€…å†å¤„ç†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰äº† leading ï¼ˆä¾‹å¦‚å½“å‰æˆ‘ä»¬ç»™å®ƒä¼ çš„æ˜¯ç”¨æˆ·çš„å¤´åƒ Widget ï¼‰ï¼Œé‚£ä¹ˆ leading å°±æ— æ³•è‡ªåŠ¨å…³è” Drawer ï¼Œä¹Ÿå°±æ˜¯è¯´å…³è” Drawer çš„è¿™éƒ¨åˆ†ä»£ç éœ€è¦å¼€å‘è€…è‡ªè¡Œå®ç°ã€‚ å¦‚æœ leading ä¸ä¸ºç©ºå‘¢ï¼Ÿå¹¶ä¸” automaticallyImplyLeading å¼€å…³å…³é—­ï¼Œé‚£ä¹ˆ leading çš„ç©ºé—´å°±ä¼šè¢« title ç»™å æ®ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œæœ€ç»ˆçš„ç»“è®ºæ˜¯ï¼šå¦‚æœæˆ‘ä»¬æƒ³è¦è‡ªå®šä¹‰ leading ,é‚£ä¹ˆç›®å‰å®˜æ–¹æºç ä¸­ AppBar ä¸­ leading è‡ªåŠ¨å…³è” Drawer çš„å¤„ç†æˆ‘ä»¬æ²¡åŠæ³•ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬éè¦ç”¨å‘¢ï¼Ÿé‚£å°±åªèƒ½ä¿®æ”¹æºç å•¦ï¼š 123456789101112131415161718192021/// æ³¨æ„ï¼Œå‰æ–¹é«˜èƒ½æ¥è¢­ï¼Œä»¥ä¸‹ä¸ºä¿®æ”¹çš„éƒ¨åˆ†code Widget leading = widget.leading; if (/*leading == null &amp;&amp; */widget.automaticallyImplyLeading) { if (hasDrawer) { leading = IconButton( icon: /*const Icon(Icons.menu)*/ leading ?? Icon(Icons.home), // å¦‚æœleadingæŒ‡å®šäº†widgeté‚£ä¹ˆ onPressed: _handleDrawerButton, tooltip: MaterialLocalizations.of(context).openAppDrawerTooltip, ); } else { if (canPop) leading = useCloseButton ? const CloseButton() : const BackButton(); } } if (leading != null) { leading = ConstrainedBox( constraints: const BoxConstraints.tightFor(width: _kLeadingWidth), child: leading, ); } é“›é“›é“›é“›ï½è¿™å°±æ”¹å¥½å•¦ï¼Œæ”¹åŠ¨çš„åœ°æ–¹æ˜¯ä¸æ˜¯å¾ˆå°‘ï¼Ÿå“ˆå“ˆğŸ˜„ï¼Œå…¶å®åªè¦æŠŠ leading ä¸ºç©ºçš„é™åˆ¶æ¡ä»¶å»æ‰ï¼Œå¹¶ä¸”å¯ä»¥ä¼ å…¥æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ Widget å°±å¥½å•¦ï¼ è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±ä¸ç”¨æ‰‹åŠ¨å»å¤„ç† leading ä¸ Drawer çš„å…³è”äº‹ä»¶ï¼Œåªéœ€è¦äº¤ç»™ç³»ç»Ÿå¸®æˆ‘ä»¬å®Œæˆå°±å¯ä»¥å•¦ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243@override Widget build(BuildContext context) { return new DefaultTabController( length: _pages.length, child: new Scaffold( key: _scaffoldKey, appBar: new DrawerAutoBindingAppBar( /// ç¬¬äºŒç§æ–¹å¼ /// é€šè¿‡ä¿®æ”¹[AppBar]æºç æ¥å°†æ™®é€šwidgetä½œä¸ºiconä¼ ç»™IconButton /// æºç ä¸­å·²å¤„ç†onPressedå…³è”draweräº‹ä»¶ï¼Œæ— éœ€é¢å¤–å¤„ç†ï¼Œè¯¦æƒ…è§[DrawerAutoBindingAppBar] leading: new Container( padding: EdgeInsets.all(3.0), child: new CircleAvatar( radius: 30.0, backgroundImage: AssetImage(&quot;assets/images/moosphon_logo.jpeg&quot;) ) ), centerTitle: true, title: new TabBar( isScrollable: true, labelPadding: EdgeInsets.all(14), indicatorSize: TabBarIndicatorSize.label, indicatorColor: Colors.white, tabs: _titles.map((String title) =&gt; new Tab(text: title)).toList() ), actions: &lt;Widget&gt;[ new IconButton( icon: new Icon(Icons.search), tooltip: 'æœç´¢', onPressed: (){ NavigatorUtil.intentToPage(context, new SearchPage(), pageName: &quot;SearchPage&quot;); } ) ], ), body: new TabBindingView(), drawer: new Drawer( child: new HomeLeftDrawerPage(), ), ) ); } ä»£ç å°±ä¸å¤šåšè§£é‡Šäº†ï¼Œæ•ˆæœæ˜¯å’Œä¹‹å‰ä¸€æ ·çš„ï¼Œå¥½å•¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ›´åŠ äº†è§£ AppBar çš„ç”¨æ³•ä»¥åŠ leading çš„èƒŒåâ€œå°å½©è›‹â€å•¦ğŸ˜ã€‚ æ„Ÿè°¢å¤§å®¶çš„é˜…è¯»ï¼Œä»¥åæˆ‘å°†ç»™å¤§å®¶å¸¦æ¥æ›´å¤šå¥½ç©å®ç”¨çš„åº”ç”¨å‹å¼€å‘æŠ€å·§ï¼Œå¦‚æœå¤§å®¶æœ‰ä»»ä½•å»ºè®®ï¼Œæ¬¢è¿ç•™è¨€ğŸ‘ã€‚ QQç¾¤ï¼š 601924443 ä¸€èµ·ç©æŠ€æœ¯ï½","link":"/2019/03/01/flutter-appbar/"},{"title":"Flutter ä¸­â€œå€’è®¡æ—¶â€çš„é‚£äº›äº‹å„¿","text":"å¥½ä¹…ä¸è§äº†ï¼Œæ–‡ç« æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´æ–°äº†ï¼Œæœ€è¿‘ä¸€ç›´åœ¨æ²‰è¿·å·¥ä½œæ— æ³•è‡ªæ‹¨ğŸ˜‚ã€‚ä¸Šå‘¨ï¼Œåº”å…¬å¸å·å¬ä»¥åŠä¸Šæ¬¡Googleå¤§ä¼šä¸­Flutterå®£è®²çš„æ„ŸæŸ“ï¼Œè®¡åˆ’å°†å…¬å¸æ–°é¡¹ç›®é‡‡ç”¨FlutteræŠ€æœ¯å®ç°ã€‚å¤§æ¦‚èŠ±äº†å‡ å¤©ç†Ÿæ‚‰äº†ä¸€ä¸‹FlutteråŸºç¡€è¯­æ³•å’Œç»“æ„ç»„æˆï¼Œä¾¿ç€æ‰‹å¼€å§‹é¡¹ç›®çš„æ­å»ºå’ŒåŸºç¡€æ¨¡å—åŠŸèƒ½å¼€å‘ï¼Œæ¯•ç«Ÿåªæœ‰é€šè¿‡å®æˆ˜æ‰èƒ½åŠ å¿«æ–°æŠ€æœ¯çš„ç†Ÿæ‚‰å’Œâ€œæ¶ˆåŒ–â€ã€‚ è¯´åˆ°éªŒè¯ç åŠŸèƒ½ï¼Œæˆ‘ä»¬é€šå¸¸çš„åšæ³•å¯èƒ½æ˜¯å€ŸåŠ©äºè®¡æ—¶å™¨æ¥å®ç°ï¼ŒæŠ±ç€å‡ ä¹è‚¯å®šçš„æ€åº¦èµ¶ç´§å»æŸ¥äº†ä¸€ä¸‹ Flutter å®˜ç½‘æœ‰æ²¡æœ‰ç›¸å…³çš„è®¡æ—¶å™¨ç»„ä»¶ã€‚æœä¸å…¶ç„¶ï¼Œå®˜æ–¹çš„ç¡®ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª Timer ç»„ä»¶æ¥å®ç°å€’è®¡æ—¶ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®˜æ–¹å¯¹äºå®ƒçš„æè¿°ï¼š Count-down timer that can be configured to fire once or repeatedly. å³å®ƒæ˜¯ä¸€ä¸ªæ”¯æŒä¸€æ¬¡æˆ–è€…å¤šæ¬¡å‘¨æœŸæ€§è§¦å‘çš„è®¡æ—¶å™¨ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥ç†Ÿæ‚‰è¿™ä¸¤ç§åœºæ™¯ä¸‹çš„åŸºæœ¬ç”¨æ³•ã€‚ å•æ¬¡è§¦å‘è¿™ç§æƒ…å†µä¸‹çš„ä¸€èˆ¬åœºæ™¯æ˜¯ä½œä¸ºå»¶æ—¶å™¨æ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šæ¥æ”¶åˆ°å€’è®¡æ—¶çš„è¿›åº¦ï¼Œåªä¼šåœ¨å€’è®¡æ—¶ç»“æŸåæ”¶åˆ°å›è°ƒæé†’ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ Flutter å®˜æ–¹æä¾›çš„ç¤ºä¾‹ä»£ç ï¼š 1234567891011const timeout = const Duration(seconds: 3);const ms = const Duration(milliseconds: 1);startTimeout([int milliseconds]) { var duration = milliseconds == null ? timeout : ms * milliseconds; return new Timer(duration, handleTimeout);}...void handleTimeout() { // callback function ...} ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ new Timer(Duration duration, void callback()) æ–¹å¼åˆ›å»ºçš„å®šæ—¶å™¨ä¼šæä¾›ä¸€ä¸ª callback å›è°ƒæ–¹æ³•æ¥å¤„ç†è®¡æ—¶ç»“æŸåçš„æ“ä½œã€‚è¿™æ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬éªŒè¯ç åŠŸèƒ½ä¸­å®æ—¶æ˜¾ç¤ºè¿›åº¦çš„éœ€æ±‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Timer å¦‚ä½•é‡å¤æ€§è§¦å‘å›è°ƒã€‚ å‘¨æœŸæ€§è§¦å‘å‘¨æœŸæ€§è§¦å‘è®¡æ—¶å›è°ƒçš„åœºæ™¯å°±å¾ˆæ™®éäº†ï¼Œåªè¦æ˜¯æ¶‰åŠåˆ°å®šæ—¶ç›¸å…³çš„æ“ä½œå¯èƒ½éƒ½ç¦»ä¸å¼€å®ƒï¼šæˆ‘ä»¬æ—¢éœ€è¦è¢«å‘ŠçŸ¥è®¡æ—¶ä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œä¹Ÿéœ€è¦å®æ—¶åœ°ç›‘æµ‹è®¡æ—¶çš„è¿›åº¦ã€‚è¿™æ­£ç¬¦åˆäº†æˆ‘ä»¬æœ€åˆæƒ³è¦çš„éªŒè¯ç åŠŸèƒ½è¿™ä¸ªéœ€æ±‚ã€‚dart-async åŒ… åŒæ ·ä¸ºæˆ‘ä»¬æä¾›äº† Timer.periodic æ„é€ æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå¯ä»¥é‡å¤å›è°ƒçš„è®¡æ—¶å™¨ï¼š 123456Timer.periodic( Duration duration, void callback( Timer timer )) æ­¤å¤–ï¼Œå®˜æ–¹æ˜¯è¿™æ ·æè¿° callback å‚æ•°çš„ï¼š The callback is invoked repeatedly with duration intervals until canceled with the cancel function. å¤§æ¦‚æ„æ€æ˜¯ï¼šcallback å›è°ƒæ–¹æ³•ä¼šä¼´éšæ—¶é—´æ¨ç§»è€Œè¢«å¤šæ¬¡è°ƒç”¨ï¼ˆè°ƒç”¨å‘¨æœŸä¸º durationï¼‰ï¼Œç›´åˆ°è°ƒç”¨ Timer.cancel æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå‘¨æœŸæ€§å›è°ƒçš„è®¡æ—¶å™¨å¹¶ä¸ä¼šâ€œç»“æŸè®¡æ—¶â€ï¼Œæˆ–è€…è¯´å®ƒå¹¶ä¸ä¼šè‡ªåŠ¨ç»“æŸè®¡æ—¶ä»»åŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å»ç»Ÿè®¡æ—¶é—´å¹¶åŠæ—¶å–æ¶ˆè®¡æ—¶ä»»åŠ¡ã€‚å…·ä½“å¦‚ä½•æ“ä½œå‘¢ï¼Ÿè¯´äº†è¿™ä¹ˆå¤šï¼Œä¸‹é¢è®©æˆ‘ä»¬è¿›å…¥æœ¬æ–‡æ­£é¢˜ï¼šéªŒè¯ç å€’è®¡æ—¶å®ç°å§ğŸ˜‚ã€‚å…¶å®ï¼Œè¯¥åŠŸèƒ½çš„å®ç°ä»£ç å¾ˆç®€å•ï¼Œè¿™é‡Œå°±ç›´æ¥è´´ä»£ç äº†ï¼š 12345678910111213141516171819202122232425262728Timer _countDownTimer; int _currentTime = 60; bool get _isTimeCountingDown =&gt; _currentTime != 60;void _startTimeCountDown() { if (_countDownTimer != null) { timer.cancel(); timer = null; } _countDownTimer = Timer.periodic(Duration(seconds: 1), (timer) { if (timer.tick == 60) { _currentTime = 60; _countDownTimer.cancel(); _countDownTimer = null; } else { _currentTime--; } setState(() { }); }); }@override void dispose() { _countDownTimer?.cancel(); _countDownTimer = null; super.dispose(); } æˆ‘ä»¬å¯ä»¥é€šè¿‡ Timer.tick æ¥è·å–å½“å‰è®¡æ—¶ï¼ˆé€’å¢ï¼‰çš„è¿›åº¦ï¼ŒåŒæ—¶å€ŸåŠ©äº _currentTime æ¥æ ‡è®°è®¡æ—¶çš„è¿›åº¦å€¼ï¼Œå…¶ä»–çš„é€»è¾‘ä»£ç åº”è¯¥å°±æ¯”è¾ƒå¥½ç†è§£äº†ã€‚ ä»€ä¹ˆï¼Ÿä½ ä»¥ä¸ºåˆ°è¿™é‡Œå°±å®Œäº†ï¼Ÿå“ˆå“ˆï¼Œå½“ç„¶ä¸ä¼šï¼Œå‡å¦‚å€’è®¡æ—¶åŠŸèƒ½éœ€è¦åœ¨æˆ‘ä»¬é¡¹ç›®é‡Œæœ‰å¾ˆå¤šä¸åŒçš„ä½¿ç”¨æƒ…æ™¯ï¼Œé‚£ä¹ˆå°±è¯¥å¯¹å€’è®¡æ—¶è¿™ä¸ªåŠŸèƒ½è¿›è¡Œå°è£…äº†ï¼Œå†µä¸”ï¼Œé€šè¿‡ setState æ–¹å¼æ¥å®æ—¶å±•ç¤ºå€’è®¡æ—¶è¿›åº¦è€Œå»åˆ·æ–°æ•´ä¸ªè§†å›¾æ ‘ç€å®ä¸å¤ªå‹å¥½ã€‚ å€’è®¡æ—¶å°è£…ç›®å‰ï¼ŒFlutter çŠ¶æ€ç®¡ç†æ–¹æ¡ˆå‘ˆç°â€œç™¾å®¶äº‰é¸£â€ä¹‹æ€ï¼Œä¸ªäººè¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢ Provider æ¥ç®¡ç†çŠ¶æ€ã€‚ä¸‹é¢å°±ç”¨ Provider æ¥å°†å€’è®¡æ—¶åŠŸèƒ½å°è£…ä¸ºä¸€ä¸ªç»„ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import 'dart:async';import 'package:flutter/material.dart';/// è®¡æ—¶å™¨ç»„ä»¶class CountDownTimeModel extends ChangeNotifier { final int timeMax; final int interval; int _time; Timer _timer; int get currentTime =&gt; _time; bool get isFinish =&gt; _time == timeMax; CountDownTimeModel(this.timeMax, this.interval) { _time = timeMax; } void startCountDown() { if (_timer != null) { _timer.cancel(); _timer = null; } _timer = Timer.periodic(Duration(seconds: interval), (timer) { if (timer.tick == timeMax) { _time = timeMax; timer.cancel(); timer = null; } else { _time--; } notifyListeners(); }); } void cancel() { if (_timer != null) { _timer.cancel(); _timer = null; } } @override void dispose() { _timer.cancel(); _timer = null; super.dispose(); }} å…·ä½“å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿç†Ÿæ‚‰ Provider ç”¨æ³•çš„å°ä¼™ä¼´åº”è¯¥å°±ä¸ç”¨å¤šè¯´äº†ï¼Œè¿™è¾¹ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œå°±ä»¥ä¸‹é¢è¿™ä¸ªæ•ˆæœä¸ºä¾‹ï¼š ç‚¹å‡»â€œè·å–éªŒè¯ç â€æŒ‰é’®å¼€å§‹ 60 ç§’å€’è®¡æ—¶æœåŠ¡ï¼Œç»“æŸå€’è®¡æ—¶è¿‡ç¨‹ä¸­æŒ‰é’®éœ€è¦å¤„äºä¸å¯ç‚¹å‡»çŠ¶æ€ï¼Œå€’è®¡æ—¶ç»“æŸåæ¢å¤ç‚¹å‡»çŠ¶æ€ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104class _LoginPageState extends State&lt;TestPage&gt; { @override Widget build(BuildContext context) { final logo = Hero( tag: 'hero', child: CircleAvatar( backgroundColor: Colors.transparent, radius: 48.0, child: Image.asset(ImageAssets.holder_logo), ), ); final email = TextFormField( keyboardType: TextInputType.emailAddress, autofocus: false, initialValue: 'alucard@gmail.com', decoration: InputDecoration( hintText: 'Email', contentPadding: EdgeInsets.fromLTRB(20.0, 10.0, 20.0, 10.0), border: OutlineInputBorder(borderRadius: BorderRadius.circular(32.0)), ), ); final password = TextFormField( autofocus: false, initialValue: 'some password', obscureText: true, decoration: InputDecoration( hintText: 'Password', contentPadding: EdgeInsets.fromLTRB(20.0, 10.0, 20.0, 10.0), border: OutlineInputBorder(borderRadius: BorderRadius.circular(32.0)), ), ); final loginButton = Padding( padding: EdgeInsets.symmetric(vertical: 16.0), child: RaisedButton( shape: RoundedRectangleBorder( borderRadius: BorderRadius.circular(24), ), onPressed: () { }, padding: EdgeInsets.all(12), color: Colors.lightBlueAccent, child: Text('Log In', style: TextStyle(color: Colors.white)), ), ); final forgotLabel = FlatButton( child: Text( 'Forgot password?', style: TextStyle(color: Colors.black54), ), onPressed: () {}, ); return Scaffold( backgroundColor: Colors.white, body: Center( child: ListView( shrinkWrap: true, padding: EdgeInsets.only(left: 24.0, right: 24.0), children: &lt;Widget&gt;[ logo, SizedBox(height: 48.0), email, SizedBox(height: 8.0), ScreenUtils.verticalSpace(2), Stack( children: &lt;Widget&gt;[ password, PartialConsumeComponent&lt;CountDownTimeModel&gt;( model: CountDownTimeModel(60, 1), builder: (context, model, _) =&gt; Positioned( right: 10, bottom: 1, top: 1, child: FlatButton( disabledColor: Colors.grey.withOpacity(0.36), color: Colors.white70.withOpacity(0.7), onPressed: !model.isFinish ? null : () { model.startCountDown(); }, child: Text( model.isFinish ? 'è·å–éªŒè¯ç ' : model.currentTime.toString()+'ç§’åé‡æ–°è·å–', style: TextStyle(color: model.isFinish ? Colors.lightBlueAccent : Colors.white), ) ), ), ), ], ), SizedBox(height: 24.0), loginButton, forgotLabel ], ), ), ); }} è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ CountDownTimeModel ä¸­å®šä¹‰çš„ isFinish å­—æ®µæ¥åˆ¤æ–­å€’è®¡æ—¶æ˜¯å¦æ­£åœ¨è¿›è¡Œï¼Œè¿›è€Œå¤„ç†æŒ‰é’®çš„å„ç§çŠ¶æ€ï¼ˆå¦‚é¢œè‰²ã€ç‚¹å‡»çŠ¶æ€ã€æ–‡å­—å†…å®¹ç­‰ï¼‰ã€‚æ­¤å¤„ä¸ºäº†æ–¹ä¾¿å¯¹å½“å‰é¡µé¢çŠ¶æ€è¿›è¡Œç®¡ç†ï¼Œæˆ‘å•ç‹¬å°è£…äº†ä¸€ä¸ªå…¬ç”¨çš„æ¶ˆè´¹è€…ç»„ä»¶ï¼š 12345678910111213141516171819202122232425262728293031class PartialConsumeComponent&lt;T extends ChangeNotifier&gt; extends StatefulWidget { final T model; final Widget child; final ValueWidgetBuilder&lt;T&gt; builder; PartialConsumeComponent({ Key key, @required this.model, @required this.builder, this.child }) : super(key: key); @override _PartialConsumeComponentState&lt;T&gt; createState() =&gt; _PartialConsumeComponentState&lt;T&gt;();}class _PartialConsumeComponentState&lt;T extends ChangeNotifier&gt; extends State&lt;PartialConsumeComponent&lt;T&gt;&gt; { @override Widget build(BuildContext context) { return ChangeNotifierProvider&lt;T&gt;.value( value: widget.model, child: Consumer&lt;T&gt;( builder: widget.builder, child: widget.child, ), ); }} æœ€åæœ¬äººåˆšæ¥è§¦ Flutter ä¸¤å‘¨å·¦å³ï¼Œæœ‰äº›åœ°æ–¹å¯èƒ½ä¼šä¸ºäº†å¼€å‘è¿›åº¦è€Œå¿½ç•¥ä¸€äº›ç»†èŠ‚ï¼Œå¦‚æœ‰ä¸ä¸¥è°¨æˆ–è€…ç–æ¼ä¹‹å¤„æ¬¢è¿æŒ‡æ­£ã€‚æ­¤å¤–ï¼Œåç»­æˆ‘å°†ä¸ºå¤§å®¶å¸¦æ¥æ›´å¤š Android å’Œ Flutter æ–¹é¢æ–‡ç« ï¼Œè¯·æœŸå¾…ã€‚ å‚è€ƒ Flutter å®˜æ–¹æ–‡æ¡£ Provider Flutter | çŠ¶æ€ç®¡ç†æŒ‡å—ç¯‡â€”Provider","link":"/2020/02/18/flutter-timer/"},{"title":"Google develop days 2018 ä¹‹æ—…","text":"ç»è¿‡ä¸¤å¤© Google Develop Day ä¹‹æ—…ï¼Œå¼ºçƒˆæ„Ÿå—åˆ°è°·æ­Œçš„å¥‰çŒ®ç²¾ç¥ï¼Œä¸å›½å†…å…¶ä»–å¤§ä¼šä¸åŒï¼Œå®ƒæ›´æ³¨é‡å¼€å‘è€…å’Œç”¨æˆ·çš„æ„è§ï¼Œä¸€ç›´åœ¨ä¸ºå¼€å‘è€…æä¾›ä¾¿æ·å¼€å‘å·¥å…·å’Œæ¥å£çš„åŒæ—¶ï¼Œä¹Ÿåœ¨ä¸ºæé«˜äº¤äº’æµç•…æ€§å’Œç”¨æˆ·ä½“éªŒåº¦çš„é“è·¯ä¸ŠåŠªåŠ›å‰è¿›ç€ã€‚æˆ‘å°†é’ˆå¯¹ Google å¤§ä¼šä¸­å¯¹äºå¼€å‘è€…è€Œè¨€æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªéƒ¨åˆ†ï¼Œç»“åˆä¸ªäººçœ‹æ³•ç®€å•è¯´æ˜ä¸€ä¸‹å¤§ä¼šä¸­çš„ä¸»è¦å†…å®¹ã€‚ Android JetPackGoogle åœ¨æœ¬æ¬¡å¼€å‘è€…ç››ä¼šä¸­ï¼Œä¾æ—§å°† Android ä½œä¸ºä¸»è¦çš„åˆ†äº«ä¸»é¢˜ï¼Œè€Œ Android JetPack ä¹Ÿæ˜¯ä½œä¸ºæœ¬æ¬¡ Android åˆ†ä¼šé¦†ä¸­æ¯”è¾ƒé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚æ­£å¦‚æœ¬æ¬¡å¤§ä¼šä»‹ç»çš„é‚£æ ·ï¼ŒJetPack ä½œä¸º â€œAndroidå¼€å‘åŠ é€Ÿå™¨â€ï¼Œå®ƒæ˜¯ä¸€ç³»åˆ—çš„ç»„ä»¶ã€å·¥å…·å’Œæ¶æ„æŒ‡å—ã€‚ä¸»è¦ä»å››ä¸ªæ–¹é¢æå‡ Android å¼€å‘çš„æ•ˆç‡ï¼š æ¶æ„ï¼š WorkManagerï¼šåå°ä»»åŠ¡æ‰§è¡Œ Navigationï¼šé¡µé¢ä¹‹é—´è·³è½¬ Pagingï¼šæ•°æ®åˆ†é¡µåŠŸèƒ½ Data Bindingï¼šæ•°æ®ç»‘å®š Lifecyclesï¼šç”Ÿå‘½å‘¨æœŸå¤„ç† LiveDataï¼šæ•°æ®ä¸UIå®æ—¶æ›´æ–° Roomï¼šæ•°æ®ç¼“å­˜ ViewModelï¼šUIä¸æ•°æ®ç®¡ç† è¡Œä¸ºï¼š Slicesï¼šç®€åŒ–äº¤äº’å’Œæ“ä½œ Download Managerï¼šå†…ç½®ä¸‹è½½å™¨ Media&amp;Playbackï¼šå¤šåª’ä½“ Permissionsï¼šæƒé™ç”³è¯· Notificationsï¼šé€šçŸ¥ Sharingï¼šå…±äº« ç•Œé¢ï¼š Fragment Layout Palette Animation &amp; Translations Autoï¼ŒTV &amp; Wear Emoji åŸºç¡€ï¼š Kotlin Extensions AppCompat Multidex Test JetPackä¹Ÿæä¾›äº†å‘åå…¼å®¹çš„ç‰¹æ€§ï¼Œèƒ½è®©è¾ƒä½sdkç‰ˆæœ¬çš„åº”ç”¨ä¾æ—§å¯ä»¥äº«å—è¿™äº›å·¥å…·ç»„ä»¶å¸¦æ¥çš„ä¾¿åˆ©ã€‚ FireBaseä»€ä¹ˆæ˜¯ FireBaseï¼ŸFireBase æ˜¯ä¸€ä¸ªäº‘ç«¯æ•°æ®å­˜å‚¨å¹³å°ï¼Œå¯ä»¥è½»æ¾å®ç°æ•°æ®çš„å®æ—¶æ›´æ–°ã€‚å®ƒæ—¨åœ¨è½»æ¾æ‰“é€ å¯Œæœ‰å¸å¼•åŠ›çš„appï¼Œå¸®åŠ©äº†è§£ç”¨æˆ·è¡Œä¸ºä»¥åŠè¯Šæ–­å’Œç›‘æ§ app çš„è¡¨ç°ï¼Œç„¶åæ ¹æ®ç”¨æˆ·çš„æ“ä½œæ¥å®šä½ç”¨æˆ·èŒƒå›´ã€‚ ML Kit å°†è°·æ­Œæœºå™¨å­¦ä¹ æ–¹é¢çš„æˆæœå¸¦ç»™ç§»åŠ¨åº”ç”¨å¼€å‘è€…ï¼š æ•°æ®åˆ†æèƒ½åŠ›ï¼š é€šè¿‡æœºå™¨å­¦ä¹ ï¼Œå¹¶åŠ¨æ€ç»‘å®šè®­ç»ƒæ¨¡å‹ï¼Œåº”ç”¨ä¸éœ€è¦å‡çº§å°±å¯ä»¥æ›´æ–°æ¨¡å‹ã€‚ å´©æºƒä¿¡æ¯é‡‡é›†ï¼š å¯ä»¥é€šè¿‡ Crashlytics æä¾›çš„ sdk å¯ä»¥å°†åº”ç”¨çš„ä¸€äº›å´©æºƒä¿¡æ¯é‡‡é›†åˆ°FireBaseä¸Šé¢ã€‚ æ›´å¤šï¼š â€‹ FlutterFlutter å¯ä»¥åª²ç¾åŸç”Ÿçš„äº¤äº’ä½“éªŒï¼Œç›¸å¯¹äº react native æ¥è¯´ï¼Œç»˜åˆ¶è¿‡ç¨‹çœå»äº†ä¸€ä¸ªç¯èŠ‚ï¼Œèƒ½å¤Ÿæ›´åŠ å¿«é€Ÿçš„æ¸²æŸ“ã€‚åŒæ—¶ä¹Ÿæ”¯æŒä¸åŸç”Ÿ Android å’Œ iOS ä¸šåŠ¡åŠŸèƒ½çš„ä»£ç æ··ç¼–ã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨ Flutterï¼Ÿ å¯è‡ªå®šä¹‰çš„æµç•…é¡µé¢ å¯åŒæ—¶åœ¨ Android å’Œ iOS è®¾å¤‡ä¸Šè¿›è¡ŒåŸç”Ÿç¼–è¯‘ é«˜æ•ˆçš„å¼€å‘å·¥å…·ï¼Œå¦‚ hot load(çƒ­é‡è½½) å“åº”å¼ç¼–ç¨‹ å„ç§å¿«æ·å®ç”¨çš„æ’ä»¶ï¼ˆimagepickerï¼Œè®¾ç½®æ»¤é•œï¼Œç¤¾äº¤å¹³å°åˆ†äº«ç­‰ï¼Œæ¯”åŸç”Ÿæ›´åŠ æ–¹ä¾¿ï¼‰ ARCoreåº”ç”¨åœºæ™¯ï¼š è´­ç‰©ã€ARç‰¹æ•ˆã€æ¸¸æˆã€ç¤¾äº¤ ä¸»è¦åŠŸèƒ½ï¼š è¿åŠ¨è·Ÿè¸ª ARCore åˆ©ç”¨æ‘„åƒå¤´å›¾åƒä¸­çš„è§†è§‰å·®å¼‚ç‰¹å¾å¹¶ç»“åˆè®¾å¤‡ä¸­æƒ¯æ€§ä¼ æ„Ÿå™¨çš„æµ‹é‡ç»“æœï¼Œä¼°ç®—è®¾å¤‡çš„ä½ç½®å’Œæ–¹å‘ã€‚ å…‰ä¼°æµ‹ ARCore å¯ä»¥æ£€æµ‹å…¶ç¯å¢ƒå…‰çº¿çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶æä¾›ç»™å®šæ‘„åƒå¤´å›¾åƒçš„å¹³å‡å…‰å¼ºåº¦å’Œè‰²å½©æ ¡æ­£ï¼Œè¾¾åˆ°èƒ½ä¸å‘¨å›´ç¯å¢ƒç›¸åŒçš„å…‰ç…§æ¥ç…§äº®è™šæ‹Ÿç‰©ä½“ï¼Œæé«˜å®ƒä»¬çš„çœŸå®æ„Ÿã€‚ ç¯å¢ƒç†è§£ ARCoreé€šè¿‡æ£€æµ‹ç‰¹å¾ç‚¹æ¥æ£€æµ‹å¹³é¢ï¼Œå¹¶è®©è¿™äº›å¹³é¢å¯ä»¥ç”±æˆ‘ä»¬çš„åº”ç”¨æ¥è¿ä½œå¹³é¢ã€‚ åŒæ—¶ï¼ŒARCoreå¯ä»¥é€šè¿‡äº‘é”šç‚¹å°†é”šç‚¹å’Œé™„è¿‘ç‰¹å¾ç‚¹å‘é€è‡³äº‘ç«¯æ‰˜ç®¡ï¼Œç„¶åå¯ä»¥ä¸å…¶ä»–ç”¨æˆ·è¿›è¡Œç¯å¢ƒå…±äº«å’Œäº¤äº’ã€‚ TensorFlowTensorFlow æ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç±»å¼€æºæ¡†æ¶ã€‚å®ƒå¯ä»¥è®©æ¨¡å‹é€šè¿‡ä¸æ–­çš„æœºå™¨å­¦ä¹ æ¥äº§ç”Ÿä¸€å¥—è§„åˆ™ï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬é¢„æœŸçš„æ•ˆæœï¼Œè¿›è€Œæ¥å¤„ç†å¤§é‡æ•°æ®ï¼Œä»£æ›¿äººå·¥å¤„ç†çš„æˆæœ¬ã€‚","link":"/2018/09/21/google-io-2018/"},{"title":"Flutter å¼€å‘å°ç»“ | Tips","text":"æ¥è§¦ Flutter å·²ç»æœ‰ä¸€é˜µå­äº†ï¼ŒæœŸé—´è®°å½•äº†å¾ˆå¤šå¼€å‘å°é—®é¢˜ï¼Œè‹¦äºå¿™ç¢Œæ²¡æ—¶é—´æ•´ç†ï¼Œæœ€è¿‘é¡¹ç›®è¿›åº¦æ­¥ä¸Šæ­£è½¨ï¼Œå€Ÿæ­¤æœºä¼šæŠ½å‡ºç‚¹æ—¶é—´æ¥ç»Ÿä¸€è®°å½•è¿™äº›é—®é¢˜ï¼Œå¹¶åˆ†äº«é¡¹ç›®å¼€å‘ä¸­çš„ä¸€ç‚¹å¿ƒå¾—ä»¥åŠå¤šå¹³å°æ‰“åŒ…çš„ä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œå¸Œæœ›èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ğŸ˜ã€‚ UI ç»„ä»¶ä½¿ç”¨å®˜æ–¹ä¸ºæˆ‘ä»¬æä¾›äº†å¤§é‡åŸç”Ÿæ•ˆæœçš„ç»„ä»¶ï¼Œå¦‚ä»¥ Android ä¸­å¸¸è§çš„ Material Design ç³»åˆ—ç»„ä»¶å’Œ iOS ç³»ç»Ÿä¸­è®©è®¾è®¡å¸ˆä»¬â€œæ¬²ç½¢ä¸èƒ½â€çš„ Cupertino ç³»åˆ—ç»„ä»¶ã€‚ä»æˆ‘è¿™ä¸€ä¸ªæœˆå·¦å³å¯¹äº Flutter UI ç»„ä»¶çš„ä½¿ç”¨æƒ…å†µæ¥çœ‹ï¼Œä¸å¾—ä¸æ„Ÿæ…¨ä¸€å¥ï¼šâ€œçœŸé¦™â€ã€‚ç”±äºæœ¬äººä¹‹å‰æ˜¯åš Android å¼€å‘çš„ï¼Œæ‰€ä»¥å¯¹äº Android æ–¹é¢çš„ä¸€äº›â€œè¯Ÿç—…â€æ·±æœ‰ä½“ä¼šã€‚ä¾‹å¦‚ï¼Œè®¾è®¡å¸ˆç»å¸¸è®©æˆ‘ä»¬è¿˜åŸè®¾è®¡ç¨¿ä¸­çš„é˜´å½±æ•ˆæœï¼Œä¸€èˆ¬éœ€è¦è®¾ç½®é˜´å½±é¢œè‰²ã€x/yåç§»é‡å’Œæ¨¡ç³Šåº¦ç­‰ï¼Œç„¶è€Œ Android åŸç”Ÿå¹¶æ²¡æœ‰æä¾›æ”¯æŒæ‰€æœ‰è¿™äº›å±æ€§çš„ä¸€æ¬¾ç»„ä»¶ï¼Œæ‰€ä»¥åªèƒ½æˆ‘ä»¬è‡ªå·±é€šè¿‡è‡ªå®šä¹‰æ§ä»¶å»å®ç°ï¼Œç°åœ¨è¿˜æœ‰å¤šå°‘äººä¾ç„¶é€šè¿‡ CardView æ¥â€œé±¼ç›®æ··ç â€å‘¢ï¼Ÿç„¶è€Œï¼Œåœ¨ Flutter ä¸­å°±æ— éœ€æ‹…å¿ƒè¿™ç§é—®é¢˜ï¼Œé€šè¿‡ç±»ä¼¼å‰ç«¯ä¸­å¸¸ç”¨çš„ç›’å­ç»„ä»¶â€”â€” Container å°±å¯ä»¥è½»æ¾å®ç°ã€‚ å½“ç„¶ï¼ŒFlutter è™½ç„¶å¾ˆå¼ºå¤§ï¼Œä½† UI ç»„ä»¶ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œè·¨å¹³å°ä¹‹è·¯æ³¨å®šæ¼«é•¿è€Œå¸ƒæ»¡è†æ£˜ï¼Œå¶å°”ä¹Ÿä¼šä¼´éšç€ä¸€äº›å°é—®é¢˜ã€‚ TextField è½¯é”®ç›˜å¼¹èµ·åç»„ä»¶æº¢å‡ºçš„é—®é¢˜ ç”±äºé¡µé¢ä¸æ”¯æŒæ»šåŠ¨ï¼Œä¸€æ—¦ä½¿ç”¨ TextFieldï¼Œè½¯é”®ç›˜å¼¹èµ·åå¾ˆå®¹æ˜“ä¼šè¦†ç›–ä¸€äº›UIç»„ä»¶ï¼Œå¦‚æœä¸ä»¥ä¸ºæ„ï¼Œé‚£ä¹ˆä¸‹é¢è¿™ä¸ªé—®é¢˜å°±ä¼šæˆä¸ºâ€œå®¶å¸¸ä¾¿é¥­â€ï¼š 1A RenderFlex overflowed by xx pixels on the bottom. å¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯é€šè¿‡åµŒå¥—ä¸€å±‚ SingleChildScrollView æ¥è§„é¿ï¼Œå½“è½¯é”®ç›˜å¼¹èµ·æ—¶ï¼Œä¸‹æ–¹çš„ç»„ä»¶ä¼šè¢«è½¯é”®ç›˜è‡ªåŠ¨é¡¶ä¸Šå»ã€‚ HintText ä¸å±…ä¸­é—®é¢˜ è¿™ä¸ªé—®é¢˜å¾ˆå¤šäººåº”è¯¥éƒ½é‡åˆ°è¿‡ï¼Œå½“æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­è®¾ç½®ä¸­æ–‡ Locale åï¼Œåœ¨ TextField çš„ InputDecoration ä¸­è®¾ç½® hintText æ—¶ï¼Œä¼šå‘ç°æç¤ºæ–‡æœ¬å‘ä¸‹åç§»å‡ ä¸ªåƒç´ ï¼Œè¿™åº”è¯¥å±äº Flutter çš„bugã€‚å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦è®¾ç½® textBaseine å±æ€§ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š 1234567891011121314TextFormField( decoration: InputDecoration( prefixIcon: Icon( Icons.lock_outline ), hintText: S.of(context).loginPasswordHint, ), style: TextStyle( /// handle hint text offset problem. textBaseline: TextBaseline.alphabetic ), keyboardType: TextInputType.number, onSaved: (password) {},) å…·ä½“å¯å‚è€ƒï¼šhttps://github.com/flutter/flutter/issues/40118 ç„¦ç‚¹é—®é¢˜ è¾“å…¥æ¡†çš„ç„¦ç‚¹é—®é¢˜ä¸»è¦ä½“ç°åœ¨ä¸¤ç‚¹ï¼š å‰å¾€å¦ä¸€ä¸ªé¡µé¢è¿”å›åè‡ªåŠ¨å¼¹å‡ºäº†è½¯é”®ç›˜ï¼ˆå³è‡ªåŠ¨è·å–äº†ç„¦ç‚¹ï¼‰ iOSæ‰‹æœºä¸Šåˆ‡æ¢è‡³æ•°å­—é”®ç›˜åæ— æ³•å…³é—­è½¯é”®ç›˜ è¿™ä¸¤ä¸ªé—®é¢˜å…¶å®éƒ½å¯ä»¥å€ŸåŠ© FocusNode æ¥è§£å†³ï¼Œå…ˆæ¥çœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼š 12345678FocusNode _writingFocusNode = FocusNode();... void _clearTextFieldFocus() { if (_writingFocusNode.hasFocus) { _writingFocusNode.unfocus(); } } ä¸Šè¿°ä»£ç åˆ›å»ºäº†ä¸€ä¸ª FocusNode å¯¹è±¡ï¼Œå¹¶å£°æ˜äº†ç§»é™¤ç„¦ç‚¹çš„æ–¹æ³•ï¼Œç›¸ä¿¡å¤§å®¶ä¸éš¾åˆ¤æ–­å‡ºã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦ç»™ TextField çš„ focusNode å±æ€§ä¼ å…¥æˆ‘ä»¬åˆ›å»ºçš„ _writingFocusNodeã€‚é—®é¢˜ä¸€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢è·³è½¬å‰å…ˆç§»é™¤ç„¦ç‚¹ï¼Œè¿™æ ·ï¼Œä»äºŒçº§é¡µé¢è¿”å›åè¾“å…¥æ¡†å°±ä¸ä¼šè‡ªåŠ¨å¼¹å‡ºè½¯é”®ç›˜ã€‚é—®é¢˜äºŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç”¨æˆ·ç‚¹å‡»ç©ºç™½åŒºåŸŸåè‡ªåŠ¨ç§»é™¤ç„¦ç‚¹ï¼ˆå…³é—­è½¯é”®ç›˜ï¼‰ï¼Œä»¥ä¸‹ä»£ç ä¾›å‚è€ƒï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364Widget _buildInputArea() =&gt; Stack( children: &lt;Widget&gt;[ // é€šè¿‡ç©ºç™½åŒºåŸŸçš„ç‚¹å‡»äº‹ä»¶æ¥å…³é—­è½¯é”®ç›˜ GestureDetector( onTap: () { _clearTextFieldFocus(); }, child: Container( /// æ­¤å¤„æ³¨æ„è®¾ç½®èƒŒæ™¯é¢œè‰²ï¼Œå¦åˆ™é»˜è®¤é€æ˜è‰²å¯èƒ½ä¼šç©¿é€ï¼Œæ— æ³•å“åº”ç‚¹å‡»äº‹ä»¶ color: AppTheme.surfaceColor, width: MediaQuery.of(context).size.width, height: MediaQuery.of(context).size.height, ), ), Column( children: &lt;Widget&gt;[ ScreenUtils.verticalSpace(32), // account input edit text Padding( padding: EdgeInsets.only(bottom: AutoSize.covert.dpToDp(12)), child: TextField( controller: _accountTextController, decoration: InputDecoration( prefixIcon: Padding( padding: EdgeInsets.all(AutoSize.covert.dpToDp(12)), child: ImageIcon(AssetImage(ImageAssets.ic_login_user_input)), ), hintText: S.of(context).loginAccountHint, ), keyboardType: TextInputType.number, ), ), // password input edit text Padding( padding: EdgeInsets.only(bottom: AutoSize.covert.dpToDp(12)), child: ValueListenableBuilder( valueListenable: obscureTextModel, builder: (context, value, child) =&gt; TextField( controller: _passwordTextController, obscureText: value, decoration: InputDecoration( prefixIcon: Padding( padding: EdgeInsets.all(AutoSize.covert.dpToDp(12)), child: ImageIcon(AssetImage(ImageAssets.ic_login_pwd_input)), ), suffixIcon: IconButton( icon: Icon(value ? Icons.visibility_off : Icons.visibility, size: AutoSize.covert.dpToDp(20)), onPressed: () { obscureTextModel.value = !value; } ), hintText: S.of(context).loginPasswordHint, ), keyboardType: TextInputType.text, ), ), ), ], ), ], ); Container ç›’å­æ¨¡å‹ç‰¹ç‚¹ å¯¹äºæ¥è§¦è¿‡å‰ç«¯çš„äººæ¥è¯´ï¼Œåº”è¯¥éƒ½é¢†ç•¥è¿‡â€œç›’å­æ¨¡å‹â€çš„å¼ºå¤§äº†ï¼Œæ‰€ä»¥ï¼ŒContainer çš„å¼ºå¤§ä¹‹å¤„ç›¸ä¿¡ä¹Ÿä¸ç”¨æˆ‘å¤šè¯´äº†ï¼šå®ƒå‡ ä¹æ˜¯ä¸€ä¸ªä¸‡èƒ½çš„â€œå®¹å™¨â€ï¼Œæ—¢èƒ½è®¾ç½® marginã€paddingã€aligmentï¼Œåˆå¯ä»¥è£…é¥°å®ƒçš„èƒŒæ™¯ docoration å±æ€§ï¼Œä¾‹å¦‚é˜´å½±æ•ˆæœã€æ¸å˜è‰²ã€åœ†è§’æ•ˆæœç­‰ç­‰ã€‚ è®¾ç½®èƒŒæ™¯è‰²é—®é¢˜ Containerè™½å¥½ï¼Œä½†ä¹Ÿéœ€è¦åœ¨ä½¿ç”¨æ—¶æ³¨æ„ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œå®ƒçš„æºç æ³¨é‡Šä¸­å°±è¯´åˆ°ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡ color å’Œ decoration æ¥è®¾ç½®ç›’å­èƒŒæ™¯ï¼Œä½†ä¸¤è€…å´ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æ—¢å¸Œæœ›ä¿ç•™èƒŒæ™¯è‰²ï¼Œåˆæƒ³ä½¿ç”¨è£…é¥°å™¨ (decoration)ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¾ç½® BoxDecoration çš„ color å±æ€§ã€‚ SafeAreaAndroidä¸­å­˜åœ¨çŠ¶æ€æ ã€åº•éƒ¨å¯¼èˆªæ ï¼Œè€Œ iOS ä¸­ä¹Ÿå­˜åœ¨çŠ¶æ€æ å’Œâ€åº•éƒ¨å¯¼èˆªæ¡â€ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬é¡µé¢ä¸­çš„è¾¹ç•Œéƒ¨åˆ†éœ€è¦å›ºå®šæ˜¾ç¤ºä¸€äº›å°ç»„ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å¥½èƒ½å¤Ÿåœ¨æœ€å¤–å±‚åµŒå¥—ä¸€å±‚ SafeArea ç»„ä»¶ï¼Œå³è®©UIç»„ä»¶å¤„äºâ€œå®‰å…¨åŒºåŸŸâ€ï¼Œä¸è‡³äºå¼•èµ·é€‚é…é—®é¢˜ã€‚ 123456Material( color: AppTheme.surfaceColor, child: SafeArea( child: Container(), ),) åˆ—è¡¨ç»„ä»¶Flutterä¸­å¸¸è§çš„åˆ—è¡¨ç»„ä»¶æœ‰ ListViewã€GridViewã€PageView ç­‰ï¼Œä¸€ä¸ªå®Œæ•´çš„åº”ç”¨è‚¯å®šä¹Ÿç¦»ä¸å¼€è¿™äº›ç»„ä»¶ã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶ï¼Œéœ€è¦ç•™æ„ä»¥ä¸‹å‡ ç‚¹ï¼š Vertical viewport was given unbounded height é—®é¢˜ ä½œä¸ºåˆå­¦è€…ï¼Œæˆ‘ä»¬åœ¨åˆæœŸåº”è¯¥éƒ½ç¢°åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼šVertical/Horizontal viewport was given unbounded heightï¼Œè¿™æ˜¯ç”±äºæˆ‘ä»¬æ²¡æœ‰ç»™åˆ—è¡¨ç»„ä»¶æŒ‡å®šé«˜åº¦æˆ–è€…å®½åº¦è€Œå¼•èµ·çš„ï¼Œä¸€èˆ¬å‡ºç°åœºæ™¯æ˜¯åœ¨ Column ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™åˆ—è¡¨ç»„ä»¶åŒ…è£¹ä¸€å±‚ç›’å­æˆ–è€…è¢« Expanded åŒ…è£¹ï¼Œè®©å…¶å°½å¯èƒ½å æ®æœ€å¤§ç©ºé—´ï¼š 1234567891011Column( children:[ ..., Expanded( child: GridView.builder( .... ) ) ) ]) physics å±æ€§ åšè¿‡åŸç”Ÿå¼€å‘çš„éƒ½çŸ¥é“ï¼Œåœ¨ Android ä¸­ï¼Œæ”¯æŒæ»šåŠ¨çš„ç»„ä»¶æ»‘åˆ°é¡¶æˆ–è€…æ»‘åˆ°åº•åè‡ªå¸¦ colorPrimary è‰²è°ƒçš„æ°´æ³¢çº¹æ•ˆæœï¼Œè‡³äºiOSï¼Œåˆ™æ˜¯è¶Šç•Œå›å¼¹æ•ˆæœã€‚ä½ æ‹¿ç€ Android ä¸­çš„é»˜è®¤æ•ˆæœå»ç»™è®¾è®¡å¸ˆçœ‹ï¼Œâ€œäº²æœå…šâ€çš„ä»–ä»¬è‚¯å®šä¸å¹²äº†ï¼Œç¡¬æ˜¯è®©ä½ æ”¹æˆ iOS çš„å›å¼¹æ•ˆæœã€‚æ‰€å¹¸ï¼ŒFlutter æ—©å°±è€ƒè™‘åˆ°äº†è¿™ä¸€ç‚¹ï¼Œæ”¯æŒæ»‘åŠ¨çš„ç»„ä»¶ä¸­éƒ½æä¾›äº† physics å±æ€§ï¼Œåªéœ€è¦å°†å…¶è®¾ç½®ä¸º BouncingScrollPhysics å°±èƒ½å®Œç¾å®ç°å›å¼¹æ•ˆæœã€‚åŒæ—¶ï¼Œphysics è¿˜æœ‰å…¶ä»–å±æ€§ï¼Œè¿™é‡Œä¸å†ä¸€ä¸€ä»‹ç»ï¼Œå¤§å®¶å¯ä»¥å»æŸ¥çœ‹ç›¸å…³æ–‡æ¡£å’Œæºç ï¼Œè¿™é‡Œæä¸€ä¸‹ NeverScrollableScrollPhysicsï¼Œå³ç¦æ­¢æ»‘åŠ¨ã€‚è¿™ä¸ªæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå…¶å®è¿˜æ˜¯æŒºæœ‰ç”¨çš„ï¼Œæ¯”å¦‚åµŒå¥—çš„ä¸¤ä¸ªæ»‘åŠ¨ç»„ä»¶ä¸­å°±å¯ä»¥å°†å…¶ä¸­ä¸€ä¸ªçš„ physics å±æ€§è®¾ç½®ä¸º NeverScrollableScrollPhysicsï¼Œè¿™æ ·å¯ä»¥ç®€å•å¿«é€Ÿè§£å†³æ»‘åŠ¨å†²çªã€‚æ­¤å¤–ï¼Œæœ‰äº›ç‰¹æ®Šåœºæ™¯æˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›ç”¨æˆ·å¯ä»¥æ»‘åŠ¨ï¼Œè€Œæ˜¯é€šè¿‡æŒ‰é’®ç‚¹å‡»æ¥æ§åˆ¶åˆ—è¡¨æ»‘åŠ¨ï¼Œè¿™æ—¶å€™ï¼Œè®¾ç½®è¯¥å±æ€§å°±å†å¥½ä¸è¿‡å•¦ã€‚ è‡ªå®šä¹‰å¼¹çª—Flutter ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›å†…ç½®çš„å®šåˆ¶å¼¹çª—ï¼Œè¿™é‡Œä¸å†ä¸€ä¸€è¯´æ˜äº†ã€‚å¦‚ä½•è‡ªå®šä¹‰å¼¹çª—ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦æ˜ç™½ï¼šå¼¹çª—å³é¡µé¢ã€‚ä»¥ä¸‹é¢çš„æ•ˆæœä¸ºä¾‹ï¼š ç›¸ä¿¡å¯¹äºå¤§å®¶æ¥è¯´ï¼Œä¸Šé¢çš„UIé¡µé¢å®ç°èµ·æ¥å¹¶ä¸å›°éš¾ï¼Œé‚£æˆ‘ä»¬ç¦» Dialog æ•ˆæœä»…å‰©ä¸€æ­¥ä¹‹é¥äº†ï¼šç‚¹å‡»ç©ºç™½åŒºåŸŸå…³é—­ã€‚å…¶å®ï¼Œåœ¨ä¸Šé¢çš„æŸæ®µä»£ç ä¸­æˆ‘å·²ç»è´´äº†å…³é”®ä»£ç ï¼Œç»†å¿ƒçš„å°ä¼™ä¼´åº”è¯¥ä¹Ÿå¯Ÿè§‰åˆ°äº†ï¼Œæ²¡é”™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Stack ç»„ä»¶åŒ…è£¹åŠé€æ˜è’™å±‚ï¼ˆå¦‚Containerï¼‰å’Œåˆ†äº«åŠŸèƒ½ç»„ä»¶ï¼Œæˆ‘ä»¬åªéœ€ä¸ºåŠé€æ˜è’™å±‚å¢åŠ ç‚¹å‡»äº‹ä»¶å³å¯ï¼š 123456789101112131415161718Stack( children: &lt;Widget&gt;[ // é€šè¿‡ç©ºç™½åŒºåŸŸçš„ç‚¹å‡»äº‹ä»¶æ¥å…³é—­å¼¹çª— GestureDetector( onTap: () { //å…³é—­å¼¹çª— Navigator.maybePop(context); }, child: Container( color: AppTheme.dialogBackgroundColor, width: MediaQuery.of(context).size.width, height: MediaQuery.of(context).size.height, ), ), Container( child: ... ) ) å“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯æœ‰ç§æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œå¼¹çª—å¯¹äºæˆ‘ä»¬æ¥è¯´ä¸å°±æ˜¯å†™ä¸€ä¸ªé¡µé¢é‚£ä¹ˆç®€å•äº†å—ğŸ˜„ã€‚ InkWellInkWell åœ¨ Android ä¸­æ¯”è¾ƒå¸¸è§ï¼Œä¿—ç§°â€œæ°´æ³¢çº¹â€æ•ˆæœï¼Œå±äºæŒ‰é’®çš„ä¸€ç§ï¼Œå®ƒæ”¯æŒè®¾ç½®æ³¢çº¹é¢œè‰²ã€åœ†è§’ç­‰å±æ€§ã€‚æˆ‘ä»¬å¶å°”å¯èƒ½ä¼šé‡åˆ°æ°´æ³¢çº¹å¤±æ•ˆçš„é—®é¢˜ï¼Œè¿™ä¸€èˆ¬æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ InkWell å†…éƒ¨çš„ child ä¸­è®¾ç½®äº†èƒŒæ™¯ï¼Œä»è€Œå¯¼è‡´æ°´æ³¢çº¹æ•ˆæœè¢«é®ç›–ã€‚å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ InkWell å¤–å±‚å¥—ä¸Š Material å¹¶è®¾ç½® color å³å¯: 123456789101112Material( color: Colors.white, child: InkWell( borderRadius: AppTheme.buttonRadius, // åœ†è§’ splashColor: AppTheme.splashColor, // æ³¢çº¹é¢œè‰² highlightColor: Colors.transparent, // ç‚¹å‡»çŠ¶æ€ onTap: () {}, // ç‚¹å‡»äº‹ä»¶ child: Container( ... ), ),) æˆ–è€…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ©äºä¹‹å‰å®ç°è‡ªå®šä¹‰ Dialog çš„æ€è·¯ï¼Œä½¿ç”¨ Stack åŒ…è£¹éœ€è¦ç‚¹å‡»çš„åŒºåŸŸï¼Œå¹¶å°† InkWell æ”¾åœ¨ä¸Šå±‚ï¼š 12345678910111213Stack( children: &lt;Widget&gt;[ Image(), Material( color: Colors.transparent, child: InkWell( splashColor: AppTheme.splashColor, onTap: () {}, ), ) ) ], ) IconButtonå’Œä¸Šé¢ InkWell ä¸€æ ·ï¼ŒIconButton åŒæ ·å¯èƒ½æœ‰ç±»ä¼¼ç‚¹å‡»æ•ˆæœé—®é¢˜ï¼Œä¸ä¸Šé¢è§£å†³æ–¹æ³•å¤§åŒå°å¼‚ï¼š 123456789101112Material( type: MaterialType.circle, color: Colors.transparent, clipBehavior: Clip.antiAlias, child: IconButton( onPressed: () =&gt; Share.share(S.of(context).commonWhoAppShareIconButtonDescription), icon: Icon( Icons.share, size: 22, ) ),), Theme ç›¸å…³Androidä¸­çš„ Theme ç›¸ä¿¡å¤§å®¶ä¹Ÿä¸é™Œç”Ÿäº†ï¼Œå®ƒèƒ½å¤Ÿå®šåˆ¶åŒ–æˆ‘ä»¬æŸç±»ç»„ä»¶çš„é£æ ¼ ï¼Œèƒ½å¤Ÿå¤§å¹…åº¦å‡å°‘é‡å¤ä»£ç å’Œå·¥ä½œé‡ã€‚Flutter ä¸­ä¹Ÿæä¾›äº† Theme æ¥è®©æˆ‘ä»¬é…ç½®å’Œå¤ç”¨å…¨å±€ç»„ä»¶çš„æ ·å¼ã€‚æ­£å¸¸æ¥è¯´ï¼Œæˆ‘ä»¬åº”ç”¨çš„é«˜ä¿çœŸè®¾è®¡å›¾ä¸­çš„ä¸€ç±»ç»„ä»¶ä¸€èˆ¬é£æ ¼ç›¸ä¼¼ï¼Œå¦‚ï¼š ä¸Šå›¾ä¸¤ä¸ªé¡µé¢çš„æŒ‰é’®æ ·å¼åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠ½ç¦»æˆ Themeï¼Œå…¶ä»–ç»„ä»¶åŒç†ã€‚å¯åšå¦‚ä¸‹é…ç½®(ä»…ä¾›å‚è€ƒ)ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374class AppTheme { AppTheme._(); /// common colors used in theme, text, background or borders static const Color primaryColor = Color(0xFF92C9AA); static const Color secondaryColor = Color(0x96A3E4C5); static const Color colorAccent = Color(0xFFE5F378); static const Color textPrimaryColor = Color(0xFF2A2A2A); static const Color textSecondaryColor = Color(0xFF383838); static const Color textHintColor = Color(0xFFB3B3B3); static const Color borderColor = Color(0xFFE8E8E8); static const Color surfaceColor = Color(0xFFF9F9F9); static const double underlineBorderWidth = 0.6; static TextTheme textTheme = TextTheme( headline: headline, title: title, body1: body1, body2: body2, caption: small ); // large title static const headline = TextStyle( fontWeight: FontWeight.bold, fontSize: 30, letterSpacing: 0.27, color: textPrimaryColor ); // normal title static const title = TextStyle( fontSize: 18, letterSpacing: 0.18, color: textPrimaryColor ); // normal text body1 static TextStyle body1 = TextStyle( fontSize: 16, letterSpacing: 0.48, color: textPrimaryColor ); // normal text body2 static TextStyle body2 = TextStyle( fontSize: 14, letterSpacing: 0.25, color: textSecondaryColor ); static TextStyle small = TextStyle( fontSize: 12, color: textHintColor ); // input field border decoration style static const inputDecorationTheme = InputDecorationTheme( hintStyle: TextStyle(fontSize: 14), focusedBorder: UnderlineInputBorder( borderSide: BorderSide(width: underlineBorderWidth, color: primaryColor) ), border: UnderlineInputBorder( borderSide: BorderSide(width: underlineBorderWidth, color: borderColor) ), enabledBorder: UnderlineInputBorder( borderSide: BorderSide(width: underlineBorderWidth, color: borderColor) ), disabledBorder: UnderlineInputBorder( borderSide: BorderSide(width: underlineBorderWidth, color: borderColor) ), );} é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¥å£ç¨‹åºå°†è¿™å¥— Theme è§„åˆ™åº”ç”¨åˆ°å…¨å±€ï¼š 1234567891011121314MaterialApp( title: 'xxx', // å…¨å±€ä¸»é¢˜é…ç½® theme: ThemeData( textTheme: AppTheme.textTheme, primaryColor: AppTheme.primaryColor, canvasColor: AppTheme.surfaceColor, scaffoldBackgroundColor: AppTheme.surfaceColor, inputDecorationTheme: AppTheme.inputDecorationTheme, appBarTheme: AppTheme.appBarTheme, //... ), home: xxxPage() ) ä»¥ä¸Šä»…åˆ—ä¸¾äº†éƒ¨åˆ†å¸¸è§UIç»„ä»¶çš„ä½¿ç”¨æŠ€å·§å’Œé—®é¢˜ï¼Œå¦‚æœ‰å…¶ä»–é—®é¢˜æ¬¢è¿ç•™è¨€æ¢è®¨ã€‚ åŠŸèƒ½éœ€æ±‚å®ç°é™¤äº† Flutter ä¸­çš„ä¸€äº› UI ç»„ä»¶çš„çš„ä½¿ç”¨ä»¥å¤–ï¼Œåº”ç”¨è‡ªç„¶è¿˜éœ€è¦æ¶‰åŠåˆ°å¾ˆå¤šå…·ä½“çš„ä¸šåŠ¡åŠŸèƒ½éœ€æ±‚ï¼Œå¸¸è§çš„æœ‰ç¬¬ä¸‰æ–¹ç™»å½•ã€åˆ†äº«ã€åœ°å›¾ã€Lottie åŠ¨ç”»æ¥å…¥ã€ç¬¬ä¸‰æ–¹å­—ä½“ä¸‹è½½å’ŒåŠ è½½ç­‰ç­‰ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬çµæ´»å˜é€šäº†ï¼Œåœ¨ä¿è¯é¡¹ç›®è¿›åº¦é¡ºåˆ©è¿›è¡Œçš„å‰æä¸‹æœ‰é€‰æ‹©æ€§åœ°å»å€ŸåŠ©ä¸€äº›æ’ä»¶å’Œå·¥å…·ï¼Œæˆ–è€…å‰å¾€ Flutter çš„ Github Issue ç¤¾åŒºå»å¯»æ‰¾ç­”æ¡ˆäº†ï¼Œè¿™é‡Œä¹Ÿé€‰æ‹©å‡ ä¸ªå¸¸ç”¨éœ€æ±‚ç®€å•è¯´ä¸€ä¸‹ã€‚ å½“å‰è®¾å¤‡çš„ç³»ç»Ÿè¯­è¨€å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦æ ¹æ®å½“å‰ç³»ç»Ÿä½¿ç”¨çš„è¯­è¨€å»åŠ¨æ€é€‰æ‹©åŠ è½½çš„å†…å®¹ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ ¹æ®å½“å‰è¯­è¨€å»åŠ è½½ä¸­æ–‡æˆ–è€…è‹±æ–‡ç‰ˆçš„ç”¨æˆ·éšç§æ¡æ¬¾ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Localizations å»è·å–å½“å‰ä½¿ç”¨è¯­è¨€çš„ languageCodeï¼Œè¿›è€Œæ¯”å¯¹å’Œå¤„ç†ï¼š 1234/// åˆ¤æ–­å½“å‰è¯­è¨€ç±»å‹_navigateToUrl(Localizations.localeOf(context).languageCode == 'zh' ? Api.PRIVACY_POLICY_ZH_CN : Api.PRIVACY_POLICY_EN); ç¬¬ä¸‰æ–¹ç™»å½•/åˆ†äº«è¿™éƒ¨åˆ†å½“åˆè€ƒè™‘è‡ªå·±å†™æ’ä»¶æ¥å¯¹æ¥åŸç”Ÿçš„åˆ†äº«sdkï¼Œä½†è€ƒè™‘åˆ°æ—¶é—´æˆæœ¬å°±æš‚æ—¶æç½®äº†ï¼Œæ‰¾åˆ°å‡ ä¸ªä¸é”™çš„æ’ä»¶æ¥å®ç°äº†è¯¥éƒ¨åˆ†åŠŸèƒ½ï¼š fluwx è¯¥æ’ä»¶åº”è¯¥æ˜¯åœ¨å¾®ä¿¡ç¤¾ä¼šåŒ–åˆ†äº«ã€æ”¯ä»˜ç­‰æ–¹é¢åŠŸèƒ½é›†æˆåº¦æ¯”è¾ƒé«˜çš„æ’ä»¶äº†ï¼Œæ˜¯ç”± OpenFlutter ç¤¾åŒºè´Ÿè´£ç»´æŠ¤çš„ï¼Œç›®å‰æ²¡å‘ç°æœ‰ä»€ä¹ˆé—®é¢˜ã€‚å…·ä½“é…ç½®çš„ç»†èŠ‚å°±ä¸å†è¯´æ˜äº†ï¼Œå®ƒçš„æ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œå…·ä½“å¯å‚è€ƒï¼šhttps://github.com/OpenFlutter/fluwx å¦å¤–ï¼Œä»–ä»¬ç»„ç»‡ä¸­è¿˜æœ‰å…¶ä»–å¾ˆå¤šä¼˜ç§€çš„ Flutter ç›¸å…³é¡¹ç›®ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å»å­¦ä¹ ä¸€ä¸‹ã€‚ flutter fake toolkit è¿™ä¸ªæ˜¯ä¸€ç³»åˆ—æ’ä»¶ï¼ŒåŒ…æ‹¬äº†å¾®ä¿¡ã€å¾®åšã€QQã€æ”¯ä»˜å®ç­‰ä¼—å¤šå¹³å°ï¼Œè®©äººä½©æœä½œè€…çš„äº§å‡ºç‡ã€‚ç›®å‰ä½¿ç”¨èµ·æ¥ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä¹Ÿå¸Œæœ›ä½œè€…èƒ½å¤Ÿå¤šé‚€è¯·å‡ ä¸ªå°ä¼™ä¼´æ¥ç»´æŠ¤ï¼Œæå‡æ›´æ–°çš„é¢‘ç‡ã€‚è¿™é‡Œé™„ä¸Šå…¶ä¸­å‡ ä¸ªå¸¸ç”¨çš„æ’ä»¶ï¼š QQæ’ä»¶ï¼šhttps://github.com/v7lin/fake_tencent å¾®åšæ’ä»¶ï¼šhttps://github.com/v7lin/fake_weibo æ”¯ä»˜å®ï¼šhttps://github.com/v7lin/fake_alipay LottieåŠ¨ç”»ç›¸ä¿¡å¤§å®¶å¯¹ Airbnb å…¬å¸æ¨å‡ºçš„è¿™ä¸ªåŠ¨ç”»å·¥å…·å·²ç»æœ‰æ‰€è€³é—»äº†ï¼ŒLottie æ”¯æŒå¤šå¹³å°ï¼Œä½¿ç”¨åŒä¸€ä¸ªJSON åŠ¨ç”»æ–‡ä»¶ï¼Œå¯åœ¨ä¸åŒå¹³å°å®ç°ç›¸åŒçš„åŠ¨ç”»æ•ˆæœã€‚ç°åœ¨å¤æ‚åŠ¨ç”»å¾ˆå¤šæ—¶å€™éƒ½å€ŸåŠ©äºå®ƒï¼Œèƒ½å¤Ÿæœ‰æ•ˆå‡å°‘å¼€å‘æˆæœ¬å’Œä¿æŒåŠ¨ç”»çš„é«˜è¿˜åŸåº¦ã€‚åŒæ ·ï¼ŒFlutter ä¸­ä¹Ÿæœ‰ä¸€äº›å°è£…äº† Lottie åŠ¨ç”»çš„æ’ä»¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨ Flutter ä¸Šä¹Ÿå¯ä»¥æ„Ÿå—åˆ°å®ƒçš„é­…åŠ›ã€‚ è¿™é‡Œï¼Œæˆ‘ä¸ªäººä½¿ç”¨çš„æ’ä»¶æ˜¯ flutter_lottie æ’ä»¶ï¼Œè¿˜ç®—ç¨³å®šï¼Œæ”¯æŒåŠ¨ç”»å±æ€§å’Œè¿›åº¦æ“ä½œï¼Œå”¯ä¸€é—æ†¾å°±æ˜¯æœ‰æ®µæ—¶é—´æ²¡æ›´æ–°äº†ğŸ˜‚ï¼Œåç»­è€ƒè™‘åˆ° iOS æ–¹é¢çš„å…¼å®¹æ€§å¯èƒ½ä¼šè‡ªå·±å†™ä¸€ä¸ªæ’ä»¶ã€‚åœ¨ pubspec.yaml ä¸­ä¾èµ–æ“ä½œå¦‚ä¸‹ï¼š 123# Use Lottie animation in Flutter. # @link: https://pub.dev/packages/flutter_lottie flutter_lottie: 0.2.0 å…·ä½“ä½¿ç”¨æŠ€å·§å¯å‚è€ƒå®ƒçš„exampleï¼šhttps://github.com/CameronStuartSmith/flutter_lottie è¿™é‡Œé™„ä¸Šæ§åˆ¶åŠ¨ç”»è¿›åº¦çš„éƒ¨åˆ†ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788int _currentIndex = 0; LottieController _lottieController; PageController _pageController = PageController(); // the key frames of animation final ANIMATION_PROGRESS = [ 0.0, 0.2083, 0.594, 0.8333, 1 ]; // the duration of each animation sections final ANIMATION_TIMES = [ 2300, 4500, 3500 ]; // animation progress controller Animation&lt;double&gt; animation; AnimationController _animationController; @override void initState() { super.initState(); _animationController = new AnimationController( duration: Duration(milliseconds: ANIMATION_TIMES[_currentIndex]), vsync: this); final Animation curve = new CurvedAnimation(parent: _animationController, curve: Curves.linear); animation = new Tween(begin: 0.0, end: 1.0).animate(curve); animation.addListener(() { _applyAnimation(animation.value); }); }// å¸ƒå±€ä»£ç ....... Positioned( bottom: 0, child: Container( width: MediaQuery.of(context).size.width, // æ­¤å¤„ä¸ºäº†å°†åŠ¨ç”»ç»„ä»¶å±…ä¸‹æ”¾ç½® height: AutoSize.covert.dpToDp(667), child: LottieView.fromFile( filePath: 'assets/anims/user_guide_anim.json', autoPlay: false, loop: true, reverse: true, onViewCreated: (controller) { _lottieController = controller; Future.delayed(Duration(milliseconds: 1), () { _animationController.forward(); }); }, ), ), ),// description page view Container( width: MediaQuery.of(context).size.width, height: MediaQuery.of(context).size.height, margin: EdgeInsets.only(bottom: 60), child: PageView( physics: BouncingScrollPhysics(), controller: _pageController, onPageChanged: (index) { setState(() { _currentIndex = index; _animationController.duration = Duration(milliseconds: ANIMATION_TIMES[index]); }); Future.delayed(Duration(microseconds: 600), () { _animationController.forward(from: 0); }); }, children: _buildPageGroup(), ), ),...... void _applyAnimation(double value) { var startProgress = ANIMATION_PROGRESS[_currentIndex]; var endProgress = ANIMATION_PROGRESS[_currentIndex + 1]; var progress = startProgress + (endProgress - startProgress) * value; _lottieController.setAnimationProgress(progress); } ç®€å•è§£é‡Šä¸€ä¸‹ä¸Šè¿°ä»£ç é€»è¾‘ï¼Œæˆ‘ä»¬è¿™é‡Œä¸»è¦å€ŸåŠ©äº Lottie æ¥å®ç°ç”¨æˆ·å¼•å¯¼é¡µçš„åˆ‡æ¢åŠ¨ç”»ï¼Œå¼•å¯¼é¡µåˆ†ä¸ºä¸‰ä¸ªç”»é¢ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è®°å½•å’Œä¿å­˜åŠ¨ç”»çš„å…³é”®å¸§å’Œæ¯æ®µç”»é¢çš„æ‰§è¡Œæ—¶é—´ã€‚è‡³äºåŠ¨ç”»çš„æ§åˆ¶æ‰§è¡Œæƒäº¤ç”±ä¸Šå±‚çš„ PageView æ¥æ»‘åŠ¨å®ç°ï¼Œæ¯æ¬¡æ»‘åŠ¨é€šè¿‡ AnimationController å’Œ setState((){}) æ¥æ§åˆ¶å’Œåˆ·æ–°æ¯æ®µåŠ¨ç”»çš„æ‰§è¡Œæ—¶é—´å’Œæ‰§è¡Œåˆ»åº¦ã€‚å…·ä½“demoæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š å¤–éƒ¨å­—ä½“ä¸‹è½½å’ŒåŠ è½½å¦‚æœæ¥è§¦è¿‡æ–‡å­—ç¼–è¾‘åŠŸèƒ½å¼€å‘çš„å°ä¼™ä¼´åº”è¯¥éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæä¾›å‡ åç§å­—ä½“ä¾›ç”¨æˆ·ä½¿ç”¨ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½åœ¨é¡¹ç›®æ‰“åŒ…æ—¶å°±æ”¾å…¥è¿™ä¹ˆå¤šå­—ä½“åŒ…ï¼Œè¿™æ ·æ˜¾è€Œä¼šä¸¥é‡å¢åŠ å®‰è£…åŒ…å¤§å°ã€‚æˆ‘ä»¬ä¸€èˆ¬çš„åšæ³•æ˜¯ï¼šå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç‚¹å‡»æƒ³ä½¿ç”¨æŸä¸ªå­—ä½“æ—¶ï¼Œæˆ‘ä»¬ä¼šå…ˆå°†å…¶ä¸‹è½½åˆ°æ‰‹æœºæœ¬åœ°å­˜å‚¨ï¼Œç„¶ååŠ è½½å­—ä½“ï¼Œåç»­å½“ç”¨æˆ·å†æ¬¡é€‰æ‹©è¯¥å­—ä½“ï¼Œé‚£ä¹ˆç›´æ¥ä»æœ¬åœ°åŠ è½½å³å¯ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒFlutter ç›®å‰çš„ç¤ºä¾‹ä¸­ä»…ä¸ºæˆ‘ä»¬æä¾›äº†ä»æœ¬åœ° Asset ç›®å½•ä¸‹åŠ è½½å­—ä½“çš„æ–¹å¼ï¼Œæ˜¾ç„¶æƒ³è¦å®ç°ä¸Šè¿°éœ€æ±‚ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å¯»æ±‚å‡ºè·¯ã€‚ å¹¸è¿çš„æ˜¯ï¼Œä¸Šå¸ä¸ºæˆ‘ä»¬å…³ä¸Šäº†ä¸€æ‰‡é—¨ï¼Œä¹Ÿä¸ºæˆ‘ä»¬æ‰“å¼€äº†ä¸€æ‰‡çª—ï¼ŒFlutter ä¸­ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª FontLoader å·¥å…·ï¼Œå®ƒæœ‰ä¸€ä¸ª addFont æ–¹æ³•ï¼Œæ”¯æŒå°† ByteData æ ¼å¼æ•°æ®è½¬åŒ–ä¸ºå­—ä½“åŒ…å¹¶åŠ è½½åˆ°åº”ç”¨å­—ä½“èµ„æºåº“ï¼š 123456789101112131415161718192021222324252627282930313233343536 /// Registers a font asset to be loaded by this font loader. /// /// The [bytes] argument specifies the actual font asset bytes. Currently, /// only TrueType (TTF) fonts are supported. void addFont(Future&lt;ByteData&gt; bytes) { if (_loaded) throw StateError('FontLoader is already loaded'); _fontFutures.add(bytes.then( (ByteData data) =&gt; Uint8List.view(data.buffer, data.offsetInBytes, data.lengthInBytes) )); }... /// Loads this font loader's font [family] and all of its associated assets /// into the Flutter engine, making the font available to the current /// application. /// /// This method should only be called once per font loader. Attempts to /// load fonts from the same loader more than once will cause a [StateError] /// to be thrown. /// /// The returned future will complete with an error if any of the font asset /// futures yield an error. Future&lt;void&gt; load() async { if (_loaded) throw StateError('FontLoader is already loaded'); _loaded = true; final Iterable&lt;Future&lt;void&gt;&gt; loadFutures = _fontFutures.map( (Future&lt;Uint8List&gt; f) =&gt; f.then&lt;void&gt;( (Uint8List list) =&gt; loadFont(list, family) ) ); return Future.wait(loadFutures.toList()); } å¦‚æ­¤ä¸€æ¥ï¼Œé‚£æˆ‘ä»¬è§£å†³æ€è·¯ä¹Ÿå°±â€œæ‰‹åˆ°æ“’æ¥â€äº†ï¼šåªéœ€è¦å°†å­—ä½“ä¸‹è½½åˆ°æœ¬åœ°å¹¶ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨ï¼Œåœ¨ä½¿ç”¨æ—¶å°†å­—ä½“æ–‡ä»¶å†è½¬ä¸º ByteData æ•°æ®æ ¼å¼ä¾› FontLoader åŠ è½½å³å¯ã€‚è¿™é‡Œé™„ä¸Šç®€åŒ–åçš„éƒ¨åˆ†å…³é”®ä»£ç ï¼š 1234567891011121314151617181920/// åŠ è½½å¤–éƒ¨çš„å­—ä½“Future loadFontFile(LetterFont font) async { // load font file var fontLoader = FontLoader(font.fontName); fontLoader.addFont(await fetchFont(font)); await fontLoader.load(); }/// ä»ç½‘ç»œä¸‹è½½å­—ä½“èµ„æºFuture&lt;ByteData&gt; fetchFont(LetterFont font) async { final response = await https.get( font.fontUrl); if (response.statusCode == 200) { // è¿™é‡Œä¹Ÿå¯ä»¥åšä¿å­˜åˆ°æœ¬åœ°çš„é€»è¾‘å¤„ç† return ByteData.view(response.bodyBytes.buffer); } else { // If that call was not successful, throw an error. throw Exception('Failed to load font'); } } æ‰“åŒ…ä¸Šæ¶ç›¸å…³æ‰“åŒ…æ–¹é¢ä¹Ÿæœ‰ä¸€éƒ¨åˆ†ç»†èŠ‚éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œè°ˆä¸€ä¸‹ Android å’Œ iOS å¼€å‘ç¯å¢ƒé…ç½®å’Œæ‰“åŒ…å·®å¼‚ä»¥åŠåˆ—ä¸¾éƒ¨åˆ†å¸¸è§é—®é¢˜ï¼Œå…¶ä»–é—®é¢˜å› äººè€Œå¼‚ï¼Œä¹Ÿå› ç‰ˆæœ¬è€Œå¼‚ï¼Œå°±ä¸å•ç‹¬æ‹¿å‡ºæ¥è®²äº†ã€‚ Androidæ–¹é¢ å¼€å‘å·¥å…· Android studio3.6ç¨³å®šç‰ˆ ä»£ç ç¼–è¯‘ç¯å¢ƒ Kotlin + AndroidX ç›®å‰Flutteråˆ›å»ºé¡¹ç›®é»˜è®¤å‹¾é€‰ä¸¤ä¸ªé€‰é¡¹ ç‰ˆæœ¬å·é…ç½® åœ¨ android/app/build.gradle ä¸­é…ç½® flutterVersionCode å’Œ flutterVersionNameã€‚ æ³¨æ„ï¼šå¦‚æœåœ¨ pubspec.yaml ä¸­é…ç½®äº†versionï¼Œé‚£ä¹ˆ Flutter å…·ä½“æ‰“åŒ…çš„ç‰ˆæœ¬ä¼šå®é™…æ ¹æ® pubspec.yaml çš„ version æ¥æ„å»ºã€‚ ç½‘ç»œé…ç½® ç›®å‰ Android å®˜æ–¹ä¸å»ºè®®é‡‡ç”¨httpè¯·æ±‚æ ¼å¼ï¼Œæ¨èä½¿ç”¨ httpsï¼Œæ‰€ä»¥ï¼Œå¦‚æœé¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†httpæ ¼å¼è¯·æ±‚ï¼Œé‚£ä¹ˆéœ€è¦æ·»åŠ ç½‘ç»œé…ç½®ã€‚é¦–å…ˆåœ¨ android/app/src/main/res è·¯å¾„ä¸‹åˆ›å»ºåä¸º xml çš„æ–‡ä»¶å¤¹ï¼šç„¶ååˆ›å»ºåä¸º network_security_config çš„ xml æ–‡ä»¶ï¼Œæ¥ç€å°†å¦‚ä¸‹ä»£ç å¤åˆ¶è¿›å»ï¼š 1234&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;network-security-config&gt; &lt;base-config cleartextTrafficPermitted=\"true\"/&gt;&lt;/network-security-config&gt; ç„¶ååœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­è®¾ç½® networkSecurityConfig å±æ€§å³å¯ï¼š 12345678910 &lt;application android:name=\"io.flutter.app.FlutterApplication\" android:label=\"Timeory\" android:icon=\"@mipmap/ic_launcher\" tools:replace=\"android:name\" android:usesCleartextTraffic=\"true\" android:networkSecurityConfig=\"@xml/network_security_config\" tools:ignore=\"GoogleAppIndexingWarning\"&gt; ......&lt;/application&gt; æƒé™é…ç½® ä¸€èˆ¬æˆ‘ä»¬é¡¹ç›®ä¸­éƒ½ä¼šç”¨åˆ°æƒé™ç”³è¯·ï¼Œå¹¶ä¸”å¾ˆå¤š flutter æ’ä»¶ä¸­ä¹Ÿä¼šè¦æ±‚æˆ‘ä»¬å»è‡ªå·±é…ç½®æƒé™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å¸¸ç”¨æƒé™ï¼ˆåªæ˜¯æ ·ä¾‹ï¼‰ï¼š 12345678&lt;uses-permission android:name=\"android.permission.INTERNET\"/&gt; &lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/&gt; &lt;uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\"/&gt; &lt;uses-permission android:name=\"android.permission.READ_PHONE_STATE\"/&gt; &lt;uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/&gt; &lt;uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\"/&gt; &lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" /&gt; &lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" /&gt; å½“ç„¶è¿™äº›è¿˜æ˜¯ä¸å¤Ÿçš„ï¼ŒAndroid6.0åŠä»¥ä¸Šï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ä»£ç ä¸­åŠ¨æ€ç”³è¯·æƒé™ï¼ŒFlutterä¸­æœ‰å¾ˆå¤šä¼˜ç§€çš„æƒé™ç”³è¯·æ’ä»¶ï¼ŒiOS ä¸Šé¢ä¸€èˆ¬æ²¡é—®é¢˜ï¼ŒAndroidç”±äºç¢ç‰‡åŒ–æ¯”è¾ƒä¸¥é‡ï¼Œå¯èƒ½ä¼šåœ¨ä¸åŒæœºå‹ä¸Šå‡ºç°å„ç§å¥‡æ€ªé—®é¢˜ï¼Œæ¯”å¦‚ï¼Œçº¢ç±³éƒ¨åˆ†æœºå‹å€ŸåŠ©äº permission_hanlder æ’ä»¶ç”³è¯·å®šä½æƒé™å¯èƒ½ä¼šå¤±è´¥çš„é—®é¢˜ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œç•™ä¸ªå¿ƒçœ¼ã€‚ Logo é…ç½® Logo éœ€è¦åœ¨ android/app/src/main/res ä¸­æ·»åŠ å’Œé…ç½®ï¼Œä¸€èˆ¬åªéœ€è¦å‡†å¤‡ hdpiã€mdpiã€xhdpiã€xxhdpiã€xxxhdpiæ ¼å¼å³å¯ã€‚å¦å¤–ï¼ŒAndroid8.0 åŠä»¥ä¸Šéœ€è¦é€‚é…åœ†è§’logoï¼Œå¦åˆ™åœ¨éƒ¨åˆ†é«˜ç‰ˆæœ¬æœºå‹ä¸Šä¼šæ˜¾ç¤º Android é»˜è®¤çš„æœºå™¨äººlogoã€‚ å…·ä½“å¯ä»¥å‚è€ƒè¯¥æ–‡ç« ï¼šhttps://blog.csdn.net/guolin_blog/article/details/79417483 æ‰“åŒ… ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬é€šè¿‡ flutter build apk æ¥æ‰“åŒ…ï¼Œç”Ÿæˆçš„å®‰è£…åœ¨ build/app/outputs/apk/release ç›®å½•ä¸‹ï¼Œè¿™æ ·æ‰“å‡ºæ¥çš„åŒ…ä¸€èˆ¬æ¯”è¾ƒå¤§ï¼Œå› ä¸ºå®ƒåŒ…å«äº† arm64-v8aã€armeabi-v7a å’Œ x86_64 ä¸‰ç§cpuæ¶æ„çš„åŒ…ã€‚å¤§å®¶å¯ä»¥æ ¹æ®éœ€è¦æœ‰é€‰æ‹©æ€§çš„é’ˆå¯¹ç‰¹å®šæœºå‹çš„cpuæ¶æ„æ‰“åŒ…ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼š 1flutter build apk --target-platform android-arm,android-arm64,android-x64 --split-per-abi æ‰§è¡Œå®Œæ¯•åå°±ä¼šåœ¨ release ç›®å½•ä¸‹ç”Ÿæˆä¸‰ç§æ ¼å¼çš„apkåŒ…ã€‚ å¦å¤–ï¼Œå¤§å®¶å¯ä»¥é€‰æ‹©ä¸€äº›apkä½“ç§¯ä¼˜åŒ–çš„æ–¹æ¡ˆï¼Œå…·ä½“å¯å‚è€ƒï¼š https://my.oschina.net/u/1464083/blog/2395914 https://www.jianshu.com/p/555c948e5195 iOS æ–¹é¢ç”±äºæœ¬äººä¹‹å‰åš Android å¼€å‘ï¼Œæ²¡æœ‰æ¥è§¦è¿‡ iOSï¼Œæ‰€ä»¥æ‰“åŒ…åˆ° iOS å¹³å°è¿˜æ˜¯é‡åˆ°ä¸å°‘é—®é¢˜ã€‚ å¼€å‘å·¥å…·ï¼š Xcode11.3.1 ç¨³å®šç‰ˆ (æ‰“åŒ…ç¯å¢ƒ) + Visual Studio Code 1.42.1 (ç¼–ç ç¯å¢ƒ) ä»£ç ç¼–è¯‘ç¯å¢ƒï¼šSwift + Objective-C (ç›®å‰åˆ›å»ºFlutteré¡¹ç›®é»˜è®¤å‹¾é€‰ä¸ºswiftï¼Œç”±äºé¡¹ç›®å¯åŠ¨æ—¶Flutterå°šæœªæ›´æ–°è¯¥é…ç½®ï¼Œæ‰€ä»¥é¡¹ç›®ä¸­éƒ¨åˆ†æ’ä»¶é‡‡ç”¨çš„æ˜¯oc)ï¼Œå¸Œæœ›åé¢é€æ­¥æ›¿æ¢ä¸ºä¸»æµçš„swiftã€‚ ç‰ˆæœ¬å·é…ç½®ï¼š åªéœ€è¦åœ¨Xcodeä¸­ Runner -&gt; targets -&gt; General -&gt; Identity é…ç½®å³å¯ã€‚ ç½‘ç»œé…ç½® iOS ä¸­ï¼Œå®˜æ–¹åŒæ ·çº¦æŸæˆ‘ä»¬ä½¿ç”¨ https è¯·æ±‚ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æš‚æ—¶ä½¿ç”¨httpæ ¼å¼è¯·æ±‚æ¥æµ‹è¯•ï¼Œå¯ä»¥åšå¦‚ä¸‹é…ç½®ï¼š åœ¨ Runner -&gt; targets -&gt; General -&gt; Info ä¸­æ·»åŠ  App Transport Security Settings å±æ€§ï¼Œå¹¶åœ¨æ­¤å±æ€§æ ‡ç­¾å†…æ·»åŠ  Allow Arbitrary Loads å­å±æ€§ï¼Œå¹¶å°†å€¼è®¾ç½®ä¸º YES å³å¯ã€‚ Logoé…ç½® iOS ä¸­çš„ logo é…ç½®åªéœ€è¦æ‰¾åˆ°å¦‚ä¸‹å…¥å£ï¼š ç‚¹å‡» â¡ï¸ å³å¯è¿›å…¥ logo èµ„æºç›®å½•ï¼Œé»˜è®¤çš„ä¸º Flutter çš„å®˜æ–¹ logoï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®å…·ä½“ logo å°ºå¯¸å»æ›¿æ¢èµ„æºå³å¯ã€‚ å›½é™…åŒ–è¯­è¨€é…ç½® é¡¹ç›®ä¸­å¦‚æœæ”¯æŒå›½é™…åŒ–è¯­è¨€ï¼ŒAndroid ä¸­æ— éœ€é¢å¤–é…ç½®ï¼ŒiOS ä¸­éœ€è¦åœ¨ Info.plist ä¸­æ·»åŠ  Localized resource can be mixed å±æ€§ï¼Œå¹¶è®¾ç½®å€¼ä¸º YES å³å¯ï¼Œå¦åˆ™APPè¿è¡Œåå¯èƒ½ä¼šå‡ºç°å®é™…å±•ç¤ºçš„æ˜¯è‹±æ–‡çš„æƒ…å†µã€‚ æ‰“åŒ…ç›¸å…³ Xcodeæ‰“åŒ…æ—¶åˆ‡è®°è¦ä½¿ç”¨ç¨³å®šç‰ˆï¼Œä¸è¦ä½¿ç”¨ beta ç‰ˆæœ¬ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼š ä»¥ä¸Šå°±æ˜¯æœ¬äººå¯¹è¿‘æœŸ Flutter å¼€å‘è¿‡ç¨‹çš„ä¸€ç‚¹ç®€å•æ€»ç»“ï¼Œå¦‚æœèƒ½å¤Ÿå¸®åŠ©åˆ°æ‚¨é‚£å°†å†å¥½ä¸è¿‡ğŸ˜„ã€‚åˆšæ¥è§¦ Flutter ä¸ä¹…ï¼Œç›¸å…³é˜è¿°å¯èƒ½ä¸å¤Ÿä¸¥è°¨æˆ–å­˜åœ¨ç†è§£é”™è¯¯ï¼Œå¦‚æ‚¨å‘ç°ï¼Œè¿˜è¯·æŒ‡å‡ºï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚","link":"/2020/04/19/flutter-tips/"},{"title":"Android å®ç°æœ¬åœ°å›¾ç‰‡å’Œè§†é¢‘é€‰æ‹©å™¨åŠŸèƒ½","text":"å“ˆå–½ï¼Œå¤§å®¶å¥½ï¼Œå¥½ä¹…ä¸è§äº†ï¼Œå¾ˆä¹…æ²¡æœ‰æ›´æ–° Android æ–¹é¢çš„æŠ€æœ¯æ–‡ç« äº†ï¼Œæœ€è¿‘åœ¨å¿™å…¬å¸çš„ AR ç±»çš„æ–°äº§å“ï¼Œå…¶ä¸­æ¶‰åŠåˆ°æœ¬åœ°å›¾ç‰‡å’Œè§†é¢‘çš„é€‰æ‹©å’Œä¸Šä¼ åŠŸèƒ½ã€‚è‡³äºä¸ºä»€ä¹ˆä¸ç”¨ç³»ç»Ÿæä¾›çš„å›¾ç‰‡å’Œè§†é¢‘é€‰æ‹©å™¨ï¼ŒåŸå› ä½ æ‡‚çš„ï¼Œç³»ç»Ÿæä¾›çš„é€‰æ‹©å™¨åªèƒ½é€šè¿‡ Intent æ–¹å¼å»è·å–ï¼Œè¿™æ„å‘³ç€éœ€è¦ç¦»å¼€å½“å‰é¡µé¢å‰å¾€ç³»ç»Ÿçš„åª’ä½“åº“ï¼Œé€‰æ‹©å®Œæ¯•ååœ¨onActivityResult æ–¹æ³•ä¸­æ‹¿åˆ°ç»“æœã€‚è¿™æ˜¾ç„¶å­˜åœ¨å¾ˆå¤šå¼Šç«¯ï¼š UIçš„å®šåˆ¶åŒ–å¾ˆå·® éœ€è¦ç¦»å¼€å½“å‰é¡µé¢ï¼Œä½“éªŒä¸å¥½ ä¸åŒæœºå‹å¯èƒ½ä¼šå‡ºç°å„ç§é—®é¢˜ ç³»ç»Ÿé€‰æ‹©å™¨å¹¶ä¸æ”¯æŒå¤šé€‰åŠŸèƒ½ â€‹å…¶å®ï¼Œæˆ‘ä»¬æœ€å¸Œæœ›çš„æ˜¯æ‹¿åˆ°æ‰‹æœºä¸­çš„å›¾ç‰‡å’Œè§†é¢‘æ•°æ®ï¼Œè‡³äºUIçš„ç»˜åˆ¶å’Œäº¤äº’ç»†èŠ‚éƒ½ç”±æˆ‘ä»¬è‡ªå·±æ¥å®šåˆ¶ã€‚ä½ è¯´ä½ æƒ³ç”¨ ListView æˆ–è€… RecyclerView æ¥å±•ç¤ºæ‰€æœ‰å›¾ç‰‡å’Œè§†é¢‘ï¼Œokï¼Œå½“ç„¶å¯ä»¥ï¼Œé‚£æ˜¯ä½ çš„è‡ªç”±ï¼è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æœ€ç»ˆå®ç°çš„æ•ˆæœå›¾å§ï¼š ä¸è¦ç›´æ¥ä¸€çœ‹æ•ˆæœå›¾ä»¥ä¸ºè¿˜æ˜¯å‰å¾€çš„å¦ä¸€ä¸ªé¡µé¢ï¼Œé‚£å’Œå…¶ä»–å›¾ç‰‡é€‰æ‹©å™¨æœ‰ä»€ä¹ˆåˆ†åˆ«ï¼Ÿå®¢å®˜å…ˆåˆ«æ€¥ï¼Œè¿™é‡Œçš„æ•ˆæœå›¾åªæ˜¯ä¸ºäº†ç¾è§‚è€Œå·²ï¼Œåæ­£æ•°æ®ç»™ä½ äº†ï¼Œæƒ³æ€ä¹ˆå®‰æ’UIå°±çœ‹ä½ ä»¬è®¾è®¡å–µäº†ğŸ˜„ï½ï¼Œæ¯”å¦‚å¯ä»¥è¿™æ ·ï¼š çœ‹åˆ°è¿™ä½ å¯èƒ½ä¼šä»¥ä¸ºå¾ˆå¤æ‚ï¼Œå…¶å®ä¸ç„¶ï¼Œä»£ç é‡å¾ˆå°‘ï¼Œè€Œä¸”æ¶‰åŠåˆ°çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹å¦‚ï¼šè·å–ç³»ç»Ÿå›¾ç‰‡å’Œè§†é¢‘æ•°æ®ã€å•é€‰å’Œå¤šé€‰åŠŸèƒ½ï¼Œç›¸ä¿¡å¤§å®¶ä¸€çœ‹å°±æ˜äº†ã€‚å¥½äº†ï¼Œå–å£èŒ¶ï¼Œä¸”å¬æˆ‘æ…¢æ…¢é“æ¥ã€‚ è·å–æ‰‹æœºæ‰€æœ‰å›¾ç‰‡å’Œè§†é¢‘æ•°æ®ä¸€èˆ¬åœ°ï¼Œè·å–æ‰‹æœºå†…éƒ¨å›¾ç‰‡å’Œè§†é¢‘æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šé€šè¿‡éå†æ–‡ä»¶å¤¹è·å–å›¾ç‰‡å’Œè§†é¢‘èµ„æºï¼Œæˆ–è€…é€šè¿‡ContentResolveræ¥è·å–ã€‚è™½ç„¶ç¬¬ä¸€ç§æ–¹å¼æ‹¿åˆ°çš„å›¾ç‰‡æ¯”è¾ƒé½å…¨ï¼Œä½†æ–‡ä»¶éå†æ“ä½œè¿‡äºè€—æ—¶ï¼Œè¿™é‡Œæˆ‘æ¨èé‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ã€‚ContentResolverå³å†…å®¹è§£æå™¨ï¼Œå¯ä»¥å¯¹ContentProviderä¸­çš„æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œå…¶ä¸­ä¸»è¦åŒ…å«è”ç³»äººã€çŸ­ä¿¡ã€ç›¸å†Œã€è§†é¢‘ã€éŸ³é¢‘ç­‰ä¸€ç³»åˆ—æ•°æ®ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“è·å–ç³»ç»Ÿå›¾ç‰‡æ•°æ®å®ç°ä»£ç å§ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667/** * &lt;pre&gt; * @author moosphon (about me: &lt;a&gt;https://github.com/Moosphan&lt;a/&gt;) * @date 2018/09/16 * @desc get all pictures of the phone. * &lt;pre/&gt; */fun getLocalPictures(mContext: Context?): List&lt;ImageMediaEntity&gt;? { val images = ArrayList&lt;ImageMediaEntity&gt;() val resolver = mContext?.contentResolver var cursor: Cursor? = null queryImageThumbnails(resolver!!, arrayOf(MediaStore.Images.Thumbnails.IMAGE_ID, MediaStore.Images.Thumbnails.DATA)) try { cursor = resolver.query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, arrayOf(MediaStore.Images.ImageColumns.DATA, MediaStore.Images.ImageColumns._ID, MediaStore.Images.ImageColumns.SIZE, MediaStore.Images.ImageColumns.MIME_TYPE), null, null, null) return if (cursor == null || !cursor.moveToFirst()) { null } else { do { val picPath = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.DATA)) val id = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media._ID)) val size = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.SIZE)) val mimeType = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.MIME_TYPE)) val image = ImageMediaEntity.Builder(id, picPath) .setMimeType(mimeType) .setSize(size) .setThumbnailPath(mThumbnailMap?.get(id)) .build() images.add(image) mThumbnailMap = null }while (cursor.moveToNext()) return images } } finally { if (cursor != null) { cursor.close() } }} /** * search for thumbnails for local images * * @author moosphon */ private fun queryImageThumbnails(cr: ContentResolver, projection: Array&lt;String&gt;) { var cur: Cursor? = null try { cur = MediaStore.Images.Thumbnails.queryMiniThumbnails(cr, MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, MediaStore.Images.Thumbnails.MINI_KIND, projection) if (cur != null &amp;&amp; cur.moveToFirst()) { do { val imageId = cur.getString(cur.getColumnIndex(MediaStore.Images.Thumbnails.IMAGE_ID)) val imagePath = cur.getString(cur.getColumnIndex(MediaStore.Images.Thumbnails.DATA)) mThumbnailMap = mapOf(imageId to imagePath) } while (cur.moveToNext() &amp;&amp; !cur.isLast) } } finally { cur?.close() } } å¯ä»¥é€šè¿‡ä»£ç çœ‹åˆ°ï¼Œæˆ‘ä»¬å€ŸåŠ©äº ContentResolver.query æ–¹æ³•æ¥æŸ¥è¯¢åŒ¹é…çš„å›¾ç‰‡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®éœ€è¦è·å–çš„å›¾ç‰‡çš„æ•°æ®å­—æ®µï¼Œå¦‚ MediaStore.Images.ImageColumns.DATA å°±è¡¨ç¤ºå›¾ç‰‡å­˜å‚¨çš„è·¯å¾„ä¿¡æ¯ï¼Œå…¶ä»–çš„å¯ä»¥è·å–çš„ä¿¡æ¯è¿˜æœ‰å›¾ç‰‡IDã€å›¾ç‰‡å¤§å°ã€å›¾ç‰‡ç±»å‹ç­‰ï¼Œå¤§å®¶å¯ä»¥å‚ç…§ä»£ç å»ç½‘ä¸ŠæŸ¥çœ‹å…·ä½“å«ä¹‰ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚æ­¤å¤–ï¼Œç³»ç»Ÿè¿˜ä¸ºæˆ‘ä»¬å­˜å‚¨äº†å›¾ç‰‡ä»¥åŠè§†é¢‘çš„ç¼©ç•¥å›¾æ•°æ®ï¼Œæˆ‘ä»¬ä¸ºäº†æé«˜å›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼Œå¯ä»¥é€šè¿‡è·å–å’Œå±•ç¤ºç¼©ç•¥å›¾çš„å½¢å¼æ¥å¢å¼ºä½“éªŒæ•ˆæœã€‚è·å–å›¾ç‰‡ç¼©ç•¥å›¾çš„æ–¹å¼é‡‡ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ï¼Œä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ä¸€ä¸‹æ–‡æ¡£ã€‚ å¦å¤–ï¼Œå¤§å®¶å¯èƒ½ä¼šå‘ç° ImageMediaEntity è¿™ä¸ªç±»ï¼Œæ˜ç™½äººåº”è¯¥å¾ˆå¿«å°±ä¼šçŸ¥é“è¿™ä¸ªæ•°æ®ç±»ä¸»è¦å­˜å‚¨ä¸€äº›å›¾ç‰‡ç›¸å…³çš„æ•°æ®ã€‚çš„ç¡®ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä¸ªäººå°è£…çš„ä¸€å±‚é’ˆå¯¹å›¾ç‰‡çš„æ•°æ®ç±»ï¼Œè€Œå®ƒè¿˜æœ‰ä¸ªçˆ¶ç±»ï¼Œåå« BaseMediaEntity ,æˆ‘ä»¬æ¥çœ‹çœ‹é‡Œé¢éƒ½æœ‰äº›å•¥ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778/** * base entity data for local media * * @author Moosphon */public abstract class BaseMediaEntity implements Parcelable{ protected enum TYPE{ IMAGE, VIDEO } protected String path; protected String id; protected String size; public Boolean isSelected = false; public BaseMediaEntity() { } public BaseMediaEntity(String path, String id) { this.path = path; this.id = id; } public BaseMediaEntity(Parcel in) { this.path = in.readString(); this.id = in.readString(); this.size = in.readString(); } public abstract TYPE getMediaType(); public String getPath() { return path; } public void setPath(String path) { this.path = path; } public String getId() { return id; } public void setId(String id) { this.id = id; } public String getSize() { return size; } public void setSize(String size) { this.size = size; } public Boolean getSelected() { return isSelected; } public void setSelected(Boolean selected) { isSelected = selected; } @Override public int describeContents() { return 0; } @Override public void writeToParcel(Parcel dest, int flags) { dest.writeString(this.path); dest.writeString(this.id); dest.writeString(this.size); }} å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯æˆ‘ä»¬æŠ½ç¦»å‡ºçš„å…¬å…±åŸºç±»ï¼Œå› ä¸ºå›¾ç‰‡å’Œè§†é¢‘ç­‰å¤šåª’ä½“æ•°æ®éƒ½æœ‰å…¬å…±çš„æ•°æ®å­—æ®µidã€pathå’Œsizeï¼Œå·®å¼‚æ€§ç”±å®ƒçš„å­ç±»æ¥å®ç°å°±OKäº†ã€‚è‡³äº ImageMediaEntity å’Œ VideoMediaEntity å…·ä½“ä»£ç å°±å…ˆçœç•¥ä¸æ”¾äº†ï¼Œå½±å“ç¯‡å¹…é•¿åº¦ï¼Œæœ€åé¢ä¼šæœ‰å®Œæ•´çš„sampleä»£ç ã€‚ çœ‹å®Œäº†æœ¬åœ°å›¾ç‰‡æ•°æ®çš„è·å–ï¼Œè‡ªç„¶è€Œç„¶å°±èƒ½çŸ¥é“è§†é¢‘æ•°æ®ä¹Ÿæ˜¯é‡‡ç”¨ç›¸åŒçš„æ–¹å¼è·å–ï¼Œæ²¡é”™ï¼Œè¿™é‡Œå°±ç›´æ¥ä¸Šä»£ç äº†ï¼Œå…¶å®å®ç°æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/** * &lt;pre&gt; * @author moosphon (about me: &lt;a&gt;https://github.com/Moosphan&lt;a/&gt;) * @date 2018/09/16 * @desc get all videos of the phone. * &lt;pre/&gt; */fun getLocalVideos(mContext: Context?) : List&lt;VideoMediaEntity&gt;?{ val videos = ArrayList&lt;VideoMediaEntity&gt;() val resolver = mContext?.contentResolver var cursor: Cursor? = null try { cursor = resolver?.query(MediaStore.Video.Media.EXTERNAL_CONTENT_URI, arrayOf(MediaStore.Images.ImageColumns.DATA, MediaStore.Video.Media._ID, MediaStore.Video.Media.DISPLAY_NAME, MediaStore.Video.Media.RESOLUTION, MediaStore.Video.Media.SIZE, MediaStore.Video.Media.DURATION, MediaStore.Video.Media.DATE_MODIFIED), MediaStore.Video.Media.MIME_TYPE + &quot;=?&quot;, arrayOf(&quot;video/mp4&quot;), null) return if (cursor == null || !cursor.moveToFirst()) { null } else { while (cursor.moveToNext()){ // video path val path = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA)) // video id val id = cursor.getLong(cursor.getColumnIndexOrThrow(MediaStore.Video.Media._ID)) // video display name val name = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DISPLAY_NAME)) // video resolution val resolution = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Video.Media.RESOLUTION)) // video size val size = cursor.getLong(cursor.getColumnIndexOrThrow(MediaStore.Video.Media.SIZE)) // video duration val duration = cursor.getLong(cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DURATION)) val date = cursor.getLong(cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATE_MODIFIED)) val video = VideoMediaEntity.Builder(id.toString(), path) .setTitle(name) .setDateTaken(date.toString()) .setDuration(duration.toString()) .setSize(size.toString()) .build() videos.add(video) } return videos } } finally { if (cursor != null) { cursor.close() } }} é€šè¿‡ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™å‡ ä¹å’Œè·å–å›¾ç‰‡æ•°æ®çš„ä»£ç ä¸€æ ·å•Šï¼Œæ²¡é”™ï¼Œæ˜¯å‡ ä¹ä¸€æ ·ï¼Œä½†ç•™æ„çš„äººä¼šå‘ç°ï¼Œè¿™é‡Œæˆ‘è°ƒç”¨ ContentResolver.query æ—¶å¤šä¼ äº†ä¸€ä¸ªselectionå‚æ•°ï¼Œå®ƒæ˜¯queryæ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¸»è¦ç”¨æ¥è®¾ç½®ä¸€äº›æŸ¥è¯¢çš„æ¡ä»¶ï¼Œå·²è¾¾åˆ°è¿‡æ»¤åŠŸèƒ½ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦è‡ªè¡Œè®¾ç½®ï¼Œè¿™é‡Œæˆ‘åªæ˜¯æƒ³æ‹¿åˆ°mp4æ ¼å¼çš„è§†é¢‘æ•°æ®ã€‚è¿˜æœ‰äººå¯èƒ½ä¼šé—®ï¼šä¸ºä»€ä¹ˆæˆ‘è¿™é‡Œæ²¡æœ‰è·å–è§†é¢‘çš„ç¼©ç•¥å›¾æ•°æ®å‘¢ï¼Ÿç³»ç»Ÿè™½ä¸ºæˆ‘ä»¬ä¹Ÿæä¾›äº†è·å–è§†é¢‘ç¼©ç•¥å›¾çš„æ–¹å¼ï¼Œä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„è§†é¢‘éƒ½å­˜åœ¨è§†é¢‘ç¼©ç•¥å›¾ï¼Œè¿™å°±é€ æˆä½ æƒ³åŠ è½½è§†é¢‘çš„ç¼©ç•¥å›¾çš„æ—¶å€™ä¼šå‡ºç°å¤§ç‰‡ç©ºç™½æ•°æ®é—®é¢˜ã€‚åŒæ—¶ï¼Œå¯èƒ½ä¼šæœ‰äººæƒ³å€ŸåŠ©äºå…¶ä»–æ–¹å¼è·å–ï¼Œä½†ä¸»æµçš„å‡ ç§æ–¹å¼éƒ½æ¯”è¾ƒè€—æ—¶ï¼Œä¸å»ºè®®åœ¨æ­£å¼é¡¹ç›®ä¸­é‡‡ç”¨ã€‚å…¶å®ï¼Œé€šè¿‡æŸ¥çœ‹å¾ˆå¤šä¼˜ç§€çš„å¼€æºè§†é¢‘é€‰æ‹©å™¨æ¡†æ¶å‘ç°ï¼Œå¾ˆå¤šéƒ½é‡‡ç”¨äº†åˆ†æ‰¹åŠ è½½åŠŸèƒ½ï¼Œæ¯”å¦‚æ‰‹æœºä¸­ä¸€å…±æœ‰ä¸€åƒä¸ªè§†é¢‘æ•°æ®ï¼Œå¦‚æœä¸€æ¬¡æ€§è·å–æ˜¾ç„¶å¾ˆè€—æ—¶ï¼Œè€Œä¸”ä½“éªŒä¸å¥½ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æ‰¹è·å–æ•°æ®ï¼Œæ¯é¡µ100æ¡é™åˆ¶ï¼Œè¿™å°±æå¤§çš„èŠ‚çœäº†è·å–æ•°æ®çš„æ—¶é—´ï¼Œç„¶åå†åœ¨åˆ—è¡¨æ»‘åŠ¨åˆ°åº•éƒ¨æ—¶åŠ è½½ä¸‹ä¸€æ‰¹æ•°æ®ã€‚è¿™é‡Œæˆ‘æš‚æ—¶ä½¿ç”¨çš„æ˜¯ Glide æ¥åŠ è½½æˆ‘ä»¬çš„è§†é¢‘æ•°æ®ï¼Œåç»­ä¼šå¯»æ‰¾æ›´ä½³æ–¹æ¡ˆä»£æ›¿ã€‚ ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å›¾ç‰‡è§†é¢‘çš„å¤šé€‰ã€å•é€‰æ•ˆæœå®ç°ã€‚ç”¨è¿‡ RecyclerView å’Œ CheckBox ç»„åˆçš„å¼€å‘è€…éƒ½çŸ¥é“ï¼ŒRecyclerViewå¤ç”¨æ€§ä¼šå¯¼è‡´ CheckBox é€‰æ‹©çŠ¶æ€æ··ä¹±ï¼Œå³onCheckChangedæ–¹æ³•çš„â€œç¥ç§˜å›è°ƒâ€ï¼Œè§£å†³æ–¹æ¡ˆä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œç½‘ä¸Šæœ‰äº›æ–¹æ¡ˆæ²¡æœ‰è§£å†³é—®é¢˜çš„ä¹Ÿæœ‰å¾ˆå¤šã€‚å¸¸è§çš„æ–¹æ¡ˆæœ‰ï¼šè‡ªå®šä¹‰ checkboxã€é€šè¿‡ checkbox çš„ onclick äº‹ä»¶æ¥å¤„ç†é€‰ä¸­çŠ¶æ€ï¼Œadapteræ•°æ®åˆ·æ–°æˆ–è€… checkbox æ¯æ¬¡é€‰ä¸­å‰ç§»é™¤ä¸Šæ¬¡çš„é€‰ä¸­äº‹ä»¶ç­‰ç­‰ï¼Œæˆ‘åªé€‰ä¸¤ç§è¿›è¡Œç®€å•è¯´æ˜ã€‚ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘è¿™é‡Œå°†å®ç°å›¾ç‰‡å¤šé€‰å’Œè§†é¢‘çš„å•é€‰åŠŸèƒ½ï¼Œå®ƒä»¬ checkbox é—®é¢˜çš„å¤„ç†å„è‡ªé‡‡ç”¨ä¸åŒçš„æ–¹å¼ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å›¾ç‰‡å¤šé€‰åŠŸèƒ½å®ç°ï¼Œå‰æ–¹é«˜èƒ½ï¼Œä»£ç æ¥è¢­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/** * &lt;pre&gt; * author: moosphon * date: 2018/09/16 * desc: æœ¬åœ°è§†é¢‘çš„é€‚é…å™¨ * &lt;pre/&gt; */class LocalImageAdapter: RecyclerView.Adapter&lt;LocalImageAdapter.LocalImageViewHolder&gt;() { lateinit var context: Context private var mSelectedPosition: Int = 0 var listener: OnLocalImageSelectListener? = null private lateinit var data: List&lt;ImageMediaEntity&gt; /** å­˜å‚¨é€‰ä¸­çš„å›¾ç‰‡ */ private var chosenImages : HashMap&lt;Int, String&gt; = HashMap() /** å­˜å‚¨é€‰ä¸­çš„çŠ¶æ€ */ private var checkStates : HashMap&lt;Int, Boolean&gt; = HashMap() override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): LocalImageViewHolder { context = parent.context val view = LayoutInflater.from(parent.context).inflate(R.layout.rv_item_local_video_layout, parent, false) return LocalImageViewHolder(view) } override fun getItemCount(): Int { return data.size } override fun onBindViewHolder(holder: LocalImageViewHolder, position: Int) { val thumbnailImage: ImageView = holder.view.find(R.id.local_video_item_thumbnail) val checkBox: CheckBox = holder.view.find(R.id.local_video_item_cb) /** é€šè¿‡mapå­˜å‚¨checkboxé€‰ä¸­çŠ¶æ€,æ”¾ç½®rvå¤ç”¨æœºåˆ¶å¯¼è‡´çš„çŠ¶æ€æ··ä¹±çŠ¶æ€ */ checkBox.setOnCheckedChangeListener(null) checkBox.isChecked = checkStates.containsKey(position) val options = RequestOptions() .diskCacheStrategy(DiskCacheStrategy.NONE) .error(R.mipmap.ic_launcher) .placeholder(R.mipmap.ic_launcher) Glide.with(context) .asBitmap() .load(data[position].thumbnailPath) .apply(options) .thumbnail(0.2f) .into(thumbnailImage) checkBox.setOnCheckedChangeListener{ _, isChecked -&gt; if (isChecked){ checkStates[position] = true // å°†å½“å‰é€‰ä¸­çš„å›¾ç‰‡å­˜å…¥map chosenImages[position] = data[position].path }else{ // ä»é€‰ä¸­åˆ—è¡¨ä¸­ç§»é™¤ checkStates.remove(position) chosenImages.remove(position) } if (listener != null){ val selectedImages = ArrayList&lt;String&gt;() for (v in chosenImages.values){ selectedImages.add(v) } listener!!.onImageSelect(holder.view, position, selectedImages) } } } fun setData(data: List&lt;ImageMediaEntity&gt;){ this.data = data for (i in 0 until data.size) { if (data[i].isSelected) { mSelectedPosition = i } } } class LocalImageViewHolder(val view: View) : RecyclerView.ViewHolder(view) /** è‡ªå®šä¹‰çš„æœ¬åœ°è§†é¢‘é€‰æ‹©ç›‘å¬å™¨ */ interface OnLocalImageSelectListener{ fun onImageSelect(view: View, position:Int, images: List&lt;String&gt;) }} å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¿™é‡Œé€šè¿‡ HashMap å­˜å‚¨å·²é€‰ä¸­ CheckBox çš„çŠ¶æ€ï¼Œå¹¶åœ¨ checkBox.setOnCheckedChangeListener å‰ç§»é™¤ä¸Šä¸€æ¬¡ CheckBox çš„ç›‘å¬å™¨ï¼Œç„¶åå†åœ¨ onCheckChanged æ–¹æ³•ä¸­åˆ¤æ–­å½“å‰é€‰ä¸­çŠ¶æ€ï¼Œå¦‚æœé€‰ä¸­ï¼Œé‚£ä¹ˆmapå­˜å…¥ CheckCox é€‰ä¸­çŠ¶æ€ï¼Œå¦åˆ™ç§»é™¤å½“å‰ä½ç½®çš„valueæ•°æ®ï¼Œè¿™æ ·ï¼Œå°±è§£å†³äº† æ»‘åŠ¨RecyclerView å CheckBox çŠ¶æ€æ··ä¹±é—®é¢˜ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ç”¨ Map å­˜å‚¨æ¯ä¸ªé€‰ä¸­åçš„å›¾ç‰‡è·¯å¾„ä¿¡æ¯ï¼Œç„¶ååœ¨è‡ªå·±çš„å›è°ƒä¸­è¿”å›è¿™äº›é€‰ä¸­çš„å›¾ç‰‡ï¼Œæœ€ååœ¨ Activity æˆ–è€… Fragment ä¸­å±•ç¤ºå°±å¯ä»¥äº†ã€‚ å®ç°äº†å›¾ç‰‡çš„å¤šé€‰æ•ˆæœï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹è§†é¢‘å•é€‰çš„å®ç°å§ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384/** * &lt;pre&gt; * author: moosphon * date: 2018/09/16 * desc: æœ¬åœ°è§†é¢‘çš„é€‚é…å™¨ * &lt;pre/&gt; */class LocalVideoAdapter: RecyclerView.Adapter&lt;LocalVideoAdapter.LocalVideoViewHolder&gt;() { lateinit var context: Context private var mSelectedPosition: Int = -1 var listener: OnLocalVideoSelectListener? = null private lateinit var data: List&lt;VideoMediaEntity&gt; private var checkState: HashSet&lt;Int&gt; = HashSet() override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): LocalVideoViewHolder { context = parent.context val view = LayoutInflater.from(parent.context).inflate(R.layout.rv_item_local_video_layout, parent, false) return LocalVideoViewHolder(view) } override fun getItemCount(): Int { return data.size } override fun onBindViewHolder(holder: LocalVideoViewHolder, position: Int) { val thumbnailImage: ImageView = holder.view.find(R.id.local_video_item_thumbnail) val checkBox: CheckBox = holder.view.find(R.id.local_video_item_cb) checkBox.isChecked = checkState.contains(position) val options = RequestOptions() .diskCacheStrategy(DiskCacheStrategy.NONE) .error(R.mipmap.ic_launcher) .placeholder(R.mipmap.ic_launcher) Glide.with(context) .asBitmap() .load(data[position].path) .apply(options) .thumbnail(0.2f) .into(thumbnailImage) checkBox.setOnClickListener { if (mSelectedPosition!=position){ //å…ˆå–æ¶ˆä¸Šä¸ªitemçš„å‹¾é€‰çŠ¶æ€ checkState.remove(mSelectedPosition) notifyItemChanged(mSelectedPosition) //è®¾ç½®æ–°Itemçš„å‹¾é€‰çŠ¶æ€ mSelectedPosition = position checkState.add(mSelectedPosition) notifyItemChanged(mSelectedPosition) }else if(checkBox.isChecked){ checkState.add(position) }else if(!checkBox.isChecked){ checkState.remove(position) } if (listener != null){ listener!!.onVideoSelect(holder.view, position) } } } fun setData(data: List&lt;VideoMediaEntity&gt;){ this.data = data for (i in 0 until data.size) { if (data[i].isSelected) { mSelectedPosition = i } } } class LocalVideoViewHolder(val view: View) : RecyclerView.ViewHolder(view) /** è‡ªå®šä¹‰çš„æœ¬åœ°è§†é¢‘é€‰æ‹©ç›‘å¬å™¨ */ interface OnLocalVideoSelectListener{ fun onVideoSelect(view:View, position:Int) }} æ­¤å¤„ä¸»è¦åˆ©ç”¨ checkBox.setOnClickListener ä»¥åŠ HashSet æ¥å¤„ç†å•é€‰äº‹ä»¶ï¼Œå…ˆé€šè¿‡ä¸€ä¸ªmSelectedPositionå­—æ®µæ¥ä¿å­˜å½“å‰é€‰ä¸­çš„ Checkbox çš„ä½ç½®ï¼Œç„¶ååœ¨ç‚¹å‡»äº‹ä»¶ä¸­è¿›è¡Œåˆ†æƒ…å†µå¤„ç†ï¼Œç”±äºè¿™é‡Œæ˜¯å•é€‰ï¼Œæ‰€ä»¥åœ¨è®¾ç½®æ–°çš„é€‰ä¸­çŠ¶æ€å‰ç§»é™¤ä¸Šä¸€æ¬¡çš„CheckBox é€‰ä¸­çŠ¶æ€ã€‚ä»£ç æ²¡ä»€ä¹ˆå¤æ‚çš„ï¼Œä¸»è¦æ˜¯ä¸€ç§æ€è·¯ï¼Œå…·ä½“é€»è¾‘ç†æ¸…æ¥šå°±å¥½äº†ï¼Œè¿™é‡Œå¤§å®¶å¯ä»¥è‡ªå·±ç¢ç£¨ä¸€ä¸‹ã€‚ Githubä¼ é€é—¨ï¼šhttps://github.com/Moosphan/LocalVideoImage-selector æ¬¢è¿å¤§å®¶æå‡ºæ”¹è¿›æ„è§æˆ–è€…å¸®åŠ©æˆ‘ä¸€èµ·å®Œå–„ä¸‹å»ï½","link":"/2018/09/22/image-selector/"},{"title":"Androidå°†libraryä»£ç å‘å¸ƒåˆ°jcenter","text":"ä½œä¸ºä¸€åAndroidå¼€å‘è€…ï¼Œæ—¥å¸¸å¼€å‘å·¥ä½œä¸­è‚¯å®šä¼šç”¨åˆ°ä¸€äº›å¼ºå¤§çš„ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼Œæœ‰äº†è¿™äº›å¼€æºçš„å¸®åŠ©ï¼Œå¼€å‘å·¥ä½œå¯è°“æ˜¯å¦‚é±¼å¾—æ°´ã€‚å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬è‡ªå·±å†™äº†ä¸€å¥—ä»£ç ï¼Œä¸ºäº†è®©åˆ«äººä½“éªŒåˆ°è‡ªå·±ä»£ç çš„ä¾¿æ·ä¹‹å¤„ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦å°†å…¶éƒ¨ç½²åˆ°githubï¼Œå‘å¸ƒåˆ°jcenterï¼Œç„¶åç”Ÿæˆgradleä»£ç ä¾›ä»–äººä½¿ç”¨ã€‚ç½‘ä¸Šå¯¹äºè¿™éƒ¨åˆ†çš„æ•™ç¨‹å¾ˆå¤šï¼Œä¸ç®¡æ˜¯é€šè¿‡gradle-bintray-pluginæ’ä»¶æˆ–è€…æ˜¯bintray-releaseæ’ä»¶ï¼Œå®ç°æµç¨‹å‡ ä¹ä¸€è‡´ï¼Œä½†æœ‰äº›ç»†èŠ‚å­˜åœ¨å·®å¼‚ï¼Œæœ€ç»ˆéƒ½å¯ä»¥é€šè¿‡compileæˆ–è€…implementionå¼•ç”¨ã€‚å…·ä½“æ­¥éª¤å¯ä»¥å‚è€ƒä»¥ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š é€šè¿‡bintray-releaseæ’ä»¶å‘å¸ƒï¼šhttps://blog.csdn.net/lmj623565791/article/details/51148825 é€šè¿‡gradle-bintray-pluginæ’ä»¶å‘å¸ƒï¼šhttps://www.cnblogs.com/AbrahamCaiJin/p/7058147.html å½“ç„¶ï¼Œå‘å¸ƒè¿‡ç¨‹å¹¶ä¸æ˜¯ç™¾åˆ†ç™¾æˆåŠŸçš„ï¼Œéš¾å…ä¼šé‡åˆ°ä»¥ä¸‹å¸¸è§é—®é¢˜ï¼š ç»ˆç«¯è¾“å…¥gradlew installå‘½ä»¤åå‡ºç°bash: gradlew: command not foundé—®é¢˜ï¼š è¯¥é—®é¢˜çš„åŸå› ä¸€èˆ¬æ˜¯æ²¡æœ‰é…ç½®gradleçš„ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†gradleæ‰€åœ¨ä½ç½®å¤åˆ¶åˆ°ç¯å¢ƒå˜é‡ä¸­å»ï¼Œwindowsè¾ƒä¸ºç®€å•ï¼ŒMacæ¯”è¾ƒç‰¹æ®Šï¼Œè¿™é‡Œç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šhttps://blog.csdn.net/u013424496/article/details/52684213 æƒé™é—®é¢˜ï¼š å¯èƒ½ä¼šé‡åˆ°-bash: /Applications/Android Studio3.0.app/Contents/gradle/gradle-4.1/bin/gradle: Permission deniedé—®é¢˜ï¼Œä¸€èˆ¬æ˜¯gradleæƒé™å¼•èµ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨asç»ˆç«¯è¾“å…¥ï¼š 12$ chmod +x gradle$ chmod +x gradle.bat ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé‡æ–°æ‰§è¡Œgradlew å‘½ä»¤å°±æ²¡é—®é¢˜äº†ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œå¯ä»¥åœ¨gradlew xxxå‘½ä»¤å‰åŠ ä¸Š./,å¦‚ï¼š 1234./gradlew clean build bintrayUpload -PbintrayUser=xxx -PbintrayKey=xxxxxxxxxxxxxxxxxxxxxx -PdryRun=false æ‰§è¡Œjcenterå‘å¸ƒå‘½ä»¤æ—¶å‡ºç°Execution failed for task ':library:bintrayUpload'. Bintray user cannot be empty!é—®é¢˜ï¼š è¿™ç§é—®é¢˜å¯èƒ½æ˜¯userä¸ºç©ºï¼Œæ²¡æœ‰è®¾ç½®ï¼Œä¹Ÿå¯èƒ½æ˜¯å‘å¸ƒå‘½ä»¤ä¸­é—´å¤šäº†ç©ºæ ¼ç¬¦åˆæˆ–è€…æ¢è¡Œç¬¦å·ï¼Œä¸è¦ä»ç½‘ä¸Šå¤åˆ¶å‘½ä»¤ç›´æ¥æ‰§è¡Œï¼Œæœ€å¥½å…ˆå¤åˆ¶åˆ°æ–‡æœ¬ç¼–è¾‘å™¨æŸ¥çœ‹æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚ libraryå‘å¸ƒæˆåŠŸåï¼Œä¸€å®šè¦è®°å¾—å…ˆåœ¨jcenterä¸ªäººä»“åº“çš„é¡¹ç›®é¡µç‚¹å‡»add to jcenterå®¡æ ¸é€šè¿‡åæ‰èƒ½ä½¿ç”¨compileå’Œmavenã€‚ å¦‚æœjcenterå®¡æ ¸é€šè¿‡ï¼Œå¯ä»¥é€šè¿‡compile....å‘½ä»¤å¤åˆ¶åˆ°gradleä¸­ç¼–è¯‘ä¸€ä¸‹ï¼Œå¦‚æœå‡ºç°ï¼š 12Error:(32, 13) Failed to resolve: com.android.support:support-annotations:27.1.0 Install Repository and sync projectShow in File. å¯ä»¥å°è¯•åœ¨projectåˆ°build.gradleæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456allprojects { repositories { maven { url &quot;https://maven.google.com&quot; } jcenter() }} é‡æ–°ç¼–ä¸€ä¸‹çœ‹èƒ½å¦é€šè¿‡ã€‚ å¦‚æœä½¿ç”¨classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:xx'æ’ä»¶ï¼Œå‘å¸ƒåˆ°jcenterç‰ˆæœ¬versionå¿…é¡»é€šè¿‡libraryçš„gradleæ–‡ä»¶ä¸­å®šä¹‰ï¼š 12version = &quot;1.0.0&quot; æ–¹å¯åœ¨jcenteræ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œå¦åˆ™ä¼šå‡ºç°ç‰ˆæœ¬å·æœªçŸ¥çš„é—®é¢˜ã€‚ å¦‚æœä½¿ç”¨classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:xxæ’ä»¶ï¼Œæœ€ç»ˆjcenterä¸­çš„compileä¾èµ–é¡¹ç›®åä¼šè‡ªåŠ¨ä½¿ç”¨ä½ libraryçš„moudleåä½œä¸ºæœ€ç»ˆçš„é¡¹ç›®åï¼Œå¦‚ï¼Œæˆ‘çš„libraryçš„moudleåä¸ºlibraryï¼Œé‚£ä¹ˆæœ€ç»ˆç”Ÿæˆçš„compileä»£ç ä¼šæ˜¯ï¼š 1com.moos:library:1.0.0 å› æ­¤ï¼Œåœ¨å‘å¸ƒä¹‹å‰ï¼Œè¯·åŠ¡å¿…ç¡®è®¤å¥½æœ€ç»ˆçš„åå­—ã€‚è¿™é‡Œï¼Œå¼ºçƒˆæ¨èä½¿ç”¨classpath 'com.novoda:bintray-release:0.x.x'æ’ä»¶æ¥è¿›è¡Œjcenterå‘å¸ƒæ“ä½œï¼ŒçœŸçš„å¾ˆæ–¹ä¾¿ï¼ æœ€åï¼Œå¦‚æœä½ çš„libraryä¸­æœ‰ä¸­æ–‡çš„æ³¨é‡Šï¼Œå¯èƒ½ä¼šæœ‰ç¼–ç é—®é¢˜ï¼Œå¯ä»¥åœ¨projectçš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789allprojects { tasks.withType(Javadoc) { options{ encoding &quot;UTF-8&quot; charSet 'UTF-8' links &quot;http://docs.oracle.com/javase/8/docs/api&quot; } }} â€‹","link":"/2018/03/25/jcenter-publish/"},{"title":"Android Kotlin å¿«é€Ÿå¼€å‘ä¹‹ Anko é­”æ³•","text":"ä¼—æ‰€å‘¨çŸ¥ï¼Œç›®å‰ kotlin å·²ç»ä½œä¸º Google å®˜æ–¹æ¨èçš„ Android å¼€å‘è¯­è¨€ï¼Œç›®å‰ GitHub ä¸Šé¢å…³äº kotlin çš„é¡¹ç›®å·²ç„¶å‘ˆç°ä¸€ç‰‡åŠ¿ä¸å¯æŒ¡çš„çƒ­åº¦ã€‚ä½œä¸ºä¸€å Android å¼€å‘è€…ï¼Œå­¦å¥½ koltin å·²ç»æˆä¸ºæˆ‘ä»¬å¿…é¡» get çš„æŠ€èƒ½ï¼Œè€Œæƒ³è¦åœ¨å·¥ä½œä¸­ä½¿ç”¨ kotlin å¿«é€Ÿå¼€å‘é¡¹ç›®ï¼ŒAnko æ— ç–‘æˆä¸ºé¦–é€‰åˆ©å™¨ï¼ â€‹ é‚£ä¹ˆ Anko åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥ä¸ºæˆ‘ä»¬åšå“ªäº›äº‹æƒ…å‘¢ï¼Ÿ â€‹ Anko æ˜¯ä¸€æ¬¾ kotlin çš„æ‰©å±•åº“ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ ç®€å•ã€å¿«é€Ÿçš„å¼€å‘ Android åº”ç”¨ã€‚å®ƒèƒ½å¤Ÿè®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ æ´å‡€æ˜“è¯»ï¼Œå¹¶ä¸”å¿˜è®° Java é‚£ç§ç¹çã€å¤æ‚çš„ç¼–ç¨‹æ–¹å¼ã€‚Anko åº“ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š Anko Commonsï¼ˆé€šç”¨æ‰©å±•åº“ï¼‰ï¼šä¸€ä¸ªè½»é‡çº§çš„å¸®åŠ©åº“ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨å°‘é‡ä»£ç å°±å¯ä»¥è½»æ¾ã€å¿«é€Ÿä½¿ç”¨ Intentã€Dialogã€ Logã€ Toast ã€ SnackBar ç­‰å¸¸ç”¨åŠŸèƒ½ã€‚ Anko Layoutsï¼ˆå¸ƒå±€æ‰©å±•åº“ï¼‰ï¼šä¸€ç§å¿«é€Ÿã€ç±»å‹å®‰å…¨çš„æ–¹å¼å»é€šè¿‡ä»£ç åŠ¨æ€ç¼–å†™ Android å¸ƒå±€ï¼Œæœ‰ç‚¹ç±»ä¼¼ swift ä¸­çš„æ–¹å¼ã€‚ Anko SQLiteï¼ˆSQLiteæ‰©å±•åº“ï¼‰ï¼šä¸€ä¸ªé’ˆå¯¹Androidçš„SQLiteæŸ¥è¯¢DSLå’Œè§£æå™¨çš„é›†åˆã€‚ Anko Coroutinesï¼ˆkotlinåç¨‹æ‰©å±•åº“ï¼‰ï¼šåŸºäº kotlinx.coroutines åº“çš„æ‰©å±• ç”±äºä¸€ç¯‡æ–‡ç« ç¯‡å¹…è¾ƒé•¿ï¼Œæ•…åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†æ¥è®²è§£ï¼Œä¸Šç¯‡ä¸»è¦ä»‹ç»Anko Commonsæ‰©å±•åº“çš„ç›¸å…³åŠŸèƒ½ã€‚ ###Anko Commons è¯¥åº“ä¸»è¦åŒ…å«ä¸€äº›å¸¸è§åŠŸèƒ½çš„æ‰©å±•å’Œå°è£…ï¼Œå¸¸è§çš„æœ‰ dialogs ã€intentã€toastã€snackBar ç­‰ï¼Œä¸‹é¢æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å…·ä½“å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚é¦–å…ˆéœ€è¦ä¾èµ–ä¸€ä¸‹æ‰©å±•åŒ…ï¼š 12// Anko Commonsimplementation &quot;org.jetbrains.anko:anko-commons:0.10.8&quot; ####Toasts Toastï¼ˆåå¸ï¼‰ç®—æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„åŠŸèƒ½ï¼Œå¤§å®¶é¡¹ç›®ä¸­æˆ–å¤šæˆ–å°‘éƒ½å¯¹å…¶è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œanko ä¸­ä½¿ç”¨ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œåªéœ€è¦è¿™æ ·ï¼š 123toast(&quot;login success!&quot;)toast(R.string.login_success)longToast(&quot;Wow, nice work!&quot;) SnackBarsSnackBar æ˜¯Android5.0å material design ä¸­å¸¸ç”¨æ§ä»¶ä¹‹ä¸€ï¼Œå®ƒçš„å‡ºç°å’Œ Toast å·®ä¸å¤šï¼Œä¸ºäº†ç»™ç”¨æˆ·å¸¦æ¥ä¸€äº›æç¤ºæ€§ä¿¡æ¯ï¼Œå…·ä½“ç‰¹ç‚¹å¯ä»¥è‡ªè¡ŒæŸ¥é˜…ç›¸å…³æ–‡ç« ã€‚é€šè¿‡ Anko æˆ‘ä»¬åªéœ€è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼å°±å¯ä»¥ç›´æ¥ä½“ä¼šåˆ°å®ƒçš„é­…åŠ›ï¼š 1234view.snackbar(&quot;login success!&quot;)view.snackbar(R.string.login_success)view.longSnackbar(&quot;Wow, nice work!&quot;)view.snackbar(&quot;Action, reaction&quot;, &quot;Click me!&quot;) { doSomeThing() } DialogsDialog æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒè¾ƒä¸ºé†’ç›®ï¼Œå±‚çº§è¾ƒé«˜ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„å½“å± AlertDialog äº†ï¼Œé€šå¸¸æˆ‘ä»¬è¿™æ ·ä½¿ç”¨ï¼š 1234567AlertDialog.Builder(this) .setPositiveButton(R.string.btn_allow_text) { _, _ -&gt; request.proceed() } .setNegativeButton(R.string.btn_deny_text) { _, _ -&gt; request.cancel() } .setCancelable(false) .setTitle(&quot;æç¤º&quot;) .setMessage(&quot;æˆ‘ä»¬éœ€è¦è¯·æ±‚ä½¿ç”¨æ‚¨æ‰‹æœºçš„éƒ¨åˆ†æƒé™ï¼Œæ˜¯å¦åŒæ„ï¼Ÿ&quot;) .show() è™½ç„¶æ˜¯é“¾å¼è°ƒç”¨ï¼Œä½†ä½¿ç”¨è¾ƒå¤šæ—¶ä¾æ—§å¾ˆéº»çƒ¦ï¼Œé€šè¿‡ Ankoï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ä¸‹é¢ä»£ç æ¥å®ç°ç›¸åŒåŠŸèƒ½ï¼š 123456789alert(&quot;æˆ‘ä»¬éœ€è¦è¯·æ±‚ä½¿ç”¨æ‚¨æ‰‹æœºçš„éƒ¨åˆ†æƒé™ï¼Œæ˜¯å¦åŒæ„ï¼Ÿ&quot;, &quot;æç¤º&quot;){ yesButton { request.proceed() } noButton { request.cancel() }}.show() æ¯”è¾ƒä¸‹æ¥ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼ŒèŠ‚çœäº†ä¸€å¤šåŠçš„ä»£ç é‡ã€‚ å½“ç„¶ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨ AppCompat ä¸‹çš„ AlertDialog ï¼Œå› ä¸ºå®ƒæä¾›äº†å‘ä¸‹å…¼å®¹çš„ç‰¹æ€§ï¼Œä¿è¯åœ¨ä¸åŒAndroidç³»ç»Ÿä¸Šå°½é‡è¾¾åˆ°ç›¸åŒæ•ˆæœï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ä¾èµ–é’ˆå¯¹ AppCompat çš„æ‰©å±•åŒ…ï¼š 12// Appcompat-v7 (only Anko Commons)implementation &quot;org.jetbrains.anko:anko-appcompat-v7-commons:0.10.8&quot; ç„¶åæˆ‘å°±å¯ä»¥ç›´æ¥è¿™æ ·ä½¿ç”¨ AppCompat ä¸‹çš„ AlertDialog äº†ï¼š 123456789alert(Appcompat, &quot;æˆ‘ä»¬éœ€è¦è¯·æ±‚ä½¿ç”¨æ‚¨æ‰‹æœºçš„éƒ¨åˆ†æƒé™ï¼Œæ˜¯å¦åŒæ„ï¼Ÿ&quot;, &quot;æç¤º&quot;){ yesButton { request.proceed() } noButton { request.cancel() }}.show() å¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰å¼¹çª—çš„å¸ƒå±€å‘¢ï¼Ÿåˆ«ç€æ€¥ï¼ŒAnko åŒæ ·ä¸ºæˆ‘ä»¬æä¾›æ–¹å¼å®ç°ï¼š 12345alert { customView { editText() }}.show() ä»€ä¹ˆï¼Ÿè¿™å°±å®Œäº†ï¼Ÿæ²¡é”™ï¼Œå¦‚æœä½ æƒ³åœ¨å¼¹çª—é‡Œæ”¾ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¿™æ ·å°±å®ç°äº†ã€‚ä½ è‚¯å®šä¼šå¥½å¥‡ï¼Œæ€ä¹ˆè®¾ç½®layoutå‘¢ï¼Ÿå…ˆåˆ«æ€¥ï¼Œè¿™æ˜¯ankoä¸ºæˆ‘ä»¬æä¾›çš„å¦å¤–ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œè¿™å—å°†åœ¨åé¢è¯´åˆ°ï¼Œå…ˆå–å–å…³å­ğŸ˜ã€‚ ä½ å¯èƒ½åˆä¼šçªç„¶æƒ³èµ·æ¥ï¼ŒAlertDialog è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†åˆ—è¡¨å•é€‰åŠŸèƒ½å‘¢ï¼Œå“ˆå“ˆï¼Œanko åŒæ ·ä¸ºæˆ‘ä»¬è€ƒè™‘åˆ°äº†ï¼Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·å†™ï¼š 1234567891011121314alert(Appcompat, &quot;Please select your country where you come from&quot;, &quot;Tips&quot;){ yesButton { } noButton { } val countries = listOf(&quot;Russia&quot;, &quot;USA&quot;, &quot;Japan&quot;, &quot;Australia&quot;) selector(&quot;Where are you from?&quot;, countries) { _, i -&gt; toast(&quot;So you're living in ${countries[i]}, right?&quot;) } }.show() æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Ÿåªéœ€è¦åœ¨alertåŸŸä¸­é€šè¿‡ selector å®ç°å°±å¯ä»¥äº†ã€‚ å¦å¤–ï¼ŒAnko åŒæ ·ä¸ºæˆ‘ä»¬æä¾›äº†å¿«é€Ÿä½¿ç”¨ ProgressDialog æ–¹å¼ï¼Œä¾‹å¦‚ï¼š 1val dialog = progressDialog(message = &quot;Please waitâ€¦&quot;, title = &quot;Tips&quot;) ####Intent å¼€å‘è¿‡ Android éƒ½çŸ¥é“ï¼ŒIntent æ˜¯æˆ‘ä»¬æ„å»ºé¡µé¢æ—¶å¿…ä¸å¯å°‘çš„å·¥å…·ï¼Œå®ƒæ˜¯å››å¤§ç»„ä»¶é€šä¿¡çš„â€ä¿¡ä½¿â€ã€‚ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­è¿™æ ·ä½¿ç”¨ï¼š 1234val intent = Intent(this, SomeOtherActivity::class.java)intent.putExtra(&quot;id&quot;, 5)intent.setFlag(Intent.FLAG_ACTIVITY_SINGLE_TOP)startActivity(intent) è€Œæˆ‘ä»¬é€šè¿‡ Anko å°±å®Œå…¨å¯ä»¥é€šè¿‡ä¸€è¡Œä»£ç å®ç°ï¼š 1startActivity(intentFor&lt;SomeOtherActivity&gt;(&quot;id&quot; to 5).singleTop()) æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯è¶…çº§æ–¹ä¾¿ï¼Ÿè€Œä¸”å®ƒç»™æˆ‘ä»¬æä¾›çš„é“¾å¼è°ƒç”¨ï¼Œå¾ˆæ¸…æ™°ï¼Œæ­¤å¤–ï¼Œå®ƒè¿˜ä¸ºæˆ‘ä»¬æä¾›äº† Intent å¸¸ç”¨åŠŸèƒ½ï¼Œä¾‹å¦‚æ‹¨æ‰“ç”µè¯ã€å‘é‚®ä»¶ã€åˆ†äº«ç­‰ç­‰ï¼š Goal Solution Make a call makeCall(number) without tel: Send a text sendSMS(number, [text]) without sms: Browse the web browse(url) Share some text share(text, [subject]) Send a email email(email, [subject], [text]) LogLog æ—¥å¿—åŠŸèƒ½æˆ‘ä»¬å¹³æ—¶åº”è¯¥è¯´ç”¨çš„æœ€å¤šäº†ï¼Œé€šå¸¸ç”¨æ¥æ‰“å°ä¸€äº›å…³é”®ä¿¡æ¯ï¼Œæµ‹è¯•ä¸€äº›å…³é”®é€»è¾‘æ­£ç¡®æ€§ã€‚Anko ä¸ºæˆ‘ä»¬æä¾›äº†è‡ªå·±çš„æ‰©å±•å°è£…ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼š 1234567class SomeActivity : Activity(), AnkoLogger { private fun someMethod() { info(&quot;London is the capital of Great Britain&quot;) debug(5) // .toString() method will be executed warn(null) // &quot;null&quot; will be printed }} æˆ–è€…ä¸æƒ³é€šè¿‡å®ç°æ¥å£æ–¹å¼ï¼Œå¯ä»¥å€ŸåŠ©ä»¥ä¸‹æ–¹å¼ï¼š 12345678class SomeActivity : Activity() { private val log = AnkoLogger(this.javaClass) private val logWithASpecificTag = AnkoLogger(&quot;my_tag&quot;) private fun someMethod() { log.warning(&quot;Big brother is watching you!&quot;) }} å¯¹åº”çš„æ—¥å¿—æ‰“å°æ–¹æ³•å¦‚ä¸‹ï¼š android.util.Log AnkoLogger v() verbose() d() debug() i() info() w() warn() e() error() wtf() wtf() ####å…¶ä»–ç‰¹æ®Šæ‰©å±•åŠŸèƒ½ Colors Ankoä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§é’ˆå¯¹è‰²å½©çš„æ‰©å±•åŠŸèƒ½æ¥è®©æˆ‘ä»¬çš„ä»£ç æ›´ä½³æ˜“è¯»ï¼Œå¦‚ï¼š Function Result 0xff0000.opaque ä¸é€æ˜çš„çº¢è‰² 0x99.gray.opaque ä¸é€æ˜çš„#999999ï¼ˆç°è‰²ï¼‰ Dimensions ä½ å¯ä»¥æŒ‡å®š dimension çš„ dip (density-independent pixels) æˆ– sp (scale-independent pixels)å€¼: dip(dipValue) æˆ– sp(spValue). æ³¨æ„ textSizeå±æ€§é»˜è®¤æ¥å—sp (textSize = 16f). ä½¿ç”¨ px2dip å’Œ px2sp ç›¸äº’è½¬æ¢. applyRecursively applyRecursively æ–¹æ³•å°†lambdaè¡¨è¾¾å¼åº”ç”¨äºä¼ é€’ View çš„æœ¬èº«ï¼Œå¦‚æœå®ƒæ˜¯ ViewGroup ï¼Œåˆ™é€’å½’åˆ°å®ƒçš„æ¯ä¸ªå­—èŠ‚ç‚¹ï¼Œä¾‹å¦‚è¿™æ ·ï¼š 1234567891011121314verticalLayout { editText { hint = &quot;Name&quot; } editText { hint = &quot;Password&quot; } button(&quot;login now&quot;) { onClick { toast(&quot;login success!&quot;) } }}.applyRecursively { view -&gt; when(view) { is EditText -&gt; view.textSize = 20f is Button -&gt; view.text = &quot;ç‚¹æˆ‘å‘€ï½&quot;}} Anko Commons åŸºç¡€æ‰©å±•åº“å·²ç»ä»‹ç»çš„å·®ä¸å¤šäº†ï¼Œæ€ä¹ˆæ ·ï¼Ÿçœ‹å®Œ Anko æ–½åŠ åœ¨ Android ä¸Šçš„â€œé­”æ³•â€ï¼Œæ˜¯ä¸æ˜¯è¿«ä¸åŠå¾…åœ°æƒ³å»å¤§å±•èº«æ‰‹äº†ï¼ŸåŸæ¥ä»£ç è¿˜å¯ä»¥è¿™æ ·ç®€æ´æ˜äº†ï¼Œæ–¹ä¾¿æ˜“ç”¨ã€‚å“ˆå“ˆï¼ŒAndroidå¿«é€Ÿå¼€å‘ä¹‹Ankoé­”æ³•ï¼ˆä¸‹ç¯‡ï¼‰ä¹Ÿå°†åœ¨ä¸ä¹…äºå¤§å®¶ä¸è§ä¸æ•£ğŸ˜„ã€‚ QQäº¤æµç¾¤ï¼š601924443 æ¬¢è¿Androidæˆ–è€…kotlinçˆ±å¥½è€…åŠ å…¥æ¢è®¨äº¤æµã€‚","link":"/2018/12/11/kotlin-anko/"},{"title":"å½“ Kotlin ä¸­çš„ç›‘å¬å™¨åŒ…å«å¤šä¸ªæ–¹æ³•æ—¶ï¼Œå¦‚ä½•è®©å®ƒ â€œå·§å¤ºå¤©å·¥â€ï¼Ÿ","text":"åŸæ–‡åœ°å€ï¼šListeners with several functions in Kotlin. How to make them shine? åŸæ–‡ä½œè€…ï¼šAntonio Leiva è¯‘æ–‡å‡ºè‡ªï¼šæ˜é‡‘ç¿»è¯‘è®¡åˆ’ æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼šhttps://github.com/xitu/gold-miner/blob/master/TODO1/listeners-several-functions-kotlin.md è¯‘è€…ï¼šMoosphon æ ¡å¯¹è€…ï¼šQiuk17, zx-Zhu å½“ Kotlin ä¸­çš„ç›‘å¬å™¨åŒ…å«å¤šä¸ªæ–¹æ³•æ—¶ï¼Œå¦‚ä½•è®©å®ƒ â€œå·§å¤ºå¤©å·¥â€ï¼Ÿ æˆ‘ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜æ˜¯åœ¨ä½¿ç”¨ Kotlin æ—¶å¦‚ä½•ç®€åŒ–å…·æœ‰å¤šä¸ªæ–¹æ³•çš„ç›‘å¬å™¨çš„äº¤äº’ã€‚å¯¹äºå…·æœ‰åªå…·æœ‰ä¸€ä¸ªæ–¹æ³•çš„ç›‘å¬å™¨ï¼ˆæˆ–ä»»ä½•æ¥å£ï¼‰å¾ˆç®€å•ï¼šKotlin ä¼šè‡ªåŠ¨è®©æ‚¨ç”¨ lambda æ›¿æ¢å®ƒã€‚ä½†å¯¹äºå…·æœ‰å¤šä¸ªæ–¹æ³•çš„ç›‘å¬å™¨æ¥è¯´ï¼Œæƒ…å†µå¹¶éå¦‚æ­¤ã€‚ å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³å‘æ‚¨å±•ç¤ºå¤„ç†é—®é¢˜çš„ä¸åŒæ–¹æ³•ï¼Œæ‚¨ç”šè‡³å¯ä»¥åœ¨é€”ä¸­å­¦ä¹ ä¸€äº›æ–°çš„ Kotlin æŠ€å·§ï¼ é—®é¢˜æ‰€åœ¨å½“æˆ‘ä»¬å¤„ç†ç›‘å¬å™¨æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“ OnclickListener ä½œç”¨äºè§†å›¾ï¼Œå½’åŠŸäº Kotlin å¯¹ Java åº“çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»¥ä¸‹ä»£ç ï¼š 12345view.setOnClickListener(object : View.OnClickListener { override fun onClick(v: View?) { toast(&quot;View clicked!&quot;) }}) è½¬åŒ–ä¸ºè¿™æ ·ï¼š 1view.setOnClickListener { toast(&quot;View clicked!&quot;) } é—®é¢˜åœ¨äºï¼Œå½“æˆ‘ä»¬ä¹ æƒ¯å®ƒæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿæ— å¤„ä¸åœ¨ã€‚ç„¶è€Œå½“æ¥å£å­˜åœ¨å¤šä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ç§åšæ³•å°†ä¸å†é€‚ç”¨ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä¸ºè§†å›¾åŠ¨ç”»è®¾ç½®ä¸€ä¸ªç›‘å¬å™¨ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°ä»¥ä¸‹â€œæ¼‚äº®â€çš„ä»£ç ï¼š 12345678910111213141516171819view.animate() .alpha(0f) .setListener(object : Animator.AnimatorListener { override fun onAnimationStart(animation: Animator?) { toast(&quot;Animation Start&quot;) } override fun onAnimationRepeat(animation: Animator?) { toast(&quot;Animation Repeat&quot;) } override fun onAnimationEnd(animation: Animator?) { toast(&quot;Animation End&quot;) } override fun onAnimationCancel(animation: Animator?) { toast(&quot;Animation Cancel&quot;) } }) ä½ å¯èƒ½ä¼šåé©³è¯´ Android framework å·²ç»ä¸ºå®ƒæä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šé€‚é…å™¨ã€‚å¯¹äºå‡ ä¹ä»»ä½•å…·æœ‰å¤šä¸ªæ–¹æ³•çš„æ¥å£ï¼Œå®ƒä»¬éƒ½æä¾›äº†ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå°†æ‰€æœ‰æ–¹æ³•å®ç°ä¸ºç©ºã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæ‚¨å¯ä»¥è¿™æ ·ï¼š 1234567view.animate() .alpha(0f) .setListener(object : AnimatorListenerAdapter() { override fun onAnimationEnd(animation: Animator?) { toast(&quot;Animation End&quot;) } }) å¥½çš„ï¼Œæ˜¯æ”¹å–„äº†ä¸€äº›ï¼Œä½†è¿™å­˜åœ¨å‡ ä¸ªé—®é¢˜ï¼š é€‚é…å™¨æ˜¯ç±»ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªç±»ä½œä¸ºæ­¤é€‚é…å™¨çš„å®ç°ï¼Œå®ƒä¸èƒ½æ‰©å±•å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚ æˆ‘ä»¬æŠŠä¸€ä¸ªæœ¬å¯ä»¥ç”¨ lambda æ¸…æ™°è¡¨è¾¾çš„äº‹ç‰©ï¼Œå˜æˆäº†ä¸€ä¸ªå…·æœ‰ä¸€ä¸ªæ–¹æ³•çš„åŒ¿åå¯¹è±¡ã€‚ æˆ‘ä»¬æœ‰ä»€ä¹ˆé€‰æ‹©ï¼Ÿ Kotlin ä¸­çš„æ¥å£ï¼šå®ƒä»¬å¯ä»¥åŒ…å«ä»£ç è¿˜è®°å¾—æˆ‘ä»¬è°ˆåˆ° Kotlin ä¸­çš„æ¥å£å—ï¼Ÿ å®ƒä»¬å†…éƒ¨å¯ä»¥åŒ…å«ä»£ç ï¼Œå› æ­¤ï¼Œæ‚¨èƒ½å¤Ÿå£°æ˜å¯ä»¥å®ç°è€Œä¸æ˜¯ç»§æ‰¿é€‚é…å™¨ï¼ˆä»¥é˜²æ‚¨ç°åœ¨å°†å…¶ç”¨äº Android å¼€å‘ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Java 8 å’Œæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼‰ï¼š 123456interface MyAnimatorListenerAdapter : Animator.AnimatorListener { override fun onAnimationStart(animation: Animator) = Unit override fun onAnimationRepeat(animation: Animator) = Unit override fun onAnimationCancel(animation: Animator) = Unit override fun onAnimationEnd(animation: Animator) = Unit} æœ‰äº†è¿™ä¸ªï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰æ–¹æ³•éƒ½ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªç±»å¯ä»¥å®ç°æ­¤æ¥å£å¹¶ä»…å£°æ˜å®ƒæ‰€éœ€çš„æ–¹æ³•ï¼š 123456class MainActivity : AppCompatActivity(), MyAnimatorListenerAdapter { ... override fun onAnimationEnd(animation: Animator) { toast(&quot;Animation End&quot;) }} ä¹‹åï¼Œæ‚¨å¯ä»¥å°†å®ƒä½œä¸ºç›‘å¬å™¨çš„å‚æ•°ï¼š 123view.animate() .alpha(0f) .setListener(this) è¿™ä¸ªæ–¹æ¡ˆè§£å†³äº†å¼€å§‹æ—¶æå‡ºçš„ä¸€ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶è¦æ˜¾å¼åœ°å£°æ˜å®ƒã€‚å¦‚æœæˆ‘æƒ³ä½¿ç”¨ lambda è¡¨è¾¾å¼å‘¢ï¼Ÿ æ­¤å¤–ï¼Œè™½ç„¶è¿™å¯èƒ½ä¼šä¸æ—¶åœ°ä½¿ç”¨ç»§æ‰¿ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä»å°†ä½¿ç”¨åŒ¿åå¯¹è±¡ï¼Œè¿™ä¸ä½¿ç”¨ framework é€‚é…å™¨å¹¶æ— ä¸åŒã€‚ ä½†æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æƒ³æ³•ï¼šå¦‚æœä½ éœ€è¦ä¸ºå…·æœ‰å¤šä¸ªæ–¹æ³•çš„ç›‘å¬å™¨å®šä¹‰ä¸€ç§é€‚é…å™¨ï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨æ¥å£è€Œä¸æ˜¯æŠ½è±¡ç±»ã€‚ç»§æ‰¿ FTW çš„æ„æˆã€‚ ä¸€èˆ¬æƒ…å†µä¸‹çš„æ‰©å±•åŠŸèƒ½è®©æˆ‘ä»¬è½¬å‘æ›´åŠ ç®€æ´çš„è§£å†³æ–¹æ¡ˆã€‚å¯èƒ½ä¼šç¢°åˆ°è¿™ç§æƒ…å†µï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ï¼šå¤§å¤šæ•°æ—¶å€™ä½ åªéœ€è¦ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œå¯¹å¦ä¸€ä¸ªåŠŸèƒ½åˆ™ä¸å¤ªæ„Ÿå…´è¶£ã€‚å¯¹äº AnimatorListenerï¼Œæœ€å¸¸ç”¨çš„ä¸€ä¸ªæ–¹æ³•é€šå¸¸æ˜¯ onAnimationEndã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä¸åˆ›å»ºä¸€ä¸ªæ¶µç›–è¿™ç§æƒ…å†µçš„æ‰©å±•æ–¹æ³•å‘¢ï¼Ÿ 123view.animate() .alpha(0f) .onAnimationEnd { toast(&quot;Animation End&quot;) } çœŸæ£’ï¼æ‰©å±•å‡½æ•°åº”ç”¨äº ViewPropertyAnimatorï¼Œè¿™æ˜¯ animate()ã€alpha å’Œæ‰€æœ‰å…¶ä»–åŠ¨ç”»æ–¹æ³•è¿”å›çš„å†…å®¹ã€‚ 1234567inline fun ViewPropertyAnimator.onAnimationEnd(crossinline continuation: (Animator) -&gt; Unit) { setListener(object : AnimatorListenerAdapter() { override fun onAnimationEnd(animation: Animator) { continuation(animation) } })} æˆ‘ä¹‹å‰å·²ç»è°ˆè¿‡ å†…è”ï¼Œä½†å¦‚æœä½ è¿˜æœ‰ä¸€äº›ç–‘é—®ï¼Œæˆ‘å»ºè®®ä½ çœ‹ä¸€ä¸‹å®˜æ–¹çš„æ–‡æ¡£ã€‚ å¦‚æ‚¨æ‰€è§ï¼Œè¯¥å‡½æ•°åªæ¥æ”¶åœ¨åŠ¨ç”»ç»“æŸæ—¶è°ƒç”¨çš„ lambdaã€‚è¿™ä¸ªæ‰©å±•å‡½æ•°ä¸ºæˆ‘ä»¬å®Œæˆäº†åˆ›å»ºé€‚é…å™¨å¹¶è°ƒç”¨ setListener è¿™ç§ä¸å‹å¥½çš„å·¥ä½œã€‚ è¿™æ ·å°±å¥½å¤šäº†ï¼æˆ‘ä»¬å¯ä»¥åœ¨ç›‘å¬å™¨ä¸­ä¸ºæ¯ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªæ‰©å±•æ–¹æ³•ã€‚ä½†åœ¨è¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é‡åˆ°äº†åŠ¨ç”»åªæ¥å—ä¸€ä¸ªç›‘å¬å™¨çš„é—®é¢˜ã€‚å› æ­¤æˆ‘ä»¬ä¸€æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªã€‚ åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå¯¹äºå¤§å¤šæ•°é‡å¤çš„æƒ…å†µï¼ˆåƒä¸Šé¢é‚£æ ·ï¼‰ï¼Œå®ƒå¹¶ä¸ä¼šæŸå®³åˆ°åƒå¦‚ä¸Šæåˆ°çš„ Animator æœ¬èº«çš„æ–¹æ³•ã€‚è¿™æ˜¯æ›´ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œéå¸¸æ˜“äºé˜…è¯»å’Œç†è§£ã€‚ ä½¿ç”¨å‘½åå‚æ•°å’Œé»˜è®¤å€¼ä½†æ˜¯ä½ å’Œæˆ‘å–œæ¬¢ Kotlin çš„åŸå› ä¹‹ä¸€æ˜¯å®ƒæœ‰å¾ˆå¤šä»¤äººæƒŠå¥‡çš„åŠŸèƒ½æ¥ç®€åŒ–æˆ‘ä»¬çš„ä»£ç ï¼æ‰€ä»¥ä½ å¯ä»¥æƒ³è±¡æˆ‘ä»¬è¿˜æœ‰ä¸€äº›é€‰æ‹©çš„ä½™åœ°ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä½¿ç”¨å‘½åå‚æ•°ï¼šè¿™å…è®¸æˆ‘ä»¬å®šä¹‰ lambda è¡¨è¾¾å¼å¹¶æ˜ç¡®è¯´æ˜å®ƒä»¬çš„ç”¨é€”ï¼Œè¿™å°†æå¤§åœ°æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚ æˆ‘ä»¬ä¼šæœ‰ç±»ä¼¼äºä¸Šé¢çš„åŠŸèƒ½ï¼Œä½†æ¶µç›–æ‰€æœ‰æ–¹æ³•çš„æƒ…å†µï¼š 123456789101112131415161718192021222324inline fun ViewPropertyAnimator.setListener( crossinline animationStart: (Animator) -&gt; Unit, crossinline animationRepeat: (Animator) -&gt; Unit, crossinline animationCancel: (Animator) -&gt; Unit, crossinline animationEnd: (Animator) -&gt; Unit) { setListener(object : AnimatorListenerAdapter() { override fun onAnimationStart(animation: Animator) { animationStart(animation) } override fun onAnimationRepeat(animation: Animator) { animationRepeat(animation) } override fun onAnimationCancel(animation: Animator) { animationCancel(animation) } override fun onAnimationEnd(animation: Animator) { animationEnd(animation) } })} æ–¹æ³•æœ¬èº«ä¸æ˜¯å¾ˆå¥½ï¼Œä½†é€šå¸¸æ˜¯ä¼´éšæ‰©å±•æ–¹æ³•çš„æƒ…å†µã€‚ä»–ä»¬éšè—äº† framework ä¸å¥½çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥æœ‰äººå¿…é¡»åšè‰°è‹¦çš„å·¥ä½œã€‚ç°åœ¨æ‚¨å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼š 12345678view.animate() .alpha(0f) .setListener( animationStart = { toast(&quot;Animation start&quot;) }, animationRepeat = { toast(&quot;Animation repeat&quot;) }, animationCancel = { toast(&quot;Animation cancel&quot;) }, animationEnd = { toast(&quot;Animation end&quot;) } ) æ„Ÿè°¢å‘½åå‚æ•°ï¼Œè®©æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šè¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚ ä½ éœ€è¦ç¡®ä¿æ²¡æœ‰å‘½åå‚æ•°çš„æ—¶å€™å°±ä¸è¦ä½¿ç”¨å®ƒï¼Œå¦åˆ™å®ƒä¼šå˜å¾—æœ‰ç‚¹ä¹±ï¼š 12345678view.animate() .alpha(0f) .setListener( { toast(&quot;Animation start&quot;) }, { toast(&quot;Animation repeat&quot;) }, { toast(&quot;Animation cancel&quot;) }, { toast(&quot;Animation end&quot;) } ) æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆä»ç„¶è¿«ä½¿æˆ‘ä»¬å®ç°æ‰€æœ‰æ–¹æ³•ã€‚ä½†å®ƒå¾ˆå®¹æ˜“è§£å†³ï¼šåªéœ€ä½¿ç”¨å‚æ•°çš„é»˜è®¤å€¼ã€‚ç©ºçš„ lambda è¡¨è¾¾å¼å°†ä¸Šé¢çš„ä»£ç æ¼”å˜æˆï¼š 12345678inline fun ViewPropertyAnimator.setListener( crossinline animationStart: (Animator) -&gt; Unit = {}, crossinline animationRepeat: (Animator) -&gt; Unit = {}, crossinline animationCancel: (Animator) -&gt; Unit = {}, crossinline animationEnd: (Animator) -&gt; Unit = {}) { ...} ç°åœ¨ä½ å¯ä»¥è¿™æ ·åšï¼š 12345view.animate() .alpha(0f) .setListener( animationEnd = { toast(&quot;Animation end&quot;) } ) è¿˜ä¸é”™ï¼Œå¯¹å§ï¼Ÿè™½ç„¶æ¯”ä¹‹å‰çš„åšæ³•è¦ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä½†å´æ›´åŠ çµæ´»äº†ã€‚ æ€æ‰‹é”æ“ä½œï¼šDSLåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä¸€ç›´åœ¨è§£é‡Šç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œè¯šå®åœ°è¯´å¯èƒ½æ¶µç›–å¤§å¤šæ•°æƒ…å†µã€‚ä½†å¦‚æœä½ æƒ³å‘ç–¯ï¼Œä½ ç”šè‡³å¯ä»¥åˆ›å»ºä¸€ä¸ªè®©äº‹æƒ…å˜å¾—æ›´åŠ æ˜ç¡®çš„å°å‹ DSLã€‚ è¿™ä¸ªæƒ³æ³• æ¥è‡ª Anko å¦‚ä½•å®ç°ä¸€äº›ä¾¦å¬å™¨ï¼Œå®ƒæ˜¯åˆ›å»ºä¸€ä¸ªå®ç°äº†ä¸€ç»„æ¥æ”¶ lambda è¡¨è¾¾å¼çš„æ–¹æ³•å¸®åŠ©å™¨ã€‚è¿™ä¸ª lambda å°†åœ¨æ¥å£çš„ç›¸åº”å®ç°ä¸­è¢«è°ƒç”¨ã€‚æˆ‘æƒ³é¦–å…ˆå‘æ‚¨å±•ç¤ºç»“æœï¼Œç„¶åè§£é‡Šä½¿å…¶å®ç°çš„ä»£ç ï¼š 12345678910view.animate() .alpha(0f) .setListener { onAnimationStart { toast(&quot;Animation start&quot;) } onAnimationEnd { toast(&quot;Animation End&quot;) } } çœ‹åˆ°äº†å—ï¼Ÿ è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªå°å‹çš„ DSL æ¥å®šä¹‰åŠ¨ç”»ç›‘å¬å™¨ï¼Œæˆ‘ä»¬åªéœ€è°ƒç”¨æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å³å¯ã€‚å¯¹äºç®€å•çš„è¡Œä¸ºï¼Œè¿™äº›æ–¹æ³•å¯ä»¥æ˜¯å•è¡Œçš„ï¼š 123456view.animate() .alpha(0f) .setListener { onAnimationStart { toast(&quot;Start&quot;) } onAnimationEnd { toast(&quot;End&quot;) } } è¿™ç›¸æ¯”äºä¹‹å‰çš„è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š å®ƒæ›´åŠ ç®€æ´ï¼šæ‚¨åœ¨è¿™é‡Œä¿å­˜äº†ä¸€äº›ç‰¹æ€§ï¼Œä½†è€å®è¯´ï¼Œä»…ä»…å› ä¸ºè¿™ä¸ªè¿˜ä¸å€¼å¾—åŠªåŠ›ã€‚ å®ƒæ›´åŠ æ˜ç¡®ï¼šå®ƒè¿«ä½¿å¼€å‘äººå‘˜è¯´å‡ºä»–ä»¬æ‰€é‡å†™çš„åŠŸèƒ½ã€‚åœ¨å‰ä¸€ä¸ªé€‰æ‹©ä¸­ï¼Œç”±å¼€å‘äººå‘˜è®¾ç½®å‘½åå‚æ•°ã€‚è¿™é‡Œæ²¡æœ‰é€‰æ‹©ï¼Œåªèƒ½è°ƒç”¨è¯¥æ–¹æ³•ã€‚ æ‰€ä»¥å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¸å¤ªå®¹æ˜“å‡ºé”™çš„è§£å†³æ–¹æ¡ˆã€‚ ç°åœ¨æ¥å®ç°å®ƒã€‚é¦–å…ˆï¼Œæ‚¨ä»éœ€è¦ä¸€ä¸ªæ‰©å±•æ–¹æ³•ï¼š 12345fun ViewPropertyAnimator.setListener(init: AnimListenerHelper.() -&gt; Unit) { val listener = AnimListenerHelper() listener.init() this.setListener(listener)} è¿™ä¸ªæ–¹æ³•åªè·å–ä¸€ä¸ªå¸¦æœ‰æ¥æ”¶å™¨çš„ lambda è¡¨è¾¾å¼ï¼Œå®ƒåº”ç”¨äºä¸€ä¸ªåä¸º AnimListenerHelper çš„æ–°ç±»ã€‚å®ƒåˆ›å»ºäº†è¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œä½¿å®ƒè°ƒç”¨ lambda è¡¨è¾¾å¼ï¼Œå¹¶å°†å®ä¾‹è®¾ç½®ä¸ºç›‘å¬å™¨ï¼Œå› ä¸ºå®ƒæ­£åœ¨å®ç°ç›¸åº”çš„æ¥å£ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®ç° AnimeListenerHelperï¼š 123class AnimListenerHelper : Animator.AnimatorListener { ...} ç„¶åå¯¹äºæ¯ä¸ªæ–¹æ³•ï¼Œå®ƒéœ€è¦ï¼š ä¿å­˜ lambda è¡¨è¾¾å¼çš„å±æ€§ DSL æ–¹æ³•ï¼Œå®ƒæ¥æ”¶åœ¨è°ƒç”¨åŸå§‹æ¥å£çš„æ–¹æ³•æ—¶æ‰§è¡Œçš„ lambda è¡¨è¾¾å¼ åœ¨åŸæœ‰æ¥å£åŸºç¡€ä¸Šé‡å†™æ–¹æ³• 123456789private var animationStart: AnimListener? = nullfun onAnimationStart(onAnimationStart: AnimListener) { animationStart = onAnimationStart}override fun onAnimationStart(animation: Animator) { animationStart?.invoke(animation)} è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ AnimListener çš„ä¸€ä¸ª ç±»å‹åˆ«åï¼š 1private typealias AnimListener = (Animator) -&gt; Unit è¿™é‡Œæ˜¯å®Œæ•´çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950fun ViewPropertyAnimator.setListener(init: AnimListenerHelper.() -&gt; Unit) { val listener = AnimListenerHelper() listener.init() this.setListener(listener)}private typealias AnimListener = (Animator) -&gt; Unitclass AnimListenerHelper : Animator.AnimatorListener { private var animationStart: AnimListener? = null fun onAnimationStart(onAnimationStart: AnimListener) { animationStart = onAnimationStart } override fun onAnimationStart(animation: Animator) { animationStart?.invoke(animation) } private var animationRepeat: AnimListener? = null fun onAnimationRepeat(onAnimationRepeat: AnimListener) { animationRepeat = onAnimationRepeat } override fun onAnimationRepeat(animation: Animator) { animationRepeat?.invoke(animation) } private var animationCancel: AnimListener? = null fun onAnimationCancel(onAnimationCancel: AnimListener) { animationCancel = onAnimationCancel } override fun onAnimationCancel(animation: Animator) { animationCancel?.invoke(animation) } private var animationEnd: AnimListener? = null fun onAnimationEnd(onAnimationEnd: AnimListener) { animationEnd = onAnimationEnd } override fun onAnimationEnd(animation: Animator) { animationEnd?.invoke(animation) }} æœ€ç»ˆçš„ä»£ç çœ‹èµ·æ¥å¾ˆæ£’ï¼Œä½†ä»£ä»·æ˜¯åšäº†å¾ˆå¤šå·¥ä½œã€‚ æˆ‘è¯¥ä½¿ç”¨å“ªç§æ–¹æ¡ˆï¼Ÿåƒå¾€å¸¸ä¸€æ ·ï¼Œè¿™è¦çœ‹æƒ…å†µã€‚å¦‚æœæ‚¨ä¸åœ¨ä»£ç ä¸­ç»å¸¸ä½¿ç”¨å®ƒï¼Œæˆ‘ä¼šè¯´å“ªç§æ–¹æ¡ˆéƒ½ä¸è¦ä½¿ç”¨ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹è¦æ ¹æ®å®é™…æƒ…å†µè€Œå®šï¼Œå¦‚æœä½ è¦ç¼–å†™ä¸€æ¬¡ç›‘å¬å™¨ï¼Œåªéœ€ä½¿ç”¨ä¸€ä¸ªå®ç°æ¥å£çš„åŒ¿åå¯¹è±¡ï¼Œå¹¶ç»§ç»­ç¼–å†™é‡è¦çš„ä»£ç ã€‚ å¦‚æœæ‚¨å‘ç°éœ€è¦ä½¿ç”¨æ›´å¤šæ¬¡ç›‘å¬å™¨ï¼Œè¯·ä½¿ç”¨å…¶ä¸­ä¸€ç§è§£å†³æ–¹æ¡ˆè¿›è¡Œé‡æ„ã€‚æˆ‘é€šå¸¸ä¼šé€‰æ‹©åªä½¿ç”¨æˆ‘ä»¬æ„Ÿå…´è¶£çš„åŠŸèƒ½è¿›è¡Œç®€å•çš„æ‰©å±•ã€‚å¦‚æœæ‚¨éœ€è¦å¤šä¸ªç›‘å¬å™¨ï¼Œè¯·è¯„ä¼°ä¸¤ç§æœ€æ–°æ›¿ä»£æ–¹æ¡ˆä¸­çš„å“ªä¸€ç§æ›´é€‚åˆæ‚¨ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œè¿™å–å†³äºä½ å°†è¦å¦‚ä½•å¹¿æ³›åœ°ä½¿ç”¨å®ƒã€‚ å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿåœ¨æ‚¨ä¸‹ä¸€æ¬¡å¤„äºè¿™ç§æƒ…å†µä¸‹æ—¶å¸®åŠ©åˆ°æ‚¨ã€‚å¦‚æœæ‚¨ä»¥ä¸åŒæ–¹å¼è§£å†³æ­¤é—®é¢˜ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ä»¬ï¼ æ„Ÿè°¢æ‚¨çš„é˜…è¯» ğŸ™‚ å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° æ˜é‡‘ç¿»è¯‘è®¡åˆ’ å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ æœ¬æ–‡æ°¸ä¹…é“¾æ¥ å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚","link":"/2018/12/22/kotlin-functions/"},{"title":"Kotlinä¸­çš„é™æ€å˜é‡å’Œé™æ€æ–¹æ³•","text":"åœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé™æ€å˜é‡ å’Œ é™æ€æ–¹æ³• æ˜¯æˆ‘ä»¬å¸¸è§çš„ç”¨æ³•ï¼ŒJavaä¸­ç›¸ä¿¡å¤§å®¶å¹¶ä¸é™Œç”Ÿäº†ï¼Œé‚£ä¹ˆåœ¨ Kotlin ä¸­è¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ªå°†å˜é‡å’Œæ–¹æ³•åŒ…å«åœ¨ companion object åŸŸä¸­å³å¯ï¼Œæ¯”å¦‚è¿™æ ·ï¼š 123456789101112131415161718class Constant { companion object { // æ¥å£æ ¹åœ°å€ const val BASE_URL = &quot;http://xxxx.xxx.xxx/&quot; // å‹ç›Ÿ const val UMENG_APP_KEY = &quot;xxxxxxxxxx&quot; const val UMENG_CHANNEL = &quot;umeng&quot; // å¾®åš const val WEIBO_APP_KEY = &quot;xxxxxxxx&quot; const val WEIBO_SECRET = &quot;xxxxxxxxxx&quot; fun getVideoFactor(){ // do some work } }} çœ‹åæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿåœ¨çº¯kotlinä»£ç ä¸­å¯ä»¥ç›´æ¥è¿™æ ·ä½¿ç”¨ï¼š 123//åˆå§‹åŒ–å„å¹³å°çš„APIKey PlatformConfig.setWeixin(Constant.WECHAT_APP_ID, Constant.WECHAT_APP_SECRET) PlatformConfig.setSinaWeibo(Constant.WEIBO_APP_KEY, Constant.WEIBO_SECRET, Constant.WEIBO_AUTH_RETURN_URL) ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Javaå’Œkotlinæ··åˆå¼€å‘ï¼Œåœ¨Javaä»£ç ä¸­å°±æ— æ³•é€šè¿‡ Constant.é™æ€å˜é‡ çš„æ–¹å¼æ¥ä½¿ç”¨é™æ€å˜é‡æˆ–è€…æ–¹æ³•æ¥ï¼Œè€Œæ˜¯é€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼š 123//åˆå§‹åŒ–å„å¹³å°çš„APIKey PlatformConfig.setWeixin(Constant.Companion.WECHAT_APP_ID, Constant.WECHAT_APP_SECRET) PlatformConfig.setSinaWeibo(Constant.Companion.WEIBO_APP_KEY, Constant.WEIBO_SECRET, Constant.WEIBO_AUTH_RETURN_URL) å¦‚æœæˆ‘ä»¬æƒ³åƒkotliné‚£æ ·ç›´æ¥é€šè¿‡ ç±»å.é™æ€å˜é‡ æ–¹å¼ä½¿ç”¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å€ŸåŠ©äºæ³¨è§£ @JvmField å’Œ @JvmStatic æ¥åˆ†åˆ«æ ‡æ³¨é™æ€å˜é‡å’Œé™æ€æ–¹æ³•ï¼Œä¹‹åæˆ‘å°±èƒ½åœ¨Javaä»£ç ä¸­åƒä»¥å‰æ–¹å¼é‚£æ ·ç›´æ¥ä½¿ç”¨é™æ€çš„æˆå‘˜å•¦ï¼ä¾‹å¦‚è¿™æ ·ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * @author moosphon on 2018/12/12 * desc: å¼‚å¸¸çš„ç»Ÿä¸€å¤„ç†è€… */class ExceptionHandler { companion object { @JvmField var errorCode = NetRequestStatus.UNKNOWN_ERROR @JvmField var errorMessage = &quot;è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•&quot; @JvmStatic fun handleException(e : Throwable): String{ e.printStackTrace() when(e){ is SocketException -&gt; { Logger.e(&quot;ExceptionHandler&quot;, &quot;ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼š &quot; + e.message) errorCode = NetRequestStatus.NETWORK_ERROR errorMessage = &quot;ç½‘ç»œè¿æ¥å¼‚å¸¸&quot; } is JsonParseException -&gt; { Logger.e(&quot;ExceptionHandler&quot;, &quot;æ•°æ®è§£æå¼‚å¸¸ï¼š &quot; + e.message) errorCode = NetRequestStatus.PARSE_ERROR errorMessage = &quot;æ•°æ®è§£æå¼‚å¸¸&quot; } else -&gt; { try { Logger.e(&quot;ExceptionHandler&quot;, &quot;å…¶ä»–é”™è¯¯ï¼š &quot; + e.message) } catch (e1: Exception) { Logger.e(&quot;ExceptionHandler&quot;, &quot;æœªçŸ¥é”™è¯¯ï¼š &quot; + e.message) } errorCode = NetRequestStatus.UNKNOWN_ERROR errorMessage = &quot;æœªçŸ¥é”™è¯¯ï¼Œä¸€èµ·ç¥·å‘Šå¿«ç‚¹å¥½èµ·æ¥å§ï½&quot; } } return errorMessage } }} å‰æ®µæ—¶é—´æ¯”è¾ƒå¿™ï¼Œä¹‹åä¼šç»§ç»­ä¸ºå¤§å®¶å¸¦æ¥kotlinæ–¹é¢çš„æ–‡ç« ï¼Œå¤§å®¶æ‹­ç›®ä»¥å¾…ã€‚Android-kotlinäº¤æµç¾¤ï¼š601924443","link":"/2018/12/11/kotlin-static/"},{"title":"å¸¦ä½ é¢†ç•¥ Kotlin ä¸­çš„ â€œwhenâ€é­”æ³•","text":"æåˆ° **when**ï¼Œå¤§å®¶éƒ½ä¼šè”æƒ³åˆ° Java ä¸­çš„ **switch**ï¼Œç„¶è€Œåœ¨ kotlin ä¸­ï¼Œwhen æ˜¾ç„¶æ¯” Java ä¸­çš„ switch è¦å¼ºå¤§å¾—å¤šã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ when çš„ç‰¹ç‚¹ï¼š å®ƒå¯ä»¥ä½œä¸ºè¡¨è¾¾å¼ä½¿ç”¨ ä½¿ç”¨æ›´åŠ å®‰å…¨ å¼ºå¤§çµæ´»çš„åˆ†æ”¯ç»“æ„ å¯ä»¥ä¸å¸¦å‚æ•° æ¥ä¸‹æ¥ï¼Œæˆ‘æ¥å¸¦å¤§å®¶é€æ­¥é¢†ç•¥è¿™äº›ç‰¹ç‚¹ã€‚ä»¥ä¸‹é¢è¿™æ®µ Java åŠŸèƒ½ä»£ç ä¸ºä¾‹ï¼š 1234567891011121314151617181920212223switch(animal) { case EAGLE: System.out.println(\"é¸Ÿç±»\"); break; case DOLPHIN: System.out.println(\"å…½ç±»\"); break; case LOCUST: System.out.println(\"æ˜†è™«ç±»\"); break; case CARP: System.out.println(\"é±¼ç±»\"); break; case TIGER: System.out.println(\"å…½ç±»\"); break; case DUCK: System.out.println(\"é¸Ÿç±»\"); break; default: System.out.println(\"æœªçŸ¥åŠ¨ç‰©\"); break;} ä»ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬è¿™é‡Œå®ç°çš„åŠŸèƒ½æ˜¯ï¼šé€šè¿‡ç”¨æˆ·è¾“å…¥ä¸€ä¸ªåŠ¨ç‰©åç§°æ¥å¾—åˆ°å…¶å¯¹åº”çš„ç§ç±»ä¿¡æ¯ã€‚ä¹ä¸€çœ‹ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—ä¸Šé¢çš„ä»£ç å†æ­£å¸¸ä¸è¿‡ï¼Œä½†æ˜¯å€˜è‹¥æˆ‘ä»¬çš„è¾“å…¥æƒ…å½¢å¾ˆå¤šçš„è¯ï¼Œå°±ä¼šå¢åŠ å¯†å¯†éº»éº»çš„é™åˆ¶æ¡ä»¶ï¼Œè¿™è‚¯å®šæ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ã€‚é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹é€šè¿‡ Kotlin çš„ when è¡¨è¾¾å¼å¦‚ä½•å®ç°ç›¸åŒåŠŸèƒ½ï¼š 1234567when(animal) { EAGLE, DUCK -&gt; println(\"é¸Ÿç±»\") DOLPHIN, TIGER -&gt; println(\"å…½ç±»\") CARP -&gt; println(\"é±¼ç±»\") LOCUST -&gt; println(\"æ˜†è™«ç±»\") else -&gt; println(\"æœªçŸ¥åŠ¨ç‰©\")} OKï¼Œä»¥ä¸Šå°±æ˜¯è¯¥åŠŸèƒ½ä»£ç çš„ kotlin å®ç°æ–¹å¼ï¼Œä»£ç ä¸ä»…ç®€åŒ–äº†å¾ˆå¤šï¼Œä¹Ÿçœå»äº†å¤§é‡çš„ break è¯­å¥ï¼Œé¿å…äº† Java ä¸­å› é—æ¼ break è€Œå¯¼è‡´çš„ bugï¼Œå¢å¼ºäº†å®‰å…¨æ€§ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œå¯¹åº”çš„åˆ†æ”¯ä¾¿ä¼šæ‰§è¡Œï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æŠŠå¤šä¸ªæƒ…å†µåˆå¹¶åˆ°åŒä¸€ä¸ªåˆ†æ”¯ï¼Œåªéœ€è¦é€šè¿‡é€—å·éš”å¼€ï¼Œå¹¶æ²¡æœ‰é¢å¤–çš„ä»£ç ã€‚ PSï¼šæ¯ä¸ªæ¡ä»¶åˆ†æ”¯çš„å¤„ç†é€šè¿‡åœ¨ -&gt; ä¹‹åæ¥è¿›è¡Œã€‚ ä½œä¸ºè¡¨è¾¾å¼ä½¿ç”¨é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é‡æ¸©ä¸€ä¸‹è¡¨è¾¾å¼ä¸è¯­å¥çš„åŒºåˆ«ã€‚è¡¨è¾¾å¼æœ‰å€¼ï¼Œå¹¶èƒ½ä½œä¸ºå¦ä¸€ä¸ªè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†æ¥ä½¿ç”¨ï¼›è€Œè¯­å¥æ²¡æœ‰è¿”å›å€¼ã€‚Java ä¸­çš„æ§åˆ¶ç»“æ„çš†ä¸ºè¯­å¥ã€‚è€Œåœ¨ Kotlin ä¸­ï¼Œé™¤äº†å¾ªç¯ä½“ç»“æ„å¤–ï¼Œå¤§å¤šæ•°æ§åˆ¶ç»“æ„éƒ½æ˜¯è¡¨è¾¾å¼ã€‚ä¸¾ä¸ªæ —å­ğŸ˜„ï¼Œè¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¼˜åŒ–ä¸ºä»¥ä¸‹ä»£ç ï¼š 123456789var result = when(animal) { EAGLE, DUCK -&gt; \"é¸Ÿç±»\" DOLPHIN, TIGER -&gt; \"å…½ç±»\" CARP -&gt; \"é±¼ç±»\" LOCUST -&gt; \"æ˜†è™«ç±»\" else -&gt; \"æœªçŸ¥åŠ¨ç‰©\"}// è¾“å…¥ï¼šDUCKï¼Œè¿”å›ï¼šå½“å‰åŠ¨ç‰©çš„ç§ç±»ä¸ºï¼šé¸Ÿç±»println(\"å½“å‰åŠ¨ç‰©çš„ç§ç±»ä¸ºï¼š $result\") æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡è¡¨è¾¾å¼å‡½æ•°æ¥ç›´æ¥å¾—åˆ°æœ€ç»ˆçš„ç»“æœï¼š 12345678fun displayAnimalType(animal: Animal) = when(animal) { Animal.EAGLE, Animal.DUCK -&gt; \"é¸Ÿç±»\" Animal.DOLPHIN, Animal.TIGER -&gt; \"å…½ç±»\" Animal.CARP -&gt; \"é±¼ç±»\" Animal.LOCUST -&gt; \"æ˜†è™«ç±»\" else -&gt; \"æœªçŸ¥åŠ¨ç‰©\" } å¼ºå¤§çµæ´»çš„åˆ†æ”¯Kotlin ä¸­çš„ when è¿œæ¯” Java å½“ä¸­çš„ switch è¦å¼ºå¤§å¾—å¤šã€‚switch åªèƒ½ä»¥å¸¸é‡ä½œä¸ºåˆ†æ”¯æ¡ä»¶ï¼Œè€Œ when å…è®¸ä½¿ç”¨ä»»æ„å¯¹è±¡ã€‚emmmï½ä¸¾ä¸ªç®€å•çš„ä¾‹å­å§ï¼š 1234567fun handleResult(score: Int) = when(score) { in 0..39 -&gt; \"fail to go up to the next grade.\" in 40 until 60 -&gt; \"not pass, should test again.\" 97,98,99,100 -&gt; \"learning outstanding results.\" else -&gt; \"pass the test.\" } Java å½“ä¸­ï¼Œå½“æˆ‘ä»¬çš„åˆ†æ”¯æƒ…å†µæ¯”è¾ƒå¤šæˆ–è€…æ¯ç§åˆ†æ”¯å¯èƒ½ä¼šé‡å¤å¤šæ¬¡æ—¶ï¼ŒåŠ¿å¿…ä¼šé€šè¿‡ if-else æ¥å„ç§åˆ¤æ–­ï¼Œè€Œåœ¨ Kotlin å½“ä¸­ï¼Œä¸€ä¸ª when å°±èƒ½å¸®æˆ‘ä»¬å®Œæˆè¿™äº›æ“ä½œã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³åˆ¤æ–­ä¸€ä¸ªæœªçŸ¥å˜é‡çš„ç±»å‹ï¼Œè€Œå…¶å¯èƒ½ç±»å‹æœ‰å¾ˆå¤šç§å¯èƒ½æ€§ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€šè¿‡ when æ¥å®ç°ï¼Œä¾‹å¦‚ï¼š 1234567fun judgeAnimalKind(animal: Any) = when(animal) { is Bird -&gt; \"è¿™æ˜¯é¸Ÿç±»\" is Fish -&gt; \"è¿™æ˜¯é±¼ç±»\" judgeIfInsect(animal) -&gt; \"è¿™æ˜¯æ˜†è™«\" else -&gt; \"æˆ‘ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆåŠ¨ç‰©\" } å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä»£ç å—ä½œä¸ºæˆ‘ä»¬çš„åˆ†æ”¯ä½“ï¼Œè¿™æ—¶å€™ï¼Œä»£ç å—ä¸­æœ€åä¸€ä¸ªè¡¨è¾¾å¼æˆ–è€…å˜é‡å°±æ˜¯è¯¥åˆ†æ”¯ä½“çš„è¿”å›ç»“æœï¼Œå¦‚ï¼š 1234567891011121314fun judgeAnimalKind(animal: Any) = when(animal) { is Bird -&gt; \"è¿™æ˜¯é¸Ÿç±»\" is Fish -&gt; \"è¿™æ˜¯é±¼ç±»\" judgeIfInsect(animal) -&gt; \"è¿™æ˜¯æ˜†è™«\" else -&gt; { val kind = if (judgeDolphin(animal) || judgeTiger(animal)) { \"è¿™æ˜¯å…½ç±»\" }else { \"æˆ‘ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆåŠ¨ç‰©\" } kind } } ä¸Šè¿°ä»£ç ä¸­ï¼Œkind å³ä¸ºæˆ‘ä»¬çš„ else åˆ†æ”¯å—ä¸­çš„æœ€ç»ˆè¿”å›ç»“æœã€‚ æ— å‚çš„æƒ…å†µç‰¹åˆ«åœ°ï¼Œwhen ä¸­çš„å‚æ•°å¯èƒ½å¹¶éæ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©çœç•¥è¯¥å‚æ•°ï¼Œä¾‹å¦‚è¿™æ ·ï¼š 1234when { phoneNumber?.length != 11 -&gt; toast(\"illegal phone number.\") password.isNullOrEmpty() -&gt; toast(\"please input password\")} æ€»ç»“é€šè¿‡ä»¥ä¸Šçš„ä»‹ç»ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼š**when** çš„ä½¿ç”¨åœºæ™¯è¦æ¯” Java çš„ switch çµæ´»ã€å¼ºå¤§çš„å¤šï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ© when æ¥é‡æ„å’Œä¼˜åŒ–å¤æ‚çš„ if-else ç»“æ„ï¼Œä»¥ç®€åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§ã€‚","link":"/2019/05/21/kotlin-when/"},{"title":"Macä¸­å¸¸ç”¨å¿«æ·é”®","text":"ä½œä¸ºä¸€åå¼€å‘è€…ï¼Œå¦‚æœä½ ä½¿ç”¨Macï¼Œé‚£ä¹ˆä¸‹é¢è¿™äº›å¿«æ·é”®ä¸å¯æˆ–ç¼ºï¼Œèƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜å¼€å‘æ•ˆç‡ã€‚å…ˆæ¥çœ‹ä¸€ä¸‹ç†Ÿæ‚‰ä¸€ä¸‹é”®ç›˜ï¼š é€šç”¨ commandï¼ˆâŒ˜ï¼‰+ tab ï¼šåº”ç”¨ç¨‹åºé—´å®ç°å¿«é€Ÿåˆ‡æ¢ commandï¼ˆâŒ˜ï¼‰+ H : éšè—å½“å‰çª—å£ commandï¼ˆâŒ˜ï¼‰+ M : å°†çª—å£æœ€å°åŒ– commandï¼ˆâŒ˜ï¼‰+ N : æ–°å»ºä¸€ä¸ªçª—å£ commandï¼ˆâŒ˜ï¼‰+ O : æ‰“å¼€å½“å‰æ–‡ä»¶ commandï¼ˆâŒ˜ï¼‰+ S : ä¿å­˜å½“å‰æ–‡ä»¶ commandï¼ˆâŒ˜ï¼‰+ shift + S : å¦å­˜ä¸º commandï¼ˆâŒ˜ï¼‰+ P : æ‰“å° commandï¼ˆâŒ˜ï¼‰+ W : å…³é—­ commandï¼ˆâŒ˜ï¼‰+ Q : é€€å‡º å·¥å…· commandï¼ˆâŒ˜ï¼‰+ shift + 3 ï¼šæˆªå±ï¼ˆæˆªå–æ•´ä¸ªå±å¹•ï¼‰ commandï¼ˆâŒ˜ï¼‰+ shift + 4 :æˆªå±ï¼ˆæˆªå–é€‰æ‹©åŒºåŸŸï¼‰ commandï¼ˆâŒ˜ï¼‰+ shift + 4 + ç©ºæ ¼ï¼šæˆªå–é€‰æ‹©çš„çª—å£ æ–‡ä»¶ spaceï¼ˆç©ºæ ¼ï¼‰ï¼šå¿«é€ŸæŸ¥çœ‹ commandï¼ˆâŒ˜ï¼‰+ A : é€‰æ‹©å…¨éƒ¨ commandï¼ˆâŒ˜ï¼‰+ I : æ˜¾ç¤ºç®€ä»‹ commandï¼ˆâŒ˜ï¼‰+ N : æ–°å»ºæ–‡ä»¶å¤¹ commandï¼ˆâŒ˜ï¼‰+ F : å¿«é€Ÿæœç´¢ commandï¼ˆâŒ˜ï¼‰+ C : å¤åˆ¶ commandï¼ˆâŒ˜ï¼‰+ V : ç²˜è´´ commandï¼ˆâŒ˜ï¼‰+ delete : åˆ é™¤ commandï¼ˆâŒ˜ï¼‰+ shift + deleteï¼šæ¸…ç©ºå›æ”¶ç«™ æµè§ˆå™¨ commandï¼ˆâŒ˜ï¼‰+ + ï¼šæ”¾å¤§ commandï¼ˆâŒ˜ï¼‰+ - ï¼šç¼©å° commandï¼ˆâŒ˜ï¼‰+ T : æ–°å»ºé€‰é¡¹å¡ commandï¼ˆâŒ˜ï¼‰+ N : æ–°å»ºçª—å£ commandï¼ˆâŒ˜ï¼‰+ R : åˆ·æ–°é¡µé¢ commandï¼ˆâŒ˜ï¼‰+ F : æœç´¢ commandï¼ˆâŒ˜ï¼‰+ W : å…³é—­å½“å‰é€‰é¡¹å¡ ç³»ç»Ÿ commandï¼ˆâŒ˜ï¼‰+ shift + â‡ª(ä»‹è´¨æ¨å‡ºé”®) ï¼šå…³é—­æ˜¾ç¤ºå™¨ commandï¼ˆâŒ˜ï¼‰+ option + esc ï¼šå¼ºåˆ¶é€€å‡ºåº”ç”¨ç¨‹åº commandï¼ˆâŒ˜ï¼‰+ option + â‡ª ï¼šç¡çœ  commandï¼ˆâŒ˜ï¼‰+ control + â‡ª ï¼šå…³é—­æ‰€æœ‰åº”ç”¨ç¨‹åºå¹¶é‡æ–°å¯åŠ¨ commandï¼ˆâŒ˜ï¼‰+ shift + Y : ç”¨å½“å‰é€‰ä¸­çš„æ–‡å­—ç”Ÿæˆä¾¿ç­¾ commandï¼ˆâŒ˜ï¼‰+ spaceï¼ˆç©ºæ ¼ï¼‰ï¼šåˆ‡æ¢è¾“å…¥æ³•ï¼ˆ2017æ–°æ¬¾ä¸é€‚ç”¨ï¼‰","link":"/2018/01/28/mac-keyboard/"},{"title":"Androidä¸­çš„ MVPï¼šå¦‚ä½•ä½¿ Presenter å±‚ç³»ç»ŸåŒ–ï¼Ÿ","text":"åŸæ–‡åœ°å€ï¼šMVP for Android: how to organize the presentation layer åŸæ–‡ä½œè€…ï¼šAntonio Leiva MVPï¼ˆModel View Presenterï¼‰æ¨¡å¼æ˜¯è‘—åçš„ MVCï¼ˆModel View Controllerï¼‰çš„è¡ç”Ÿç‰©ï¼Œå¹¶ä¸”æ˜¯ Android åº”ç”¨ç¨‹åºä¸­ç®¡ç†è¡¨ç¤ºå±‚çš„æœ€æµè¡Œçš„æ¨¡å¼ä¹‹ä¸€ã€‚ è¿™ç¯‡æ–‡ç« é¦–æ¬¡å‘è¡¨äº 2014 å¹´ 4 æœˆï¼Œä»é‚£ä»¥åå°±ä¸€ç›´å¤‡å—æ¬¢è¿ã€‚æ‰€ä»¥æˆ‘å†³å®šæ›´æ–°å®ƒæ¥è§£å†³äººä»¬å¿ƒä¸­çš„å¤§éƒ¨åˆ†ç–‘è™‘ï¼Œå¹¶å°†ä»£ç è½¬æ¢ä¸º Kotlin è¯­è¨€å½¢å¼ã€‚ è‡ªé‚£æ—¶èµ·ï¼Œæ¶æ„æ¨¡å¼å‘ç”Ÿäº†é‡å¤§å˜åŒ–ï¼Œä¾‹å¦‚å¸¦æœ‰æ¶æ„ç»„ä»¶çš„ MVVMï¼Œä½† MVP ä»ç„¶æœ‰æ•ˆå¹¶ä¸”æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰æ‹©ã€‚ ä»€ä¹ˆæ˜¯ MVP æ¨¡å¼ï¼ŸMVP æ¨¡å¼å°† Presenter å±‚ä»é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±æŠŠæ‰€æœ‰å…³äº UI å¦‚ä½•å·¥ä½œä¸æˆ‘ä»¬åœ¨å±å¹•ä¸Šå¦‚ä½•è¡¨ç¤ºå®ƒåˆ†ç¦»äº†å¼€æ¥ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼ŒMVP æ¨¡å¼å°†å®ç°ç›¸åŒçš„é€»è¾‘å¯èƒ½å…·æœ‰å®Œå…¨ä¸åŒä¸”å¯äº¤æ›¿çš„ç•Œé¢ã€‚ è¦æ˜ç¡®çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ MVP æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ¶æ„ï¼Œå®ƒåªè´Ÿè´£è¡¨ç¤ºå±‚ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰äº‰è®®çš„è¯´æ³•ï¼Œæ‰€ä»¥æˆ‘æƒ³æ›´æ·±å…¥åœ°è§£é‡Šä¸€ä¸‹ã€‚ ä½ å¯èƒ½ä¼šå‘ç° MVP è¢«å®šä¹‰ä¸ºæ¶æ„æ¨¡å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥æˆä¸ºä½ çš„åº”ç”¨ç¨‹åºæ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚ä½†ä½ ä¸åº”å½“è¿™æ ·è®¤ä¸ºï¼Œå› ä¸ºå»æ‰ MVP ä¹‹åï¼Œä½ çš„æ¶æ„ä¾æ—§æ˜¯å®Œæ•´çš„ã€‚MVP ä»…ä»…å¡‘é€ è¡¨ç¤ºå±‚ï¼Œä½†å¦‚æœä½ éœ€è¦çµæ´»ä¸”å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆå…¶ä½™å±‚ä»éœ€è¦è‰¯å¥½çš„ä½“ç³»æ¶æ„ã€‚ å®Œæ•´æ¶æ„ä½“ç³»çš„ä¸€ä¸ªç¤ºä¾‹å¯ä»¥æ˜¯ Clean Architectureï¼Œä½†è¿˜æœ‰è®¸å¤šå…¶ä»–é€‰æ‹©ã€‚ åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œåœ¨ä½ ä»æœªä½¿ç”¨ MVP çš„æ¶æ„ä¸­å»ä½¿ç”¨å®ƒæ€»æ˜¯ä»¶å¥½äº‹ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ MVPï¼Ÿåœ¨ Android å¼€å‘ä¸­ï¼Œæˆ‘ä»¬é‡åˆ°ä¸€ä¸ªä¸¥å³»çš„é—®é¢˜ï¼šActivity é«˜åº¦è€¦åˆäº†ç”¨æˆ·ç•Œé¢å’Œæ•°æ®å­˜å–æœºåˆ¶ã€‚æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°åƒ CursorAdapter è¿™æ ·çš„æç«¯ä¾‹å­ï¼Œå®ƒå°†ä½œä¸ºè§†å›¾å±‚ä¸€éƒ¨åˆ†çš„ Adapter å’Œ å±äºæ•°æ®è®¿é—®å±‚çº§çš„ Cursor æ··åˆåˆ°äº†ä¸€èµ·ã€‚ ä¸ºäº†èƒ½å¤Ÿè½»æ¾åœ°æ‰©å±•å’Œç»´æŠ¤ä¸€ä¸ªåº”ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¯ä»¥ç›¸äº’åˆ†ç¦»çš„ä½“ç³»æ¶æ„ã€‚å¦‚æœæˆ‘ä»¬ä¸å†ä»æ•°æ®åº“è·å–æ•°æ®ï¼Œè€Œæ˜¯ä» web æœåŠ¡å™¨è·å–ï¼Œé‚£ä¹ˆæˆ‘æ¥ä¸‹æ¥è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯èƒ½å°±è¦é‡æ–°ç¼–å†™æ•´ä¸ªè§†å›¾å±‚äº†ã€‚ MVP ä½¿è§†å›¾ç‹¬ç«‹äºæˆ‘ä»¬çš„æ•°æ®æºè€Œå­˜åœ¨ã€‚æˆ‘ä»¬éœ€è¦å°†åº”ç”¨ç¨‹åºåˆ’åˆ†ä¸ºè‡³å°‘ä¸‰ä¸ªä¸åŒçš„å±‚æ¬¡ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç‹¬ç«‹åœ°æµ‹è¯•å®ƒä»¬ã€‚é€šè¿‡ MVPï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤§éƒ¨åˆ†æœ‰å…³ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ä» Activity ä¸­ç§»é™¤ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä½¿ç”¨ Instrumentation Test çš„æƒ…å†µä¸‹å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚ å¦‚ä½•å®ç° Android å½“ä¸­çš„ MVPï¼Ÿå¥½å§ï¼Œè¿™å°±æ˜¯å®ƒå¼€å§‹äº§ç”Ÿåˆ†æ­§çš„åœ°æ–¹ã€‚MVP æœ‰å¾ˆå¤šå˜ç§ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å’Œè‡ªå·±æ„Ÿè§‰æ›´åŠ èˆ’é€‚çš„æ–¹å¼æ¥è°ƒæ•´æ¨¡å¼ã€‚è¿™ä¸»è¦å–å†³äºæˆ‘ä»¬å§”æ‰˜ç»™ Presenter çš„ä»»åŠ¡æ•°é‡ã€‚ åˆ°åº•æ˜¯è¯¥ç”± View å±‚æ¥è´Ÿè´£å¯ç”¨æˆ–ç¦ç”¨ä¸€ä¸ªè¿›åº¦æ¡ï¼Œè¿˜æ˜¯è¯¥ç”± Presenter æ¥è´Ÿè´£å‘¢ï¼Ÿåˆè¯¥ç”±è°æ¥å†³å®š Action Bar åº”è¯¥åšå‡ºä»€ä¹ˆè¡Œä¸ºå‘¢ï¼Ÿè¿™å°±æ˜¯è‰°éš¾å†³å®šçš„å¼€å§‹ã€‚æˆ‘å°†å±•ç¤ºæˆ‘é€šå¸¸æƒ…å†µä¸‹æ˜¯å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µçš„ï¼Œä½†æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æ›´æ˜¯ä¸€ä¸ªé€‚åˆè®¨è®ºçš„åœ°æ–¹ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼çš„çº¦æŸ MVP è¯¥å¦‚ä½•åº”ç”¨ï¼Œå› ä¸ºæ ¹æœ¬æ²¡æœ‰â€œæ ‡å‡†â€çš„æ–¹å¼æ¥å®ç°å®ƒã€‚ å¯¹äºæœ¬æ–‡ï¼Œæˆ‘å·²ç»å®ç°äº†ä¸€ä¸ªéå¸¸ç®€å•çš„ç¤ºä¾‹ï¼Œä½ å¯ä»¥åœ¨æˆ‘çš„ Github æ‰¾åˆ° ä¸€ä¸ªç™»å½•é¡µé¢å’Œä¸»é¡µé¢ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæœ¬æ–‡ä¸­çš„ä»£ç æ˜¯ä½¿ç”¨ Kotlin å®ç°çš„ï¼Œä½†ä½ ä¹Ÿå¯ä»¥åœ¨ä»“åº“ä¸­æŸ¥çœ‹ä½¿ç”¨ Java 8 ç¼–å†™çš„ä»£ç ã€‚ Model å±‚åœ¨å…·æœ‰å®Œæ•´åˆ†å±‚ä½“ç³»ç»“æ„çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™é‡Œçš„ Model ä»…ä»…æ˜¯é€šå¾€é¢†åŸŸå±‚æˆ–ä¸šåŠ¡é€»è¾‘å±‚çš„å¤§é—¨ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ é²å‹ƒå¤§å”çš„ clean architecture æ¶æ„ï¼Œè¿™é‡Œçš„ Model å¯èƒ½æ˜¯ä¸€ä¸ªå®ç°äº†ä¸€ä¸ªç”¨ä¾‹çš„ Interactorï¼ˆäº¤äº’å™¨ï¼‰ã€‚ä½†å°±æœ¬æ–‡è€Œè¨€ï¼Œå°† Model çœ‹åšæ˜¯ä¸€ä¸ªç»™ View å±‚æ˜¾ç¤ºæ•°æ®çš„æä¾›è€…å°±è¶³å¤Ÿäº†ã€‚ å¦‚æœä½ æ£€æŸ¥ä»£ç ï¼Œä½ å°†çœ‹åˆ°æˆ‘åˆ›å»ºäº†ä¸¤ä¸ªå¸¦æœ‰äººä¸ºå»¶è¿Ÿæ“ä½œçš„ Interactor æ¥æ¨¡æ‹Ÿå¯¹æœåŠ¡å™¨çš„è¯·æ±‚æƒ…å†µã€‚å…¶ä¸­ä¸€ä¸ª Interactor çš„ç»“æ„ï¼š 123456789101112131415class LoginInteractor { ... fun login(username: String, password: String, listener: OnLoginFinishedListener) { // Mock login. I'm creating a handler to delay the answer a couple of seconds postDelayed(2000) { when { username.isEmpty() -&gt; listener.onUsernameError() password.isEmpty() -&gt; listener.onPasswordError() else -&gt; listener.onSuccess() } } }} è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶è¿›è¡Œä¸€äº›éªŒè¯æ“ä½œã€‚ View å±‚View å±‚é€šå¸¸æ˜¯ç”±ä¸€ä¸ª Activityï¼ˆä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª Fragmentï¼Œä¸€ä¸ª Viewï¼Œè¿™å–å†³äº App çš„ç»“æ„ï¼‰ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªå¯¹ Presenter çš„å¼•ç”¨ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼ŒPresenter æ˜¯é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼æä¾›çš„ï¼ˆæ¯”å¦‚ Daggerï¼‰ï¼Œä½†å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨è¿™ç±»å·¥å…·ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ª Presenter å¯¹è±¡ã€‚View éœ€è¦åšçš„å”¯ä¸€ä¸€ä»¶äº‹å°±æ˜¯ï¼šå½“æœ‰ç”¨æˆ·æ“ä½œå‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚ä¸€ä¸ªæŒ‰é’®è¢«ç‚¹å‡»äº†ï¼‰ï¼Œå°±è°ƒç”¨ Presenter ä¸­çš„ç›¸åº”æ–¹æ³•ã€‚ ç”±äº View å¿…é¡»ä¸ Presenter å±‚æ— å…³ï¼Œå› æ­¤å®ƒå°±éœ€è¦å®ç°ä¸€ä¸ªæ¥å£ã€‚ä¸‹é¢æ˜¯ç¤ºä¾‹ä¸­ä½¿ç”¨åˆ°çš„æ¥å£ï¼š 1234567interface LoginView { fun showProgress() fun hideProgress() fun setUsernameError() fun setPasswordError() fun navigateToHome()} æ¥å£ä¸­æœ‰ä¸€äº›æœ‰æ•ˆçš„æ–¹æ³•æ¥æ˜¾ç¤ºæˆ–éšè—è¿›åº¦æ¡ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œè·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ç­‰ç­‰ã€‚æ­£å¦‚ä¸Šé¢æ‰€æåˆ°çš„ï¼Œæœ‰å¾ˆå¤šæ–¹å¼å»å®ç°è¿™äº›åŠŸèƒ½ï¼Œä½†æˆ‘æ›´å–œæ¬¢ç½—åˆ—å‡ºæœ€ç®€å•ç›´è§‚çš„æ–¹æ³•ã€‚ ç„¶åï¼ŒActivity å¯ä»¥å®ç°è¿™äº›æ–¹æ³•ã€‚è¿™é‡Œæˆ‘å‘ä½ å±•ç¤ºäº†ä¸€äº›ç”¨æ³•ï¼Œä»¥ä¾¿ä½ å¯¹å…¶ç”¨æ³•æœ‰æ‰€äº†è§£ï¼š 123456789101112131415class LoginActivity : AppCompatActivity(), LoginView { ... override fun showProgress() { progress.visibility = View.VISIBLE } override fun hideProgress() { progress.visibility = View.GONE } override fun setUsernameError() { username.error = getString(R.string.username_error) }} ä½†æ˜¯å¦‚æœä½ è¿˜è®°å¾—ï¼Œæˆ‘è¿˜å‘Šè¯‰è¿‡ä½ ï¼ŒView å±‚ä½¿ç”¨ Presenter æ¥é€šçŸ¥ç”¨æˆ·äº¤äº’æ“ä½œã€‚ä¸‹é¢å°±æ˜¯å®ƒçš„ç”¨æ³•ï¼š 123456789101112131415161718192021class LoginActivity : AppCompatActivity(), LoginView { private val presenter = LoginPresenter(this, LoginInteractor()) override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_login) button.setOnClickListener { validateCredentials() } } private fun validateCredentials() { presenter.validateCredentials(username.text.toString(), password.text.toString()) } override fun onDestroy() { presenter.onDestroy() super.onDestroy() } ...} Presenter è¢«å®šä¹‰ä¸º Activity çš„å±æ€§ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œå®ƒä¼šè°ƒç”¨ validateCredentials()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä¼šé€šçŸ¥ Presenterã€‚ onDestroy() æ–¹æ³•äº¦æ˜¯å¦‚æ­¤ã€‚æˆ‘ä»¬ç¨åå°†ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹éœ€è¦é€šçŸ¥ Presenterã€‚ Presenter å±‚Presenter å……å½“ç€ View å±‚å’Œ Model å±‚çš„ä¸­é—´äººã€‚å®ƒä» Model å±‚è·å–æ”¶æ®å¹¶å°†æ ¼å¼åŒ–åæ•°æ®è¿”å›ç»™ View å±‚ã€‚ æ­¤å¤–ï¼Œä¸å…¸å‹çš„ MVC æ¨¡å¼ä¸åŒçš„æ˜¯ï¼ŒPresenter å†³å®šäº†å½“ä½ åœ¨ä¸ View å±‚äº¤äº’æ—¶ä¼šåšä½•å“åº”ã€‚å› æ­¤ï¼Œå®ƒå°†ä¸ºç”¨æˆ·æ¯ä¸ªå¯æ‰§è¡Œçš„æ“ä½œæä¾›ä¸€ç§æ–¹æ³•ã€‚æˆ‘ä»¬åœ¨ View å±‚ä¸­çœ‹åˆ°äº†å®ƒï¼Œè¿™é‡Œæ˜¯ä»£ç å®ç°ï¼š 123456789class LoginPresenter(var loginView: LoginView?, val loginInteractor: LoginInteractor) : LoginInteractor.OnLoginFinishedListener { fun validateCredentials(username: String, password: String) { loginView?.showProgress() loginInteractor.login(username, password, this) } ...} MVP æ¨¡å¼å­˜åœ¨ä¸€äº›é£é™©ï¼Œå¸¸å¸¸è¢«æˆ‘ä»¬å¿½ç•¥çš„æœ€é‡è¦çš„é—®é¢˜æ˜¯ Presenter æ°¸è¿œä¾é™„åœ¨ View ä¸Šé¢ã€‚å¹¶ä¸” View å±‚ä¸€èˆ¬ä¸º Activityï¼Œè¿™å°±æ„å‘³ç€ï¼š æˆ‘ä»¬å¯èƒ½ä¼šç”±äºé•¿æ—¶é—´çš„è¿è¡Œçš„ä»»åŠ¡è€Œå¯¼è‡´ Activity çš„æ³„æ¼ æˆ‘ä»¬å¯èƒ½ä¼šåœ¨ Activity å·²ç»è¢«é”€æ¯çš„æƒ…å†µä¸‹å»æ›´æ–°è§†å›¾ é¦–å…ˆï¼Œå€˜è‹¥ä½ èƒ½å¤Ÿä¿è¯èƒ½å¤Ÿåœ¨åˆç†çš„æ—¶é—´å†…å®Œæˆä½ çš„åå°ä»»åŠ¡ï¼Œæˆ‘å°†ä¸ä¼šè¿‡äºæ‹…å¿ƒã€‚å°†ä½ çš„ Activity æ³„æ¼ 5-10 ç§’ä¼šè®©ä½ çš„ App å˜å¾—å¾ˆç³Ÿç³•ï¼Œå¹¶ä¸”è§£å†³æ–¹æ¡ˆé€šå¸¸å¾ˆå¤æ‚ã€‚ ç¬¬äºŒç‚¹åè€Œæ›´è®©äººæ‹…å¿ƒã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ èŠ±è´¹ 10 ç§’é’Ÿæ—¶é—´å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œä½†ç”¨æˆ·å´åœ¨ 5 ç§’é’Ÿåå…³é—­äº† Activityã€‚å½“å›è°ƒæ–¹æ³•æ­£åœ¨è¢«è°ƒç”¨å¹¶ä¸” UI è¢«æ›´æ–°æ—¶ï¼ŒApp å°†ä¼šå´©æºƒï¼Œå› ä¸º Activity æ­£åœ¨é”€æ¯ä¸­ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Activity ä¸­è°ƒç”¨ onDestroy() æ–¹æ³•å¹¶æ¸…é™¤ Viewï¼š 123fun onDestroy() { loginView = null} è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é¿å…åœ¨ä»»åŠ¡ç»“æŸæ—¶é—´ä¸æ´»åŠ¨é”€æ¯æ—¶é—´ä¸ä¸€è‡´çš„æƒ…å†µä¸‹è°ƒç”¨ Activity äº†ã€‚ æ€»ç»“åœ¨ Android ä¸­å°†ç”¨æˆ·ç•Œé¢å±‚ä¸é€»è¾‘å±‚åˆ†ç¦»å¹¶ä¸ç®€å•ï¼Œä½† MVP æ¨¡å¼å¯ä»¥æ›´åŠ è½»æ˜“åœ°é˜²æ­¢æˆ‘ä»¬çš„ Activity æœ€ç»ˆæ²¦ä¸ºé«˜åº¦è€¦åˆçš„ã€åŒ…å«äº†æˆç™¾ä¸Šåƒè¡Œä»£ç çš„ç±»ã€‚åœ¨å¤§å‹åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå°†ä»£ç ç®¡ç†å¥½æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚å¦åˆ™ï¼Œå¯¹ä»£ç çš„ç»´æŠ¤å’Œæ‰©å±•éƒ½ä¼šå˜å¾—å¾ˆå›°éš¾ã€‚ å¦‚ä»Šï¼Œè¿˜æœ‰å…¶ä»–çš„ä»£æ›¿æ–¹æ¡ˆæ¯”å¦‚ MVVMï¼Œæˆ‘å°†ä¼šåˆ›ä½œæ–°çš„æ–‡ç« æ¥å¯¹ MVVM å’Œ MVP åšæ¯”è¾ƒï¼Œå¹¶å¸®åŠ©å¼€å‘è€…è¿ç§»ã€‚æ‰€ä»¥è¯·ç»§ç»­å…³æ³¨æˆ‘çš„åšå®¢ï¼ è¯·è®°ä½ è¿™ä¸ªä»“åº“ï¼Œä½ å¯ä»¥åœ¨è¿™æŸ¥çœ‹ MVP åœ¨ Kotlin å’Œ Java ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚ å¦‚æœä½ æƒ³è¦äº†è§£æ›´å¤šå…³äº Kotlin æ–¹é¢çš„å†…å®¹ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘çš„ Kotlin for Android Developers è¿™æœ¬ä¹¦ ä¸­çš„ sample åº”ç”¨ï¼Œæˆ–è€…è§‚çœ‹ åœ¨çº¿è¯¾ç¨‹ã€‚ å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° æ˜é‡‘ç¿»è¯‘è®¡åˆ’ å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ æœ¬æ–‡æ°¸ä¹…é“¾æ¥ å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚","link":"/2018/12/24/mvp-presenter/"},{"title":"MotionLayout:)æ‰“å¼€åŠ¨ç”»æ–°ä¸–ç•Œå¤§é—¨","text":"æœ€åˆæ¥è§¦åˆ° MotionLayout æ˜¯åœ¨å›½å¤–çŸ¥ååšå®¢çš„ Android ä¸“æ ä¸Šã€‚ç¬¬ä¸€çœ¼è§åˆ° MotionLayout æ—¶æ— ç–‘æ˜¯å…´å¥‹çš„ï¼Œåœ¨ç»è¿‡ä½¿ç”¨å’Œç†Ÿæ‚‰äº†è¿™ä¸ªå¸ƒå±€ç»„ä»¶ä¹‹åï¼Œæˆ‘å°±æƒ³å°†è¿™ä»½å–œæ‚¦ä¼ é€’ç»™å›½å†…å¼€å‘è€…ï¼Œä»æ­¤â€œæ‹³æ‰“â€è®¾è®¡ï¼Œâ€œè„šè¸¢â€äº§å“ğŸ˜ã€‚å½“ç„¶ï¼Œç”±äºå…³äº MotionLayout çš„å¤–æ–‡ä¸“æ ç›¸å…³ä»‹ç»å·²è¶³å¤Ÿè¯¦ç»†ï¼Œæ‰€ä»¥æœ¬æ–‡ä»…å¯¹å…¶è¿›è¡Œæ€»ç»“å’Œç®€å•åº”ç”¨ã€‚è€è§„çŸ©ï¼Œæ­£æ–‡å¼€å§‹å‰å…ˆä¸Šä¸€å¼ å›¾ï¼š ç®€ä»‹ç”±äºæœ¬æ–‡çš„å—ä¼—éœ€è¦æœ‰ä¸€ç‚¹ ConstraintLayout çš„ç”¨æ³•åŸºç¡€ï¼Œå¦‚æœä½ å¯¹å®ƒå¹¶ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥å…ˆå»èŠ±å‡ åˆ†é’Ÿçœ‹ä¸€ä¸‹æœ¬äººä¹‹å‰çš„è¯‘æ–‡ï¼šå¸¦ä½ é¢†ç•¥ ConstraintLayout 1.1 çš„æ–°åŠŸèƒ½ã€‚å›åˆ°æ­£é¢˜ï¼Œä»€ä¹ˆæ˜¯ MotionLayout ï¼Ÿå¾ˆå¤šäººå¯èƒ½ä¼šå¯¹è¿™ä¸ªåè¯æ¯”è¾ƒé™Œç”Ÿï¼Œä½†å¦‚æœè¯´åˆ°å®ƒçš„å‰èº« â€” ConstraintLayout*ï¼Œå¤§å®¶åº”è¯¥å°±å¤šå°‘æœ‰äº›äº†è§£äº†ã€‚MotionLayout* å…¶å®æ˜¯ Google åœ¨å»å¹´å¼€å‘è€…å¤§ä¼šä¸Šæ–°æ¨çš„å¸ƒå±€ç»„ä»¶ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ **Android å®˜æ–¹å¯¹äºå®ƒçš„å®šä¹‰ï¼š MotionLayout is a layout type that helps you manage motion and widget animation in your app. MotionLayout is a subclass of ConstraintLayout and builds upon its rich layout capabilities. ç®€å•ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šMotionLayout æ˜¯ä¸€ä¸ªèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨ app ä¸­ç®¡ç†æ‰‹åŠ¿å’Œæ§ä»¶åŠ¨ç”»çš„å¸ƒå±€ç»„ä»¶ã€‚å®ƒæ˜¯ ConstraintLayout çš„å­ç±»å¹¶ä¸”åŸºäºå®ƒè‡ªèº«ä¸°å¯Œçš„å¸ƒå±€åŠŸèƒ½æ¥è¿›è¡Œæ„å»ºã€‚ å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å­—é¢æ„æ€å°†å®ƒç®€å•ç†è§£ä¸ºâ€œè¿åŠ¨å¸ƒå±€â€ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿé€šè¿‡ä¸Šå›¾æ¥å¯¹æ¯”ä¼ ç»Ÿçš„å¸ƒå±€ç»„ä»¶ï¼ˆå¦‚ï¼šFrameLayoutã€LinearLayout ç­‰ï¼‰ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼šMotionLayout æ˜¯å¸ƒå±€ç»„ä»¶ä¸­çš„ä¸€ä¸ªâ€œé‡Œç¨‹ç¢‘â€ï¼Œç”±æ­¤å¼€å§‹å°±å‘Šåˆ«äº† XML æ–‡ä»¶ä¸­åªèƒ½â€é™æ€â€œæ“ä½œ UI çš„å†å²ã€‚é€šè¿‡ MotionLayoutï¼Œæˆ‘ä»¬å°±èƒ½æ›´åŠ è½»æ˜“å¤„ç†å…¶å†…éƒ¨å­ View çš„æ‰‹åŠ¿æ“ä½œå’Œâ€è¿åŠ¨â€æ•ˆæœäº†ã€‚æ­£å¦‚ Nicolas Roard æ‰€è¯´çš„é‚£æ ·ï¼š ä½ å¯ä»¥åœ¨ MotionLayout åŠŸèƒ½æ–¹é¢å°†å…¶çœ‹ä½œæ˜¯å±æ€§åŠ¨ç”»ã€TransitionManager å’Œ CoordinatorLayout çš„ç»“åˆä½“ã€‚ MotionLayout åŸºç¡€é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä» MotionLayout çš„ä¸€äº›åŸºæœ¬å±æ€§å’Œç”¨æ³•è®²èµ·ï¼Œè¿™æ ·å¯¹äºæˆ‘ä»¬åé¢çš„å®é™…æ“ä½œå°†ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ å¼•å…¥ MotionLayout åº“123dependencies { implementation 'com.android.support.constraint:constraint-layout:2.0.0-beta2'} ç›®å‰ï¼ŒMotionLayout ä»å¤„äº beta ç‰ˆæœ¬ï¼Œè™½ç„¶å®˜æ–¹ä¹‹å‰è¯´è¿‡ MotionLayout çš„åŠ¨ç”»è¾…åŠ©å·¥å…·å°†ä¼šåœ¨ beta ç‰ˆæœ¬æ¨å‡ºï¼Œä½†ç›®å‰è¿˜æ²¡æœ‰å‡ºç°ï¼Œä¸å‡ºæ„å¤–åº”è¯¥æ˜¯åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬äº†ã€‚åˆ°æ—¶å€™åº”è¯¥å°±å¯ä»¥åƒ ConstraintLayout é‚£æ ·ç›´æ¥é€šè¿‡å¸ƒå±€ç¼–è¾‘å™¨æ¥è¿›è¡Œéƒ¨åˆ†é¢„è§ˆå’Œå‚æ•°æ“ä½œäº†ã€‚ åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨ MotionLayoutæƒ³è¦ä½¿ç”¨ MotionLayoutï¼Œåªéœ€è¦åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½œå¦‚ä¸‹å£°æ˜å³å¯ï¼š 123456789&lt;android.support.constraint.motion.MotionLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:layoutDescription=\"@xml/scene1\"&gt;&lt;/android.support.constraint.motion.MotionLayout&gt; ç”±äº MotionLayout ä½œä¸º ConstraintLayout çš„å­ç±»ï¼Œé‚£ä¹ˆå°±è‡ªç„¶è€Œç„¶åœ°å¯ä»¥åƒ ConstraintLayout é‚£æ ·ä½¿ç”¨å»â€œçº¦æŸâ€å­è§†å›¾äº†ï¼Œä¸è¿‡è¿™å¯å°±æœ‰ç‚¹â€œå¤§æå°ç”¨äº†â€ï¼ŒMotionLayout çš„ç”¨å¤„å¯è¿œä¸æ­¢è¿™äº›ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ MotionLayout çš„æ„æˆï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼ŒMotionLayout å¯åˆ†ä¸º &lt;View&gt; å’Œ &lt;Helper&gt; ä¸¤ä¸ªéƒ¨åˆ†ã€‚*&lt;View&gt;* éƒ¨åˆ†å¯ç®€å•ç†è§£ä¸ºä¸€ä¸ª ConstraintLayoutï¼Œè‡³äº &lt;Helper&gt; å…¶å®å°±æ˜¯æˆ‘ä»¬çš„â€œåŠ¨ç”»å±‚â€äº†ã€‚MotionLayout ä¸ºæˆ‘ä»¬æä¾›äº† layoutDescription å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå®ƒä¼ å…¥ä¸€ä¸ª MotionScene åŒ…è£¹çš„ XML æ–‡ä»¶ï¼Œæƒ³è¦å®ç°åŠ¨ç”»äº¤äº’ï¼Œå°±å¿…é¡»é€šè¿‡è¿™ä¸ªâ€œåª’ä»‹â€æ¥è¿æ¥ã€‚ MotionSceneï¼šä¼ è¯´ä¸­çš„â€œç™¾å®è¢‹â€ä»€ä¹ˆæ˜¯ MotionSceneï¼Ÿç»“åˆä¸Šå›¾ MotionScene ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š**StateSetã€ConstraintSet** å’Œ **Transition**ã€‚ä¸ºäº†è®©å¤§å®¶å¿«é€Ÿç†è§£å’Œä½¿ç”¨ MotionSceneï¼Œæœ¬æ–‡å°†é‡ç‚¹è®²è§£ ConstarintSet å’Œ Transitionï¼Œè‡³äº StateSet çŠ¶æ€ç®¡ç†å°†ä¼šåœ¨åç»­æ–‡ç« ä¸­ä¸ºå¤§å®¶ä»‹ç»å…·ä½“ç”¨æ³•å’Œåœºæ™¯ã€‚åŒæ—¶ï¼Œä¸ºäº†å¸®åŠ©å¤§å®¶ç†è§£ï¼Œæ­¤å¤„å°†å¼€å§‹ç»“åˆä¸€äº›å…·ä½“å°å®ä¾‹æ¥å¸®åŠ©å¤§å®¶å¿«é€Ÿç†è§£å’Œä½¿ç”¨å®ƒã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ä»å®ç°ä¸‹é¢è¿™ä¸ªç®€å•çš„æ•ˆæœè®²èµ·ï¼š GIF ç”»è´¨æœ‰ç‚¹æ¸£ï¼Œè§è°…ï¼Œä½†ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¹³ç§»åŠ¨ç”»ï¼Œé€šè¿‡ç‚¹å‡»è‡ªèº«ï¼ˆç¯®çƒï¼‰æ¥è§¦å‘ï¼Œè®©æˆ‘ä»¬æ¥é€šè¿‡ MotionLayout çš„æ–¹å¼æ¥å®ç°å®ƒã€‚é¦–å…ˆæ¥çœ‹ä¸‹å¸ƒå±€æ–‡ä»¶ï¼š 123456789101112131415&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.constraint.motion.MotionLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:layoutDescription=\"@xml/step1\" tools:context=\".practice.MotionSampleActivity\"&gt; &lt;ImageView android:id=\"@+id/ball\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:src=\"@drawable/ic_basketball\"/&gt;&lt;/android.support.constraint.motion.MotionLayout&gt; å¸ƒå±€æ–‡ä»¶å¾ˆç®€å•ï¼Œåªä¸è¿‡ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œæˆ‘ä»¬å¯¹ ImageView å¹¶æ²¡æœ‰æ·»åŠ ä»»ä½•çº¦æŸï¼ŒåŸå› åœ¨äºï¼šæˆ‘ä»¬ä¼šåœ¨ MotionScene ä¸­å£°æ˜ ConstraintSetï¼Œé‡Œé¢å°†åŒ…å«è¯¥ ImageView çš„â€œè¿åŠ¨â€èµ·å§‹ç‚¹å’Œç»ˆç‚¹çš„çº¦æŸä¿¡æ¯ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å¯¹å…¶åŠ ä»¥çº¦æŸï¼Œä½† MotionScene ä¸­å¯¹äºæ§ä»¶çº¦æŸçš„ä¼˜å…ˆçº§ä¼šé«˜äºå¸ƒå±€æ–‡ä»¶ä¸­çš„è®¾å®šã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡ layoutDescription æ¥ä¸º MotionLayout è®¾ç½®å®ƒçš„ MotionScene ä¸º step1ï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¸€ç¹ MotionScene çš„èŠ³å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!--describe the animation for activity_motion_sample_step1.xml--&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;!-- A transition describes an animation via start and end state --&gt; &lt;Transition app:constraintSetStart=\"@id/start\" app:constraintSetEnd=\"@id/end\" app:duration=\"2200\"&gt; &lt;OnClick app:targetId=\"@id/ball\" app:clickAction=\"toggle\" /&gt; &lt;/Transition&gt; &lt;!-- Constraints to apply at the start of the animation --&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@+id/ball\" android:layout_width=\"48dp\" android:layout_height=\"48dp\" android:layout_marginStart=\"12dp\" android:layout_marginTop=\"12dp\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\"/&gt; &lt;/ConstraintSet&gt; &lt;!-- Constraints to apply at the end of the animation --&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@+id/ball\" android:layout_width=\"48dp\" android:layout_height=\"48dp\" android:layout_marginEnd=\"12dp\" android:layout_marginBottom=\"12dp\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;/ConstraintSet&gt;&lt;/MotionScene&gt; é¦–å…ˆï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ª &lt;ConstraintSet&gt;*ï¼Œåˆ†åˆ«æè¿°äº†è¿™ä¸ªğŸ€ ImageView çš„åŠ¨ç”»èµ·å§‹ä½ç½®ä»¥åŠç»“æŸä½ç½®çš„çº¦æŸä¿¡æ¯ï¼ˆä»…åŒ…å«å°‘é‡å¿…è¦ä¿¡æ¯ï¼Œå¦‚ï¼šwidthã€heightã€marginä»¥åŠä½ç½®å±æ€§ç­‰ï¼‰ã€‚æ˜¾è€Œæ˜“è§ï¼Œç¯®çƒçš„èµ·å§‹ä½ç½®ä¸ºå±å¹•å·¦ä¸Šè§’ï¼Œç»“æŸä½ç½®ä¸ºå±å¹•å³ä¸‹è§’ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•è®©å®ƒåŠ¨èµ·æ¥å‘¢ï¼Ÿè¿™å°±è¦ä¾é æˆ‘ä»¬çš„ *&lt;Transition&gt; å…ƒç´ äº†ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒåŠ¨ç”»éƒ½æ˜¯æœ‰å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®çš„ï¼Œè€Œ MotionLayout æ­£æ˜¯åˆ©ç”¨è¿™ä¸€å®¢è§‚äº‹å®ï¼Œå°†é¦–å°¾ä½ç½®å’ŒåŠ¨ç”»è¿‡ç¨‹åˆ†ç¦»ï¼Œä¸¤ä¸ªç‚¹ä½ç½®å’Œè·ç¦»è™½ç„¶æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯å®ƒä»¬ä¹‹é—´çš„ Path æ˜¯æ— é™çš„ï¼Œå¯ä»¥æ˜¯â€œä¸€é©¬å¹³å·â€ï¼Œä¹Ÿå¯ä»¥æ˜¯â€èœ¿èœ’æ›²æŠ˜â€çš„ã€‚ å›åˆ°ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸º Transition è®¾ç½®èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®çš„ ConstraintSet å¹¶è®¾ç½®åŠ¨ç”»æ—¶é—´å³å¯ï¼Œå‰©ä¸‹çš„éƒ½äº¤ç»™ MotionLayout è‡ªåŠ¨å»å¸®æˆ‘ä»¬å®Œæˆã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ onClick ç‚¹å‡»äº‹ä»¶æ¥è§¦å‘åŠ¨ç”»ï¼Œç»‘å®šç›®æ ‡æ§ä»¶çš„ id ä»¥åŠé€šè¿‡ clickAction å±æ€§æ¥è®¾ç½®ç‚¹å‡»äº‹ä»¶çš„ç±»å‹ï¼Œè¿™é‡Œæˆ‘ä»¬è®¾ç½®çš„æ˜¯ toggleï¼Œå³é€šè¿‡åå¤ç‚¹å‡»æ§ä»¶æ¥åˆ‡æ¢åŠ¨ç”»çš„çŠ¶æ€ï¼Œå…¶ä»–è¿˜æœ‰å¾ˆå¤šå±æ€§å¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£å»ç ”ç©¶ï¼Œæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€è®²è§£å®ƒä»¬çš„æ•ˆæœäº†ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œè¿è¡Œä¸€ä¸‹å°±èƒ½çœ‹åˆ°ä¸Šé¢çš„æ•ˆæœäº†ã€‚å¦å¤–ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ MotionLayout åŠ ä¸Šè°ƒè¯•å±æ€§ï¼š*app:motionDebug=&quot;SHOW_PATH&quot;*ï¼Œç„¶åå°±èƒ½è½»æ˜“çš„æŸ¥çœ‹å…¶åŠ¨ç”»å†…éƒ¨çš„è¿åŠ¨è½¨è¿¹ï¼š ä»€ä¹ˆï¼Ÿä½ è¯´è¿™ä¸ªåŠ¨ç”»æ•ˆæœå¤ªåŸºç¡€ï¼Ÿé‚£å¥½ï¼Œæˆ‘å°±æ¥ä¸ªç®€é™‹ç‰ˆçš„â€œç™¾èŠ±é½æ”¾â€æ•ˆæœå§ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªæ•ˆæœï¼šä»”ç»†çœ‹æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé€šè¿‡å‘ä¸Šæ»‘åŠ¨è“è‰²çš„ Android æœºå™¨äººï¼Œç´«è‰²å’Œæ©™è‰²çš„æœºå™¨äººä¼šæ…¢æ…¢æ·¡å‡ºå¹¶åˆ†åˆ«å¿˜å·¦ä¸Šè§’å’Œå³ä¸Šè§’ç§»åŠ¨ã€‚å¸ƒå±€æ–‡ä»¶å¾ˆç®€å•ï¼Œä¸€æŠŠæ¢­å°±OKäº†ğŸ˜‚ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.constraint.motion.MotionLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:motionDebug=\"SHOW_PATH\" app:layoutDescription=\"@xml/step2\" tools:context=\".practice.MotionSampleActivity\"&gt; &lt;ImageView android:id=\"@+id/ic_android_blue\" android:layout_width=\"42dp\" android:layout_height=\"42dp\" android:src=\"@mipmap/android_icon_blue\"/&gt; &lt;ImageView android:id=\"@+id/ic_android_left\" android:layout_width=\"42dp\" android:layout_height=\"42dp\" android:src=\"@mipmap/android_icon_purple\"/&gt; &lt;ImageView android:id=\"@+id/ic_android_right\" android:layout_width=\"42dp\" android:layout_height=\"42dp\" android:src=\"@mipmap/android_icon_orange\"/&gt; &lt;TextView android:id=\"@+id/tipText\" android:text=\"Swipe the blue android icon up\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" app:layout_constraintEnd_toEndOf=\"parent\" android:layout_marginEnd=\"16dp\" android:layout_marginTop=\"16dp\" app:layout_constraintTop_toTopOf=\"parent\"/&gt;&lt;/android.support.constraint.motion.MotionLayout&gt; ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹ step2 ä¸­çš„ MotionSceneï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!--describe the animation for activity_motion_sample_step2.xml--&gt;&lt;!--animate by dragging target view--&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;!--At the start, all three stars are centered at the bottom of the screen.--&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@+id/ic_android_blue\" android:layout_width=\"42dp\" android:layout_height=\"42dp\" android:layout_marginBottom=\"20dp\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;Constraint android:id=\"@+id/ic_android_left\" android:layout_width=\"42dp\" android:layout_height=\"42dp\" android:alpha=\"0.0\" android:layout_marginBottom=\"20dp\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;Constraint android:id=\"@+id/ic_android_right\" android:layout_width=\"42dp\" android:layout_height=\"42dp\" android:layout_marginBottom=\"20dp\" android:alpha=\"0.0\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;/ConstraintSet&gt; &lt;!--Define the end constraint to set use a chain to position all three stars together below @id/tipText.--&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;Constraint android:id=\"@+id/ic_android_left\" android:layout_width=\"58dp\" android:layout_height=\"58dp\" android:layout_marginEnd=\"90dp\" android:alpha=\"1.0\" app:layout_constraintHorizontal_chainStyle=\"packed\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintEnd_toStartOf=\"@id/ic_android_blue\" app:layout_constraintTop_toBottomOf=\"@id/tipText\"/&gt; &lt;Constraint android:id=\"@+id/ic_android_blue\" android:layout_width=\"58dp\" android:layout_height=\"58dp\" app:layout_constraintEnd_toStartOf=\"@id/ic_android_right\" app:layout_constraintStart_toEndOf=\"@id/ic_android_left\" app:layout_constraintTop_toBottomOf=\"@id/tipText\"/&gt; &lt;Constraint android:id=\"@+id/ic_android_right\" android:layout_width=\"58dp\" android:layout_height=\"58dp\" android:layout_marginStart=\"90dp\" android:alpha=\"1.0\" app:layout_constraintStart_toEndOf=\"@id/ic_android_blue\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintTop_toBottomOf=\"@id/tipText\"/&gt; &lt;/ConstraintSet&gt; &lt;!-- A transition describes an animation via start and end state --&gt; &lt;Transition app:constraintSetStart=\"@id/start\" app:constraintSetEnd=\"@id/end\"&gt; &lt;!-- MotionLayout will track swipes relative to this view --&gt; &lt;OnSwipe app:touchAnchorId=\"@id/ic_android_blue\"/&gt; &lt;/Transition&gt;&lt;/MotionScene&gt; ä¸Šé¢ä»£ç å…¶å®å¾ˆå¥½ç†è§£ï¼Œä¹‹å‰æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ§ä»¶çš„ Constraintï¼Œç°åœ¨åªéœ€è¦å¤šåŠ ä¸¤ä¸ªå³å¯ã€‚ç”±äºä¸‰ä¸ª Android æœºå™¨äººèµ·ç‚¹ä½ç½®æ˜¯ä¸€æ ·çš„ï¼Œè€Œåªæœ‰è“è‰²çš„æ˜¾ç¤ºï¼Œé‚£ä¹ˆåªè¦åœ¨å¼€å§‹ä½ç½®å°†å¦å¤–çš„ä¸¤ä¸ªæœºå™¨äººé€æ˜åº¦è®¾ç½®ä¸º 0 å³å¯ï¼Œç„¶ååœ¨ç»“æŸä½ç½®å°†ä¸‰ä¸ªå°æœºå™¨äººåˆ†å¼€æ‘†æ”¾ï¼Œè¿™é‡Œè®¾è®¡åˆ° ConstraintLayout çš„åŸºç¡€ï¼Œå°±ä¸å¤šè¯´äº†ã€‚æ¥ç€å°†ç»“æŸä½ç½®çš„å·¦ã€å³ Android æœºå™¨äººé€æ˜åº¦è®¾ç½®ä¸º 1ï¼ŒåŠ¨ç”»å¼€å§‹åï¼ŒMotionLayout ä¼šè‡ªåŠ¨å¤„ç†ç›®æ ‡æ§ä»¶ alpha å±æ€§çš„å˜åŒ–æ•ˆæœï¼Œè®©å…¶çœ‹èµ·æ¥ä¾æ—§ä¸æ»‘ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬è¿™é‡Œæ²¡æœ‰å†é€šè¿‡ &lt;OnClick&gt; æ¥è§¦å‘åŠ¨ç”»æ•ˆæœï¼Œç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† &lt;OnSwipe&gt; æ‰‹åŠ¿æ»‘åŠ¨æ¥è§¦å‘åŠ¨ç”»ï¼Œåªéœ€è¦æŒ‡å®š touchAnchorId ä¸ºè“è‰²å°æœºå™¨äººå³å¯ï¼Œæ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯æœ‰ç§â€œæ‹æ¡ˆæƒŠå¥‡â€çš„æ„Ÿè§‰ğŸ˜ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥é€šè¿‡æŒ‡å®š touchAnchorSide å’Œ dragDirection ç­‰æ¥æŒ‡å®šè‡ªå·±æƒ³è¦çš„æ»‘åŠ¨æ‰‹åŠ¿å’Œæ»‘åŠ¨æ–¹å‘ï¼Œé»˜è®¤ä¸ºå‘ä¸Šæ»‘åŠ¨ï¼Œæ‰‹åŠ¿æ»‘åŠ¨æˆ‘ä»¬å°†åœ¨åé¢ç¤ºä¾‹ä¸­ç©¿æ’ä½¿ç”¨å’Œè®²è§£ï¼Œè¿™é‡Œä¸åšå…·ä½“ä»‹ç»ï¼Œå¿ä¸ä½çš„å°ä¼™ä¼´å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ä»‹ç»ã€‚OKï¼Œå°±è¿™æ ·ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä¼ªâ€œç™¾èŠ±é½æ”¾â€æ•ˆæœå°±å·²ç»å®ç°äº†ï¼Œæ²¡ä»€ä¹ˆéš¾çš„å¯¹å§ğŸ˜„ã€‚ åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šè¯´ï¼šå‰é¢ä¸¤ä¸ªç¤ºä¾‹çš„åŠ¨ç”»è½¨è¿¹ä¸€ç›´æ˜¯â€ç›´çº¿â€ï¼Œå¦‚æœæƒ³è¦æŸæ®µåŠ¨ç”»è¿‡ç¨‹çš„è½¨è¿¹æ˜¯â€æ›²çº¿â€æ•ˆæœå¯ä»¥å—ï¼Ÿå½“ç„¶æ²¡é—®é¢˜ï¼Keyframes å…³é”®å¸§å¸®ä½ å®‰æ’ï¼ KeyFrameSetï¼šè®©åŠ¨ç”»ç‹¬æ ‘ä¸€å¸œå¦‚æœæˆ‘ä»¬æƒ³å®ç°â€œç‹¬æ ‘ä¸€å¸œâ€çš„åŠ¨ç”»äº¤äº’æ•ˆæœï¼Œé‚£å°±ç¦»ä¸å¼€ KeyFrameSet è¿™ä¸ªå¼ºå¤§çš„å±æ€§ã€‚å®ƒå¯ä»¥æ”¹å˜æˆ‘ä»¬åŠ¨ç”»è¿‡ç¨‹ä¸­æŸä¸ªå…³é”®å¸§çš„ä½ç½®ä»¥åŠçŠ¶æ€ä¿¡æ¯ã€‚è¿™æ ·è¯´å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ï¼š ä»¥å¤§å®¶çš„æ…§çœ¼ä¸éš¾å‘ç°ï¼šé£è½¦çš„è¿åŠ¨è½¨è¿¹ä¸ºæ›²çº¿ï¼Œå¹¶ä¸”æ—‹è½¬å¹¶æ”¾å¤§è‡³ä¸­é—´ä½ç½®æ—¶ä¼šè¾¾åˆ°é›¶ç•Œç‚¹ï¼Œç„¶åå¼€å§‹ç¼©å°ã€‚å¸ƒå±€ä»£ç å°±ä¸ä¸Šäº†ï¼Œå¾ˆç®€å•ï¼Œé‡Œé¢å”¯ä¸€é‡è¦çš„å°±æ˜¯æˆ‘ä»¬éœ€è¦å®ç°çš„ MotionScene æ•ˆæœ â€” step3.xml äº†ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!--describe the animation for activity_motion_sample_step3.xml--&gt;&lt;!--animate in the path way on a view--&gt;&lt;MotionScene xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;!-- Constraints to apply at the start of the animation --&gt; &lt;ConstraintSet android:id=\"@+id/start\"&gt; &lt;Constraint android:id=\"@id/windmill\" android:layout_width=\"40dp\" android:layout_height=\"40dp\" android:layout_marginStart=\"12dp\" android:layout_marginBottom=\"12dp\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;Constraint android:id=\"@id/tipText\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:alpha=\"0.0\" app:layout_constraintStart_toStartOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"@id/windmill\" app:layout_constraintTop_toTopOf=\"@id/windmill\"/&gt; &lt;/ConstraintSet&gt; &lt;!-- Constraints to apply at the end of the animation --&gt; &lt;ConstraintSet android:id=\"@+id/end\"&gt; &lt;!--this view end point should be at bottom of parent--&gt; &lt;Constraint android:id=\"@id/windmill\" android:layout_width=\"40dp\" android:layout_height=\"40dp\" android:layout_marginBottom=\"12dp\" android:layout_marginEnd=\"12dp\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;Constraint android:id=\"@+id/tipText\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginBottom=\"12dp\" android:alpha=\"1.0\" android:layout_marginEnd=\"72dp\" app:layout_constraintEnd_toEndOf=\"parent\" app:layout_constraintBottom_toBottomOf=\"parent\"/&gt; &lt;/ConstraintSet&gt; &lt;!-- A transition describes an animation via start and end state --&gt; &lt;Transition app:constraintSetStart=\"@id/start\" app:constraintSetEnd=\"@id/end\"&gt; &lt;KeyFrameSet&gt; &lt;KeyPosition app:framePosition=\"50\" app:motionTarget=\"@id/windmill\" app:keyPositionType=\"parentRelative\" app:percentY=\"0.5\"/&gt; &lt;!--apply other animation attributes--&gt; &lt;!--å‰åŠæ®µçš„åŠ¨ç”»æ•ˆæœï¼šé€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆï¼ŒåŒæ—¶æ”¾å¤§ä¸€å€--&gt; &lt;KeyAttribute app:motionTarget=\"@id/windmill\" android:rotation=\"-360\" android:scaleX=\"2.0\" android:scaleY=\"2.0\" app:framePosition=\"50\"/&gt; &lt;!--ååŠæ®µçš„åŠ¨ç”»æ•ˆæœï¼šé€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆï¼ŒåŒæ—¶å˜å›åŸæ ·--&gt; &lt;KeyAttribute app:motionTarget=\"@id/windmill\" android:rotation=\"-720\" app:framePosition=\"100\"/&gt; &lt;!--å»¶è¿ŸåŠ¨ç”»â€”â€”0-85è¿‡ç¨‹ä¸­å°†é€æ˜åº¦ä¸€ç›´ç»´æŒåœ¨0.0--&gt; &lt;KeyAttribute app:motionTarget=\"@id/tipText\" app:framePosition=\"85\" android:alpha=\"0.0\"/&gt; &lt;/KeyFrameSet&gt; &lt;OnSwipe app:touchAnchorId=\"@id/windmill\" app:touchAnchorSide=\"bottom\" app:dragDirection=\"dragRight\"/&gt; &lt;/Transition&gt;&lt;/MotionScene&gt; ä»ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼šKeyFrameSet éœ€è¦è¢«åŒ…å«åœ¨ Transition é‡Œé¢ï¼ŒåŒæ—¶ KeyFrameSet ä¸­å®šä¹‰äº† &lt;KeyPosition&gt; å’Œ &lt;KeyAttribute&gt; ä¸¤ç§å…ƒç´ ï¼Œå®ƒä»¬ä¸»è¦ç”¨æ¥è®¾ç½®åŠ¨ç”»æŸä¸ªä½ç½®çš„å…³é”®å¸§ï¼Œè¿›è€Œä¸ºæŸæ®µåŠ¨ç”»æŒ‡å®šæ‰€æœŸæœ›çš„æ•ˆæœã€‚é¡¾åæ€ä¹‰ï¼ŒKeyPosition ç”¨äºæŒ‡å®šåŠ¨ç”»æŸä¸ªå…³é”®å¸§çš„ä½ç½®ä¿¡æ¯ï¼Œè€Œ KeyAttribute åˆ™ç”¨æ¥æè¿°åŠ¨ç”»æŸå…³é”®å¸§çš„å±æ€§é…ç½®ï¼ˆå¦‚ï¼šé€æ˜åº¦ã€ç¼©æ”¾ã€æ—‹è½¬ç­‰ï¼‰ã€‚é™¤æ­¤ä»¥å¤–ï¼ŒKeyFrameSet ä¸­è¿˜æ”¯æŒ &lt;KeyCycle&gt; å’Œ &lt;KeyTimeCycle&gt; æ¥è®©åŠ¨ç”»å˜å¾—æ›´åŠ æœ‰è¶£å’Œçµæ´»ï¼Œå› ç¯‡å¹…æœ‰é™ï¼Œå°†åœ¨åç»­æ–‡ç« å¯¹äºŒè€…è¿›è¡Œè®²è§£ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ KeyPosition çš„æ„æˆï¼š ä»ä¸Šå›¾å¯è§ï¼ŒkeyPositionType ä¸€å…±æœ‰ä¸‰ç§ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ parentRelativeï¼Œå³ä»¥æ•´ä¸ª MotionLayout çš„å¸ƒå±€ä¸ºåæ ‡ç³»ï¼Œå·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ï¼Œå³å‚è€ƒ View çš„åæ ‡ç³»å³å¯ï¼Œè€Œå¦å¤–ä¸¤ç§å°†åœ¨åç»­æ–‡ç« ç»Ÿä¸€è®²è§£å’Œåº”ç”¨ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºåæ ‡ç³»é€‰å–çš„å‚è€ƒç‚¹ä¸åŒè€Œå·²ã€‚æˆ‘ä»¬é€šè¿‡ framePosition å±æ€§æ¥æŒ‡å®šå…³é”®å¸§æ‰€åœ¨çš„ä½ç½®ï¼Œå–å€¼èŒƒå›´ä¸º 0 - 100ï¼Œæœ¬ç¤ºä¾‹ä¸­è®¾ç½®çš„ 50 å³ä¸ºåŠ¨ç”»ä¸­ç‚¹ä½ç½®ã€‚å¦å¤–ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®š percentX å’Œ percentY æ¥è®¾ç½®è¯¥å…³é”®å¸§ä½ç½®çš„åç§»é‡ï¼Œå®ƒä»¬å–å€¼ä¸€èˆ¬ä¸º 0 â€” 1ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºè´Ÿæ•°æˆ–è€…å¤§äºä¸€ï¼Œæ¯”å¦‚ï¼Œæœ¬ç¤ºä¾‹ä¸­å¦‚æœæ²¡æœ‰è®¾ç½®åç§»é‡ï¼Œé‚£ä¹ˆåŠ¨ç”»çš„è½¨è¿¹æ— ç–‘æ˜¯ä¸€æ¡å¹³è¡Œäº x è½´çš„ç›´çº¿ï¼Œä½†é€šè¿‡è®¾ç½® app:percentY=&quot;0.5&quot;ï¼Œé‚£ä¹ˆé£è½¦å°±ä¼šåœ¨åŠ¨ç”»ä¸­ç‚¹ä½ç½®å‘ y è½´æ–¹å‘åç§»ä¸€åŠçš„é«˜åº¦ï¼Œå³ä¸‹å›¾çš„æ•ˆæœï¼ˆå¼€å§‹ debug æ¨¡å¼ï¼‰ï¼š å¯èƒ½ä¼šæœ‰äººé—®äº†ï¼šä¸ºä»€ä¹ˆè½¨è¿¹ä¸æ˜¯ä¸‰è§’å½¢ï¼Œè€Œæ˜¯æ›²çº¿å‘¢ï¼Ÿå“ˆå“ˆï¼Œè¿™ä¸ªé—®é¢˜é—®å¾—å¥½ï¼å› ä¸º MotionLayout ä¼šè‡ªåŠ¨åœ°å°†å…³é”®å¸§ä½ç½®å°½é‡è¡”æ¥çš„åœ†æ»‘ï¼Œè®©åŠ¨ç”»æ‰§è¡Œèµ·æ¥ä¸é‚£ä¹ˆåƒµç¡¬ã€‚å…¶ä»–ä»£ç åº”è¯¥å°±æ¯”è¾ƒå¥½ç†è§£äº†ï¼Œå¯ä»¥å‚ç…§æ–‡æ¡£ç†è§£ã€‚ äº†è§£å®Œ KeyFrameSet çš„ç”¨æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾ˆè½»æ˜“çš„å®ç°ä¸‹é¢è¿™ä¸ªæ•ˆæœå•¦ï¼š ä»£ç å°±ä¸è´´äº†ï¼ŒMotionLayout ç³»åˆ—ä»£ç éƒ½ä¼šä¸Šä¼ è‡³ GitHub ä¸Šï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»çœ‹ä¸€ä¸‹ã€‚ä¸çŸ¥ä¸è§‰å·²ç»è®²äº†è¿™ä¹ˆå¤šï¼Œä½†å‘ç°è¿˜æœ‰å¾ˆå¤šå†…å®¹æ²¡æœ‰æ¶‰åŠåˆ°æˆ–æ˜¯è®²æ¸…æ¥šï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œå°±åªèƒ½æ”¾åœ¨åé¢å‡ æœŸæ¥ä¸ºå¤§å®¶ä»‹ç»å•¦ğŸ˜„ã€‚å¦‚æœå¤§å®¶è§‰å¾—å¯¹æœ¬æ–‡æœ‰ä»€ä¹ˆé—®é¢˜æˆ–è€…å»ºè®®ï¼Œæ¬¢è¿è¯„è®ºåŒºç•™è¨€ï¼ŒçŸ¥æ— ä¸è¨€ï¼Œè¨€æ— ä¸å°½ã€‚ æœ¬æ–‡å…¨éƒ¨ä»£ç ï¼šhttps://github.com/Moosphan/ConstraintSample åç»­æ–‡ç« å°†ç»§ç»­è·Ÿè¿›ç›¸å…³è¿›é˜¶ç”¨æ³•ï¼Œè¯¥ä»“åº“ä¹Ÿå°†æŒç»­æ›´æ–°ï¼Œæ•¬è¯·æœŸå¾…~ å‚è€ƒå’Œæ„Ÿè°¢ï¼š Introduction to MotionLayout (part I) Introduction to MotionLayout (part II) Introduction to MotionLayout (part III) Defining motion paths in MotionLayout MotionLayout development æœ€å æœ¬æ–‡çš„å‡ºå‘ç‚¹æ˜¯å¸Œæœ›ä»…ä»…ä¸ºå¤§å®¶æä¾›ä¸€ä¸ªâ€œé’¥åŒ™å­”â€çš„è§’è‰²ï¼Œé€šè¿‡è¿™ä¸ªâ€œå­”â€ï¼Œå¤§å®¶å¯ä»¥ä¾ç¨€çœ‹è§é—¨é‡Œâ€œå®è—â€çš„ä½™å…‰ï¼Œæƒ³è¦æ‰“å¼€é—¨å¯»å¾—å®è—ï¼Œå°±éœ€è¦å¤§å®¶â€äº‹å¿…èº¬äº²â€ï¼Œæ‹¿åˆ°â€œé’¥åŒ™â€æ¥æ‰“å¼€è¿™æ‰‡é—¨äº†ğŸ˜„ã€‚å½“ç„¶ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥ç»§ç»­å…³æ³¨æˆ‘çš„åç»­ä¹‹ä½œï¼Œæ¥å‘ç°æ›´å¤š MotionLayout çš„å®è—ã€‚","link":"/2019/10/19/motionlayout-part1/"},{"title":"Androidç‰ˆå¾®ä¿¡è·³ä¸€è·³å°æ¸¸æˆå¦‚ä½•åˆ©ç”¨æŠ€æœ¯æ‰‹æ®µè¾¾åˆ°é«˜åˆ†ï¼","text":"æœ¬æ–‡ä¸»è¦æ¥è®²ä¸ªä¸ªå¥½ç©çš„ä¸œè¥¿ï¼Œè¿‘æ¥å¾®ä¿¡åˆšå‡ºçš„è·³ä¸€è·³å¾®ä¿¡å°ç¨‹åºçš„æ¸¸æˆå¾ˆç«ï¼Œçœ‹åˆ°å¾ˆå¤šäººéƒ½è¾¾åˆ°äº†äºŒä¸‰ç™¾åˆ†å°±å„ç§åˆ·æœ‹å‹åœˆäº†ã€‚ æœ€ç»ˆæˆ‘ä»¬è¾¾åˆ°çš„åˆ†æ•°å´æ˜¯è¿™æ ·çš„ï¼š ä¸€å®šä¼šæœ‰äººæ‹æ‰‹å«å¥½ï¼Œâ€œé»„é‡‘å³æ‰‹â€ï¼è¯´çœŸçš„ï¼Œæˆ‘å·²ç»ä¸ç”¨å³æ‰‹å¥½å¤šå¹´ï¼Œè€Œä¸”æˆ‘ç©è¿™ä¸ªæ¸¸æˆå‹æ ¹å°±æ²¡ç”¨æ‰‹ï¼Œè€Œæ˜¯æ„å¿µï¼å“ˆå“ˆï¼Œåˆ«å–·æˆ‘ï¼Œå¼€ä¸ªç©ç¬‘è€Œå·²ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨æŠ€æœ¯æ‰‹æ®µå•¦ï¼Œä»€ä¹ˆæŠ€æœ¯ï¼Ÿpythonå–½ï½å“ˆå“ˆï¼Œä¸è¿‡ä¸æ˜¯æˆ‘å†™çš„ï¼Œæˆ‘è‡ªå·±æ˜¯åšAndroidå¼€å‘çš„ï¼Œæˆ‘å¯¹äºpythonä»æ¥æ²¡æœ‰æ¥è§¦ï¼Œåªæ˜¯æ°å¥½åœ¨è›‹å“¥å…¬ä¼—å·çœ‹åˆ°å…³äºè¿™ä¸ªæ¸¸æˆçš„æ–‡ç« ï¼Œè§‰å¾—æœ‰æ„æ€ï¼Œå°±èŠ±äº†ç‚¹æ—¶é—´è¯•ç€æäº†ä¸€ä¸‹ï¼Œæ²¡æƒ³åˆ°è¿˜è·‘æˆåŠŸäº†ï¼Œæ”¶è·ä¹ŸæŒºå¤šçš„ğŸ˜„ã€‚æœ¬æ–‡é’ˆå¯¹macç³»ç»Ÿ+Androidå…¨é¢å±æ‰‹æœºï¼Œå¦‚æƒ³äº†è§£å…¶ä»–ç³»ç»Ÿæˆ–è€…æ‰‹æœºçš„æ•™ç¨‹ï¼Œå¯ä»¥åˆ°é¡¹ç›®ä¸»é¡µæˆ–è€…issueä¸­æ¢ç´¢ä¸€ä¸‹ã€‚å¥½äº†ï¼Œä¸‹é¢ç»™å¤§å®¶çœ‹çœ‹å®ƒçš„â€œåºå±±çœŸé¢ç›®â€ã€‚ å…³äºæ¸¸æˆè„šæœ¬ï¼Œä½œè€…å·²ç»å¼€æºåœ¨äº†githubï¼Œåœ°å€åœ¨https://github.com/wangshub/wechat_jump_gameï¼Œæœ‰å…´è¶£çš„å¯ä»¥å…ˆå»çœ‹çœ‹ã€‚ä¸€èˆ¬çš„ï¼Œæ‰‹æœºå‹å·æ¯”è¾ƒè€ï¼ˆåƒAndroid4.3ä»¥ä¸‹çš„ï¼‰ï¼Œæˆ–è€…æ¯”è¾ƒæ–°ï¼ˆåƒvivox20ï¼Œå°ç±³mix2ç­‰ç­‰åˆšå‡ºçš„å…¨é¢å±æ‰‹æœºï¼‰ï¼Œå†æˆ–è€…æ¯”è¾ƒç¨€æœ‰çš„ï¼ˆåƒTCLï¼Œè”æƒ³ï¼Œè¯ºåŸºäºšç­‰ç­‰ï¼‰ï¼Œé¡ºåˆ©çš„è·‘èµ·è„šæœ¬è¿˜æ˜¯æŒºéš¾çš„ï¼Œå¤šå°‘éƒ½ä¼šæœ‰äº›é—®é¢˜ï¼Œç”±äºè„šæœ¬æ˜¯ä½œè€…å‡ ä¸ªå°æ—¶å°±å†™å¥½çš„ï¼Œå·²ç»å¾ˆå‰å®³äº†ï¼Œé€‚é…çš„è¿™äº›é—®é¢˜ä¸å¯èƒ½å…¨éƒ¨éƒ½é¢é¢å…·åˆ°ï¼Œæ¯•ç«ŸAndroidæœºå‹åƒåƒä¸‡å‘€ï¼å¸Œæœ›å¤§å®¶å¤šå¤šä½“è°…ï¼Œä½œè€…ç²¾åŠ›ä¹Ÿæ˜¯æœ‰é™ï¼Œä¸å¯èƒ½åŠæ—¶å›ç­”æ¯ä¸€ä¸ªäººçš„é—®é¢˜ï¼Œå¤§å®¶æ¯•ç«Ÿä¹Ÿæ˜¯ææŠ€æœ¯çš„ï¼Œæœ‰äº›é—®é¢˜åº”è¯¥éƒ½æœ‰èƒ½åŠ›è§£å†³çš„ï¼Œä¾‹å¦‚issueï¼Œåº¦å¨˜ç­‰ç­‰ã€‚è¿™é‡Œæˆ‘ç®€å•è¯´æ˜ä»¥ä¸‹è‡ªå·±ç”¨macå’Œvivox20å¦‚ä½•è·‘èµ·æ¥çš„ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬åˆ°ä½œè€…çš„æºç åœ°å€çœ‹çœ‹åŸç†å’ŒAndroidçš„ä½¿ç”¨æ­¥éª¤,å¦‚ä¸‹ï¼š å°†æ‰‹æœºç‚¹å‡»åˆ°ã€Šè·³ä¸€è·³ã€‹å°ç¨‹åºç•Œé¢ï¼›ç”¨ ADB å·¥å…·è·å–å½“å‰æ‰‹æœºæˆªå›¾ï¼Œå¹¶ç”¨ ADB å°†æˆªå›¾ pull ä¸Šæ¥ 12adb shell screencap -p /sdcard/autojump.pngadb pull /sdcard/autojump.png . è®¡ç®—æŒ‰å‹æ—¶é—´æ‰‹åŠ¨ç‰ˆï¼šç”¨ Matplotlib æ˜¾ç¤ºæˆªå›¾ï¼Œç”¨é¼ æ ‡ç‚¹å‡»èµ·å§‹ç‚¹å’Œç›®æ ‡ä½ç½®ï¼Œè®¡ç®—åƒç´ è·ç¦»ï¼›è‡ªåŠ¨ç‰ˆï¼šé æ£‹å­çš„é¢œè‰²æ¥è¯†åˆ«æ£‹å­ï¼Œé åº•è‰²å’Œæ–¹å—çš„è‰²å·®æ¥è¯†åˆ«æ£‹ç›˜ï¼›ç”¨ ADB å·¥å…·ç‚¹å‡»å±å¹•è“„åŠ›ä¸€è·³ï¼› 1adb shell input swipe x y x y time(ms) åŸæ¥æ˜¯åˆ©ç”¨adbæ¥è®¡ç®—å’Œæ¨¡æ‹Ÿä½ç½®çš„ï¼Œæˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªï¼Œå†æ¥çœ‹çœ‹Androidæ‰‹æœºä½¿ç”¨æ­¥éª¤ï¼š å®‰å“æ‰‹æœºæ‰“å¼€ USB è°ƒè¯•ï¼Œè®¾ç½®ã€‹å¼€å‘è€…é€‰é¡¹ã€‹USB è°ƒè¯• ç”µè„‘ä¸æ‰‹æœº USB çº¿è¿æ¥ï¼Œç¡®ä¿æ‰§è¡Œadb deviceså¯ä»¥æ‰¾åˆ°è®¾å¤‡ ID ç•Œé¢è½¬è‡³å¾®ä¿¡è·³ä¸€è·³æ¸¸æˆï¼Œç‚¹å‡»å¼€å§‹æ¸¸æˆ è¿è¡Œpython wechat_jump_auto.pyï¼Œå¦‚æœæ‰‹æœºç•Œé¢æ˜¾ç¤º USB æˆæƒï¼Œè¯·ç‚¹å‡»ç¡®è®¤ è¯·æŒ‰ç…§ä½ çš„æ‰‹æœºåˆ†è¾¨ç‡ä»./config/æ–‡ä»¶å¤¹æ‰¾åˆ°ç›¸åº”çš„é…ç½®ï¼Œæ‹·è´åˆ° *.py åŒçº§ç›®å½•./config.jsonï¼ˆå¦‚æœå±å¹•åˆ†è¾¨ç‡èƒ½æˆåŠŸæ¢æµ‹ï¼Œä¼šç›´æ¥è°ƒç”¨ config ç›®å½•çš„é…ç½®ï¼Œä¸éœ€è¦å¤åˆ¶ï¼‰ OKï¼Œæˆ‘å°±æŒ‰ç…§æ­¥éª¤ä¸€æ­¥ä¸€æ­¥æ¥ï¼š æ‰“å¼€æ‰‹æœºå¼€å‘è€…é€‰é¡¹å’Œusbè°ƒè¯•ï¼Œè¿™ä¸€æ­¥æˆ‘æƒ³ä¸éœ€è¦å¤šè¯´äº†ï¼Œå¤§å®¶åº”è¯¥éƒ½çŸ¥é“æ€ä¹ˆåšï¼› éœ€è¦ç¡®ä¿adb deviceså¯ä»¥æ‰¾åˆ°è®¾å¤‡ã€‚ æç§»åŠ¨ç«¯å¼€å‘çš„åº”è¯¥éƒ½çŸ¥é“adbå§ï¼Œä¸è¿‡å¯èƒ½æœ‰äº›äººæ²¡æœ‰æ¥è§¦è¿‡ï¼Œè¿™é‡Œå°±ç®€å•è¯´æ˜ä¸€ä¸‹å¦‚ä½•æ‰§è¡Œadbå‘½ä»¤ã€‚é¦–å…ˆéœ€è¦ä¸‹è½½adbå·¥å…·ï¼Œä¸€èˆ¬Android studioçš„sdkä¸­è‡ªå¸¦äº†ï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡å°±å¯ä»¥äº†ï¼Œæƒ³çŸ¥é“å¦‚ä½•é…ç½®ï¼Œå¯ä»¥éµå¾ªå¦‚ä¸‹æ­¥éª¤ï¼š 12345678910- æ‰“å¼€macçš„terminalç»ˆç«¯ï¼Œè¾“å…¥ cd ~/ ã€è¿›å…¥å½“å‰ç”¨æˆ·çš„homeç›®å½•ã€‘- è¾“å…¥ touch .bash_profile ã€å¦‚æœæ²¡æœ‰.bash_profileè¿™ä¸ªæ–‡ä»¶ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªè¿™ä¸ªæ–‡ä»¶ã€‘- è¾“å…¥ open .bash_profile ã€æ‰“å¼€æˆ‘ä»¬åˆ›å»ºçš„è¿™ä¸ªæ–‡ä»¶ï¼Œæ­¤æ—¶åº”è¯¥å¼¹å‡ºä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘æ¡†ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡é…ç½®ç¯å¢ƒï¼Œé‚£ä¹ˆæ–‡æœ¬ç¼–è¾‘æ¡†ä¸ºç©ºç™½ã€‘- åœ¨æ‰“å¼€çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š export ANDROID_HOME=/usr/local/opt/android-sdk export PATH=${PATH}:${ANDROID_HOME}/tools export PATH=${PATH}:${ANDROID_HOME}/platform-tools- æ³¨æ„çš„ANDROID_HOMEåé¢åº”è¯¥æ ¹æ®è‡ªå·±çš„sdkè·¯å¾„æ¥å¡«å†™ï¼Œå…¶ä½™å¯ä»¥ç›´æ¥å¤åˆ¶ã€‚è‡³äºsdkè·¯å¾„ï¼Œå¯ä»¥æ‰“å¼€Android Studioï¼Œåœ¨preference(Windowsçš„setting)ä¸­æœç´¢sdkæ¥æŸ¥çœ‹ã€‚åœ¨ç»ˆç«¯ä¸­è¾“å…¥ source .bash_profile ã€ä½¿æˆ‘ä»¬çš„æ”¹åŠ¨ç”Ÿæ•ˆã€‘- è¾“å…¥ adb ã€éªŒè¯æ˜¯å¦å®Œæˆé…ç½®ï¼Œå¦‚æœä¸æ˜¾ç¤º adb: command not foundï¼Œè¯´æ˜é…ç½®å®Œæˆ ã€‘ å¦‚æœæ²¡æœ‰ç”¨è¿‡Android studioï¼Œé‚£ä¹ˆå¯ä»¥å»ç™¾åº¦ä¸€ä¸‹å¦‚ä½•å®‰è£…ï¼Œæˆ‘ç›¸ä¿¡è¿™å¯¹äºå¤§å®¶æ¥è¯´ä¸æ˜¯ä¸€ä»¶å›°éš¾çš„äº‹ï¼Œå®‰è£…å®Œæˆååªéœ€è¦æŒ‰ç…§ä¸Šé¢è¯´çš„é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡å°±å¯ä»¥äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ‰‹æœºè¿æ¥åˆ°ç”µè„‘ï¼Œå¹¶å¼€å¯ç¬¬ä¸€æ­¥ä¸­çš„è®¾ç½®é€‰é¡¹åï¼Œåœ¨ç”µè„‘ç»ˆç«¯è¾“å…¥ï¼š 1adb devices ä¸å‡ºæ„å¤–çš„è¯ï¼Œç»ˆç«¯ä¼šå‡ºç°ç±»ä¼¼å¦‚ä¸‹å†…å®¹ï¼š 1234Last login: Mon Jan 1 20:20:11 on ttys000MoosdeMacBook-Pro:~ moos$ adb devicesList of devices attacheda619aaxx device è¿™æ ·å°±ä»£è¡¨æˆ‘ä»¬adbè®¾å¤‡è¿æ¥æˆåŠŸäº†ã€‚ æ‰“å¼€æˆ‘ä»¬çš„å¾®ä¿¡ä¸­â€œè·³ä¸€è·³â€æ¸¸æˆå°ç¨‹åºï¼Œç‚¹å‡»å¼€å§‹æ¸¸æˆï¼Œæ‰‹æœºå‡ºç°æ¸¸æˆåˆå§‹ç•Œé¢ï¼› è¦æ±‚æˆ‘ä»¬è¿è¡Œè„šæœ¬é¡¹ç›®ä¸­çš„pythonæ–‡ä»¶ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬å®‰è£…pythonäº†ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œä¸€èˆ¬macç³»ç»Ÿè‡ªå¸¦äº†pythonï¼Œæˆ‘ä»¬ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š 1python å¦‚æœå‡ºç°å¦‚ä¸‹å†…å®¹ï¼Œåˆ™è¯´æ˜æˆ‘ä»¬å·²ç»å®‰è£…è¿‡äº†ï¼š 12345MoosdeMacBook-Pro:~ moos$ pythonPython 2.7.10 (default, Jul 15 2017, 17:16:57) [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)] on darwinType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; å¦‚æœæ²¡æœ‰å®‰è£…pythonï¼Œå¯ä»¥å‚è€ƒè¯¥æ–‡ç« ï¼šhttp://blog.csdn.net/u010828718/article/details/70257622ä¸‹é¢æˆ‘ä»¬å°±éœ€è¦è¿è¡Œwechat_jump_auto.pyè¿™ä¸ªè„šæœ¬æ–‡ä»¶äº†ï¼Œè¿™ä¸ªæ˜¯è‡ªåŠ¨ç©æ¸¸æˆï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©æ‰‹åŠ¨ç©ï¼Œè¿è¡Œwechat_jump_py3.pyå³å¯ï¼Œå¦‚ä½•è¿è¡Œï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æŠŠgithubä¸Šé¢çš„é¡¹ç›®ä¸‹è½½ä¸‹æ¥ï¼Œå¹¶è¿›å…¥åˆ°è¯¥ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼ˆä»¥è‡ªåŠ¨ç‰ˆä¸ºä¾‹ï¼‰ï¼š 1python wechat_jump_auto.py è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·‘èµ·æ¥è¿™ä¸ªè„šæœ¬äº†ï¼Œä½†æ˜¯ä½ å¯èƒ½ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼š 12345Traceback (most recent call last): File &quot;wechat_jump_auto.py&quot;, line 8, in &lt;module&gt; from PIL import Image, ImageDrawImportError: No module named PILMoosdeMacBook-Pro:wechat_jump_game-master moos$ åªéœ€è¦å®‰è£…pillowï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼š 1sudo pip install Pillow è®°å¾—åŠ ä¸Šsudoï¼Œéœ€è¦è·å–ç³»ç»Ÿæƒé™ã€‚ è¿™æ ·ï¼Œåº”è¯¥åŸºæœ¬å¯ä»¥è·‘èµ·æ¥è„šæœ¬äº†ã€‚ä½†æ˜¯ï¼Œvivox20æ‰‹æœºè¿è¡Œäº†è„šæœ¬ä¹‹åï¼Œä¸€ç›´æ²¡æœ‰è‡ªåŠ¨æ¸¸æˆï¼Œåæ¥å‘ç°ï¼Œå¯èƒ½æ˜¯ä¸åŒæ‰‹æœºåˆ†è¾¨ç‡å’Œå°ºå¯¸å·®å¼‚ï¼Œå¯¼è‡´è„šæœ¬æ²¡æœ‰æ˜¯è¯†åˆ«åˆ°å¯¹åº”çš„æ¨¡æ‹ŸæŒ‰å‹çš„åæ ‡ä½ç½®ï¼Œå¯ä»¥ä¿®æ”¹ä¸€ä¸‹å¯¹åº”çš„æŒ‰å‹å‚æ•°ä¸º320ï¼Œ1210ï¼Œ720ï¼Œ910ï¼Œå¯¹åº”çš„ä¿®æ”¹ä½ç½®æ˜¯wechat_jump_auto.pyä¸­çš„å¦‚ä¸‹å‚æ•°ï¼š 1swipe['x1'], swipe['y1'], swipe['x2'], swipe['y2'] = 320, 410, 320, 410 è¯¥ä¿®æ”¹æ„è§å·²ç»è¢«ä½œè€…åˆå¹¶åˆ°ä¸»åˆ†æ”¯äº†ï¼Œæ‰“å¼€è¯¥æ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°äº†ã€‚å†è·‘ä¸€ä¸‹è¯•è¯•ï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œç¨‹åºåœ¨è¿è¡Œï¼Œä½ç½®åæ ‡ä¹Ÿåœ¨å˜åŒ–ï¼Œä½†æ¸¸æˆæ²¡æœ‰è¿›è¡Œï¼Œé‚£å¯èƒ½å°±æ˜¯æ‰‹æœºçš„é—®é¢˜äº†ï¼Œå°è¯•å¼€å¯å¼€å‘è€…è®¾ç½®ä¸­çš„usbå®‰å…¨éªŒè¯è®¾ç½®ï¼Œæˆ‘å†è·‘ï¼Œå˜¿ï¼Œå¯ä»¥äº†ï¼šè¯·å¿½ç•¥è¿™æ¸£å›¾ï¼Œvysorè¿˜æ²¡æœ‰å¾ˆå¥½çš„é€‚é…vivox20ï¼Œå¹¶ä¸æ˜¯gifçš„é—®é¢˜ğŸ˜¢ï¼Œå†çœ‹çœ‹ç»ˆç«¯çš„æ•°æ®ï¼š 1234567891011121314151617181920212223242526('scan_start_y: ', 720)(1514815959, 0, 0, 0, 0)adb shell input swipe 320 1210 720 910 200('scan_start_y: ', 670)(1514815962, 0, 0, 0, 0)adb shell input swipe 320 1210 720 910 200('scan_start_y: ', 670)(1514815966, 0, 0, 0, 0)adb shell input swipe 320 1210 720 910 200('scan_start_y: ', 820)(1514815971, 338, 1224, 788, 968)adb shell input swipe 320 1210 720 910 710('scan_start_y: ', 920)(1514815976, 697, 1203, 400, 1008)adb shell input swipe 320 1210 720 910 487('scan_start_y: ', 820)(1514815979, 320, 1275, 839, 940)adb shell input swipe 320 1210 720 910 847('scan_start_y: ', 870)(1514815984, 392, 1194, 718, 1009)adb shell input swipe 320 1210 720 910 514('scan_start_y: ', 870)(1514815987, 660, 1167, 450, 1052)adb shell input swipe 320 1210 720 910 328('scan_start_y: ', 770)... è¿™æ ·å°±æ²¡æ¯›ç—…äº†ï¼ŒåŒæ—¶ï¼Œæˆ‘è¿˜ä¿®æ”¹äº†2160x1080çš„é…ç½®å‚æ•°ï¼Œæé«˜äº†è·³è·ƒçš„å‡†ç¡®åº¦ï¼Œè¾¾åˆ°å‡ åƒåˆ†ä¸æ˜¯é—®é¢˜ï¼Œå¹¶ä¸”å·²ç»è¢«ä½œè€…åŒæ„äº†åˆå¹¶äº†ï¼Œæ— éœ€å†åšé¢å¤–ä¿®æ”¹äº†ã€‚ åœ¨å€Ÿç”¨è¯¥è„šæœ¬ä½œè€…çš„ä¸€å¥è¯ï¼š 1äº‹å®è¯æ˜ï¼Œæœºå™¨äººæ¯”äººæ›´ä¼šç©å„¿æ¸¸æˆã€‚ å¥½äº†ï¼Œå¤§å®¶æ˜¯ä¸æ˜¯å·²ç»è¿«ä¸åŠå¾…æƒ³å»åˆ·åˆ†äº†å‘¢ğŸ˜„ï¼Œä¸è¿‡åˆ†é«˜è™½å¥½ï¼Œå¯ä¸è¦â€œè´ªæ¯â€å“Ÿï¼Œä¼šæ²¡æœ‹å‹çš„ã€‚","link":"/2018/01/01/python-game/"},{"title":"å¾®ä¿¡å°æ¸¸æˆå¼€å‘ç¬”è®°ï¼ˆä¸Šï¼‰","text":"å¥½ä¹…ä¸è§ï½æœ€è¿‘ä¸¤ä¸ªæœˆä¸€ç›´åœ¨å¿™å…¬å¸çš„å¾®ä¿¡å°æ¸¸æˆé¡¹ç›®ï¼Œæ²¡æ—¶é—´æ‰“ç†åšå®¢ï¼Œå¾ˆå¤šäººç•™è¨€å¯èƒ½æ²¡æœ‰åŠæ—¶å›å¤ï¼Œæ¥ä¸‹æ¥æˆ‘å°†ç»§ç»­å’Œå¤§å®¶æ¢ç´¢Androidæ–¹é¢çš„å¥½ç©çš„ä¸œè¥¿ã€‚ä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡æ¸¸æˆå¼€å‘å’Œå‰ç«¯å¼€å‘ï¼Œä¸€å¼€å§‹ä¸Šæ‰‹å¯èƒ½è¾ƒä¸ºå›°éš¾ã€‚å¾®ä¿¡å°æ¸¸æˆä¸€èˆ¬è¦å€ŸåŠ©äºä¸»æµçš„æ¸¸æˆå¼•æ“è¿›è¡Œå¼€å‘ï¼Œå¸¸è§çš„æœ‰layaã€cocosã€egretç­‰ï¼Œè¿™é‡Œæˆ‘é€‰ç”¨äº†layaæ¸¸æˆå¼•æ“ï¼Œlayaç›¸å¯¹äºå…¶ä»–æ¸¸æˆå¼•æ“æ¥è¯´ï¼Œæ–‡æ¡£è®°å½•å¯èƒ½ä¸å¤Ÿå…¨é¢ï¼Œè€Œä¸”ç¤¾åŒºé—®é¢˜åé¦ˆæ•ˆç‡è¾ƒä½ï¼Œä½†å¥½åœ¨åŠŸèƒ½è¾ƒä¸ºé½å…¨ï¼Œéœ€è¦è‡ªå·±èŠ±æ—¶é—´ç ”ç©¶ï¼Œå¦‚æœ‰æƒ³å¼€å‘å°æ¸¸æˆçš„å¯ä»¥è‡ªè¡Œé€‰æ‹©ã€‚ æœ¬æ¥æƒ³è¦æŒ‰ç…§å¼€å‘æµç¨‹å†™ä¸€ä¸ªç³»åˆ—æ•™ç¨‹ï¼Œä½†æ˜¯å‘ç°è¿™æ ·å†™ä¸‹å»ç¯‡å¹…è¾ƒé•¿ï¼Œè€Œä¸”å¼€å‘è¿‡ç¨‹ä¸­ä¾é çš„å¤§å¤šè¿˜æ˜¯å®˜æ–¹çš„æ–‡æ¡£å’Œä¹‹å‰ç´¯ç§¯çš„å¼€å‘ç»éªŒï¼Œè¿™é‡Œè¿˜æ˜¯å…ˆæ”¾ä¸€ä¸‹æ—¥å¸¸çš„å¼€å‘æ–‡æ¡£å§ï¼Œåç»­å°†å†™æ–‡ç« è®°å½•ä¸€ä¸‹å¾®ä¿¡æ’è¡Œæ¦œç»˜åˆ¶ç­‰éš¾ç‚¹ã€‚ 2018/07/04 ä¿®æ”¹Layaboxçš„åˆå§‹åŒ–é¡µé¢ï¼š ä»¥actionScriptä¸ºä¾‹ï¼Œéœ€è¦ä¿®æ”¹actionScriptPropertiesã€asconfig.jsonã€xxx.as3projã€xxx.max.jsä¸­çš„targetå…³é”®å­—ï¼ŒtargetæŒ‡ä»£ç›®æ ‡çš„æ›¿æ¢åˆå§‹åŒ–é¡µé¢ã€‚ å°†layaé¡¹ç›®æ‰“åŒ…å‡ºå¾®ä¿¡å°æ¸¸æˆé¡¹ç›®æ—¶å‡ºé”™ï¼š é”™è¯¯ä¿¡æ¯ï¼š[ERR]|FileNotFound: /Users/moos/Documents/Emerson/EmersonGame/src/LayaUISample.jsã€‚ è§£å†³æ–¹æ¡ˆï¼šå…¨å±€æœç´¢å…³é”®è¯å¹¶åˆ é™¤è¯¥ç›¸å…³ç±»ä¿¡æ¯ 2018/07/05 layaboxç®€å•é€‚é…ï¼š è¾¹è·ä½ç½®é€‚é… leftã€rightã€topã€bottomå››ä¸ªå±æ€§åˆ†åˆ«åŸºäºçˆ¶å®¹å™¨çš„å·¦è¾¹ç¼˜ã€å³è¾¹ç¼˜ã€ä¸Šè¾¹ç¼˜ã€ä¸‹è¾¹ç¼˜ã€‚è¿™é‡Œç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œleftã€rightã€topã€bottomçš„å±æ€§æ•ˆæœæ˜¯åŸºäºçˆ¶å®¹å™¨ï¼ˆé¡µé¢ï¼‰çš„å„ä¸ªè¾¹ç¼˜ï¼Œè€Œä¸æ˜¯å±å¹•çš„å„ä¸ªè¾¹ç¼˜ã€‚çˆ¶å®¹å™¨ï¼ˆé¡µé¢ï¼‰çš„åˆ†è¾¨ç‡ä¸€å®šè¦ä¸é¡¹ç›®ä¸­Laya.init()è®¾ç½®çš„åˆ†è¾¨ç‡ç›¸åŒï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®æˆç›¸åŒï¼Œé‚£ä¹ˆå¹¶ä¸èƒ½å®ç°æ•ˆæœã€‚ è¾¹è·çš„æ‹‰ä¼¸é€‚é… é™¤äº†å±…äºæŸä¸€ä¸ªè¾¹ç¼˜çš„é€‚é…ä½œç”¨å¤–ï¼ŒåŒæ—¶è®¾ç½®leftã€rightã€topã€bottomçš„å±æ€§å€¼ï¼Œè¿˜å¯ä»¥æ ¹æ®ä¸åŒå±å¹•å¯¹ç»„ä»¶è¿›è¡Œæ‹‰ä¼¸é€‚é…ã€‚Tipsï¼šæ‹‰ä¼¸é€‚é…çš„è¾¹è·è®¾ç½®æ–¹å¼é€šå¸¸éœ€è¦ç»“åˆä¹å®«æ ¼æ¥å®ç°ã€‚ ä¸­å¿ƒä½ç½®é€‚é… ä¸­å¿ƒé€‚é…å¸¸ç”¨äºåŸºäºå±å¹•ä¸­é—´çš„æ¸¸æˆå¯åŠ¨LOGOï¼Œå¼¹å‡ºæç¤ºæ¡†ç­‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡centerXã€centerYè¿›è¡Œä½ç½®å±…ä¸­è®¾ç½®. binç›®å½•ä¸‹çš„indexæ–‡ä»¶ä¸­çš„jsæ–‡ä»¶å£°æ˜é¡ºåºå†³å®šäº†UIæ¸²æŸ“çš„é¡ºåºã€‚ 1234&lt;script src=&quot;../src/GameInfo.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;../src/Role.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;../src/BackGround.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;../src/Game.js&quot;&gt;&lt;/script&gt; layaUI.max.all.jsæ–‡ä»¶ä¸­åŠ è½½UIçš„å›¾ç‰‡èµ„æºæ˜¯binç›®å½•ä¸‹çš„å›¾é›†ã€‚æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰ç‰¹åˆ«è®¾ç½®ï¼Œåˆ›å»ºçš„UIç»„ä»¶éƒ½ä¼šè¢«æ‰“åŒ…æˆå›¾é›†å­˜å‚¨åœ¨bin/res/atlasç›®å½•ä¸‹ã€‚ 2018/07/09 UIç»„ä»¶çš„å›¾ç‰‡èµ„æºåŠ è½½å¤±è´¥çš„é—®é¢˜ï¼š æ—¥å¿—ä¿¡æ¯ï¼š 12lose skin template/StartDialog/btn_dialog_close.pnglose skin template/StartDialog/btn_start_game.png é—®é¢˜åŸå› ï¼šæ²¡æœ‰å¾…èµ„æºåŠ è½½å®Œæ¯•å°±å°†ç»„ä»¶æ·»åŠ åˆ°èˆå°äº†ã€‚è§£å†³æ–¹æ³•ï¼šåœ¨æ·»åŠ UIåˆ°èˆå°ä¹‹å‰éœ€è¦é¢„åŠ è½½UIå›¾é›†èµ„æº 12345function beginLoad(){ Laya.loader.load(&quot;res/atlas/template/HomePage.atlas&quot;, Handler.create(null, onLoaded)); // é¢„åŠ è½½å¼¹çª—çš„UIèµ„æº Laya.loader.load(&quot;res/atlas/template/StartDialog.atlas&quot;, Handler.create(null, onLoaded));} åŠ è½½dialogæ—¶å‡ºç°å´©æºƒå¼‚å¸¸ï¼š å¼‚å¸¸ä¿¡æ¯ï¼šdialog is not defined è§£å†³æ–¹æ¡ˆï¼šdialogå¹¶ä¸å±äºHomePageUI 12345678910111213141516function onSecondLevelLoad() { console.log(&quot;ç¬¬äºŒå…³å‡†å¤‡ä¸­ï½&quot;); var dialog = new StartDialogUI(); Laya.stage.addChild(dialog); dialog.popup(); dialog.title_start_dialog.font dialog.title_start_dialog.text = &quot;ç¬¬äºŒå…³&quot;; dialog.btn_start_game.on(Laya.Event.CLICK, this, onGameStart); dialog.btn_start_dialog_close.on(Laya.Event.CLICK, this, onDialogClose); function onDialogClose(){ console.log(&quot;å…³é—­å¯¹è¯æ¡†ï½&quot;); dialog.close(); } } æ–°å»ºGameSceneå¹¶æ·»åŠ åˆ°èˆå°åï¼Œå‡ºç°å¦‚ä¸‹å¼‚å¸¸ï¼š å¼‚å¸¸ä¿¡æ¯ï¼š 123456789101112131415161718192021&quot;TypeError: Cannot read property 'call' of undefined at Function.&lt;anonymous&gt;(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:130:41) at new GameScene(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/src/GameScene.js:4:19) at HomePageUI.onGameStart(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/src/HomePage.js:78:27) at EventHandler.__proto.runWith(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:724:59) at Button.__proto.event(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:499:30) at TouchManager.__proto.sendEvents(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:3340:7) at TouchManager.__proto.onMouseUp(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:3499:10) at MouseManager.__proto.onMouseUp(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:3043:18) at MouseManager.__proto.check(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:3070:13) at MouseManager.__proto.check(file:///Users/moos/Company/Emerson-AirWar/EmersonGame/bin/libs/laya.core.js:3063:15)&quot; é—®é¢˜åŸå› ï¼šcmd+ç‚¹å‡»GameSceneUIè·³è½¬ä¸åˆ°å®šä¹‰çš„åœ°æ–¹ï¼Œåº”è¯¥æ˜¯æ‰¾ä¸åˆ°GameSceneUIå®šä¹‰ï¼Œå°†ui.å»æ‰å³å¯ï¼Œä¿®æ”¹æ‰€åœ¨ç›®å½•ã€‚ 2018/07/10 å›¾é›†èµ„æºåŠ è½½å®Œæ¯•çš„å›è°ƒå‡½æ•°æ²¡æœ‰å›è°ƒé—®é¢˜ï¼š 12345//åŠ è½½å›¾é›†èµ„æºLaya.loader.load(&quot;res/atlas/war.json&quot;,Laya.Handler.create(this,this.onLoaded),null,Laya.Loader.ATLAS);function onLoaded(){console.log(&quot;å‡†å¤‡åŠ è½½èƒŒæ™¯äº†ï½&quot;);} è§£å†³æ–¹æ¡ˆï¼šéœ€è¦å°†onloadedæ–¹æ³•ç§»åˆ°Game()æ–¹æ³•çš„å†…éƒ¨ï¼Œå¦åˆ™æ— æ³•æ‰¾åˆ°onloadedæ–¹æ³•ã€‚ æ¸¸æˆè¿è¡ŒæˆåŠŸåï¼Œæ¸¸æˆé‡Œçš„è§’è‰²å›¾ç‰‡ç´ æéƒ½å‘ç”Ÿäº†ç ´ç¢å’Œæ¨¡ç³Šé—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šæ¸¸æˆä¸­çš„è§’è‰²ç´ ææ˜¯ä»¥æ‰“åŒ…å›¾é›†çš„æ–¹å¼è¢«æ¸¸æˆåŠ è½½å‡ºæ¥çš„ï¼Œåœ¨æœªçŸ¥åŸå› ä¸‹ï¼Œå›¾é›†ä¸­èµ„æºä¸ªæ•°ä»¥åŠä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¼è‡´ä¹‹å‰å›¾é›†jsonæ–‡ä»¶ä¸­ä½ç½®å‚æ•°ç­‰æ— æ•ˆï¼Œæ‰€ä»¥ï¼Œéœ€è¦å°†å›¾é›†èµ„æºå›¾ç‰‡æ›¿æ¢æˆä¹‹å‰çš„å†…å®¹ã€‚ 2018/07/12 æ‰“åŒ…assetsä¸‹çš„waræ–‡ä»¶å¤¹ä¸­çš„å›¾é›†åå¹¶æ²¡æœ‰åœ¨å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆå›¾é›†èµ„æºé—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šèµ„æºè·¯å¾„éœ€è¦é€‰æ‹©å›¾ç‰‡æ‰€åœ¨çš„ä¸Šä¸Šçº§æ–‡ä»¶å¤¹æ‰èƒ½ç”Ÿæˆã€‚ è§£å†³æ–¹æ¡ˆï¼šé€‰æ‹©assetsç›®å½•ä½œä¸ºè¦æ‰“åŒ…çš„å›¾ç‰‡èµ„æºçš„ç›®æ ‡è·¯å¾„ã€‚ åŠ è½½progressbarå¤±è´¥é—®é¢˜ï¼š æ—¥å¿—ä¿¡æ¯ï¼š 1234[warn]Retry to load: GameScene/progress.png[warn]Retry to load: GameScene/progress$bar.png[error]Failed to load: GameScene/progress.png[error]Failed to load: GameScene/progress$bar.png è§£å†³æ–¹æ¡ˆï¼šé—®é¢˜å‡ºåœ¨uiç¼–è¾‘é¡µé¢çš„progressBarçš„skinèµ„æºè·¯å¾„ä¸å…¨ï¼Œéœ€è¦åŒ…å«å…¶æ ¹è·¯å¾„ã€‚ 2018/07/16 ä½¿ç”¨å®šæ—¶å™¨æ¥å®ç°è­¦å‘Šæ•ˆæœï¼Œæ— æ³•å…³é—­å®šæ—¶å™¨é—®é¢˜ï¼š æ³¨å†Œå®šæ—¶å™¨çš„æ—¶å€™å’Œç§»é™¤å®šæ—¶å™¨æ—¶ç»‘å®šçš„å›è°ƒå‡½æ•°éœ€è¦æ˜¯åŒä¸€ä¸ªï¼š 123456789101112131415161718192021222324proto.startWarning = function(){ Laya.timer.frameLoop(10,this,onWarn); } .......function onWarn(){ this.warningTime++; if(this.warningState){ hideWarning(); }else{ showWarning(); } if(this.warningTime === 5){ console.log(&quot;è¯¥ç»“æŸè­¦å‘Šäº†ï½&quot;); Laya.timer.clear(this, onWarn); this.warningState = false; this.warning_title.visible = false; this.warning_content.visible = false; } } UIç¼–è¾‘é¡µé¢çš„å³ä¾§æ§ä»¶å±æ€§æ æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ï¼š ç‚¹å‡»çª—å£æ é€‰æ‹©é‡ç½®é¢æ¿å³å¯ å®ç°ç‚¹å‡»å¼¹çª—dialogå¤–éƒ¨ï¼Œä¸å…³é—­dialogï¼š éœ€è¦åœ¨layaå…¨å±€åˆå§‹åŒ–ä¹‹å‰è®¾ç½®ä»¥ä¸‹å±æ€§ï¼š 1UIConfig.closeDialogOnSide = false; è‡ªå®šä¹‰äº†RadioGroupåï¼Œå‘ç°radioçš„çŠ¶æ€å›¾ç‰‡èµ„æºå¹¶æ²¡æœ‰å‡ºç°ï¼š é—®é¢˜åŸå› ï¼šæ²¡æœ‰é¢„åŠ è½½dialogçš„UIèµ„æºï¼Œå¯¼è‡´å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œåœ¨é¦–é¡µé¢„åŠ è½½ä»¥ä¸‹å°±å¯ä»¥äº†ï¼š 1234 Laya.loader.load(&quot;res/atlas/template/StartDialog.atlas&quot;, Handler.create(null));Laya.loader.load(&quot;res/atlas/template/LeaveDialog.atlas&quot;, Handler.create(null));Laya.loader.load(&quot;res/atlas/template/RankDialog.atlas&quot;, Handler.create(null));Laya.loader.load(&quot;res/atlas/template/QuestionDialog.atlas&quot;, Handler.create(null)); 2018/07/19 layaè‡ªå®šä¹‰RadioGroupåï¼Œæ¯ä¸ªradioçš„iconçš„skinèµ„æºæ— æ³•åŠ è½½é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šlayaä¸­è‡ªå®šä¹‰radioGroupå¦‚æœè¦è®¾ç½®æ¯ä¸ªé€‰é¡¹çš„æ–‡å­—ä¿¡æ¯ï¼Œä¸èƒ½é€šè¿‡æŒ‡å®šradioGroupçš„labelså±æ€§æ¥å®ç°ï¼Œå¦åˆ™iconä¸ä¼šæ˜¾ç¤ºã€‚è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥é€šè¿‡è·å–radioGroupçš„æ¯ä¸€ä¸ªradioæ¥åŠ¨æ€ä¸ºå®ƒä»¬è®¾ç½®labelï¼š 1234567891011121314function completeHandler(e){ dialog.title_question_dialog.visible = false; dialog.radioGroup_question.visible = true; console.log(e); console.log(e.result.question); answer = e.result.answerIndex; console.log(answer); dialog.subtitle_question_dialog.text = e.result.question; dialog.radioGroup_question.getChildAt(0).label = e.result.choices[0].content; dialog.radioGroup_question.getChildAt(1).label = e.result.choices[1].content; dialog.radioGroup_question.getChildAt(2).label = e.result.choices[2].content; dialog.radioGroup_question.getChildAt(3).label = e.result.choices[3].content; } layaä¸­ç½‘ç»œè¯·æ±‚çš„æ­£ç¡®å§¿åŠ¿ï¼š æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå¹¶æŒ‰ç…§æ–‡æ¡£ä¸­æ•™ç¨‹æ¥ï¼Œå‘ç°ç½‘ç»œè¯·æ±‚è™½ç„¶è¿›è¡Œäº†ï¼Œä½†æ— æ³•å›è°ƒè·å–åˆ°æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š 1234567891011121314151617181920212223//ç½‘ç»œè¯·æ±‚ç­”é¢˜æ•°æ® var xhr = new Laya.HttpRequest(); xhr.http.timeout = 10000;//è®¾ç½®è¶…æ—¶æ—¶é—´ï¼› xhr.on('complete',this,completeHandler); xhr.on('error',this,errorHandler); xhr.send(&quot;http://www.wanandroid.com/tools/mockapi/4080/question&quot;,&quot;&quot;,&quot;get&quot;,&quot;json&quot;); function completeHandler(e){ dialog.title_question_dialog.visible = false; dialog.radioGroup_question.visible = true; console.log(e); console.log(e.result.question); answer = e.result.answerIndex; console.log(answer); dialog.subtitle_question_dialog.text = e.result.question; dialog.radioGroup_question.getChildAt(0).label = e.result.choices[0].content; dialog.radioGroup_question.getChildAt(1).label = e.result.choices[1].content; dialog.radioGroup_question.getChildAt(2).label = e.result.choices[2].content; dialog.radioGroup_question.getChildAt(3).label = e.result.choices[3].content; } function errorHandler(data){ console.log(&quot;ç½‘ç»œå‡ºé”™äº†å“Ÿï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ç½‘ç»œå§ï½&quot;); } 2018/07/20 layaæ¸¸æˆæ‰“åŒ…æˆå¾®ä¿¡å°æ¸¸æˆåï¼Œè¿è¡Œå¤±è´¥ï¼š é”™è¯¯ä¿¡æ¯ï¼šgameThirdScriptErrorwindow.focus is not a functionTypeError: window.focus is not a functionã€‚ é—®é¢˜åŸå› ï¼šä½¿ç”¨layaè‡ªå¸¦çš„httpRequestè¯·æ±‚ç½‘ç»œæ•°æ®åå‡ºç°è¯¥é—®é¢˜ å­å¼¹çš„å¤„ç†é€»è¾‘ï¼š è‹±é›„æˆ˜æœºå­å¼¹ Bosså­å¼¹ ç¢°æ’ç»“æœ 1 0 1 0 1 1 1 1 0 0 0 1 2018/07/26 æ¸¸æˆç»“æŸé‡æ–°å¼€å§‹æ¸¸æˆåï¼Œbossç”Ÿå‘½å€¼æ²¡æœ‰è¢«é‡ç½®çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šbossè§’è‰²å¯¹è±¡è¢«å›æ”¶ï¼Œhpå±æ€§å€¼å˜ä¸º0ï¼Œå¯¼è‡´bossç¬é—´æ­»äº¡ è§£å†³æ–¹æ¡ˆï¼š å›æ”¶æ–¹æ¡ˆï¼šå°†bosså›æ”¶åï¼Œå¯ä»¥é€šè¿‡åˆ¤æ–­å½“å‰æ˜¯å¦å­˜åœ¨bossï¼Œå¹¶ä¸”hpå€¼å°äº1æ—¶æ‰æç¤ºï¼› éå›æ”¶æ–¹æ¡ˆï¼šä¸å›æ”¶çš„è¯éœ€è¦åŠæ—¶é‡ç½®bossçš„è¡€é‡å€¼ï¼Œrestartè¿‡ç¨‹ä¸­è®¾ç½®ï¼Œå¹¶éšè—bossï¼Œå¹¶åˆ©ç”¨isCanAttackæ¥åˆ¤æ–­å½“å‰æ˜¯å¦å¯ä»¥è¢«æ”»å‡»ï¼Œéœ€è¦å¢åŠ ä¸€äº›é¢å¤–é€»è¾‘ï¼Œå› ä¸ºï¼Œbosså³ä½¿è®¾ç½®äº†visibleå±æ€§ï¼Œæ”»å‡»bossä½ç½®ï¼Œä¾æ—§ä¼šæ‰è¡€ã€‚ layaä¸­æ— æ³•æ¸²æŸ“listçš„é—®é¢˜ï¼š è§£å†³æ–¹æ¡ˆï¼šéœ€è¦ç°å°†ç›®æ ‡çš„é‚£äº›ç»„ä»¶æ‰“åŒ…æˆboxç±»å‹ï¼Œç„¶åä¸ºå…¶æŒ‡å®šrenderTypeä¸ºrenderã€‚ 1234567891011121314151617dialog.equipment_list.array = data;dialog.equipment_list.renderHandler = new Handler(this, onRender);function onRender(cell, index){ console.log(&quot;è£…å¤‡åˆ—è¡¨çš„æ¸²æŸ“å›è°ƒ&quot;); if(index &gt; data.length)return; //è·å–å½“å‰æ¸²æŸ“æ¡ç›®itemçš„æ•°æ® var equipmentData = data[index]; //æ ¹æ®å­èŠ‚ç‚¹çš„åå­—weaponï¼Œè·å–å­èŠ‚ç‚¹å¯¹è±¡ //var weaponData = cell.getChildByName(&quot;weapon&quot;); var weaponData = equipmentData.weapon; //è·å–å­æ¡ç›®å„é¡¹æ•°æ® var weaponImg = weaponData.res; var weaponName = weaponData.name; console.log(&quot;è£…å¤‡åˆ—è¡¨ä¸­æ­¦å™¨åç§°=&quot;+weaponName+&quot;,æ­¦å™¨èµ„æº=&quot;+weaponImg); } 2018/07/27 æ ¹æ®ç­”é¢˜é€»è¾‘å’Œæ‰“bossç­‰é€»è¾‘éœ€è¦ï¼Œéœ€è¦åå°è¿”å›çš„éšæœºé—®é¢˜æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334{ &quot;code&quot;:200, &quot;message&quot;:&quot;success&quot;, &quot;result&quot;:{ &quot;question&quot;:&quot;è°ƒæ•´å‹å­”æ¿æµé‡è®¡ä¸­é—´ä¸å¼€å­”çš„ä¸»è¦åŸå› æ˜¯ï¼Ÿ&quot;, &quot;answerIndex&quot;:1, &quot;choices&quot;:[ { &quot;choiceId&quot;:0, &quot;choiceHead&quot;:&quot;A&quot;, &quot;content&quot;:&quot;ä¸­é—´å¼€å­”ä¸å¥½çœ‹&quot; }, { &quot;choiceId&quot;:1, &quot;choiceHead&quot;:&quot;B&quot;, &quot;content&quot;:&quot;ä¸­é—´å¼€å­”æŠ—å¹²æ‰°èƒ½åŠ›å·®&quot; }, { &quot;choiceId&quot;:2, &quot;choiceHead&quot;:&quot;C&quot;, &quot;content&quot;:&quot;ä¸­é—´å¼€å­”ä¸åˆ©äºå®‰è£…&quot; }, { &quot;choiceId&quot;:3, &quot;choiceHead&quot;:&quot;D&quot;, &quot;content&quot;:&quot;ä»¥ä¸Šéƒ½ä¸æ­£ç¡®&quot; } ], &quot;weaponType&quot;:&quot;11&quot;, &quot;weaponName&quot;:&quot;å†…è—å­”æ¿(å˜é€å™¨)&quot;, &quot;weaponInfo&quot;:&quot;æµé‡é‡ç¨‹æ¯”å¤§äº10ï¼š1ï¼Œå››èºæ “è®¾è®¡ï¼Œå­”æ¿æ²Ÿæ§½å¯†å°å’Œå¯¹ä¸­ï¼Œå¸¦å†…æŠ›å…‰ç›´ç®¡æ®µï¼Œè€å‹900#ï¼ˆè¿‡ç¨‹è¿æ¥1500#ï¼‰ï¼Œè®¡ç®—æ ‡å‡†å…¼å®¹ASME MFC-14Må’ŒSO/TR15377&quot; } } ç­›é€‰å‡ºé‡å¤é—®é¢˜åŠå…¶å¯¹åº”çš„é‡å¤æ­¦å™¨æ•°æ®ï¼Œé˜²æ­¢listä¸­é‡å¤å±•ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/** * è·å–è£…å¤‡æ•°æ® */ function getListData(){ data = []; //æ ¹æ®å½“å‰å…³å¡æ¥åˆ¤æ–­å­˜åœ¨å“ªäº›æ­¦å™¨ levelWeaponData = []; if(currentLevel === 1){ console.log(&quot;åŠ è½½ç¬¬ä¸€å…³æ­¦å™¨æ•°æ®&quot;); levelWeaponData.push(11); levelWeaponData.push(12); }else if(currentLevel === 2){ console.log(&quot;åŠ è½½ç¬¬äºŒå…³æ­¦å™¨æ•°æ®&quot;); levelWeaponData.push(21); levelWeaponData.push(22); levelWeaponData.push(23); }else if(currentLevel === 3){ console.log(&quot;åŠ è½½ç¬¬ä¸‰å…³æ­¦å™¨æ•°æ®&quot;); levelWeaponData.push(31); levelWeaponData.push(32); levelWeaponData.push(33); } console.log(&quot;levelWeaponDataæ•°é‡ä¸º=&quot;+levelWeaponData.length); console.log(&quot;answerDataæ•°é‡ä¸º=&quot;+answerData.length); if(answerData.length &gt; 0){ for(var i = 0;i&lt;levelWeaponData.length;i++){ //æ ¹æ®å…³å¡ç­›é€‰æ•°æ®ï¼Œéœ€è¦é˜²æ­¢é‡å¤æ€§æ•°æ® console.log(&quot;å½“å‰å…³å¡ä¸­æ­¦å™¨ä»£å·ä¸º=&quot;+levelWeaponData[i]); for(var j = 0;j&lt;answerData.length;j++){ //å¦‚æœå·²è·å–çš„æ­¦å™¨é‡Œå­˜åœ¨å½“å‰å…³å¡æ­¦å™¨ä¸­ï¼Œé‚£ä¹ˆå­˜å…¥data var currentAnswer = answerData[j].weapon.code; if(currentAnswer === levelWeaponData[i]){ console.log(&quot;å½“å‰è£…å¤‡ä»£å·ä¸º=&quot;+currentAnswer); data.push(answerData[j]); //ä¸€æ—¦æŸ¥è¯¢åˆ°æ•°æ®ï¼Œå…³é—­äºŒçº§å¾ªç¯ï¼Œé˜²æ­¢æ•°æ®é‡å  break; } } } } console.log(&quot;åˆ—è¡¨æ•°æ®æ•°ç›®ä¸º=&quot;+data.length); dialog.equipment_list.array = data; dialog.equipment_list.renderHandler = new Handler(this, onRender); } 2018/07/30 é—®é¢˜é€‰é¡¹æ— æ³•é‡å¤é€‰ä¸­çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šç”±äºradiogroupé‡‡ç”¨äº†å¤ç”¨åŸåˆ™ï¼Œæ‰€ä»¥ï¼Œç¬¬äºŒæ¬¡å±•ç¤ºç­”é¢˜å¡é€‰é¡¹æ—¶ä¾æ—§ä¼šè®°å½•ä¸Šæ¬¡çš„é€‰æ‹©ã€‚ è§£å†³æ–¹æ¡ˆï¼šåªéœ€è¦åœ¨æ¯æ¬¡ç‚¹å‡»ä¸‹ä¸€é¢˜æŒ‰é’®æ—¶é‡ç½®é€‰ä¸­çŠ¶æ€å³å¯ï¼š 1dialog.radioGroup_question.selectedIndex = -1; æŠ€èƒ½æ çš„å®ç°ï¼š å¯ä»¥é€šè¿‡listviewå®ç°ï¼Œç›‘å¬æ¯ä¸ªitemçš„é€‰ä¸­çŠ¶æ€ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//æ˜¾ç¤ºå¾…ä½¿ç”¨çš„æ­¦å™¨æŠ€èƒ½åˆ—è¡¨ if(this.weaponCount &gt; 0){ this.weapon_ready_list.visible = true; this.weapon_ready_list.array = data; this.weapon_ready_list.selectEnable = true; this.weapon_ready_list.renderHandler = new Handler(this, onWeaponRender); this.weapon_ready_list.selectHandler = new Handler(this, onSelect); } /** * item çš„æ¸²æŸ“å¤„ç† * @param {*} cell * @param {*} index */ function onWeaponRender(cell,index){ console.log(&quot;æ¸²æŸ“å¾…ä½¿ç”¨æ­¦å™¨åˆ—è¡¨çš„å›è°ƒï½&quot;); if(index &gt; data.length)return; //è·å–å½“å‰æ¸²æŸ“æ¡ç›®itemçš„æ•°æ® var equipmentData = data[index]; //æ ¹æ®å­èŠ‚ç‚¹çš„åå­—weaponï¼Œè·å–å­èŠ‚ç‚¹å¯¹è±¡ var weaponData = equipmentData.weapon; //è·å–å­æ¡ç›®å„é¡¹æ•°æ® var weaponImg = weaponData.res; var weaponName = weaponData.name; console.log(&quot;è£…å¤‡åˆ—è¡¨ä¸­æ­¦å™¨åç§°=&quot;+weaponName+&quot;,æ­¦å™¨èµ„æº=&quot;+weaponImg); var icon = cell.getChildByName(&quot;icon_weapon&quot;); icon.skin = weaponImg; } /** * itemçš„ç‚¹å‡»é€‰ä¸­å¤„ç† * @param {*} index */ function onSelect(index){ console.log(&quot;å½“å‰é€‰ä¸­äº†ç¬¬&quot;+index+&quot;ä¸ªæ­¦å™¨&quot;); for(var i=0; i&lt;data.length; i++){ var cell = this.weapon_ready_list.getCell(index); var bg_weapon = cell.getChildByName(&quot;bg_weapon&quot;); if(i === index){ //è®¾ç½®é€‰ä¸­çš„çŠ¶æ€ bg_weapon.skin = &quot;template/GameScene/bg_weapon_selected.png&quot;; }else{ //è®¾ç½®æœªé€‰ä¸­çŠ¶æ€ bg_weapon.skin = &quot;template/GameScene/bg_weapon_unselected.png&quot;; } } } é‡ç½®listçš„itemçš„é€‰ä¸­çŠ¶æ€æ—¶æ¸¸æˆå´©æºƒé—®é¢˜ï¼š æ—¥å¿—ä¿¡æ¯ï¼šâ€Cannot read property â€˜getChildByNameâ€™ of nullâ€ã€‚ è§£å†³æ–¹æ¡ˆï¼šå°†è·å–indexä½ç½®çš„itemå®¹å™¨æ”¹ä¸ºè·å–ç¬¬iä½ç½®çš„ï¼š 1234567891011121314151617181920/** * itemçš„ç‚¹å‡»é€‰ä¸­å¤„ç† * @param {*} index */ function onSelect(index){ console.log(&quot;å½“å‰é€‰ä¸­äº†ç¬¬&quot;+index+&quot;ä¸ªæ­¦å™¨&quot;); for(var i=0; i&lt;data.length; i++){ var cell = this.weapon_ready_list.getCell(i); var bg_weapon_img = cell.getChildByName(&quot;bg_weapon&quot;); if(i === index){ //è®¾ç½®é€‰ä¸­çš„çŠ¶æ€ bg_weapon_img.skin = &quot;template/GameScene/bg_weapon_selected.png&quot;; }else{ //è®¾ç½®æœªé€‰ä¸­çŠ¶æ€ bg_weapon_img.skin = &quot;template/GameScene/bg_weapon_unselected.png&quot;; } } } 2018/07/31 layaè¯·æ±‚åå°çš„é—®é¢˜æ¥å£åæ— æ³•è·å–æ•°æ®ï¼š éœ€è¦åå°å¤„ç†ä¸€ä¸‹è·¨åŸŸçš„é—®é¢˜ æ’è¡Œæ¦œUIå®ç°ï¼š é€šè¿‡layaæä¾›çš„UIç»„ä»¶listæ¥å®ç°ï¼Œåˆ¤æ–­itemä½ç½®è¿›è€Œè¿›è¡Œå·®å¼‚åŒ–æ¸²æŸ“ï¼Œä»è€Œå®ç°å‰ä¸‰åçš„ç‹¬ç‰¹æ•ˆæœã€‚æ­¤å¤–ï¼Œåœ†å½¢å¤´åƒéœ€è¦é€šè¿‡maskè’™ç‰ˆæ¥è¿›è¡Œå¤„ç†ã€‚ è£…å¤‡åˆ—è¡¨åªæ¸²æŸ“ä¸€æ¬¡çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šæ²¡æœ‰è®¾ç½®repeatxå’Œrepeatyï¼Œè€Œä¸”listçš„boxè®¾ç½®çš„é«˜åº¦å¤ªå¤§ï¼Œå¯¼è‡´æ¸²æŸ“ä¸€æ¬¡ã€‚ è§£å†³æ–¹æ¡ˆï¼šè®¾ç½®repeatxå’Œrepeatyå±æ€§ï¼Œä»£è¡¨æ¨ªå‘å’Œçºµå‘åˆ—è¡¨ä¸­itemçš„æ•°é‡","link":"/2018/08/31/wechat-game-1/"},{"title":"å¾®ä¿¡å°æ¸¸æˆå¼€å‘ç¬”è®°ï¼ˆä¸‹ï¼‰","text":"ä¸Šæ¬¡æˆ‘ä»¬ä»‹ç»äº†åŸºäºlayaå®ç°å¾®ä¿¡å°æ¸¸æˆçš„æ’è¡Œæ¦œåŠŸèƒ½ï¼Œè¿‡ç¨‹ä¸­å…ä¸äº†é‡åˆ°ä¸€äº›å‘ï¼Œä¸»è¦åŒ…å«ä¸€äº›å›¾ç‰‡åŠ è½½ã€é€»è¾‘å¤„ç†ã€æ’è¡Œæ¦œç»˜åˆ¶ã€å¾®ä¿¡å¤´åƒè·¨åŸŸç­‰é—®é¢˜ï¼Œå…·ä½“å¯å‚è€ƒä¸‹é¢çš„è®°å½•æ–‡æ¡£ã€‚ 2018/08/01 è®¾ç½®layaèˆå°å…¨å±æ˜¾ç¤ºå‡ºç°æ¸¸æˆå´©æºƒé—®é¢˜ï¼š é”™è¯¯ä¿¡æ¯ï¼šStage is not defined è§£å†³æ–¹æ¡ˆï¼šå¢åŠ å‰ç¼€åŒ…åLaya1Laya.stage.scaleMode = Laya.Stage.SCALE_SHOWALL; ç¬¬äºŒä¸ªbosså‡ºç°åï¼Œbosså­å¼¹å‘ç”Ÿäº†é‡å ï¼š è§£å†³æ–¹æ¡ˆï¼šåœ¨ç”Ÿæˆæ¯ä¸ªbosså‰ç§»é™¤ä¹‹å‰çš„boss12345678910111213141516171819202122/** * æ ¹æ®å…³å¡ç”Ÿæˆboss */function generateBoss(level,grade,hp,shootType){ if(this.boss!=null){ this.boss.removeSelf(); //å›æ”¶åˆ°å¯¹è±¡æ±  Laya.Pool.recover(&quot;role&quot;,this.boss); } isLastTime = true; //åœ¨å¾ªç¯ä¸­åˆ›å»ºæ•Œäºº Laya.timer.frameLoop(1,this,onLoop); this.boss = new Role(); this.boss.init(&quot;boss&quot;+level+&quot;_&quot;+grade,1,hp,0,60 ); this.boss.shootType = shootType; this.boss.shootInterval = 800; //bosså‡ºç°ä½ç½® this.boss.pos(187, 100); this.boss.visible = true; //æ·»åŠ åˆ°èˆå°ä¸Š this.roleBox.addChild(this.boss);} ç¬¬ä¸€ä¸ªbossè¢«å‡»è´¥åï¼Œéœ€è¦æ ¹æ®ç¬¬äºŒä¸ªbossåˆ·æ–°æ”»å‡»å±æ€§å’Œä¼¤å®³å€¼ï¼š1234567891011121314function appearBoss(){ Laya.timer.clear(this, onNextBossWarning); removeEnemys(); generateBoss(currentLevel,this.bossGrade,20,1); console.log(&quot;å½“å‰é€‰ä¸­çš„æŠ€èƒ½æ˜¯&quot;+levelWeaponData[this.weapon_ready_list.selectedIndex]); if(levelWeaponData[this.weapon_ready_list.selectedIndex] != (currentLevel*10 + this.bossGrade)){ //å¦‚æœæ´¾å‡ºçš„bossä¸é€‰ä¸­çš„æ­¦å™¨å±æ€§ä¸å»åˆï¼Œé‚£ä¹ˆé™ä½ä¼¤å®³å€¼ console.log(&quot;70%ç«åŠ›ï½&quot;); upgradeBullet(false); }else{ console.log(&quot;100%ç«åŠ›ï½&quot;); upgradeBullet(true); }} 2018/08/02 layaå›¾é›†æ‰“åŒ…åï¼Œéƒ¨åˆ†å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥çš„é—®é¢˜ï¼š é”™è¯¯æ—¥å¿—ï¼š1234567[warn]Retry to load: war/war/bg_second_level.png[warn]Retry to load: war/hero_down1.png[warn]Retry to load: war/hero_down2.png[warn]Retry to load: war/hero_down3.png[warn]Retry to load: war/hero_down4.png[error]Failed to load: war/war/bg_second_level.png é—®é¢˜åŸå› ï¼šå›¾é›†æ‰“åŒ…æœ€å¤§åªå…è®¸2048x512ï¼Œè€Œæœ€ç»ˆæ‰“åŒ…åçš„å›¾ç‰‡å¤§å°è¶…å‡ºäº†èŒƒå›´ï¼Œå¯¼è‡´æ— æ³•æ˜¾ç¤ºå‡ºæ¥ã€‚ è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥åˆ†å¼€æ‰“åŒ…å›¾é›† 2018/08/03 å°†bossçš„å‡ºç°æ”¹åœ¨ç­”é¢˜ä¹‹å‰åï¼Œæˆ˜æœºæ— æ³•å‘å°„å­å¼¹æˆ–è€…ä¸€ç›´warningï¼š è§£å†³æ–¹æ¡ˆï¼šéœ€è¦ä¿®æ”¹generateBossæ–¹æ³•é€»è¾‘ï¼Œå°†ç»§ç»­æ¸¸æˆä¸bosså‡ºç°åŠŸèƒ½ä»£ç åˆ†ç¦»ï¼Œå…ˆåœ¨warningç»“æŸæ—¶ç”Ÿæˆbossï¼Œç„¶ååœ¨ç­”é¢˜ç»“æŸåè°ƒç”¨resumeæ–¹æ³•ç»§ç»­æ¸¸æˆã€‚ é€€å‡ºå½“å‰å…³å¡åï¼Œè¿›å…¥ä¸‹ä¸€å…³ï¼Œç„¶åå†é€€å‡ºï¼Œæ¸¸æˆåœºæ™¯å¡ä½ä¸è¿”å›é¦–é¡µçš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šæ²¡æœ‰åˆé€‚çš„ç§»é™¤UIèµ„æº è§£å†³æ–¹æ¡ˆï¼šå…³é—­æ¸¸æˆåœºæ™¯å‰éœ€è¦ç§»é™¤é‡Œé¢çš„èƒŒæ™¯èµ„æºã€åœºæ™¯èµ„æºä»¥åŠè§’è‰²èµ„æºï¼Œå¹¶åˆ¤æ–­é¦–é¡µUIæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨éœ€è¦å›æ”¶ï¼Œç„¶åæ–°å»ºã€‚12345678910111213function onGameLeave(){ dialog.close(); console.log(&quot;ç»“æŸæ¸¸æˆï½&quot;); removeGame(); this.removeChildren(); this.removeSelf(); if(!GameScene.homePage){ GameScene.homePage = null; } GameScene.homePage = new HomePageUI(); Laya.stage.addChild(GameScene.homePage); } 2018/08/06 ç»™ç‚¹å‡»äº‹ä»¶çš„å›è°ƒæ–¹æ³•æ·»åŠ å‚æ•°å›è°ƒï¼š123456789101112131415161718192021222324252627btn_use.on(Laya.Event.CLICK, this,onUseEquipment, [index]);....../** * listä¸­å¯¹åº”ä½ç½®çš„ä½¿ç”¨æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å¤„ç† * @param {*} index */ function onUseEquipment(index){ console.log(&quot;å½“å‰ä½¿ç”¨äº†ç¬¬&quot;+index+&quot;ä¸ªè£…å¤‡&quot;); for(var i=0; i&lt;data.length; i++){ if(i === index){ //è®¾ç½®é€‰ä¸­çš„çŠ¶æ€ console.log(&quot;å½“å‰bossçº§åˆ«-&gt;&quot;+(currentLevel*10 + this.bossGrade)+&quot;ï¼Œå½“å‰é€‰ä¸­çš„æ­¦å™¨-&gt;&quot;+levelWeaponData[index]); if((currentLevel*10 + this.bossGrade) === levelWeaponData[index]){ //ä½¿ç”¨çš„æ­¦å™¨ä¸bossæ˜¯å¯¹åº”çš„ console.log(&quot;100%ç«åŠ›ï½&quot;); upgradeBullet(true); }else{ console.log(&quot;70%ç«åŠ›ï½&quot;); upgradeBullet(false); } } }} 2018/08/07 å¼€æ”¾åŸŸæ‰“åŒ…é›†æˆåˆ°ä¸»åŸŸåï¼Œå‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š æ—¥å¿—ä¿¡æ¯ï¼š123gameSubContextThirdScriptErrorwx.getFileSystemManager is not a function;at onMessage callback functionTypeError: wx.getFileSystemManager is not a function é—®é¢˜åŸå› ï¼šå¼€æ”¾åŸŸä¸­çš„å›¾é›†èµ„æºå¹¶æ²¡æœ‰æˆåŠŸåŠ è½½ è§£å†³æ–¹æ¡ˆï¼šå¼€æ”¾åŸŸä¸­å¹¶ä¸èƒ½åŠ è½½å›¾é›†èµ„æºï¼Œå¯ä»¥ç›´æ¥åŠ è½½å›¾ç‰‡é›†1234567891011_proto.loadResource = function(){ Laya.loader.load([&quot;comp/bg_line.png&quot;,&quot;comp/ranking1.png&quot;,&quot;comp/ranking2.png&quot;, &quot;comp/ranking3.png&quot;,&quot;comp/userholder_img.png&quot;], Laya.Handler.create(null,function(){ console.log(&quot;å¼€æ”¾åŸŸèµ„æºåŠ è½½å®Œæ¯•ï½&quot;); //sample.dialog = new RankDialogUI(); sample.rankView = new RankingViewUI(); Laya.stage.addChild(sample.rankView); })); } å¼€æ”¾åŸŸä»£ç æ‰“åŒ…åˆ°å¾®ä¿¡å°æ¸¸æˆé¡¹ç›®ä¸­æ—¶æ— æ³•è¿è¡Œçš„é—®é¢˜ï¼š é”™è¯¯ä¿¡æ¯ï¼š1dispatchMessage is not defined;at onMessage callback function ReferenceError: dispatchMessage is not defined è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡_protoæ¥åˆ›å»ºæ–¹æ³•ï¼š123456789101112131415161718192021var _proto = LayaUISample.prototype; /** * å†™å…¥æ’è¡Œæ¦œæ•°æ® */ _proto.writeRankingData = function(rankingData){ //KVDataListä»£è¡¨æ’è¡Œæ•°æ®,å¯ä»¥ä¸ºå¤šä¸ª,å¤šä¸ªä»£è¡¨å¤šä¸ªæ’è¡Œ //key-æ’è¡Œç±»å‹,value-æ’è¡Œåˆ†æ•° window['wx'].setUserCloudStorage({ KVDataList: [ //{ key: 'å‡»æ€æ’è¡Œ', value: &quot;&quot; + 1 }, { key: 'åˆ†æ•°æ’è¡Œ', value: &quot;&quot; + 100 },//éœ€è¦æ”¹æˆåŠ¨æ€çš„å€¼ ], success: function (res) { console.log('setUserCloudStorage', 'success', res) }, fail: function (res) { console.log('setUserCloudStorage', 'fail') } }); } 2018/08/08 å¼€æ”¾åŸŸç»˜åˆ¶çš„æ’è¡Œæ¦œè¢«ä¸»åŸŸçš„dialogè¦†ç›–çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šå¼€æ”¾åŸŸä¸ä¸»åŸŸçš„è§†å›¾å±‚çº§ä¸ä¸€æ ·ï¼Œdialogçš„å±‚çº§è¿œè¿œå¤§äºæ™®é€šè§†å›¾å®¹å™¨ã€‚ è§£å†³æ–¹æ¡ˆï¼šdialogçš„é»˜è®¤å±‚çº§zOrderä¸º1000ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯å°†shareCanvasçš„å®¹å™¨spriteçš„å±‚çº§zOrderå¤§äº1000å³å¯ã€‚123456789101112131415161718/** * è®¾ç½®å…±äº«Canvas */function showShareCanvas(){ window['sharedCanvas'].width = rankViewWidth; window['sharedCanvas'].height = rankViewHeight; //ä¸»åŸŸæ˜¾ç¤ºå¼€æ”¾åŸŸå†…å®¹??? //window['sharedCanvas'].sharedCanvas = window['wx'].getOpenDataContext().canvas; Laya.timer.once(1000, this, function () { var sprite = new Laya.Sprite(); sprite.zOrder = 1008; sprite.pos(0, 0); var texture = new Laya.Texture(window['sharedCanvas']); texture.bitmap.alwaysChange = true;//å°ç¨‹åºä½¿ç”¨ï¼Œéå¸¸è´¹ sprite.graphics.drawTexture(texture, (screenWidth - rankViewWidth)/2, (screenHeight - rankViewHeight)/2, texture.width, texture.height); Laya.stage.addChild(sprite); });} æäº¤æ’è¡Œæ¦œæ•°æ®æ—¶å‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š é”™è¯¯ä¿¡æ¯ï¼šsetUserCloudStorage:fail invalid KVData itemã€‚ é—®é¢˜åŸå› ï¼šæäº¤æ•°æ®çš„æ ¼å¼é”™è¯¯ï¼Œkeyä¸valueéƒ½åº”è¯¥æ˜¯stringç±»å‹ å‚è€ƒï¼šhttps://developers.weixin.qq.com/minigame/dev/document/open-api/data/KVData.html 2018/08/09 å°æ¸¸æˆåˆ†äº«å¤±è´¥çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šåœ¨å¼€æ”¾åŸŸåˆ†äº«ç”¨æˆ·æ’ååï¼Œæç¤ºæ— è¯¥æ–¹æ³•ï¼Œå¼€æ”¾åŸŸå®˜æ–¹åªæä¾›äº†å‡ ä¸ªæœ‰é™çš„apiæ¥å£ï¼Œåº”è¯¥åœ¨ä¸»åŸŸå»è¯·æ±‚åˆ†äº«1234567891011121314151617181920212223242526 window['wx'].showShareMenu({ withShareTicket:false, success:function(res){ console.log(&quot;å¼€å¯è½¬å‘æˆåŠŸï½&quot;); }, fail:function(res){ console.log(&quot;å¼€å¯è½¬å‘å¤±è´¥ï½&quot;); }, complete:function(res){ } });window['wx'].onShareAppMessage(function () { // ç”¨æˆ·ç‚¹å‡»äº†â€œè½¬å‘â€æŒ‰é’® return { title: 'æˆ‘åœ¨é£æœºå¤§æˆ˜æ¸¸æˆä¸­æ’ååˆä¸Šå‡äº†,å¿«æ¥æŒ‘æˆ˜æˆ‘å§ï½' }})window['wx'].shareAppMessage({ title: 'æˆ‘åœ¨é£æœºå¤§æˆ˜æ¸¸æˆä¸­æ’ååˆä¸Šå‡äº†,å¿«æ¥æŒ‘æˆ˜æˆ‘å§ï½', imageUrl: canvas.toTempFilePathSync({ destWidth: 500, destHeight: 400 })}); æäº¤æ’è¡Œæ¦œåˆ†æ•°ï¼š12345678910111213141516171819202122232425262728293031323334/** * å‘å¼€æ”¾åŸŸå‘é€æ¶ˆæ¯ï¼Œå¹¶æ¥æ”¶å¼€æ”¾åŸŸè¿”å›è¿‡æ¥çš„æ•°æ®ï¼Œ * å¯æ ¹æ®å‘é€å‚æ•°å’Œæ¥æ”¶æ•°æ®åœ¨ä¸»åŸŸè¿™è¾¹è¿›è¡Œä¸‹æ­¥å¤„ç† * @param message * @param caller * @param callback */function wxPostMessage(message, caller, callback){ window['wx'].postMessage(message); Laya.timer.once(300, this, function (){ //å›è°ƒå¤„ç† if (caller == null || caller == undefined) { callback(message); } else { caller.callback(message); } });}/** * æäº¤åˆ†æ•°åˆ°å¾®ä¿¡æœåŠ¡å™¨ */function postScoreToWXServer(){ wxPostMessage({ command: 2, text: &quot;æäº¤ç©å®¶åˆ†æ•°&quot;, rankingData: { fightScore:this.score*scoreFactor, fightTime:new Date().getTime() } }, null, function (message) { console.log(&quot;æäº¤åˆ†æ•°çš„å›è°ƒ&quot;); });} 2018/08/10 è°ƒå–ç”¨æˆ·å¥½å‹æ’è¡Œæ•°æ®å¹¶æ’åºæ•´åˆåï¼Œå¾—åˆ°çš„nickNameä¸ºundefineï¼š é—®é¢˜åŸå› ï¼šè·å–å¥½å‹æ’è¡Œæ¦œçš„æ•°æ®ä¸­å½“å‰ç™»å½•ç”¨æˆ·çš„æ˜µç§°æ˜¯ç©ºå€¼ è§£å†³æ–¹æ¡ˆï¼šå…ˆé€šè¿‡getUserInfoè·å–å½“å‰ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åé€šè¿‡avatarUrlå»æŸ¥æ‰¾å¥½å‹æ’è¡Œæ¦œä¸­æ•°æ®ï¼Œå¦‚æœç›¸åŒï¼Œè¯´æ˜ä¸ºåŒä¸€ä¸ªç”¨æˆ·ï¼Œå°†å½“å‰ç”¨æˆ·æ˜µç§°å¤åˆ¶ç»™å¥½å‹æ’è¡Œæ¦œä¸­å½“å‰ç”¨æˆ·çš„æ˜µç§°ã€‚ ç»Ÿè®¡ä¸‰å…³åˆ†æ•°ï¼Œå¹¶å¯¹å®ƒä»¬çš„æ€»åˆ†è¿›è¡Œæ’åºçš„è§£å†³æ€è·¯ï¼š å¯ä»¥é€šè¿‡å¾®ä¿¡æä¾›çš„æ’è¡Œæ¦œåˆ†ç±»ç»Ÿè®¡åŠŸèƒ½ï¼Œè¿™æ ·å°±æ— éœ€ç†ä¼šç©å®¶æ˜¯ä¸€æ¬¡æ€§é€šå…³è¿˜æ˜¯å¤šæ¬¡é€‰æ‹©å…³å¡é€šå…³çš„é—®é¢˜äº†ã€‚åªè¦å°†ç©å®¶ç©æ¯ä¸€å…³é€šè¿‡æ—¶çš„åˆ†æ•°é€šè¿‡key(å…³å¡)ã€value(åˆ†å€¼)é”®å€¼å¯¹å½¢å¼å­˜å‚¨ï¼Œç„¶åæ¯æ¬¡é‡å¤é€‰æ‹©éƒ½ä¼šåˆ·æ–°å…³å¡çš„åˆ†å€¼ã€‚è€Œè·å–å¥½å‹æ’è¡Œæ¦œæ•°æ®æ—¶ï¼Œéœ€è¦å°†åˆ†æ•°å…ˆè½¬åŒ–ä¸ºnumberï¼Œç„¶åç´¯åŠ è¿›è¡Œæ’åºï¼Œå¹¶å±•ç¤ºå³å¯ã€‚ å…³é—­æ’è¡Œæ¦œåï¼Œå†æ¬¡æ‰“å¼€ï¼Œæ•°æ®æ²¡äº†æˆ–è€…å‡ºç°æ··ä¹±çš„é—®é¢˜ï¼š è§£å†³æ–¹æ¡ˆï¼šéœ€è¦é‡æ–°æ¸…ç©ºé‡ç½®æ•°æ®ï¼Œå¹¶æ¸²æŸ“listï¼š123456789101112/** * å…³é—­æ’è¡Œæ¦œ */ _proto.closeRankingDialog = function(){ //dialog.close(); console.log(&quot;å…³é—­æ’è¡Œæ¦œï½&quot;); sortData = []; lastRenderIndex = -1; sample.rankView.removeChildren(); sample.rankView = null; } å…³äºå¦‚ä½•åœ¨layaæ¸¸æˆå¼•æ“ä¸­æ˜¾ç¤ºå¤–éƒ¨ç½‘é¡µçš„é—®é¢˜ï¼š æ–¹æ³•ä¸€ï¼šé€šè¿‡è®¾ç½®hrefæ¥æ·»åŠ å¤–éƒ¨ç½‘é¡µèµ„æºã€‚ä½†è¿™ç§æ–¹æ³•æ— æ³•å…³é—­å’Œè®¾ç½®å¤–éƒ¨ç½‘é¡µçš„ä½ç½®å’Œå¤§å°ã€‚1Laya.Browser.window.location.href = &quot;http://www.baidu.com&quot;; æ–¹æ³•äºŒï¼šé€šè¿‡iframeæ¥æ·»åŠ å¤–éƒ¨ç½‘é¡µå¹¶æ§åˆ¶å…¶ä½ç½®ã€å¤§å°ä»¥åŠç§»é™¤ï¼š12345678910111213 var iframe = Laya.Browser.document.createElement(&quot;iframe&quot;); iframe.style.position =&quot;absolute&quot;;//è®¾ç½®å¸ƒå±€å®šä½ã€‚è¿™ä¸ªä¸èƒ½å°‘ã€‚ iframe.style.zIndex = 1006;//è®¾ç½®å±‚çº§ iframe.style.left = &quot;36px&quot;; iframe.style.top = &quot;136px&quot;;iframe.width = 180;iframe.height = 220; iframe.src = &quot;http://ask.layabox.com/&quot;; Laya.Browser.document.body.appendChild(iframe);function onHelpClose(){ Laya.Browser.document.body.removeChild(iframe);; dialog.close(); } 2018/08/13 æ— æ³•åŠ è½½å¾®ä¿¡ç”¨æˆ·å¤´åƒçš„é—®é¢˜ï¼š é”™è¯¯ä¿¡æ¯ï¼š123gameThirdScriptErrormodule &quot;code.js&quot; is not definedError: module &quot;code.js&quot; is not defined è§£å†³æ–¹æ¡ˆï¼šåº”è¯¥æ˜¯å˜é‡çš„ä½œç”¨åŸŸä¸åŒé€ æˆçš„ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªå¤–éƒ¨çš„å…¨å±€å˜é‡ï¼Œå¹¶å°†this.userLogoImageèµ‹å€¼ç»™å®ƒï¼Œç„¶ååœ¨è·å–å®Œæ¯•å¾®ä¿¡å¤´åƒä¿¡æ¯ååŠ è½½è¯¥å…¨å±€å˜é‡å³å¯ã€‚ å…³äºå¦‚ä½•è®©layaçš„labelå†…å®¹è¶…å‡ºç©ºé—´å¤§å°åè‡ªåŠ¨æ»šåŠ¨çš„é—®é¢˜ï¼š è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥é€šè¿‡Panelç»„ä»¶æ¥åŒ…è£¹labelæ§ä»¶ï¼Œè®©å…¶è¾¾åˆ°æ»šåŠ¨æ•ˆæœã€‚ ä½¿ç”¨panelç»„ä»¶åï¼Œé‡Œé¢çš„labelå†…å®¹è¶…è¿‡æœ¬èº«å¤§å°åæ— æ³•æ»šåŠ¨çš„é—®é¢˜ï¼š è§£å†³æ–¹æ¡ˆï¼španelç»„ä»¶åªæ˜¯è®©å…¶å†…éƒ¨çš„æ§ä»¶åœ¨å¤§å°è¶…è¿‡å…¶å®¹å™¨(å³panel)çš„æ—¶å€™ï¼Œå°½é‡è¾¾åˆ°æ»‘åŠ¨æ˜¾ç¤ºå…¨éƒ¨ä¿¡æ¯ï¼Œæ‰€ä»¥ï¼Œéœ€è¦å°†é‡Œé¢çš„labelæ§ä»¶é«˜åº¦è®¾ç½®å°½é‡å¤§ï¼Œä»¥ä¿è¯æ–‡å­—å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ã€‚ æ‰“åŒ…æˆå¾®ä¿¡å°æ¸¸æˆååŒ…å¤ªå¤§æ— æ³•é¢„è§ˆä¸Šä¼ çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šå¾®ä¿¡é™åˆ¶ä¸Šä¼ çš„ä»£ç åŒ…ä¸å¾—è¶…è¿‡4mã€‚ è§£å†³æ–¹æ¡ˆï¼š å‹ç¼©å›¾ç‰‡èµ„æº å»é™¤indexä¸­æ²¡æœ‰ä½¿ç”¨åˆ°çš„library åˆ é™¤å›¾é›†æ‰“åŒ…ç”Ÿæˆçš„å¤šä½™çš„æ–‡ä»¶ å¤´åƒè®¾ç½®çš„é®ç½©æ— æ•ˆçš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šä¸ºäº†é™ä½åŒ…å¤§å°ï¼Œä¸å°å¿ƒå°†webglä»£ç åº“æ³¨é‡Šäº†ï¼Œå¯¼è‡´maské®ç½©æ— æ³•æ¸²æŸ“æˆåŠŸ 2018/08/14 iosæ‰‹æœºä¸­æ— æ³•æ’­æ”¾æ¸¸æˆå£°éŸ³çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šlayaå¼•æ“å†…éƒ¨çš„æ–¹æ³•æ’­æ”¾éŸ³é¢‘åªå¯¹Androidæ‰‹æœºæœ‰æ•ˆï¼Œå¯¹iosçš„æœºå‹æ²¡æœ‰æ•ˆæœ è§£å†³æ–¹æ¡ˆï¼šéœ€è¦å€ŸåŠ©äºå¾®ä¿¡è‡ªå¸¦çš„æ¥å£æ¥æ’­æ”¾éŸ³é¢‘1234var audio = wx.createInnerAudioContext()audio.src = &quot;res/sound/game_over.mp3&quot; // src å¯ä»¥è®¾ç½® http(s) audio.obeyMuteSwitch = falseaudio.play(); è°ƒè¯•æ¨¡å¼ä¸‹å¯ä»¥æ­£å¸¸æ˜¾ç¤ºç”¨æˆ·çš„å¤´åƒï¼Œä½†åœ¨éè°ƒè¯•æ¨¡å¼ä¸‹æ— æ³•æ˜¾ç¤ºç”¨æˆ·å¤´åƒé—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šå¾®ä¿¡ç”¨æˆ·æˆæƒæ–¹æ³•å¤±æ•ˆå¼•èµ·çš„ è§£å†³æ–¹æ¡ˆï¼š æ’è¡Œæ¦œç©å®¶æ˜µç§°ä¸æ˜¾ç¤ºé—®é¢˜ä»¥åŠæ’åºé”™ä¹±é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šæ²¡æœ‰æ­£ç¡®å¤åˆ¶å¥½å‹æ’è¡Œæ¦œçš„æ•°æ®ï¼Œå¤´åƒé“¾æ¥ã€åˆ†æ•°ç­‰éƒ½å¯ä»¥è·å–åˆ°ï¼Œä½†æ˜¯ååæ˜µç§°è·å–ä¸ºundefinedï¼Œæ’è¡Œæ¦œæ’åºæ–¹å¼ä¹Ÿæœ‰é—®é¢˜ã€‚ è§£å†³æ–¹æ¡ˆï¼šç”±äºç›´æ¥æ‹¿åˆ°å¾®ä¿¡è¿”å›çš„æ’è¡Œæ¦œæ•°æ®ä¸­ç”¨æˆ·æ˜µç§°æ˜¯å­˜åœ¨çš„ï¼Œè€Œé€šè¿‡å˜é‡èµ‹å€¼è·å–åä¾¿ä¸ºundefinedäº†ï¼Œå¯ä»¥æ‹¿åˆ°åŸå§‹æ•°æ®res.data[i].nicknameï¼Œç„¶åå¤åˆ¶ç»™å˜é‡currentPlayerï¼Œå†ä¾¿éå†æ·»åŠ åˆ°æ•°ç»„é›†åˆã€‚æ’åºå¯ä»¥é€šè¿‡sortæ–¹æ³•ï¼Œé€šè¿‡æ¯”è¾ƒç›®æ ‡é›†åˆä¸­çš„ä¸¤ä¸ªä»»æ„å¯¹è±¡çš„åˆ†å€¼ï¼Œä»å¤§åˆ°å°æ’åˆ—ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859//å–å‡ºæ‰€æœ‰å¥½å‹æ•°æ® window['wx'].getFriendCloudStorage({ keyList: [ //'å‡»æ€æ’è¡Œ', 'ç¬¬1å…³', 'ç¬¬2å…³', 'ç¬¬3å…³' ], success: res =&gt; { console.log(&quot;wx.getFriendCloudStorage success&quot;, res); let data = res.data; for (let i = 0; i &lt; data.length; i++) { var playerInfo = data[i]; var currentPlayer = res.data[i].nickname; console.log(&quot;å½“å‰æ’è¡Œç©å®¶æ˜µç§°ä¸º=&gt;&quot;+res.data[i].nickname); var kvList = playerInfo.KVDataList; var scoreSum = 0; if(kvList.length&gt;0){ for(var j = 0;j&lt;kvList.length;j++){ if(kvList[j].key != null){ //å°†valueè½¬åŒ–ä¸ºintå†ç´¯åŠ  scoreSum+=Number(kvList[j].value); } } } if (data[i].avatarUrl == userData.avatarUrl) { //è·å–ç¾¤å¥½å‹çš„æ—¶å€™,æ²¡æœ‰è‡ªå·±çš„åå­—?? data[i].nickName = userData.nickName; myRanking = i+1; console.log(&quot;æ­¤IDä¸ºè‡ªå·±,å½“å‰æ’åç¬¬&quot;+myRanking); } //å¡«å……æ€»åˆ†ä¿¡æ¯ sortData.push({ nickName: currentPlayer, avatarUrl: data[i].avatarUrl, totalScore: scoreSum }); } sortData.sort((a, b) =&gt; { var score1 = Number(a.totalScore); var score2 = Number(b.totalScore); if (score1 &gt; score2) { return -1; }else if(score1 &lt; score2){ return 1; }else{ return 0; } }); showRankingDialog(); }, fail: res =&gt; { console.log(&quot;æ‹‰å–å¥½å‹ä¿¡æ¯å¤±è´¥&quot;, res); }, }); ä¸‰å¼ èƒŒæ™¯å›¾æ‰“åŒ…å›¾é›†åï¼Œæœ‰ä¸€å¼ æ— æ³•æ˜¾ç¤ºå‡ºæ¥çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šå›¾é›†æ‰“åŒ…çš„å›¾ç‰‡è¶…è¿‡äº†æœ€å¤§é™åˆ¶ è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥ä¸æ‰“åŒ…å›¾ç‰‡ï¼Œç›´æ¥åœ¨binä¸­ä½¿ç”¨ 2018/08/15 layaç»˜åˆ¶çš„å¥½å‹æ’è¡Œæ¦œåœ¨å¾®ä¿¡å¼€å‘å·¥å…·æ— æ³•æ»‘åŠ¨çš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šä¸»åŸŸå’Œå¼€æ”¾åŸŸçš„æ’è¡Œæ¦œçš„ä½ç½®åæ ‡çŸ©é˜µä¸åŒæ­¥é€ æˆçš„ è§£å†³æ–¹æ¡ˆï¼šéœ€è¦å°†ä¸»åŸŸå’Œå¼€æ”¾åŸŸçš„æ’è¡Œæ¦œå¯¹åº”ä½ç½®åæ ‡çŸ©é˜µåŒæ­¥123456789101112131415161718192021222324252627282930313233ä¸»åŸŸä»£ç ï¼š// è§£å†³æ˜¾ç¤ºå¯¹è±¡å’Œé¼ æ ‡é”™ä½è€Œå¯¼è‡´çš„æ’è¡Œæ¦œæ»‘åŠ¨æ— æ•ˆé—®é¢˜ var globalPosition = dialog.ranking_list.localToGlobal(new Laya.Point()); var originMatrix = Laya.stage._canvasTransform; var mat = new Laya.Matrix(originMatrix.a, 0, 0, originMatrix.d, globalPosition.x * originMatrix.a, globalPosition.y * originMatrix.d); //var mat = new Laya.Matrix(Laya.Browser.clientWidth/Laya.stage.width, 0, 0, Laya.Browser.clientHeight/Laya.stage.height); mat.translate(globalPosition.x * mat.a, globalPosition.y * mat.d); wxPostMessage({ command: 0, text: &quot;è®¾ç½®å¼€æ”¾åŸŸcanvaså¤§å°&quot;, canvasData: { width: rankViewWidth * mat.a, height: rankViewHeight * mat.d, matrix: mat //width:rankViewWidth, height:rankViewHeight, matrix: Laya.stage._canvasTransform }, isLoad: false }, null, function (message) { console.log(&quot;å†æ¬¡å¾€å¼€æ”¾åŸŸå‘è¯·æ±‚&quot;); window['wx'].postMessage({ command: 1, text: 'å¼€æ”¾åŸŸåŠ è½½èµ„æº', }); }); å¼€æ”¾åŸŸä»£ç ï¼š var openMatrix = new Laya.Matrix(); openMatrix.a = mainMatrix.a; openMatrix.b = mainMatrix.b; openMatrix.c = mainMatrix.c; openMatrix.d = mainMatrix.d; openMatrix.tx = mainMatrix.tx; openMatrix.ty = mainMatrix.ty; //é‡ç½®çŸ©é˜µ Laya.stage._canvasTransform = openMatrix; ä¸»åŸŸä¿®æ”¹äº†åæ ‡çŸ©é˜µçš„åŒæ­¥ä»£ç åï¼Œå°æ¸¸æˆæ’è¡Œæ¦œæ— æ³•æ˜¾ç¤ºï¼š é”™è¯¯ä¿¡æ¯ï¼š123gameSubContextThirdScriptErrorCannot read property 'ranking_list' of undefined;at api getFriendCloudStorage success callback functionTypeError: Cannot read property 'ranking_list' of undefined é—®é¢˜åŸå› ï¼šlayaå¹³å°è‡ªèº«é—®é¢˜ï¼Œåªæ˜¯å­˜åœ¨ä»¥ä¸‹ä»£ç ï¼Œå¼€æ”¾åŸŸçš„æ’è¡Œæ¦œä¾¿æ— æ³•ç»˜åˆ¶ï¼š1234567// è§£å†³æ˜¾ç¤ºå¯¹è±¡å’Œé¼ æ ‡é”™ä½è€Œå¯¼è‡´çš„æ’è¡Œæ¦œæ»‘åŠ¨æ— æ•ˆé—®é¢˜ ...... var mat = new Laya.Matrix(Laya.Browser.clientWidth/Laya.stage.width, 0, 0, Laya.Browser.clientHeight/Laya.stage.height); mat.translate(globalPosition.x * mat.a, globalPosition.y * mat.d); ...... 2018/08/21 å°†æ¸¸æˆå‘å¸ƒåˆ°å¾®ä¿¡å¹³å°åï¼Œå¾®ä¿¡å¤´åƒæ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ï¼š é—®é¢˜åŸå› ï¼šå¾®ä¿¡å¤´åƒurlè·¨åŸŸäº† è§£å†³æ–¹æ¡ˆï¼šè·å–åˆ°å¾®ä¿¡å¤´åƒåœ°å€åï¼Œéœ€è¦å°†å…¶ä¼ åˆ°æœåŠ¡å™¨ï¼Œè®©æœåŠ¡å™¨å¤åˆ¶ä¸€ä»½ç”Ÿæˆè‡ªå·±çš„æœåŠ¡å™¨å›¾ç‰‡url","link":"/2018/09/11/wechat-game-2/"},{"title":"åŸºäºLayaæ¸¸æˆå¼•æ“å®ç°å¾®ä¿¡å°æ¸¸æˆæ’è¡Œæ¦œ","text":"æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¾®ä¿¡å°æ¸¸æˆå’Œå°ç¨‹åºç›®å‰é£å¤´åè¶³ï¼Œå¾ˆå¤šå…¬å¸éƒ½é€æ¸å¢åŠ äº†ç›¸å…³ä¸šåŠ¡çº¿æ¥è¿…é€Ÿæ¨å¹¿è‡ªå·±çš„äº§å“å’ŒæŠ¢å ç”¨æˆ·ç¾¤ã€‚è¯´åˆ°å¾®ä¿¡å°æ¸¸æˆï¼Œå°±ä¸å¾—ä¸æåˆ°æ’è¡Œæ¦œè¿™ä¸ªåŠŸèƒ½ï¼Œå°±ç›®å‰æ¸¸æˆè¡Œä¸šï¼Œä¼¼ä¹éƒ½ç¦»ä¸å¼€æ’è¡Œæ¦œè¿™ä¸ªé‡è¦åŠŸèƒ½ï¼Œç”¨æˆ·å¾ˆå¤§ä¸€éƒ¨åˆ†ç•™å­˜éƒ½æ˜¯ä¾ä»—è¿™ä¸ªçœ‹ä¼¼ä¸èµ·çœ¼çš„æ¨¡å—ã€‚é‚£ä¹ˆï¼Œå¾®ä¿¡å°æ¸¸æˆä¸­å…·ä½“è¯¥å¦‚ä½•å€ŸåŠ©layaå¼•æ“å®ç°æ’è¡Œæ¦œè¿™ä¸ªåŠŸèƒ½å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æœ€ç»ˆçš„æ•ˆæœå›¾ï¼š æŒ‰ç…§å¾®ä¿¡å®˜æ–¹çš„è¯´æ³•ï¼Œå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨å¾®ä¿¡å®˜æ–¹æä¾›çš„å¥½å‹å…³ç³»é“¾çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ç›´æ¥åœ¨é¡¹ç›®ä¸­ç»˜åˆ¶æ’è¡Œæ¦œï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©äºå¼€æ”¾åŸŸæ¥ç»˜åˆ¶æ’è¡Œæ¦œï¼š â€‹ å¦‚æœæƒ³è¦å±•ç¤ºé€šè¿‡å…³ç³»é“¾ API è·å–åˆ°çš„ç”¨æˆ·æ•°æ®ï¼Œå¦‚ç»˜åˆ¶æ’è¡Œæ¦œç­‰ä¸šåŠ¡åœºæ™¯ï¼Œéœ€è¦å°†æ’è¡Œæ¦œç»˜åˆ¶åˆ° sharedCanvas ä¸Šï¼Œå†åœ¨ä¸»åŸŸå°† sharedCanvas æ¸²æŸ“ä¸Šå±ã€‚ç®€å•æ¥è¯´ï¼ŒsharedCanvas æ˜¯ä¸»åŸŸå’Œå¼€æ”¾æ•°æ®åŸŸéƒ½å¯ä»¥è®¿é—®çš„ä¸€ä¸ªç¦»å±ç”»å¸ƒã€‚åœ¨å¼€æ”¾æ•°æ®åŸŸè°ƒç”¨ wx.getSharedCanvas() å°†è¿”å› sharedCanvasã€‚æ›´å¤šç›¸å…³è¯¦æƒ…å¯ä»¥å»çœ‹çœ‹å®˜ç½‘çš„ä»‹ç»ï¼šhttps://mp.weixin.qq.com/debug/wxagame/dev/tutorial/open-ability/open-data.html é‚£ä¹ˆæˆ‘ä»¬æ¥å®é™…åŠ¨æ‰‹æ“ä½œä¸€ä¸‹å§ã€‚ ä¸»åŸŸç»˜åˆ¶é€šè¿‡æ•ˆæœå¯ä»¥çœ‹å‡ºæ¥ï¼Œæˆ‘ä»¬æ’è¡Œæ¦œæ˜¯ä¸€ä¸ªå¼¹çª—å½¢å¼å±•ç¤ºçš„ï¼Œç”±äºå¼€æ”¾åŸŸåªè´Ÿè´£æ’è¡Œæ¦œUIç»˜åˆ¶ï¼Œæ‰€ä»¥ï¼Œé™¤æ­¤ä»¥å¤–çš„UIä»¥åŠäº¤äº’æˆ‘ä»¬éœ€è¦åœ¨ä¸»åŸŸç»˜åˆ¶å’Œå¤„ç†ã€‚å› æ­¤ï¼Œè¿™é‡Œçš„å¼¹çª— dialog éœ€è¦åœ¨ä¸»åŸŸç»˜åˆ¶ï¼Œç„¶åå°†å¯¹åº”çš„æ’è¡Œæ¦œéœ€è¦æ˜¾ç¤ºçš„ä½ç½®ä¿¡æ¯å’Œé•¿å®½æ˜ å°„åˆ°å¼€æ”¾åŸŸï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123 /** * æ˜¾ç¤ºæ’è¡Œæ¦œæ•°æ® */ function onRankInfoLoad(){ console.log(&quot;æŸ¥çœ‹æ’è¡Œæ¦œï½&quot;); var dialog = new RankDialogUI(); showShareCanvas(); // è§£å†³æ˜¾ç¤ºå¯¹è±¡å’Œé¼ æ ‡é”™ä½è€Œå¯¼è‡´çš„æ’è¡Œæ¦œæ»‘åŠ¨æ— æ•ˆé—®é¢˜ var globalPosition = dialog.ranking_list.localToGlobal(new Laya.Point()); var originMatrix = Laya.stage._canvasTransform; var mat = new Laya.Matrix(originMatrix.a, 0, 0, originMatrix.d, globalPosition.x * originMatrix.a, globalPosition.y * originMatrix.d); wxPostMessage({ command: 0, text: &quot;è®¾ç½®å¼€æ”¾åŸŸcanvaså¤§å°&quot;, canvasData: { width: rankViewWidth * mat.a, height: rankViewHeight * mat.d, matrix: mat }, isLoad: false }, null, function (message) { console.log(&quot;å†æ¬¡å¾€å¼€æ”¾åŸŸå‘è¯·æ±‚&quot;); window['wx'].postMessage({ command: 1, text: 'å¼€æ”¾åŸŸåŠ è½½èµ„æº', }); }); Laya.stage.addChild(dialog); dialog.ranking_list.visible = false; dialog.popup(); Laya.timer.once(400,this,function(){ wxPostMessage({ command: 3, text: &quot;è·å–æ’è¡Œæ¦œæ•°æ®ï½&quot; }, null, function (message) { console.log(&quot;è·å–æ’è¡Œæ¦œçš„å›è°ƒï½&quot;); }); }); dialog.btn_rank_dialog_share.on(Laya.Event.CLICK, this, onGameRankShare); dialog.btn_rank_dialog_back.on(Laya.Event.CLICK, this, onDialogClose); function onDialogClose(){ wxPostMessage({ command: 4, text: &quot;å…³é—­æ’è¡Œæ¦œï½&quot; }, null, function (message) { console.log(&quot;å…³é—­æ’è¡Œæ¦œçš„å›è°ƒï½&quot;); }); dialog.close(); } function onGameRankShare(){ console.log(&quot;åˆ†äº«æ’è¡Œæ¦œï½&quot;); window['wx'].showShareMenu({ withShareTicket:false, success:function(res){ console.log(&quot;å¼€å¯è½¬å‘æˆåŠŸï½&quot;); }, fail:function(res){ console.log(&quot;å¼€å¯è½¬å‘å¤±è´¥ï½&quot;); }, complete:function(res){ } }); window['wx'].onShareAppMessage(function () { return { title: 'æˆ‘åœ¨é£æœºå¤§æˆ˜æ¸¸æˆä¸­æ’ååˆä¸Šå‡äº†,å¿«æ¥æŒ‘æˆ˜æˆ‘å§ï½' } }) window['wx'].shareAppMessage({ title: 'æˆ‘åœ¨é£æœºå¤§æˆ˜æ¸¸æˆä¸­æ’ååˆä¸Šå‡äº†,å¿«æ¥æŒ‘æˆ˜æˆ‘å§ï½', imageUrl: canvas.toTempFilePathSync({ x: (screenWidth - rankViewWidth)/2 - 10, y: (screenHeight - rankViewHeight)/2+80, width: (rankViewWidth - 30)*4, height: (rankViewHeight - 40)*4, destWidth: 500, destHeight: 600 }) }); } } /** * è®¾ç½®å…±äº«Canvas */ function showShareCanvas(){ window['sharedCanvas'].width = rankViewWidth; window['sharedCanvas'].height = rankViewHeight; //ä¸»åŸŸæ˜¾ç¤ºå¼€æ”¾åŸŸå†…å®¹??? //window['sharedCanvas'].sharedCanvas = window['wx'].getOpenDataContext().canvas; Laya.timer.once(1000, this, function () { var sprite = new Laya.Sprite(); sprite.zOrder = 1008; sprite.pos(0, 0); var texture = new Laya.Texture(window['sharedCanvas']); texture.bitmap.alwaysChange = true;//å°ç¨‹åºä½¿ç”¨ï¼Œéå¸¸è´¹ sprite.graphics.drawTexture(texture, (screenWidth - rankViewWidth)/2, (screenHeight - rankViewHeight)/2, texture.width, texture.height); Laya.stage.addChild(sprite); }); }/** * å‘å¼€æ”¾åŸŸå‘é€æ¶ˆæ¯ï¼Œå¹¶æ¥æ”¶å¼€æ”¾åŸŸè¿”å›è¿‡æ¥çš„æ•°æ®ï¼Œ * å¯æ ¹æ®å‘é€å‚æ•°å’Œæ¥æ”¶æ•°æ®åœ¨ä¸»åŸŸè¿™è¾¹è¿›è¡Œä¸‹æ­¥å¤„ç† * @param message * @param caller * @param callback */ function wxPostMessage(message, caller, callback){ window['wx'].postMessage(message); Laya.timer.once(400, this, function (){ //å›è°ƒå¤„ç† if (caller == null || caller == undefined) { callback(message); } else { caller.callback(message); } }); } è¿™è¾¹ä¸»è¦å‘é€çš„æ¶ˆæ¯ä½“ä¸­æºå¸¦äº†commandå­—æ®µï¼Œç”¨äºåœ¨å¼€æ”¾åŸŸæ‰§è¡Œä¸åŒçš„åŠŸèƒ½ä»£ç ï¼Œè¿™è¾¹å¤§ä½“åˆ†ä¸ºï¼šèµ„æºåŠ è½½å‘½ä»¤ã€åˆå§‹åŒ–æ’è¡Œæ¦œå¤§å°å‘½ä»¤ã€è·å–å…³ç³»é“¾(æ’è¡Œæ¦œ)æ•°æ®å‘½ä»¤ä»¥åŠå…³é—­æ’è¡Œæ¦œçš„å‘½ä»¤ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®ä¸šåŠ¡å…·ä½“éœ€è¦é€‚å½“å¢å‡ã€‚ å¼€æ”¾åŸŸç»˜åˆ¶æ ¹æ®å®˜æ–¹çš„è¯´æ˜ï¼Œå¼€æ”¾æ•°æ®åŸŸ æ˜¯ä¸€ä¸ªå°é—­ã€ç‹¬ç«‹çš„ JavaScript ä½œç”¨åŸŸã€‚è¦è®©ä»£ç è¿è¡Œåœ¨å¼€æ”¾æ•°æ®åŸŸï¼Œéœ€è¦åœ¨ game.json ä¸­æ·»åŠ é…ç½®é¡¹ openDataContext æŒ‡å®šå¼€æ”¾æ•°æ®åŸŸçš„ä»£ç ç›®å½•ã€‚æ·»åŠ è¯¥é…ç½®é¡¹è¡¨ç¤ºå°æ¸¸æˆå¯ç”¨äº†å¼€æ”¾æ•°æ®åŸŸï¼Œè¿™å°†ä¼šå¯¼è‡´ä¸€äº› é™åˆ¶ã€‚è¿™äº›é™åˆ¶ä¸»è¦åŒ…å«ï¼š æ— æ³•è®¾ç½®sharedCanvasçš„å®½é«˜ åªèƒ½ä½¿ç”¨æœ‰é™çš„æ¥å£(å¦‚é€å¸§åŠ¨ç”»ã€Timerã€è§¦æ‘¸äº‹ä»¶ä»¥åŠè·å–å’Œè®¾ç½®å…³ç³»é“¾æ•°æ®ç­‰æ¥å£) ä¸‹é¢æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥åœ¨å¼€æ”¾åŸŸç»˜åˆ¶æ’è¡Œæ¦œã€‚ é¦–å…ˆï¼Œéœ€è¦æ–°å»ºä¸€ä¸ªé¡¹ç›®ä½œä¸ºå¼€æ”¾åŸŸï¼Œè¿™ä¸ªé¡¹ç›®ç›®å½•æ˜¯ä¸ä¸»åŸŸé¡¹ç›®å¹³è¡Œçš„(ä¸»åŸŸå°±æ˜¯æœªåšæ’è¡Œæ¦œä¹‹å‰çš„é¡¹ç›®ç›®å½•)ï¼Œæ¯”å¦‚æˆ‘çš„é¡¹ç›®ç›®å½•æ˜¯è¿™æ ·çš„ï¼š æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¼€æ”¾åŸŸä¸­æ¥æ”¶ä¸»åŸŸå‘é€çš„æ¶ˆæ¯å¹¶å¤„ç†ä¸åŒçš„åŠŸèƒ½å‘½ä»¤ï¼ŒUIå°±ä¸æ”¾äº†ï¼Œçœ‹çœ‹å…·ä½“ä»£ç å§ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263/** * ç›‘å¬ä»ä¸»åŸŸå‘è¿‡æ¥çš„æ¶ˆæ¯ */ function wxOnMessage(){ if(window['wx'] != undefined){ window['wx'].onMessage(function (message){ dispatchMessage(message); }); }else{ console.log(&quot;å¾®ä¿¡æ¥å£æ— æ³•ä½¿ç”¨ï½&quot;); } } /** * å¤„ç†æ¶ˆæ¯ * @param {*} message */ function dispatchMessage(message){ switch(message.command){ //è®¾ç½®å¼€æ”¾åŸŸç”»å¸ƒå¤§å° case 0: sample.setCanvasSize(message.canvasData); break; //åŠ è½½èµ„æº case 1: sample.loadResource(); break; //å†™å…¥æ’è¡Œæ¦œæ•°æ® case 2: sample.writeRankingData(message.rankingData); break; //è·å–å¾®ä¿¡æ’è¡Œæ¦œæ•°æ® case 3: sample.getRankingData(); break; //å…³é—­æ’è¡Œæ¦œ case 4: sample.closeRankingDialog(); break; default: console.log(JSON.stringify(message)); } } /** * è®¾ç½®å¼€æ”¾åŸŸç”»å¸ƒå¤§å° * @param {*} size */ _proto.setCanvasSize = function(size){ console.log(&quot;è®¾ç½®å¼€æ”¾åŸŸcanvaså¤§å°ï½&quot;); window['sharedCanvas'].width = size.width; window['sharedCanvas'].height = size.height; //Laya.stage.width = size.width; //Laya.stage.width = size.height; /** * å°†ä¸»åŸŸçš„canvasTransformæ˜ å°„åˆ°å¼€æ”¾åŸŸ */ if(size.matrix!=null){ console.log(&quot;æ”¶åˆ°ä¸»åŸŸçš„åŒæ­¥canvasTransformäº†ï½&quot;); } var mainMatrix = size.matrix; var openMatrix = new Laya.Matrix(); openMatrix.a = mainMatrix.a; openMatrix.b = mainMatrix.b; openMatrix.c = mainMatrix.c; openMatrix.d = mainMatrix.d; openMatrix.tx = mainMatrix.tx; openMatrix.ty = mainMatrix.ty; //é‡ç½®çŸ©é˜µ Laya.stage._canvasTransform = openMatrix; //ç›‘å¬èˆå°çš„é¼ æ ‡ç§»åŠ¨äº‹ä»¶ Laya.stage.mouseEnabled = true; } /** * ç”¨æˆ·è‡ªå·±çš„æ’å */ var myRanking = -1; /** * è·å–å¾®ä¿¡æ’è¡Œæ¦œæ•°æ® */ _proto.getRankingData = function(){ window['wx'].getUserInfo({ openIdList: ['selfOpenId'], success: (userRes) =&gt; { console.log('success', userRes.data); //ç´¢å¼•ä»£è¡¨å„ä¸ªå¥½å‹0ä¸ºè‡ªå·± let userData = userRes.data[0]; console.log(&quot;å–ä¿¡æ¯ç´¢å¼•0&quot; + userData.nickName); //å–å‡ºæ‰€æœ‰å¥½å‹æ•°æ® window['wx'].getFriendCloudStorage({ keyList: [ //'å‡»æ€æ’è¡Œ', 'ç¬¬1å…³', 'ç¬¬2å…³', 'ç¬¬3å…³' ], success: res =&gt; { console.log(&quot;wx.getFriendCloudStorage success&quot;, res); let data = res.data; /*data.sort((a, b) =&gt; { if (a.KVDataList.length == 0 &amp;&amp; b.KVDataList.length == 0) { return 0; } if (a.KVDataList.length == 0) { return 1; } if (b.KVDataList.length == 0) { return -1; } return b.KVDataList[0].value - a.KVDataList[0].value; });*/ for (let i = 0; i &lt; data.length; i++) { var playerInfo = data[i]; var currentPlayer = res.data[i].nickname; console.log(&quot;å½“å‰æ’è¡Œç©å®¶æ˜µç§°ä¸º=&gt;&quot;+res.data[i].nickname); var kvList = playerInfo.KVDataList; var scoreSum = 0; if(kvList.length&gt;0){ for(var j = 0;j&lt;kvList.length;j++){ if(kvList[j].key != null){ //å°†valueè½¬åŒ–ä¸ºintå†ç´¯åŠ  scoreSum+=Number(kvList[j].value); } } } if (data[i].avatarUrl == userData.avatarUrl) { //è·å–ç¾¤å¥½å‹çš„æ—¶å€™,æ²¡æœ‰è‡ªå·±çš„åå­—?? data[i].nickName = userData.nickName; myRanking = i+1; console.log(&quot;æ­¤IDä¸ºè‡ªå·±,å½“å‰æ’åç¬¬&quot;+myRanking); } //å¡«å……æ€»åˆ†ä¿¡æ¯ sortData.push({ nickName: currentPlayer, avatarUrl: data[i].avatarUrl, totalScore: scoreSum }); } sortData.sort((a, b) =&gt; { var score1 = Number(a.totalScore); var score2 = Number(b.totalScore); if (score1 &gt; score2) { return -1; }else if(score1 &lt; score2){ return 1; }else{ return 0; } }); showRankingDialog(); }, fail: res =&gt; { console.log(&quot;æ‹‰å–å¥½å‹ä¿¡æ¯å¤±è´¥&quot;, res); }, }); }, fail: (res) =&gt; { console.log(&quot;æ‹‰å–ä¸ªäººä¿¡æ¯å¤±è´¥&quot;) } }); } /** * åŠ è½½èµ„æº */ _proto.loadResource = function(){ Laya.loader.load([&quot;comp/bg_line.png&quot;,&quot;comp/ranking1.png&quot;,&quot;comp/ranking2.png&quot;, &quot;comp/ranking3.png&quot;,&quot;comp/userholder_img.png&quot;], Laya.Handler.create(null,function(){ console.log(&quot;å¼€æ”¾åŸŸèµ„æºåŠ è½½å®Œæ¯•ï½&quot;); sample.rankView = new RankingViewUI(); Laya.stage.addChild(sample.rankView); })); } /** * å†™å…¥æ’è¡Œæ¦œæ•°æ® */ _proto.writeRankingData = function(rankingData){ console.log(&quot;å†™å…¥æ’è¡Œæ¦œæ•°æ®ï½&quot;); //KVDataListä»£è¡¨æ’è¡Œæ•°æ®,å¯ä»¥ä¸ºå¤šä¸ª,å¤šä¸ªä»£è¡¨å¤šä¸ªæ’è¡Œ //key-æ’è¡Œç±»å‹,value-æ’è¡Œåˆ†æ•° window['wx'].setUserCloudStorage({ KVDataList: [ //{ key: 'å‡»æ€æ’è¡Œ', value: &quot;&quot; + 1 }, { key: 'ç¬¬'+rankingData.fightLevel+'å…³', value: rankingData.fightScore+&quot;&quot; },//éœ€è¦æ”¹æˆåŠ¨æ€çš„å€¼ ], success: function (res) { console.log('setUserCloudStorage', 'success', res) }, fail: function (res) { console.log('setUserCloudStorage', 'fail') } }); } var sortData = []; /** * æ¸²æŸ“æ’è¡Œæ¦œåˆ—è¡¨ */ function showRankingDialog(){ console.log(&quot;æ‹¿åˆ°å¥½å‹æ’è¡Œæ¦œä¿¡æ¯&quot;, sortData); sample.rankView.ranking_list.vScrollBarSkin = &quot;&quot;; sample.rankView.ranking_list.array = sortData; sample.rankView.ranking_list.renderHandler = new Laya.Handler(this, onRender); sample.rankView.ranking_list.selectHandler = new Laya.Handler(this, onSelect); } var lastRenderIndex = -1; function onRender(cell, index){ if (index == lastRenderIndex) { return; } lastRenderIndex = index; //æ ¹æ®å­èŠ‚ç‚¹çš„nameè·å–å­èŠ‚ç‚¹å¯¹è±¡ var name = cell.getChildByName(&quot;item_rank_name&quot;); var ranking = cell.getChildByName(&quot;item_rank_text&quot;); var userlogo = cell.getChildByName(&quot;item_rank_logo&quot;); var score = cell.getChildByName(&quot;item_rank_score&quot;); var rank_icon = cell.getChildByName(&quot;item_rank_icon&quot;); name.text = sortData[index].nickName; console.log(&quot;æ¸²æŸ“æ’è¡Œæ¦œå½“å‰çš„ç”¨æˆ·åä¸º=&quot;+sortData[index].nickName+&quot;ï¼Œæ¸²æŸ“ç´¢å¼•ï¼š&quot;+lastRenderIndex); ranking.text = (index+1)+&quot;&quot;; userlogo.skin = sortData[index].avatarUrl; score.text = sortData[index].totalScore+&quot;åˆ†&quot;; if(lastRenderIndex === 0 || lastRenderIndex === 1 || lastRenderIndex === 2){ ranking.visible = false; rank_icon.visible = true; rank_icon.skin = &quot;comp/ranking&quot;+(lastRenderIndex+1)+&quot;.png&quot;; }else{ rank_icon.visible = false; ranking.visible = true; } } function onSelect(index){ console.log(&quot;å½“å‰é€‰æ‹©çš„ç´¢å¼•æ˜¯ï¼š&quot;+index); } /** * å…³é—­æ’è¡Œæ¦œ */ _proto.closeRankingDialog = function(){ //dialog.close(); console.log(&quot;å…³é—­æ’è¡Œæ¦œï½&quot;); sortData = []; lastRenderIndex = -1; sample.rankView.removeChildren(); sample.rankView = null; } _proto.start = function(){ console.log(&quot;å¼€å§‹æ¥æ”¶ä¸»åŸŸçš„æ¶ˆæ¯ï½&quot;); wxOnMessage(); }} å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¿™é‡Œé€šè¿‡ wx.onMessage æ–¹æ³•æ¥è·å–ä¸»åŸŸå‘é€çš„æ•°æ®ï¼Œç„¶åå€ŸåŠ© dispatchMessage æ–¹æ³•ä½œæ¶ˆæ¯çš„åˆ†å‘å¤„ç†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨è®¾ç½®å¼€æ”¾åŸŸcanvaså¤§å°çš„æ—¶å€™ï¼Œéœ€è¦é‡ç½®åæ ‡çŸ©é˜µï¼Œå°†ä¸»åŸŸçš„æ’è¡Œæ¦œæ˜¾ç¤ºä½ç½®æ˜ å°„åˆ°å¼€æ”¾åŸŸä¸­æ¥ï¼Œå¦åˆ™ä¼šå‘ç”Ÿæ»‘åŠ¨æ— æ•ˆçš„é—®é¢˜ã€‚æˆ‘è¿™é‡Œè®¾ç½®çš„æ’è¡Œæ¦œæ•°æ®æœ‰ä¸‰æ¡ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚æ¥ä¼ å…¥ï¼Œè·å–åˆ°æ’è¡Œæ¦œæ•°æ®åï¼Œéœ€è¦å¯¹å®ƒè¿›è¡Œæ’åºå¤„ç†å¹¶å±•ç¤ºï¼Œè¿™é‡Œç›´æ¥å€ŸåŠ©äºlayaä¸­çš„ List æ§ä»¶å±•ç¤ºå°±å¯ä»¥äº†ï¼Œå¯¹äºå®ƒç”¨æ³•ä¸ç†Ÿæ‚‰çš„å¯ä»¥å»layaå®˜ç½‘äº†è§£ä¸€ä¸‹ï¼šhttps://ldc.layabox.com/doc/?nav=zh-js-6-0-0 å¼€æ”¾åŸŸå›¾ç‰‡åŠ è½½é—®é¢˜ï¼šç”¨è¿‡layaæ¸¸æˆå¼•æ“çš„éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨å®˜æ–¹æ¨èçš„æ‰“åŒ…å›¾é›†çš„æ–¹å¼æ¥åŠ è½½æ¸¸æˆä¸­çš„å›¾ç‰‡èµ„æºï¼Œè¿™ç§æ–¹å¼åœ¨ä¸»åŸŸä¸­æ˜¯å¯è¡Œçš„ï¼Œç„¶è€Œï¼Œåœ¨å¼€æ”¾åŸŸä¸­å´ä¸èƒ½æˆåŠŸåŠ è½½å›¾ç‰‡èµ„æºã€‚å› æ­¤ï¼Œå¼€æ”¾åŸŸä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦å°†å›¾ç‰‡èµ„æºæ‰“åŒ…æˆå›¾é›†ï¼Œåªè¦åƒä¸‹é¢è¿™æ ·ç›´æ¥åŠ è½½å›¾ç‰‡å³å¯ï¼š 123456789101112/** * åŠ è½½èµ„æº */ _proto.loadResource = function(){ Laya.loader.load([&quot;comp/bg_line.png&quot;,&quot;comp/ranking1.png&quot;,&quot;comp/ranking2.png&quot;, &quot;comp/ranking3.png&quot;,&quot;comp/userholder_img.png&quot;], Laya.Handler.create(null,function(){ console.log(&quot;å¼€æ”¾åŸŸèµ„æºåŠ è½½å®Œæ¯•ï½&quot;); sample.rankView = new RankingViewUI(); Laya.stage.addChild(sample.rankView); })); } ç„¶åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å¯¹åº”çš„å›¾ç‰‡æ–‡ä»¶å¤¹æ‹·è´åˆ°wx_publishç›®å½•ä¸‹ï¼Œå¦åˆ™ä¼šæç¤ºæ‰¾ä¸åˆ°å›¾ç‰‡èµ„æºã€‚ åˆå¹¶ä¸»åŸŸå’Œå¼€æ”¾åŸŸä¸»åŸŸå’Œå¼€æ”¾åŸŸåŠŸèƒ½ä»£ç å®ç°äº†ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰“åŒ…æˆå¾®ä¿¡å°æ¸¸æˆé¡¹ç›®äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†ä¸»åŸŸé¡¹ç›®å‘å¸ƒæˆå¾®ä¿¡å°æ¸¸æˆï¼Œå‘å¸ƒç›®å½•ç›´æ¥ä¸ºé¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¦‚ä¸Šå›¾çš„ wx_publish ç›®å½•ã€‚ç„¶åï¼Œåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºsrc/myOpenDataContextç›®å½•ã€‚æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦å°†å¼€æ”¾åŸŸé¡¹ç›®ä¹Ÿå‘å¸ƒæˆå¾®ä¿¡å°æ¸¸æˆï¼Œç›®å½•å¯ä»¥é€‰æ‹©æ¡Œé¢ï¼Œåç§°ä¸º wx_openï¼Œå‘å¸ƒæˆåŠŸåï¼Œè¿›å…¥è¯¥ç›®å½•ï¼Œå°†code.jsã€weapp-adapter.jsä»¥åŠindex.jsæ–‡ä»¶å¤åˆ¶åˆ° wx_publish/src/myOpenDataContext ç›®å½•ä¸‹ï¼Œå¹¶åœ¨ game.json æ–‡ä»¶ä¸­å¢åŠ å¼€æ”¾åŸŸæ˜ å°„ç›®å½•ï¼š 123456789101112{ &quot;deviceOrientation&quot;: &quot;portrait&quot;, &quot;showStatusBar&quot;: &quot;false&quot;, &quot;networkTimeout&quot;: { &quot;request&quot;: 10000, &quot;connectSocket&quot;: 10000, &quot;uploadFile&quot;: 10000, &quot;downloadFile&quot;: 10000 }, &quot;openDataContext&quot;: &quot;src/myOpenDataContext&quot;} åˆ°è¿™é‡Œï¼Œå¾®ä¿¡å°æ¸¸æˆæ’è¡Œæ¦œåŠŸèƒ½å°±ç®—å®ç°äº†ï¼Œåˆ°å¤´æ¥å‘ç°ï¼Œå…¶å®å®ç°èµ·æ¥å¹¶ä¸éš¾ï¼Œéš¾çš„æ˜¯ç¼ºä¹èµ„æ–™ï¼Œæ­¤æ–‡ä»…ç”¨æ¥æŠ›ç –å¼•ç‰ï¼Œå¦‚æœ‰é—®é¢˜æ¬¢è¿æå‡ºã€‚","link":"/2018/09/20/wechat-game-rank/"}],"tags":[{"name":"Gradle","slug":"Gradle","link":"/tags/Gradle/"},{"name":"æœªæ¥è§„åˆ’","slug":"æœªæ¥è§„åˆ’","link":"/tags/%E6%9C%AA%E6%9D%A5%E8%A7%84%E5%88%92/"},{"name":"æ€»ç»“","slug":"æ€»ç»“","link":"/tags/%E6%80%BB%E7%BB%93/"},{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","link":"/tags/%E8%AF%BB%E4%B9%A6/"},{"name":"åœ°å›¾å¯¼èˆª","slug":"åœ°å›¾å¯¼èˆª","link":"/tags/%E5%9C%B0%E5%9B%BE%E5%AF%BC%E8%88%AA/"},{"name":"é«˜å¾·åœ°å›¾","slug":"é«˜å¾·åœ°å›¾","link":"/tags/%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE/"},{"name":"MotionLayout","slug":"MotionLayout","link":"/tags/MotionLayout/"},{"name":"Android åŠ¨ç”»","slug":"Android-åŠ¨ç”»","link":"/tags/Android-%E5%8A%A8%E7%94%BB/"},{"name":"è¾“å…¥æç¤º","slug":"è¾“å…¥æç¤º","link":"/tags/%E8%BE%93%E5%85%A5%E6%8F%90%E7%A4%BA/"},{"name":"è‡ªå®šä¹‰Marker","slug":"è‡ªå®šä¹‰Marker","link":"/tags/%E8%87%AA%E5%AE%9A%E4%B9%89Marker/"},{"name":"Proguard","slug":"Proguard","link":"/tags/Proguard/"},{"name":"Markerèšåˆ","slug":"Markerèšåˆ","link":"/tags/Marker%E8%81%9A%E5%90%88/"},{"name":"Android tools","slug":"Android-tools","link":"/tags/Android-tools/"},{"name":"ConstraintLayout","slug":"ConstraintLayout","link":"/tags/ConstraintLayout/"},{"name":"Android","slug":"Android","link":"/tags/Android/"},{"name":"è¯„è®ºå›å¤","slug":"è¯„è®ºå›å¤","link":"/tags/%E8%AF%84%E8%AE%BA%E5%9B%9E%E5%A4%8D/"},{"name":"UIæ•ˆæœ","slug":"UIæ•ˆæœ","link":"/tags/UI%E6%95%88%E6%9E%9C/"},{"name":"Flutter","slug":"Flutter","link":"/tags/Flutter/"},{"name":"Dart","slug":"Dart","link":"/tags/Dart/"},{"name":"AppBar","slug":"AppBar","link":"/tags/AppBar/"},{"name":"Google","slug":"Google","link":"/tags/Google/"},{"name":"Google develop days","slug":"Google-develop-days","link":"/tags/Google-develop-days/"},{"name":"å±•ä¼š","slug":"å±•ä¼š","link":"/tags/%E5%B1%95%E4%BC%9A/"},{"name":"Image selector","slug":"Image-selector","link":"/tags/Image-selector/"},{"name":"Jcenter","slug":"Jcenter","link":"/tags/Jcenter/"},{"name":"å¼€æº","slug":"å¼€æº","link":"/tags/%E5%BC%80%E6%BA%90/"},{"name":"Kotlin","slug":"Kotlin","link":"/tags/Kotlin/"},{"name":"Anko","slug":"Anko","link":"/tags/Anko/"},{"name":"Mac","slug":"Mac","link":"/tags/Mac/"},{"name":"å¿«æ·é”®","slug":"å¿«æ·é”®","link":"/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"name":"å¼€å‘æ•ˆç‡","slug":"å¼€å‘æ•ˆç‡","link":"/tags/%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87/"},{"name":"MVP","slug":"MVP","link":"/tags/MVP/"},{"name":"Android architecture","slug":"Android-architecture","link":"/tags/Android-architecture/"},{"name":"å¾®ä¿¡å°æ¸¸æˆ","slug":"å¾®ä¿¡å°æ¸¸æˆ","link":"/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E6%B8%B8%E6%88%8F/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"æ¸¸æˆè„šæœ¬","slug":"æ¸¸æˆè„šæœ¬","link":"/tags/%E6%B8%B8%E6%88%8F%E8%84%9A%E6%9C%AC/"},{"name":"Layabox","slug":"Layabox","link":"/tags/Layabox/"},{"name":"æ¸¸æˆæ’è¡Œæ¦œ","slug":"æ¸¸æˆæ’è¡Œæ¦œ","link":"/tags/%E6%B8%B8%E6%88%8F%E6%8E%92%E8%A1%8C%E6%A6%9C/"}],"categories":[{"name":"Android Gradle","slug":"Android-Gradle","link":"/categories/Android-Gradle/"},{"name":"ä¸ªäººæ€»ç»“","slug":"ä¸ªäººæ€»ç»“","link":"/categories/%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93/"},{"name":"Android","slug":"Android","link":"/categories/Android/"},{"name":"åœ°å›¾å¼€å‘","slug":"Android/åœ°å›¾å¼€å‘","link":"/categories/Android/%E5%9C%B0%E5%9B%BE%E5%BC%80%E5%8F%91/"},{"name":"åŠ¨ç”»","slug":"Android/åŠ¨ç”»","link":"/categories/Android/%E5%8A%A8%E7%94%BB/"},{"name":"å¼€æº","slug":"Android/å¼€æº","link":"/categories/Android/%E5%BC%80%E6%BA%90/"},{"name":"Flutter","slug":"Flutter","link":"/categories/Flutter/"},{"name":"Google","slug":"Google","link":"/categories/Google/"},{"name":"Proguard","slug":"Android/Proguard","link":"/categories/Android/Proguard/"},{"name":"Jcenter","slug":"Jcenter","link":"/categories/Jcenter/"},{"name":"Kotlin","slug":"Kotlin","link":"/categories/Kotlin/"},{"name":"Mac","slug":"Mac","link":"/categories/Mac/"},{"name":"Architecture","slug":"Android/Architecture","link":"/categories/Android/Architecture/"},{"name":"å¾®ä¿¡å°æ¸¸æˆ","slug":"å¾®ä¿¡å°æ¸¸æˆ","link":"/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E6%B8%B8%E6%88%8F/"},{"name":"Dart","slug":"Flutter/Dart","link":"/categories/Flutter/Dart/"},{"name":"Meeting","slug":"Google/Meeting","link":"/categories/Google/Meeting/"}]}